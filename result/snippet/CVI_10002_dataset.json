[{"slice": "<?php\n// php code: \n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]){\n$query = \"SELECT user_id FROM session where session_id = '\".$_GET[\"sid\"].\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 0, "slice_label": "bad", "file_name": "D:\\bad_2179_13.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB \t= new CentreonDB();\n\t$is_admin = isUserAdmin($_GET[\"sid\"]);\n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]){\n\t\t$DBRESULT = $pearDB->query(\"SELECT user_id FROM session where session_id = '\".$_GET[\"sid\"].\"'\");\n\t\t$session = $DBRESULT->fetchRow();\n\t\t$access = new CentreonAcl($session[\"user_id\"], $is_admin);\n}\n\t$normal_mode = 1;\n\t$type = \"root\";\n\tif (strlen($url_var) > 1){\n\t\t$type = substr($url_var, 0, 2);\n}\n\tif ($normal_mode){\n\t\tif ($type == \"HG\") {\n}\nelse if ($type == \"ST\") {\n}\nelse if ($type == \"HH\") {\n}\nelse if ($type == \"HS\") {\n}\nelse if ($type == \"HO\") {\n}\nelse if ($type == \"RS\") {\n}\nelse if ($type == \"MT\") {\n\t\t\tif ($is_admin)\n;\n$query = \"SELECT * FROM meta_service WHERE `meta_activate` = '1' AND `meta_id` IN (\".$access->getMetaServiceString().\") ORDER BY `meta_name`\";\t\t//sink point: $access;\n$res = mysql_query($query);\n}\n}\n\n", "id": 1, "slice_label": "bad", "file_name": "D:\\bad_2179_13.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$mobileid = $_GET['input0'];\n$email = $_GET['input1'];\n\n// php code: \n\t\tif ( ! User_Devices_Model::device_registered($mobileid))\n\t\t{\n\t\t\t$user_email = ($email) ? $email : $this->getRandomString();\n$query = 'SELECT id FROM '._PAD_->table_prefix.'users WHERE `email` = \\''.$user_email.'\\' LIMIT 1;';\t\t//sink point: $user_email;\n$res = mysql_query($query);\n}\n\n", "id": 2, "slice_label": "bad", "file_name": "D:\\bad_3703_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$mobileid = $_GET['input0'];\n\n// php code: \n\t\tif ( ! User_Devices_Model::device_registered($mobileid))\n\t\t{\n$query = 'SELECT id FROM '.$this->table_prefix.'users WHERE `email` = \\''._PAD_.'\\' LIMIT 1;';\t\t//sink point: $this;\n$res = mysql_query($query);\n}\n\n", "id": 3, "slice_label": "bad", "file_name": "D:\\bad_3703_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"index_id\"]) && $_GET[\"index_id\"] != 0) {\n$query = \"SELECT metric_id, metric_name FROM metrics as ms, index_data as ixd WHERE ms.index_id = ixd.id and ms.index_id='\".$_GET[\"index_id\"].\"';\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 4, "slice_label": "bad", "file_name": "D:\\bad_2179_14.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$where = \"\";\n\tif (isset($_GET[\"vdef\"]) && $_GET[\"vdef\"] == 0)\n\t\t$where = \" AND def_type='\".$_GET[\"vdef\"].\"'\";\n\tif (isset($_GET[\"index_id\"]) && $_GET[\"index_id\"] != 0) {\n$query = \"SELECT vmetric_id, vmetric_name, def_type FROM virtual_metrics WHERE index_id='\"._PAD_.\"'\".$where.\";\";\t\t//sink point: $where;\n$res = mysql_query($query);\n}\n\n", "id": 5, "slice_label": "bad", "file_name": "D:\\bad_2179_14.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"index_id\"]) && $_GET[\"index_id\"] != 0) {\n$query = \"SELECT vmetric_id, vmetric_name, def_type FROM virtual_metrics WHERE index_id='\".$_GET[\"index_id\"].\"'\"._PAD_.\";\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 6, "slice_label": "bad", "file_name": "D:\\bad_2179_14.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_GET[\"service_id\"]) && $_GET[\"service_id\"]) {\n$query = \"SELECT service_description, service_id FROM service WHERE service_template_model_stm_id = '\"._PAD_->escape($_GET[\"service_id\"]).\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 7, "slice_label": "bad", "file_name": "D:\\good_2179_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_GET[\"service_id\"]) && $_GET[\"service_id\"]) {\n$query = \"SELECT service_description, service_id FROM service WHERE service_template_model_stm_id = '\".$pearDB->escape(_PAD_).\"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n}\n\n", "id": 8, "slice_label": "bad", "file_name": "D:\\good_2179_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (count($_POST)>0) {\n\t\tif (if_group(\"superadmin\")){\n}\nelse if (if_group(\"admin\") && file_exists($_SERVER[\"PROJECT_ROOT\"].\"/app/billing/app_config.php\")){\n$query = \"SELECT COUNT(*) as count FROM v_billings WHERE domain_uuid = '\"._PAD_.\"' AND type_value='\".$_POST[\"accountcode\"].\"'\";\t\t//sink point: $_POST;\n$res = mysql_query($query);\n}\n}\n\n", "id": 9, "slice_label": "bad", "file_name": "D:\\bad_1147_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (count($_POST)>0) {\n\t\tif (if_group(\"superadmin\")){\n}\nelse if (if_group(\"admin\") && file_exists($_SERVER[\"PROJECT_ROOT\"].\"/app/billing/app_config.php\")){\n$query = \"SELECT COUNT(*) as count FROM v_billings WHERE domain_uuid = '\".$_SESSION['domain_uuid'].\"' AND type_value='\"._PAD_.\"'\";\t\t//sink point: $_SESSION;\n$res = mysql_query($query);\n}\n}\n\n", "id": 10, "slice_label": "bad", "file_name": "D:\\bad_1147_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$add = $_GET['input0'];\n$second_category = $_GET['input1'];\n\n// php code: \n    $addsub = ($add) ? '+' : '-';\n    if ($second_category > 0) {\n$query = \"UPDATE \" . _PAD_ . \"categories SET counter = counter \" . $addsub . \" 1 WHERE cat_id = :cat_id\";\t\t//sink point: $addsub;\n$res = mysql_query($query);\n}\n\n", "id": 11, "slice_label": "bad", "file_name": "D:\\bad_56_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$second_category = $_GET['input0'];\n\n// php code: \n    if ($second_category > 0) {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET counter = counter \" . _PAD_ . \" 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 12, "slice_label": "bad", "file_name": "D:\\bad_56_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$second_category = $_GET['input0'];\n\n// php code: \n    if ($second_category > 0) {\n$query = \"SELECT left_id, right_id, level FROM \" . $DBPrefix . \"categories WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 13, "slice_label": "bad", "file_name": "D:\\bad_56_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$add = $_GET['input0'];\n$category = $_GET['input1'];\n$second_category = $_GET['input2'];\n\n// php code: \n    $addsub = ($add) ? '+' : '-';\n    $query0 = \"UPDATE \" . $DBPrefix . \"categories SET counter = counter \" . $addsub . \" 1 WHERE cat_id = :cat_id\";\n    $params = array();\n    $params[] = array(':cat_id', $category, 'int');\n    $db->query($query0, $params);\n    $db->query($query0, $params);\n    $parent_node = $db->result();\n    $category_crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n    if ($second_category > 0) {\n        $second_category_crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n        $crumbs = $category_crumbs + $second_category_crumbs;\n    }\nelse {\n        $crumbs = $category_crumbs;\n    }\n    for ($i = 0; $i < count($crumbs); $i++) {\n$query = \"UPDATE \" . _PAD_ . \"categories SET sub_counter = sub_counter \" . $addsub . \" 1 WHERE cat_id = :cat_id\";\t\t//sink point: $addsub;\n$res = mysql_query($query);\n}\n\n", "id": 14, "slice_label": "bad", "file_name": "D:\\bad_56_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$add = $_GET['input0'];\n$category = $_GET['input1'];\n$second_category = $_GET['input2'];\n\n// php code: \n    $addsub = ($add) ? '+' : '-';\n    $query0 = \"UPDATE \" . $DBPrefix . \"categories SET counter = counter \" . $addsub . \" 1 WHERE cat_id = :cat_id\";\n    $params = array();\n    $params[] = array(':cat_id', $category, 'int');\n    $db->query($query0, $params);\n    $db->query($query0, $params);\n    $parent_node = $db->result();\n    $category_crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n    if ($second_category > 0) {\n        $second_category_crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n        $crumbs = $category_crumbs + $second_category_crumbs;\n    }\nelse {\n        $crumbs = $category_crumbs;\n    }\n    for ($i = 0; $i < count($crumbs); $i++) {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET sub_counter = sub_counter \" . _PAD_ . \" 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 15, "slice_label": "bad", "file_name": "D:\\bad_56_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$pearDB = new CentreonDB();\n$mnftr_id = $pearDB->escape($_POST[\"mnftr_id\"]);\nif (isset($_POST[\"mnftr_id\"])){\n    if ($_POST[\"mnftr_id\"] == -1) {\n}\nelse if ($_POST[\"mnftr_id\"] == -2) {\n}\nelse if ($_POST[\"mnftr_id\"] != 0) {\n$query = \"SELECT traps_id, traps_name FROM traps WHERE manufacturer_id = \" . $mnftr_id . \" ORDER BY traps_name\";\t\t//sink point: $mnftr_id;\n$res = mysql_query($query);\n    }\n}\n\n", "id": 16, "slice_label": "bad", "file_name": "D:\\good_2179_7.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$object = $_GET['input0'];\n$table = $_GET['input1'];\n$identifier = $_GET['input2'];\n$is_revisioned = $_GET['input3'];\n\n// php code: \n        if ($is_revisioned) {\n            $this->trim_revisions($table, $object->$identifier, WORKFLOW_REVISION_LIMIT);\n}\n$query = \"UPDATE \" . _PAD_->prefix . \"$table SET \";\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 17, "slice_label": "bad", "file_name": "D:\\good_5278_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$object = $_GET['input0'];\n$table = $_GET['input1'];\n$identifier = $_GET['input2'];\n$is_revisioned = $_GET['input3'];\n\n// php code: \n        if ($is_revisioned) {\n            $this->trim_revisions($table, $object->$identifier, WORKFLOW_REVISION_LIMIT);\n}\n$query = \"UPDATE \" . $this->prefix . \"_PAD_ SET \";\t\t//sink point: $this;\n$res = mysql_query($query);\n\n", "id": 18, "slice_label": "bad", "file_name": "D:\\good_5278_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$query = \"SELECT * FROM `session` WHERE session_id = '\".$_GET[\"session_id\"].\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 19, "slice_label": "bad", "file_name": "D:\\bad_2179_15.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n\t$session = $pearDB->query(\"SELECT * FROM `session` WHERE session_id = '\".$_GET[\"session_id\"].\"'\");\n\tif (!$session->numRows()){\n}\nelse {\n\t \t$CentreonGMT = new CentreonGMT($pearDB);\n\t \t$CentreonGMT->getMyGMTFromSession($_GET[\"session_id\"], $pearDB);\n\t\tif (!isset($_GET[\"host_name\"]) && !isset($_GET[\"service_description\"])){\n$query = \"SELECT * FROM index_data WHERE `id` = '\".$_GET[\"index\"].\"' LIMIT 1\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\t\t}\n}\n\n", "id": 20, "slice_label": "bad", "file_name": "D:\\bad_2179_15.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n\t$session = $pearDB->query(\"SELECT * FROM `session` WHERE session_id = '\".$_GET[\"session_id\"].\"'\");\n\tif (!$session->numRows()){\n}\nelse {\n\t \t$CentreonGMT = new CentreonGMT($pearDB);\n\t \t$CentreonGMT->getMyGMTFromSession($_GET[\"session_id\"], $pearDB);\n\t\tif (!isset($_GET[\"host_name\"]) && !isset($_GET[\"service_description\"])){\n}\nelse {\n$query = \"SELECT * FROM index_data WHERE host_name = '\".utf8_encode($_GET[\"host_name\"]).\"' AND `service_description` = '\".utf8_encode($_GET[\"service_description\"]).\"' LIMIT 1\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\t\t}\n}\n\n", "id": 21, "slice_label": "bad", "file_name": "D:\\bad_2179_15.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n\t$session = $pearDB->query(\"SELECT * FROM `session` WHERE session_id = '\".$_GET[\"session_id\"].\"'\");\n\tif (!$session->numRows()){\n}\nelse {\n\t\t$pearDBO = new CentreonDB(\"centstorage\");\n\t\tif (!isset($_GET[\"host_name\"]) && !isset($_GET[\"service_description\"])){\n\t\t\t$DBRESULT = $pearDBO->query(\"SELECT * FROM index_data WHERE `id` = '\".$_GET[\"index\"].\"' LIMIT 1\");\n\t\t}\nelse {\n\t\t\t$DBRESULT = $pearDBO->query(\"SELECT * FROM index_data WHERE host_name = '\".utf8_encode($_GET[\"host_name\"]).\"' AND `service_description` = '\".utf8_encode($_GET[\"service_description\"]).\"' LIMIT 1\");\n\t\t}\n\t\t$index_data_ODS = $DBRESULT->fetchRow();\n\t\tif (!isset($_GET[\"template_id\"])|| !$_GET[\"template_id\"]){\n\t\t\t$host_id = getMyHostID($index_data_ODS[\"host_name\"]);\n\t\t\t$svc_id = getMyServiceID($index_data_ODS[\"service_description\"], $host_id);\n\t\t\t$template_id = getDefaultGraph($svc_id, 1);\n}\n\t\t\t$template_id = $_GET[\"template_id\"];\n$query = \"SELECT * FROM giv_graphs_template WHERE graph_id = '\".$template_id.\"' LIMIT 1\";\t\t//sink point: $template_id;\n$res = mysql_query($query);\n}\n\n", "id": 22, "slice_label": "bad", "file_name": "D:\\bad_2179_15.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n\t$session = $pearDB->query(\"SELECT * FROM `session` WHERE session_id = '\".$_GET[\"session_id\"].\"'\");\n\tif (!$session->numRows()){\n}\nelse {\n\t\t$pearDBO = new CentreonDB(\"centstorage\");\n\t\tif (!isset($_GET[\"host_name\"]) && !isset($_GET[\"service_description\"])){\n\t\t\t$DBRESULT = $pearDBO->query(\"SELECT * FROM index_data WHERE `id` = '\".$_GET[\"index\"].\"' LIMIT 1\");\n\t\t}\nelse {\n\t\t\t$DBRESULT = $pearDBO->query(\"SELECT * FROM index_data WHERE host_name = '\".utf8_encode($_GET[\"host_name\"]).\"' AND `service_description` = '\".utf8_encode($_GET[\"service_description\"]).\"' LIMIT 1\");\n\t\t}\n\t\t$index_data_ODS = $DBRESULT->fetchRow();\n\t\tif (preg_match(\"/meta_([0-9]*)/\", $index_data_ODS[\"service_description\"], $matches)) {\n$query = \"SELECT meta_name FROM meta_service WHERE `meta_id` = '\".$matches[1].\"'\";\t\t//sink point: $matches;\n$res = mysql_query($query);\n}\n}\n\n", "id": 23, "slice_label": "bad", "file_name": "D:\\bad_2179_15.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_SESSION['centreon'])) {\n$query = \"SELECT user_id FROM session WHERE session_id = '\" . _PAD_->escape($_GET['sid']) . \"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 24, "slice_label": "bad", "file_name": "D:\\good_3816_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n\tif (isset($_SESSION['centreon'])) {\n$query = \"SELECT user_id FROM session WHERE session_id = '\" . $pearDB->escape(_PAD_) . \"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n}\n\n", "id": 25, "slice_label": "bad", "file_name": "D:\\good_3816_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$max_age = $_GET['input0'];\n\n// php code: \n\t\t\tif ($max_age) {\n$query = \"SELECT * FROM bigtree_caches WHERE `identifier` = '_PAD_' AND `key` = '_PAD_' AND timestamp >= '\".date(\"Y-m-d H:i:s\",time() - $max_age).\"'\");\t\t//sink point: $max_age;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 26, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$key = $_GET['input0'];\n$max_age = $_GET['input1'];\n\n// php code: \n\t\t\t$key = sqlescape($key);\n\t\t\tif ($max_age) {\n$query = \"SELECT * FROM bigtree_caches WHERE `identifier` = '_PAD_' AND `key` = '$key' AND timestamp >= '\".date(\"Y-m-d H:i:s\",time() - _PAD_).\"'\");\t\t//sink point: $key;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 27, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$identifier = $_GET['input0'];\n$max_age = $_GET['input1'];\n\n// php code: \n\t\t\t$identifier = sqlescape($identifier);\n\t\t\tif ($max_age) {\n$query = \"SELECT * FROM bigtree_caches WHERE `identifier` = '$identifier' AND `key` = '_PAD_' AND timestamp >= '\".date(\"Y-m-d H:i:s\",time() - _PAD_).\"'\");\t\t//sink point: $identifier;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 28, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$key = $_GET['input0'];\n$max_age = $_GET['input1'];\n\n// php code: \n\t\t\t$key = sqlescape($key);\n\t\t\tif ($max_age) {\n}\nelse {\n$query = \"SELECT * FROM bigtree_caches WHERE `identifier` = '_PAD_' AND `key` = '$key'\");\t\t//sink point: $key;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 29, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$identifier = $_GET['input0'];\n$max_age = $_GET['input1'];\n\n// php code: \n\t\t\t$identifier = sqlescape($identifier);\n\t\t\tif ($max_age) {\n}\nelse {\n$query = \"SELECT * FROM bigtree_caches WHERE `identifier` = '$identifier' AND `key` = '_PAD_'\");\t\t//sink point: $identifier;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 30, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$key = $_GET['input0'];\n\n// php code: \n\t\t\t$key = sqlescape($key);\n$query = \"SELECT * FROM bigtree_caches WHERE `identifier` = '_PAD_' AND `key` = '$key'\");\t\t//sink point: $key;\n$res = mysql_query($query);\n\n", "id": 31, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$identifier = $_GET['input0'];\n\n// php code: \n\t\t\t$identifier = sqlescape($identifier);\n$query = \"SELECT * FROM bigtree_caches WHERE `identifier` = '$identifier' AND `key` = '_PAD_'\");\t\t//sink point: $identifier;\n$res = mysql_query($query);\n\n", "id": 32, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$identifier = $_GET['input0'];\n$key = $_GET['input1'];\n$value = $_GET['input2'];\n\n// php code: \n\t\t\t$identifier = sqlescape($identifier);\n\t\t\t$key = sqlescape($key);\n\t\t\t$f = sqlfetch(sqlquery(\"SELECT * FROM bigtree_caches WHERE `identifier` = '$identifier' AND `key` = '$key'\"));\n\t\t\tif (strnatcmp(phpversion(),'5.3') >= 0) {\n\t\t\t\t$value = sqlescape(json_encode($value,JSON_FORCE_OBJECT));\t\t\t\n\t\t\t}\nelse {\n\t\t\t\t$value = sqlescape(json_encode($value));\n\t\t\t}\n\t\t\tif ($f) {\n$query = \"UPDATE bigtree_caches SET `value` = '$value' WHERE `identifier` = '_PAD_' AND `key` = '_PAD_'\";\t\t//sink point: $value;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 33, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$identifier = $_GET['input0'];\n$key = $_GET['input1'];\n\n// php code: \n\t\t\t$identifier = sqlescape($identifier);\n\t\t\t$key = sqlescape($key);\n\t\t\t$f = sqlfetch(sqlquery(\"SELECT * FROM bigtree_caches WHERE `identifier` = '$identifier' AND `key` = '$key'\"));\n\t\t\tif ($f) {\n$query = \"UPDATE bigtree_caches SET `value` = '_PAD_' WHERE `identifier` = '_PAD_' AND `key` = '$key'\";\t\t//sink point: $key;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 34, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$identifier = $_GET['input0'];\n$key = $_GET['input1'];\n\n// php code: \n\t\t\t$identifier = sqlescape($identifier);\n\t\t\t$key = sqlescape($key);\n\t\t\t$f = sqlfetch(sqlquery(\"SELECT * FROM bigtree_caches WHERE `identifier` = '$identifier' AND `key` = '$key'\"));\n\t\t\tif ($f) {\n$query = \"UPDATE bigtree_caches SET `value` = '_PAD_' WHERE `identifier` = '$identifier' AND `key` = '_PAD_'\";\t\t//sink point: $identifier;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 35, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$identifier = $_GET['input0'];\n$key = $_GET['input1'];\n$value = $_GET['input2'];\n\n// php code: \n\t\t\t$identifier = sqlescape($identifier);\n\t\t\t$key = sqlescape($key);\n\t\t\t$f = sqlfetch(sqlquery(\"SELECT * FROM bigtree_caches WHERE `identifier` = '$identifier' AND `key` = '$key'\"));\n\t\t\tif (strnatcmp(phpversion(),'5.3') >= 0) {\n\t\t\t\t$value = sqlescape(json_encode($value,JSON_FORCE_OBJECT));\t\t\t\n\t\t\t}\nelse {\n\t\t\t\t$value = sqlescape(json_encode($value));\n\t\t\t}\n\t\t\tif ($f) {\n}\nelse {\n$query = \"INSERT INTO bigtree_caches (`identifier`,`key`,`value`) VALUES ('_PAD_','_PAD_','$value')\";\t\t//sink point: $value;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 36, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$identifier = $_GET['input0'];\n$key = $_GET['input1'];\n\n// php code: \n\t\t\t$identifier = sqlescape($identifier);\n\t\t\t$key = sqlescape($key);\n\t\t\t$f = sqlfetch(sqlquery(\"SELECT * FROM bigtree_caches WHERE `identifier` = '$identifier' AND `key` = '$key'\"));\n\t\t\tif ($f) {\n}\nelse {\n$query = \"INSERT INTO bigtree_caches (`identifier`,`key`,`value`) VALUES ('_PAD_','$key','_PAD_')\";\t\t//sink point: $key;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 37, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$identifier = $_GET['input0'];\n$key = $_GET['input1'];\n\n// php code: \n\t\t\t$identifier = sqlescape($identifier);\n\t\t\t$key = sqlescape($key);\n\t\t\t$f = sqlfetch(sqlquery(\"SELECT * FROM bigtree_caches WHERE `identifier` = '$identifier' AND `key` = '$key'\"));\n\t\t\tif ($f) {\n}\nelse {\n$query = \"INSERT INTO bigtree_caches (`identifier`,`key`,`value`) VALUES ('$identifier','_PAD_','_PAD_')\";\t\t//sink point: $identifier;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 38, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$path = $_GET['input0'];\n\n// php code: \n\t\t\t$x = count($path);\n\t\t\twhile ($x) {\n$query = \"SELECT * FROM bigtree_route_history WHERE old_route = '\".sqlescape(implode(\"/\",array_slice(_PAD_,0,$x))).\"'\");\t\t//sink point: $x;\n$res = mysql_query($query);\n}\n\n", "id": 39, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$path = $_GET['input0'];\n\n// php code: \n\t\t\t$x = count($path);\n\t\t\twhile ($x) {\n$query = \"SELECT * FROM bigtree_route_history WHERE old_route = '\".sqlescape(implode(\"/\",array_slice($path,0,_PAD_))).\"'\");\t\t//sink point: $path;\n$res = mysql_query($query);\n}\n\n", "id": 40, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$page = $_GET['input0'];\n\n// php code: \n\t\t\t$pieces = explode(\"/\",$page[\"path\"]);\n\t\t\t$paths = array();\n\t\t\t$path = \"\";\n\t\t\tforeach ($pieces as $piece) {\n\t\t\t\t$path = $path.$piece.\"/\";\n\t\t\t\t$paths[] = \"path = '\".sqlescape(trim($path,\"/\")).\"'\";\n\t\t\t}\n$query = \"SELECT id,nav_title,path,trunk FROM bigtree_pages WHERE (\".implode(\" OR \",$paths).\") ORDER BY LENGTH(path) DESC\";\t\t//sink point: $paths;\n$res = mysql_query($query);\n\n", "id": 41, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$page = $_GET['input0'];\n\n// php code: \n$query = \"SELECT bigtree_modules.class FROM bigtree_modules JOIN bigtree_templates ON bigtree_modules.id = bigtree_templates.module WHERE bigtree_templates.id = '\".$page[\"template\"].\"'\");\t\t//sink point: $page;\n$res = mysql_query($query);\n\n", "id": 42, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$item = $_GET['input0'];\n\n// php code: \n\t\t\tif (!is_array($item)) {\n\t\t\t\t$item = sqlescape($item);\n$query = \"SELECT * FROM bigtree_feeds WHERE id = '$item'\");\t\t//sink point: $item;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 43, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$route = $_GET['input0'];\n\n// php code: \n\t\t\t$route = sqlescape($route);\n$query = \"SELECT * FROM bigtree_feeds WHERE route = '$route'\");\t\t//sink point: $route;\n$res = mysql_query($query);\n\n", "id": 44, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$ipl = $_GET['input0'];\n\n// php code: \n\t\t\t$ipl = explode(\"//\",$ipl);\n\t\t\t$navid = $ipl[1];\n\t\t\tif (isset($this->iplCache[$navid])) {\n}\nelse {\n$query = \"SELECT path FROM bigtree_pages WHERE id = '\".sqlescape($navid).\"'\");\t\t//sink point: $navid;\n$res = mysql_query($query);\n}\n\n", "id": 45, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n\n// php code: \n$query = \"SELECT path FROM bigtree_pages WHERE id = '\".sqlescape($id).\"'\");\t\t//sink point: $id;\n$res = mysql_query($query);\n\n", "id": 46, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$parent = $_GET['input0'];\n\n// php code: \n\t\t\tif (is_array($parent)) {\n\t\t\t\t$where_parent = array();\n\t\t\t\tforeach ($parent as $p) {\n\t\t\t\t\t$where_parent[] = \"parent = '\".sqlescape($p).\"'\";\n\t\t\t\t}\n\t\t\t\t$where_parent = \"(\".implode(\" OR \",$where_parent).\")\";\n\t\t\t}\nelse {\n\t\t\t\t$where_parent = \"parent = '$parent'\";\n\t\t\t}\n$query = \"SELECT id,nav_title,parent,external,new_window,template,route,path FROM bigtree_pages WHERE $where_parent AND in_nav = '_PAD_' AND archived != 'on' AND (publish_at <= NOW() OR publish_at IS NULL) AND (expire_at >= NOW() OR expire_at IS NULL) ORDER BY _PAD_\";\t\t//sink point: $where_parent;\n$res = mysql_query($query);\n\n", "id": 47, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$only_hidden = $_GET['input0'];\n\n// php code: \n\t\t\t$in_nav = $only_hidden ? \"\" : \"on\";\n$query = \"SELECT id,nav_title,parent,external,new_window,template,route,path FROM bigtree_pages WHERE _PAD_ AND in_nav = '$in_nav' AND archived != 'on' AND (publish_at <= NOW() OR publish_at IS NULL) AND (expire_at >= NOW() OR expire_at IS NULL) ORDER BY _PAD_\";\t\t//sink point: $in_nav;\n$res = mysql_query($query);\n\n", "id": 48, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$only_hidden = $_GET['input0'];\n\n// php code: \n\t\t\t$sort = $only_hidden ? \"nav_title ASC\" : \"position DESC, id ASC\";\n$query = \"SELECT id,nav_title,parent,external,new_window,template,route,path FROM bigtree_pages WHERE _PAD_ AND in_nav = '_PAD_' AND archived != 'on' AND (publish_at <= NOW() OR publish_at IS NULL) AND (expire_at >= NOW() OR expire_at IS NULL) ORDER BY $sort\";\t\t//sink point: $sort;\n$res = mysql_query($query);\n\n", "id": 49, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$parent = $_GET['input0'];\n$follow_module = $_GET['input1'];\n\n// php code: \n\t\t\tif (is_array($parent)) {\n\t\t\t\t$where_parent = array();\n\t\t\t\tforeach ($parent as $p) {\n\t\t\t\t\t$where_parent[] = \"parent = '\".sqlescape($p).\"'\";\n\t\t\t\t}\n\t\t\t\t$where_parent = \"(\".implode(\" OR \",$where_parent).\")\";\n\t\t\t}\nelse {\n\t\t\t\t$where_parent = \"parent = '$parent'\";\n\t\t\t}\n\t\t\tif ($follow_module) {\n\t\t\t\tif (is_array($parent)) {\n\t\t\t\t\t$where_parent = array();\n\t\t\t\t\tforeach ($parent as $p) {\n\t\t\t\t\t\t$where_parent[] = \"bigtree_pages.id = '\".sqlescape($p).\"'\";\n\t\t\t\t\t}\n$query = \"SELECT bigtree_modules.class,bigtree_templates.routed,bigtree_templates.module,bigtree_pages.id,bigtree_pages.path,bigtree_pages.template FROM bigtree_modules JOIN bigtree_templates JOIN bigtree_pages ON bigtree_templates.id = bigtree_pages.template WHERE bigtree_modules.id = bigtree_templates.module AND (\".implode(\" OR \",$where_parent).\")\";\t\t//sink point: $where_parent;\n$res = mysql_query($query);\n}\n}\n\n", "id": 50, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$parent = $_GET['input0'];\n$follow_module = $_GET['input1'];\n\n// php code: \n\t\t\tif (is_array($parent)) {\n}\nelse {\n\t\t\t\t$parent = sqlescape($parent);\n}\n\t\t\tif ($follow_module) {\n\t\t\t\tif (is_array($parent)) {\n}\nelse {\n$query = \"SELECT bigtree_modules.class,bigtree_templates.routed,bigtree_templates.module,bigtree_pages.id,bigtree_pages.path,bigtree_pages.template FROM bigtree_modules JOIN bigtree_templates JOIN bigtree_pages ON bigtree_templates.id = bigtree_pages.template WHERE bigtree_modules.id = bigtree_templates.module AND bigtree_pages.id = '$parent'\");\t\t//sink point: $parent;\n$res = mysql_query($query);\n}\n}\n\n", "id": 51, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$path = $_GET['input0'];\n\n// php code: \n\t\t\t$spath = sqlescape(implode(\"/\",$path));\n$query = \"SELECT bigtree_pages.id,bigtree_templates.routed FROM bigtree_pages LEFT JOIN bigtree_templates ON bigtree_pages.template = bigtree_templates.id WHERE path = '$spath' AND archived = '' _PAD_\");\t\t//sink point: $spath;\n$res = mysql_query($query);\n\n", "id": 52, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$previewing = $_GET['input0'];\n\n// php code: \n\t\t\tif (!$previewing) {\n\t\t\t\t$publish_at = \"AND (publish_at <= NOW() OR publish_at IS NULL) AND (expire_at >= NOW() OR expire_at IS NULL)\";\n\t\t\t}\nelse {\n\t\t\t\t$publish_at = \"\";\n\t\t\t}\n$query = \"SELECT bigtree_pages.id,bigtree_templates.routed FROM bigtree_pages LEFT JOIN bigtree_templates ON bigtree_pages.template = bigtree_templates.id WHERE path = '_PAD_' AND archived = '' $publish_at\");\t\t//sink point: $publish_at;\n$res = mysql_query($query);\n\n", "id": 53, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$path = $_GET['input0'];\n\n// php code: \n\t\t\t$spath = sqlescape(implode(\"/\",$path));\n\t\t\t$x = 0;\n\t\t\twhile ($x < count($path)) {\n\t\t\t\t$spath = sqlescape(implode(\"/\",array_slice($path,0,-1 * $x)));\n$query = \"SELECT bigtree_pages.id FROM bigtree_pages JOIN bigtree_templates ON bigtree_pages.template = bigtree_templates.id WHERE bigtree_pages.path = '$spath' AND bigtree_pages.archived = '' AND bigtree_templates.routed = 'on' _PAD_\");\t\t//sink point: $spath;\n$res = mysql_query($query);\n}\n\n", "id": 54, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$path = $_GET['input0'];\n$previewing = $_GET['input1'];\n\n// php code: \n\t\t\tif (!$previewing) {\n\t\t\t\t$publish_at = \"AND (publish_at <= NOW() OR publish_at IS NULL) AND (expire_at >= NOW() OR expire_at IS NULL)\";\n\t\t\t}\nelse {\n\t\t\t\t$publish_at = \"\";\n\t\t\t}\n\t\t\t$x = 0;\n\t\t\twhile ($x < count($path)) {\n$query = \"SELECT bigtree_pages.id FROM bigtree_pages JOIN bigtree_templates ON bigtree_pages.template = bigtree_templates.id WHERE bigtree_pages.path = '_PAD_' AND bigtree_pages.archived = '' AND bigtree_templates.routed = 'on' $publish_at\");\t\t//sink point: $publish_at;\n$res = mysql_query($query);\n}\n\n", "id": 55, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$child = $_GET['input0'];\n\n// php code: \n$query = \"SELECT * FROM bigtree_pages WHERE id = '$child'\");\t\t//sink point: $child;\n$res = mysql_query($query);\n\n", "id": 56, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n$return_tags = $_GET['input1'];\n\n// php code: \n\t\t\tif (is_numeric($id)) {\n\t\t\t\t$page = $this->getPage($id);\n\t\t\t\tif ($return_tags) {\n\t\t\t\t\t$page[\"tags\"] = $this->getTagsForPage($id);\n\t\t\t\t}\n$query = \"SELECT * FROM bigtree_pending_changes WHERE `table` = 'bigtree_pages' AND item_id = '\".$page[\"id\"].\"'\");\t\t//sink point: $page;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 57, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n\n// php code: \n\t\t\tif (is_numeric($id)) {\n}\nelse {\n$query = \"SELECT * FROM bigtree_pending_changes WHERE `id` = '\".sqlescape(substr($id,1)).\"'\");\t\t//sink point: $id;\n$res = mysql_query($query);\n}\n\n", "id": 58, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n$return_tags = $_GET['input1'];\n\n// php code: \n\t\t\tif (is_numeric($id)) {\n\t\t\t\t$page = $this->getPage($id);\n\t\t\t\tif ($return_tags) {\n\t\t\t\t\t$page[\"tags\"] = $this->getTagsForPage($id);\n\t\t\t\t}\n\t\t\t\t$f = sqlfetch(sqlquery(\"SELECT * FROM bigtree_pending_changes WHERE `table` = 'bigtree_pages' AND item_id = '\".$page[\"id\"].\"'\"));\n\t\t\t}\nelse {\n\t\t\t\t$f = sqlfetch(sqlquery(\"SELECT * FROM bigtree_pending_changes WHERE `id` = '\".sqlescape(substr($id,1)).\"'\"));\n\t\t\t\tif ($f) {\n\t\t\t\t\t$f[\"id\"] = $id;\n\t\t\t\t}\n}\n\t\t\tif ($f) {\n\t\t\t\tif ($return_tags) {\n\t\t\t\t\t$tags_changes = json_decode($f[\"tags_changes\"],true);\n\t\t\t\t\tif (is_array($tags_changes)) {\n\t\t\t\t\t\tforeach ($tags_changes as $tag) {\n$query = \"SELECT * FROM bigtree_tags WHERE id = '$tag'\");\t\t//sink point: $tag;\n$res = mysql_query($query);\n\t\t\t\t\t\t}\n}\n}\n}\n\n", "id": 59, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n\n// php code: \n\t\t\tif (substr($id,0,1) == \"p\") {\n}\nelse if ($id == 0) {\n}\nelse {\n$query = \"SELECT path FROM bigtree_pages WHERE id = '\".sqlescape($id).\"'\");\t\t//sink point: $id;\n$res = mysql_query($query);\n}\n\n", "id": 60, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$tags = $_GET['input0'];\n\n// php code: \n\t\t\tforeach ($tags as $tag) {\n$query = \"SELECT * FROM bigtree_tags WHERE tag = '\".sqlescape($tag).\"'\");\t\t//sink point: $tag;\n$res = mysql_query($query);\n}\n\n", "id": 61, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$tags = $_GET['input0'];\n\n// php code: \n\t\t\tforeach ($tags as $tag) {\n\t\t\t\t$tdat = sqlfetch(sqlquery(\"SELECT * FROM bigtree_tags WHERE tag = '\".sqlescape($tag).\"'\"));\n\t\t\t\tif ($tdat) {\n$query = \"SELECT * FROM bigtree_tags_rel WHERE tag = '\".$tdat[\"id\"].\"' AND `table` = 'bigtree_pages'\";\t\t//sink point: $tdat;\n$res = mysql_query($query);\n}\n}\n\n", "id": 62, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n\n// php code: \n\t\t\t$id = sqlescape($id);\n$query = \"SELECT * FROM bigtree_settings WHERE id = '$id'\");\t\t//sink point: $id;\n$res = mysql_query($query);\n\n", "id": 63, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n\n// php code: \n\t\t\t$id = sqlescape($id);\n\t\t\t$f = sqlfetch(sqlquery(\"SELECT * FROM bigtree_settings WHERE id = '$id'\"));\n\t\t\tif ($f[\"encrypted\"]) {\n$query = \"SELECT AES_DECRYPT(`value`,'\".sqlescape($bigtree[\"config\"][\"settings_key\"]).\"') AS `value`, system FROM bigtree_settings WHERE id = '_PAD_'\");\t\t//sink point: $bigtree;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 64, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n\n// php code: \n\t\t\t$id = sqlescape($id);\n\t\t\t$f = sqlfetch(sqlquery(\"SELECT * FROM bigtree_settings WHERE id = '$id'\"));\n\t\t\tif ($f[\"encrypted\"]) {\n$query = \"SELECT AES_DECRYPT(`value`,'\".sqlescape(_PAD_[\"settings_key\"]).\"') AS `value`, system FROM bigtree_settings WHERE id = '$id'\");\t\t//sink point: $id;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 65, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$ids = $_GET['input0'];\n\n// php code: \n\t\t\tif (!is_array($ids)) {\n\t\t\t\t$ids = array($ids);\n\t\t\t}\n\t\t\t$parts = array();\n\t\t\tforeach ($ids as $id) {\n\t\t\t\t$parts[] = \"id = '\".sqlescape($id).\"'\";\n\t\t\t}\n$query = \"SELECT * FROM bigtree_settings WHERE (\".implode(\" OR \",$parts).\") ORDER BY id ASC\";\t\t//sink point: $parts;\n$res = mysql_query($query);\n\n", "id": 66, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$ids = $_GET['input0'];\n\n// php code: \n\t\t\tif (!is_array($ids)) {\n\t\t\t\t$ids = array($ids);\n\t\t\t}\n\t\t\t$parts = array();\n\t\t\tforeach ($ids as $id) {\n\t\t\t\t$parts[] = \"id = '\".sqlescape($id).\"'\";\n\t\t\t}\n\t\t\t$q = sqlquery(\"SELECT * FROM bigtree_settings WHERE (\".implode(\" OR \",$parts).\") ORDER BY id ASC\");\n\t\t\twhile ($f = sqlfetch($q)) {\n\t\t\t\tif ($f[\"encrypted\"]) {\n$query = \"SELECT AES_DECRYPT(`value`,'\".sqlescape($bigtree[\"config\"][\"settings_key\"]).\"') AS `value` FROM bigtree_settings WHERE id = '\"._PAD_.\"'\");\t\t//sink point: $bigtree;\n$res = mysql_query($query);\n\t\t\t\t}\n}\n\n", "id": 67, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$ids = $_GET['input0'];\n\n// php code: \n\t\t\tif (!is_array($ids)) {\n\t\t\t\t$ids = array($ids);\n\t\t\t}\n\t\t\t$parts = array();\n\t\t\tforeach ($ids as $id) {\n\t\t\t\t$parts[] = \"id = '\".sqlescape($id).\"'\";\n\t\t\t}\n\t\t\t$q = sqlquery(\"SELECT * FROM bigtree_settings WHERE (\".implode(\" OR \",$parts).\") ORDER BY id ASC\");\n\t\t\twhile ($f = sqlfetch($q)) {\n\t\t\t\tif ($f[\"encrypted\"]) {\n$query = \"SELECT AES_DECRYPT(`value`,'\".sqlescape(_PAD_[\"settings_key\"]).\"') AS `value` FROM bigtree_settings WHERE id = '\".$f[\"id\"].\"'\");\t\t//sink point: $f;\n$res = mysql_query($query);\n\t\t\t\t}\n}\n\n", "id": 68, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n\n// php code: \n\t\t\t$id = sqlescape($id);\n$query = \"SELECT * FROM bigtree_tags WHERE id = '$id'\");\t\t//sink point: $id;\n$res = mysql_query($query);\n\n", "id": 69, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$route = $_GET['input0'];\n\n// php code: \n\t\t\t$route = sqlescape($route);\n$query = \"SELECT * FROM bigtree_tags WHERE route = '$route'\");\t\t//sink point: $route;\n$res = mysql_query($query);\n\n", "id": 70, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$page = $_GET['input0'];\n\n// php code: \n\t\t\tif (!is_numeric($page)) {\n\t\t\t\t$page = $page[\"id\"];\n\t\t\t}\n$query = \"SELECT bigtree_tags.* FROM bigtree_tags JOIN bigtree_tags_rel ON bigtree_tags.id = bigtree_tags_rel.tag WHERE bigtree_tags_rel.`table` = 'bigtree_pages' AND bigtree_tags_rel.entry = '\".sqlescape($page).\"' ORDER BY bigtree_tags.tag\";\t\t//sink point: $page;\n$res = mysql_query($query);\n\n", "id": 71, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n\n// php code: \n\t\t\t$id = sqlescape($id);\n$query = \"SELECT * FROM bigtree_templates WHERE id = '$id'\");\t\t//sink point: $id;\n$res = mysql_query($query);\n\n", "id": 72, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$page = $_GET['input0'];\n\n// php code: \n\t\t\t$paths = array();\n\t\t\t$path = \"\";\n\t\t\t$parts = explode(\"/\",$page[\"path\"]);\n\t\t\tforeach ($parts as $part) {\n\t\t\t\t$path .= \"/\".$part;\n\t\t\t\t$path = ltrim($path,\"/\");\n\t\t\t\t$paths[] = \"path = '\".sqlescape($path).\"'\";\n\t\t\t}\n$query = \"SELECT id,trunk,path FROM bigtree_pages WHERE (\".implode(\" OR \",$paths).\") AND (trunk = 'on' OR parent = '0') ORDER BY LENGTH(path) DESC LIMIT 1\");\t\t//sink point: $paths;\n$res = mysql_query($query);\n\n", "id": 73, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$page = $_GET['input0'];\n$trunk_as_toplevel = $_GET['input1'];\n\n// php code: \n\t\t\t$paths = array();\n\t\t\t$path = \"\";\n\t\t\t$parts = explode(\"/\",$page[\"path\"]);\n\t\t\tforeach ($parts as $part) {\n\t\t\t\t$path .= \"/\".$part;\n\t\t\t\t$path = ltrim($path,\"/\");\n\t\t\t\t$paths[] = \"path = '\".sqlescape($path).\"'\";\n\t\t\t}\n\t\t\t$f = sqlfetch(sqlquery(\"SELECT id,trunk,path FROM bigtree_pages WHERE (\".implode(\" OR \",$paths).\") AND (trunk = 'on' OR parent = '0') ORDER BY LENGTH(path) DESC LIMIT 1\"));\n\t\t\tif ($f[\"trunk\"] && !$trunk_as_toplevel) {\n$query = \"SELECT id FROM bigtree_pages WHERE (\".implode(\" OR \",_PAD_).\") AND LENGTH(path) < \".strlen($f[\"path\"]).\" ORDER BY LENGTH(path) ASC LIMIT 1\");\t\t//sink point: $f;\n$res = mysql_query($query);\n}\n\n", "id": 74, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$page = $_GET['input0'];\n$trunk_as_toplevel = $_GET['input1'];\n\n// php code: \n\t\t\t$paths = array();\n\t\t\t$path = \"\";\n\t\t\t$parts = explode(\"/\",$page[\"path\"]);\n\t\t\tforeach ($parts as $part) {\n\t\t\t\t$path .= \"/\".$part;\n\t\t\t\t$path = ltrim($path,\"/\");\n\t\t\t\t$paths[] = \"path = '\".sqlescape($path).\"'\";\n\t\t\t}\n\t\t\t$f = sqlfetch(sqlquery(\"SELECT id,trunk,path FROM bigtree_pages WHERE (\".implode(\" OR \",$paths).\") AND (trunk = 'on' OR parent = '0') ORDER BY LENGTH(path) DESC LIMIT 1\"));\n\t\t\tif ($f[\"trunk\"] && !$trunk_as_toplevel) {\n$query = \"SELECT id FROM bigtree_pages WHERE (\".implode(\" OR \",$paths).\") AND LENGTH(path) < \".strlen(_PAD_).\" ORDER BY LENGTH(path) ASC LIMIT 1\");\t\t//sink point: $paths;\n$res = mysql_query($query);\n}\n\n", "id": 75, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$url = $_GET['input0'];\n\n// php code: \n\t\t\t$url = sqlescape(htmlspecialchars(strip_tags(rtrim($url,\"/\"))));\n$query = \"SELECT * FROM bigtree_404s WHERE broken_url = '$url'\");\t\t//sink point: $url;\n$res = mysql_query($query);\n\n", "id": 76, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$url = $_GET['input0'];\n\n// php code: \n\t\t\t$url = sqlescape(htmlspecialchars(strip_tags(rtrim($url,\"/\"))));\n\t\t\t$f = sqlfetch(sqlquery(\"SELECT * FROM bigtree_404s WHERE broken_url = '$url'\"));\n\t\t\tif ($f[\"redirect_url\"]) {\n\t\t\t\tif ($f[\"redirect_url\"] == \"/\") {\n\t\t\t\t\t$f[\"redirect_url\"] = \"\";\n\t\t\t\t}\n$query = \"UPDATE bigtree_404s SET requests = (requests + 1) WHERE = '\".$f[\"id\"].\"'\";\t\t//sink point: $f;\n$res = mysql_query($query);\n}\n\n", "id": 77, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$url = $_GET['input0'];\n\n// php code: \n\t\t\t$url = sqlescape(htmlspecialchars(strip_tags(rtrim($url,\"/\"))));\n\t\t\t$f = sqlfetch(sqlquery(\"SELECT * FROM bigtree_404s WHERE broken_url = '$url'\"));\n\t\t\tif ($f[\"redirect_url\"]) {\n\t\t\t\tif ($f[\"redirect_url\"] == \"/\") {\n\t\t\t\t\t$f[\"redirect_url\"] = \"\";\n\t\t\t\t}\n}\nelse {\n\t\t\t\tif ($f) {\n$query = \"UPDATE bigtree_404s SET requests = (requests + 1) WHERE id = '\".$f[\"id\"].\"'\";\t\t//sink point: $f;\n$res = mysql_query($query);\n\t\t\t\t}\n}\n\n", "id": 78, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$url = $_GET['input0'];\n\n// php code: \n\t\t\t$url = sqlescape(htmlspecialchars(strip_tags(rtrim($url,\"/\"))));\n\t\t\t$f = sqlfetch(sqlquery(\"SELECT * FROM bigtree_404s WHERE broken_url = '$url'\"));\n\t\t\tif ($f[\"redirect_url\"]) {\n}\nelse {\n\t\t\t\tif ($f) {\n}\nelse {\n$query = \"INSERT INTO bigtree_404s (`broken_url`,`requests`) VALUES ('$url','1')\";\t\t//sink point: $url;\n$res = mysql_query($query);\n\t\t\t\t}\n}\n\n", "id": 79, "slice_label": "bad", "file_name": "D:\\good_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$postid = $_GET['input0'];\n\n// php code: \n\t$post = $wpdb->get_row( $wpdb->prepare( \"SELECT * FROM $wpdb->posts WHERE ID = %d\", $postid ) );\n\t$post = get_post( $post );\n\tif ( is_post_type_hierarchical( $post->post_type ) ) {\n$query = \"SELECT * FROM $wpdb->posts WHERE post_parent = %d AND post_type = %s\", _PAD_, _PAD_->post_type;\t\t//sink point: $wpdb;\n$res = mysql_query($query);\n}\n\n", "id": 80, "slice_label": "bad", "file_name": "D:\\bad_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$postid = $_GET['input0'];\n\n// php code: \n\t$post = $wpdb->get_row( $wpdb->prepare( \"SELECT * FROM $wpdb->posts WHERE ID = %d\", $postid ) );\n\t$post = get_post( $post );\n\tif ( is_post_type_hierarchical( $post->post_type ) ) {\n$query = \"SELECT * FROM _PAD_->posts WHERE post_parent = %d AND post_type = %s\", _PAD_, $post->post_type;\t\t//sink point: $post;\n$res = mysql_query($query);\n}\n\n", "id": 81, "slice_label": "bad", "file_name": "D:\\bad_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$postid = $_GET['input0'];\n\n// php code: \n\t$post = $wpdb->get_row( $wpdb->prepare( \"SELECT * FROM $wpdb->posts WHERE ID = %d\", $postid ) );\n\t$post = get_post( $post );\n\t$parent_data = array( 'post_parent' => $post->post_parent );\n\t$parent_where = array( 'post_parent' => $postid );\n\tif ( is_post_type_hierarchical( $post->post_type ) ) {\n\t\t$children_query = $wpdb->prepare( \"SELECT * FROM $wpdb->posts WHERE post_parent = %d AND post_type = %s\", $postid, $post->post_type );\n\t\t$children = $wpdb->get_results( $children_query );\n\t\tif ( $children ) {\n\t\t\t$wpdb->update( $wpdb->posts, $parent_data, $parent_where + array( 'post_type' => $post->post_type ) );\n\t\t}\n}\n$query = \"SELECT ID FROM $wpdb->posts WHERE post_parent = %d AND post_type = 'revision'\", _PAD_ );\t\t//sink point: $wpdb;\n$res = mysql_query($query);\n\n", "id": 82, "slice_label": "bad", "file_name": "D:\\bad_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$postid = $_GET['input0'];\n\n// php code: \n$query = \"SELECT ID FROM _PAD_->posts WHERE post_parent = %d AND post_type = 'revision'\", $postid );\t\t//sink point: $postid;\n$res = mysql_query($query);\n\n", "id": 83, "slice_label": "bad", "file_name": "D:\\bad_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$postid = $_GET['input0'];\n\n// php code: \n\t$post = $wpdb->get_row( $wpdb->prepare( \"SELECT * FROM $wpdb->posts WHERE ID = %d\", $postid ) );\n\t$post = get_post( $post );\n\t$parent_data = array( 'post_parent' => $post->post_parent );\n\t$parent_where = array( 'post_parent' => $postid );\n\tif ( is_post_type_hierarchical( $post->post_type ) ) {\n\t\t$children_query = $wpdb->prepare( \"SELECT * FROM $wpdb->posts WHERE post_parent = %d AND post_type = %s\", $postid, $post->post_type );\n\t\t$children = $wpdb->get_results( $children_query );\n\t\tif ( $children ) {\n\t\t\t$wpdb->update( $wpdb->posts, $parent_data, $parent_where + array( 'post_type' => $post->post_type ) );\n\t\t}\n}\n\t$wpdb->update( $wpdb->posts, $parent_data, $parent_where + array( 'post_type' => 'attachment' ) );\n$query = \"SELECT comment_ID FROM $wpdb->comments WHERE comment_post_ID = %d\", _PAD_ );\t\t//sink point: $wpdb;\n$res = mysql_query($query);\n\n", "id": 84, "slice_label": "bad", "file_name": "D:\\bad_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$postid = $_GET['input0'];\n\n// php code: \n$query = \"SELECT comment_ID FROM _PAD_->comments WHERE comment_post_ID = %d\", $postid );\t\t//sink point: $postid;\n$res = mysql_query($query);\n\n", "id": 85, "slice_label": "bad", "file_name": "D:\\bad_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$postid = $_GET['input0'];\n\n// php code: \n\t$post = $wpdb->get_row( $wpdb->prepare( \"SELECT * FROM $wpdb->posts WHERE ID = %d\", $postid ) );\n\t$post = get_post( $post );\n\t$parent_data = array( 'post_parent' => $post->post_parent );\n\t$parent_where = array( 'post_parent' => $postid );\n\tif ( is_post_type_hierarchical( $post->post_type ) ) {\n\t\t$children_query = $wpdb->prepare( \"SELECT * FROM $wpdb->posts WHERE post_parent = %d AND post_type = %s\", $postid, $post->post_type );\n\t\t$children = $wpdb->get_results( $children_query );\n\t\tif ( $children ) {\n\t\t\t$wpdb->update( $wpdb->posts, $parent_data, $parent_where + array( 'post_type' => $post->post_type ) );\n\t\t}\n}\n\t$wpdb->update( $wpdb->posts, $parent_data, $parent_where + array( 'post_type' => 'attachment' ) );\n$query = \"SELECT meta_id FROM $wpdb->postmeta WHERE post_id = %d \", _PAD_ );\t\t//sink point: $wpdb;\n$res = mysql_query($query);\n\n", "id": 86, "slice_label": "bad", "file_name": "D:\\bad_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$postid = $_GET['input0'];\n\n// php code: \n$query = \"SELECT meta_id FROM _PAD_->postmeta WHERE post_id = %d \", $postid );\t\t//sink point: $postid;\n$res = mysql_query($query);\n\n", "id": 87, "slice_label": "bad", "file_name": "D:\\bad_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$post = $_GET['input0'];\n\n// php code: \n\t$post = get_post($post);\n\t$post_id = $post->ID;\n\t$statuses = get_post_meta($post_id, '_wp_trash_meta_comments_status', true);\n\t$group_by_status = array();\n\tforeach ( $statuses as $comment_id => $comment_status )\n\t\t$group_by_status[$comment_status][] = $comment_id;\n\tforeach ( $group_by_status as $status => $comments ) {\n$query = \"UPDATE $wpdb->comments SET comment_approved = %s WHERE comment_ID IN (_PAD_)\", _PAD_ );\t\t//sink point: $wpdb;\n$res = mysql_query($query);\n\t}\n\n", "id": 88, "slice_label": "bad", "file_name": "D:\\bad_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$post = $_GET['input0'];\n\n// php code: \n\t$post = get_post($post);\n\t$post_id = $post->ID;\n\t$statuses = get_post_meta($post_id, '_wp_trash_meta_comments_status', true);\n\t$group_by_status = array();\n\tforeach ( $statuses as $comment_id => $comment_status )\n\t\t$group_by_status[$comment_status][] = $comment_id;\n\tforeach ( $group_by_status as $status => $comments ) {\n\t\tif ( 'post-trashed' == $status ) {\n\t\t\t$status = '0';\n\t\t}\n$query = \"UPDATE _PAD_->comments SET comment_approved = %s WHERE comment_ID IN (_PAD_)\", $status );\t\t//sink point: $status;\n$res = mysql_query($query);\n\t}\n\n", "id": 89, "slice_label": "bad", "file_name": "D:\\bad_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$post = $_GET['input0'];\n\n// php code: \n\t$post = get_post($post);\n\t$post_id = $post->ID;\n\t$statuses = get_post_meta($post_id, '_wp_trash_meta_comments_status', true);\n\t$group_by_status = array();\n\tforeach ( $statuses as $comment_id => $comment_status )\n\t\t$group_by_status[$comment_status][] = $comment_id;\n\tforeach ( $group_by_status as $status => $comments ) {\n\t\t$comments_in = implode( ', ', array_map( 'intval', $comments ) );\n$query = \"UPDATE _PAD_->comments SET comment_approved = %s WHERE comment_ID IN ($comments_in)\", _PAD_ );\t\t//sink point: $comments_in;\n$res = mysql_query($query);\n\t}\n\n", "id": 90, "slice_label": "bad", "file_name": "D:\\bad_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$post_type = $_GET['input0'];\n\n// php code: \n\tif ( 'attachment' == $post_type ) {\n}\nelse if ( is_post_type_hierarchical( $post_type ) ) {\n$query = \"SELECT post_name FROM $wpdb->posts WHERE post_name = %s AND post_type IN ( %s, 'attachment';\t\t//sink point: $wpdb;\n$res = mysql_query($query);\n}\n\n", "id": 91, "slice_label": "bad", "file_name": "D:\\bad_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$ids = $_GET['input0'];\n\n// php code: \n\t$non_cached_ids = _get_non_cached_ids( $ids, 'posts' );\n\tif ( !empty( $non_cached_ids ) ) {\n$query = \"SELECT $wpdb->posts.* FROM $wpdb->posts WHERE ID IN (%s)\", join( \",\", _PAD_ ) );\t\t//sink point: $wpdb;\n$res = mysql_query($query);\n}\n\n", "id": 92, "slice_label": "bad", "file_name": "D:\\bad_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$ids = $_GET['input0'];\n\n// php code: \n\t$non_cached_ids = _get_non_cached_ids( $ids, 'posts' );\n\tif ( !empty( $non_cached_ids ) ) {\n$query = \"SELECT _PAD_->posts.* FROM _PAD_->posts WHERE ID IN (%s)\", join( \",\", $non_cached_ids ) );\t\t//sink point: $non_cached_ids;\n$res = mysql_query($query);\n}\n\n", "id": 93, "slice_label": "bad", "file_name": "D:\\bad_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = (isset($_SESSION['CURRENT_ITEM'])) ? intval($_SESSION['CURRENT_ITEM']) : 0;\n$id = (isset($_REQUEST['id'])) ? intval($_REQUEST['id']) : 0;\n$query0 = \"SELECT a.*, ac.counter, u.nick, u.reg_date, u.city, u.country, u.zip FROM \" . $DBPrefix . \"auctions a\n\t        LEFT JOIN \" . $DBPrefix . \"users u ON (u.id = a.user)\n\t        LEFT JOIN \" . $DBPrefix . \"auccounter ac ON (ac.auction_id = a.id)\n\t        WHERE a.id = :auction_id LIMIT 1\";\n$params = array();\n$params[] = array(':auction_id', $id, 'int');\n$db->query($query0, $params);\n$auction_data = $db->result();\nif (!isset($auction_data['counter'])) {\n$query = \"INSERT INTO `\" . $DBPrefix . \"auccounter` (`auction_id`, `counter`) VALUES (:counter, 1;\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 94, "slice_label": "bad", "file_name": "D:\\bad_56_8.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = (isset($_SESSION['CURRENT_ITEM'])) ? intval($_SESSION['CURRENT_ITEM']) : 0;\n$id = (isset($_REQUEST['id'])) ? intval($_REQUEST['id']) : 0;\n$_SESSION['CURRENT_ITEM'] = $id;\n$_SESSION['REDIRECT_AFTER_LOGIN'] = $system->SETTINGS['siteurl'] . 'item.php?id=' . $id;\n$query0 = \"SELECT a.*, ac.counter, u.nick, u.reg_date, u.city, u.country, u.zip FROM \" . $DBPrefix . \"auctions a\n\t        LEFT JOIN \" . $DBPrefix . \"users u ON (u.id = a.user)\n\t        LEFT JOIN \" . $DBPrefix . \"auccounter ac ON (ac.auction_id = a.id)\n\t        WHERE a.id = :auction_id LIMIT 1\";\n$params = array();\n$params[] = array(':auction_id', $id, 'int');\n$db->query($query0, $params);\nif ($db->numrows() == 0) {\n    $_SESSION['msg_title'] = $ERR_622;\n    $_SESSION['msg_body'] = $ERR_623;\n}\n$auction_data = $db->result();\nif (!isset($auction_data['counter'])) {\n}\nelse {\n    if (!isset($_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n        $_SESSION['WEBID_VIEWED_AUCTIONS'] = array();\n    }\n    if (!in_array($id, $_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n$query = \"UPDATE \" . $DBPrefix . \"auccounter set counter = counter + 1 WHERE auction_id = :auction_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 95, "slice_label": "bad", "file_name": "D:\\bad_56_8.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = (isset($_SESSION['CURRENT_ITEM'])) ? intval($_SESSION['CURRENT_ITEM']) : 0;\n$id = (isset($_REQUEST['id'])) ? intval($_REQUEST['id']) : 0;\n$query0 = \"SELECT a.*, ac.counter, u.nick, u.reg_date, u.city, u.country, u.zip FROM \" . $DBPrefix . \"auctions a\n\t        LEFT JOIN \" . $DBPrefix . \"users u ON (u.id = a.user)\n\t        LEFT JOIN \" . $DBPrefix . \"auccounter ac ON (ac.auction_id = a.id)\n\t        WHERE a.id = :auction_id LIMIT 1\";\n$params = array();\n$params[] = array(':auction_id', $id, 'int');\n$db->query($query0, $params);\n$auction_data = $db->result();\nif (!isset($auction_data['counter'])) {\n    $auction_data['counter'] = 1;\n}\nif ($system->SETTINGS['extra_cat'] == 'y' && intval($auction_data['secondcat']) > 0) {\n$query = \"SELECT left_id, right_id, level FROM \" . $DBPrefix . \"categories WHERE cat_id = :sec_cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 96, "slice_label": "bad", "file_name": "D:\\bad_56_8.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = (isset($_SESSION['CURRENT_ITEM'])) ? intval($_SESSION['CURRENT_ITEM']) : 0;\n$id = (isset($_REQUEST['id'])) ? intval($_REQUEST['id']) : 0;\n$_SESSION['CURRENT_ITEM'] = $id;\n$_SESSION['REDIRECT_AFTER_LOGIN'] = $system->SETTINGS['siteurl'] . 'item.php?id=' . $id;\n$query0 = \"SELECT a.*, ac.counter, u.nick, u.reg_date, u.city, u.country, u.zip FROM \" . $DBPrefix . \"auctions a\n\t        LEFT JOIN \" . $DBPrefix . \"users u ON (u.id = a.user)\n\t        LEFT JOIN \" . $DBPrefix . \"auccounter ac ON (ac.auction_id = a.id)\n\t        WHERE a.id = :auction_id LIMIT 1\";\n$params = array();\n$params[] = array(':auction_id', $id, 'int');\n$db->query($query0, $params);\nif ($db->numrows() == 0) {\n    $_SESSION['msg_title'] = $ERR_622;\n    $_SESSION['msg_body'] = $ERR_623;\n}\n$auction_data = $db->result();\nif (!isset($auction_data['counter'])) {\n    $params[] = array(':counter', $id, 'int');\n    $db->query($query0, $params);\n}\nelse {\n    if (!isset($_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n        $_SESSION['WEBID_VIEWED_AUCTIONS'] = array();\n    }\n    if (!in_array($id, $_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n        $db->query($query0, $params);\n}\n}\nif ($user->logged_in) {\n    $db->query($query0, $params);\n}\n$db->query($query0, $params);\nif ($system->SETTINGS['extra_cat'] == 'y' && intval($auction_data['secondcat']) > 0) {\n    $db->query($query0, $params);\n}\n$db->query($query0, $params);\n$left = $auction_data['quantity'];\n$hbidder_data = array();\nforeach ($db->fetchall() as $bidrec) {\n    if ($left > 0 && !in_array($bidrec['bidder'], $hbidder_data)) {\n$query = \"SELECT rate FROM \" . $DBPrefix . \"feedbacks WHERE rated_user_id = :rate_users_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 97, "slice_label": "bad", "file_name": "D:\\bad_56_8.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = (isset($_SESSION['CURRENT_ITEM'])) ? intval($_SESSION['CURRENT_ITEM']) : 0;\n$id = (isset($_REQUEST['id'])) ? intval($_REQUEST['id']) : 0;\n$_SESSION['CURRENT_ITEM'] = $id;\n$_SESSION['REDIRECT_AFTER_LOGIN'] = $system->SETTINGS['siteurl'] . 'item.php?id=' . $id;\n$query0 = \"SELECT a.*, ac.counter, u.nick, u.reg_date, u.city, u.country, u.zip FROM \" . $DBPrefix . \"auctions a\n\t        LEFT JOIN \" . $DBPrefix . \"users u ON (u.id = a.user)\n\t        LEFT JOIN \" . $DBPrefix . \"auccounter ac ON (ac.auction_id = a.id)\n\t        WHERE a.id = :auction_id LIMIT 1\";\n$params = array();\n$params[] = array(':auction_id', $id, 'int');\n$db->query($query0, $params);\nif ($db->numrows() == 0) {\n    $_SESSION['msg_title'] = $ERR_622;\n    $_SESSION['msg_body'] = $ERR_623;\n}\n$auction_data = $db->result();\nif (!isset($auction_data['counter'])) {\n    $params[] = array(':counter', $id, 'int');\n    $db->query($query0, $params);\n}\nelse {\n    if (!isset($_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n        $_SESSION['WEBID_VIEWED_AUCTIONS'] = array();\n    }\n    if (!in_array($id, $_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n        $db->query($query0, $params);\n}\n}\nif ($user->logged_in) {\n    $db->query($query0, $params);\n}\n$db->query($query0, $params);\nif ($system->SETTINGS['extra_cat'] == 'y' && intval($auction_data['secondcat']) > 0) {\n    $db->query($query0, $params);\n}\n$db->query($query0, $params);\n$left = $auction_data['quantity'];\n$hbidder_data = array();\nforeach ($db->fetchall() as $bidrec) {\n    if ($left > 0 && !in_array($bidrec['bidder'], $hbidder_data)) {\n$query = \"SELECT icon FROM \" . $DBPrefix . \"membertypes WHERE feedbacks <= :feedback ORDER BY feedbacks DESC LIMIT 1;\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 98, "slice_label": "bad", "file_name": "D:\\bad_56_8.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = (isset($_SESSION['CURRENT_ITEM'])) ? intval($_SESSION['CURRENT_ITEM']) : 0;\n$id = (isset($_REQUEST['id'])) ? intval($_REQUEST['id']) : 0;\n$_SESSION['CURRENT_ITEM'] = $id;\n$_SESSION['REDIRECT_AFTER_LOGIN'] = $system->SETTINGS['siteurl'] . 'item.php?id=' . $id;\n$query0 = \"SELECT a.*, ac.counter, u.nick, u.reg_date, u.city, u.country, u.zip FROM \" . $DBPrefix . \"auctions a\n\t        LEFT JOIN \" . $DBPrefix . \"users u ON (u.id = a.user)\n\t        LEFT JOIN \" . $DBPrefix . \"auccounter ac ON (ac.auction_id = a.id)\n\t        WHERE a.id = :auction_id LIMIT 1\";\n$params = array();\n$params[] = array(':auction_id', $id, 'int');\n$db->query($query0, $params);\nif ($db->numrows() == 0) {\n    $_SESSION['msg_title'] = $ERR_622;\n    $_SESSION['msg_body'] = $ERR_623;\n}\n$auction_data = $db->result();\nif (!isset($auction_data['counter'])) {\n    $params[] = array(':counter', $id, 'int');\n    $db->query($query0, $params);\n}\nelse {\n    if (!isset($_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n        $_SESSION['WEBID_VIEWED_AUCTIONS'] = array();\n    }\n    if (!in_array($id, $_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n        $db->query($query0, $params);\n}\n}\nif ($user->logged_in) {\n    $db->query($query0, $params);\n}\n$db->query($query0, $params);\nif ($system->SETTINGS['extra_cat'] == 'y' && intval($auction_data['secondcat']) > 0) {\n    $db->query($query0, $params);\n}\n$db->query($query0, $params);\n$num_bids = $db->numrows();\nif ($user->logged_in && $num_bids > 0) {\n$query = \"SELECT bid FROM \" . $DBPrefix . \"bids WHERE auction = :auction AND bidder = :bidder LIMIT 1\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 99, "slice_label": "bad", "file_name": "D:\\bad_56_8.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = (isset($_SESSION['CURRENT_ITEM'])) ? intval($_SESSION['CURRENT_ITEM']) : 0;\n$id = (isset($_REQUEST['id'])) ? intval($_REQUEST['id']) : 0;\n$_SESSION['CURRENT_ITEM'] = $id;\n$_SESSION['REDIRECT_AFTER_LOGIN'] = $system->SETTINGS['siteurl'] . 'item.php?id=' . $id;\n$query0 = \"SELECT a.*, ac.counter, u.nick, u.reg_date, u.city, u.country, u.zip FROM \" . $DBPrefix . \"auctions a\n\t        LEFT JOIN \" . $DBPrefix . \"users u ON (u.id = a.user)\n\t        LEFT JOIN \" . $DBPrefix . \"auccounter ac ON (ac.auction_id = a.id)\n\t        WHERE a.id = :auction_id LIMIT 1\";\n$params = array();\n$params[] = array(':auction_id', $id, 'int');\n$db->query($query0, $params);\nif ($db->numrows() == 0) {\n    $_SESSION['msg_title'] = $ERR_622;\n    $_SESSION['msg_body'] = $ERR_623;\n}\n$auction_data = $db->result();\nif (!isset($auction_data['counter'])) {\n    $params[] = array(':counter', $id, 'int');\n    $db->query($query0, $params);\n}\nelse {\n    if (!isset($_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n        $_SESSION['WEBID_VIEWED_AUCTIONS'] = array();\n    }\n    if (!in_array($id, $_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n        $db->query($query0, $params);\n}\n}\nif ($user->logged_in) {\n    $db->query($query0, $params);\n}\n$db->query($query0, $params);\nif ($system->SETTINGS['extra_cat'] == 'y' && intval($auction_data['secondcat']) > 0) {\n    $db->query($query0, $params);\n}\n$db->query($query0, $params);\n$num_bids = $db->numrows();\n$left = $auction_data['quantity'];\n$hbidder_data = array();\nforeach ($db->fetchall() as $bidrec) {\n    if ($left > 0 && !in_array($bidrec['bidder'], $hbidder_data)) {\n        $db->query($query0, $params);\n        $db->query($query0, $params);\n}\n}\nif ($user->logged_in && $num_bids > 0) {\n    $db->query($query0, $params);\n}\n$db->query($query0, $params);\nforeach ($db->fetchall() as $row) {\n$query = \"SELECT sentfrom, message FROM \" . $DBPrefix . \"messages WHERE question = :id AND reply_of = :reply_of OR id = :message_id ORDER BY sentat ASC\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 100, "slice_label": "bad", "file_name": "D:\\bad_56_8.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"id\"]) && $_GET[\"id\"] && is_numeric($_GET[\"id\"])) {\n$query = \"SELECT dir_name, img_path FROM view_img_dir, view_img, view_img_dir_relation vidr WHERE view_img_dir.dir_id = vidr.dir_dir_parent_id AND vidr.img_img_id = img_id AND img_id = '\".$_GET[\"id\"].\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 101, "slice_label": "bad", "file_name": "D:\\bad_2179_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_POST[\"index\"])){\n$query = \"SELECT `command_example` FROM `command` WHERE `command_id` = '\". _PAD_->escape($_POST[\"index\"]) .\"'\";\t\t//sink point: $_POST;\n$res = mysql_query($query);\n}\n\n", "id": 102, "slice_label": "bad", "file_name": "D:\\good_3816_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n\tif (isset($_POST[\"index\"])){\n$query = \"SELECT `command_example` FROM `command` WHERE `command_id` = '\". $pearDB->escape(_PAD_) .\"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n}\n\n", "id": 103, "slice_label": "bad", "file_name": "D:\\good_3816_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$object = $_GET['input0'];\n$where = $_GET['input1'];\n\n// php code: \n\t   if (isset($object->id)) {\n$query = \"UPDATE \" . _PAD_->prefix . _PAD_ . \" SET \" . _PAD_ . \"=0 WHERE \" . $where;\t\t//sink point: $where;\n$res = mysql_query($query);\n}\n\n", "id": 104, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$object = $_GET['input0'];\n$table = $_GET['input1'];\n\n// php code: \n\t   if (isset($object->id)) {\n$query = \"UPDATE \" . _PAD_->prefix . $table . \" SET \" . _PAD_ . \"=0 WHERE \" . _PAD_;\t\t//sink point: $table;\n$res = mysql_query($query);\n}\n\n", "id": 105, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$object = $_GET['input0'];\n$col = $_GET['input1'];\n\n// php code: \n\t   if (isset($object->id)) {\n$query = \"UPDATE \" . _PAD_->prefix . _PAD_ . \" SET \" . $col . \"=0 WHERE \" . _PAD_;\t\t//sink point: $col;\n$res = mysql_query($query);\n}\n\n", "id": 106, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$object = $_GET['input0'];\n\n// php code: \n\t   if (isset($object->id)) {\n$query = \"UPDATE \" . $this->prefix . _PAD_ . \" SET \" . _PAD_ . \"=0 WHERE \" . _PAD_;\t\t//sink point: $this;\n$res = mysql_query($query);\n}\n\n", "id": 107, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$object = $_GET['input0'];\n\n// php code: \n\t   if (isset($object->id)) {\n$query = \"UPDATE \" . _PAD_->prefix . _PAD_ . \" SET \" . _PAD_ . \"=1 WHERE id=\" . $object->id;\t\t//sink point: $object;\n$res = mysql_query($query);\n}\n\n", "id": 108, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$object = $_GET['input0'];\n$table = $_GET['input1'];\n$col = $_GET['input2'];\n$where = $_GET['input3'];\n\n// php code: \n\t   if (isset($object->id)) {\n\t       $this->sql(\"UPDATE \" . $this->prefix . $table . \" SET \" . $col . \"=0 WHERE \" . $where);\n$query = \"UPDATE \" . _PAD_->prefix . $table . \" SET \" . _PAD_ . \"=1 WHERE id=\" . _PAD_->id;\t\t//sink point: $table;\n$res = mysql_query($query);\n}\n\n", "id": 109, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$object = $_GET['input0'];\n$table = $_GET['input1'];\n$col = $_GET['input2'];\n$where = $_GET['input3'];\n\n// php code: \n\t   if (isset($object->id)) {\n\t       $this->sql(\"UPDATE \" . $this->prefix . $table . \" SET \" . $col . \"=0 WHERE \" . $where);\n$query = \"UPDATE \" . _PAD_->prefix . _PAD_ . \" SET \" . $col . \"=1 WHERE id=\" . _PAD_->id;\t\t//sink point: $col;\n$res = mysql_query($query);\n}\n\n", "id": 110, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$object = $_GET['input0'];\n$table = $_GET['input1'];\n$col = $_GET['input2'];\n$where = $_GET['input3'];\n\n// php code: \n\t   if (isset($object->id)) {\n\t       $this->sql(\"UPDATE \" . $this->prefix . $table . \" SET \" . $col . \"=0 WHERE \" . $where);\n$query = \"UPDATE \" . $this->prefix . _PAD_ . \" SET \" . _PAD_ . \"=1 WHERE id=\" . _PAD_->id;\t\t//sink point: $this;\n$res = mysql_query($query);\n}\n\n", "id": 111, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n$query = 'UPDATE `' . $table . '` SET rgt = rgt + ' . _PAD_ . ' WHERE rgt >=' . _PAD_;\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 112, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$width = $_GET['input0'];\n\n// php code: \n$query = 'UPDATE `' . _PAD_ . '` SET rgt = rgt + ' . $width . ' WHERE rgt >=' . _PAD_;\t\t//sink point: $width;\n$res = mysql_query($query);\n\n", "id": 113, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$start = $_GET['input0'];\n\n// php code: \n$query = 'UPDATE `' . _PAD_ . '` SET rgt = rgt + ' . _PAD_ . ' WHERE rgt >=' . $start;\t\t//sink point: $start;\n$res = mysql_query($query);\n\n", "id": 114, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n$start = $_GET['input1'];\n$width = $_GET['input2'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n\t   $this->sql('UPDATE `' . $table . '` SET rgt = rgt + ' . $width . ' WHERE rgt >=' . $start);\n$query = 'UPDATE `' . $table . '` SET lft = lft + ' . _PAD_ . ' WHERE lft >=' . _PAD_;\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 115, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n$start = $_GET['input1'];\n$width = $_GET['input2'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n\t   $this->sql('UPDATE `' . $table . '` SET rgt = rgt + ' . $width . ' WHERE rgt >=' . $start);\n$query = 'UPDATE `' . _PAD_ . '` SET lft = lft + ' . $width . ' WHERE lft >=' . _PAD_;\t\t//sink point: $width;\n$res = mysql_query($query);\n\n", "id": 116, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n$start = $_GET['input1'];\n$width = $_GET['input2'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n\t   $this->sql('UPDATE `' . $table . '` SET rgt = rgt + ' . $width . ' WHERE rgt >=' . $start);\n$query = 'UPDATE `' . _PAD_ . '` SET lft = lft + ' . _PAD_ . ' WHERE lft >=' . $start;\t\t//sink point: $start;\n$res = mysql_query($query);\n\n", "id": 117, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$lft = $_GET['input0'];\n\n// php code: \n$query = 'UPDATE `' . _PAD_ . '` SET rgt = rgt + ' . _PAD_ . ' WHERE rgt BETWEEN ' . $lft . ' AND ' . _PAD_;\t\t//sink point: $lft;\n$res = mysql_query($query);\n\n", "id": 118, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n$query = 'UPDATE `' . $table . '` SET rgt = rgt + ' . _PAD_ . ' WHERE rgt BETWEEN ' . _PAD_ . ' AND ' . _PAD_;\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 119, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$width = $_GET['input0'];\n\n// php code: \n$query = 'UPDATE `' . _PAD_ . '` SET rgt = rgt + ' . $width . ' WHERE rgt BETWEEN ' . _PAD_ . ' AND ' . _PAD_;\t\t//sink point: $width;\n$res = mysql_query($query);\n\n", "id": 120, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$rgt = $_GET['input0'];\n\n// php code: \n$query = 'UPDATE `' . _PAD_ . '` SET rgt = rgt + ' . _PAD_ . ' WHERE rgt BETWEEN ' . _PAD_ . ' AND ' . $rgt;\t\t//sink point: $rgt;\n$res = mysql_query($query);\n\n", "id": 121, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n$lft = $_GET['input1'];\n$rgt = $_GET['input2'];\n$width = $_GET['input3'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n\t   $this->sql('UPDATE `' . $table . '` SET rgt = rgt + ' . $width . ' WHERE rgt BETWEEN ' . $lft . ' AND ' . $rgt);\n$query = 'UPDATE `' . _PAD_ . '` SET lft = lft + ' . _PAD_ . ' WHERE lft BETWEEN ' . $lft . ' AND ' . _PAD_;\t\t//sink point: $lft;\n$res = mysql_query($query);\n\n", "id": 122, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n$lft = $_GET['input1'];\n$rgt = $_GET['input2'];\n$width = $_GET['input3'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n\t   $this->sql('UPDATE `' . $table . '` SET rgt = rgt + ' . $width . ' WHERE rgt BETWEEN ' . $lft . ' AND ' . $rgt);\n$query = 'UPDATE `' . $table . '` SET lft = lft + ' . _PAD_ . ' WHERE lft BETWEEN ' . _PAD_ . ' AND ' . _PAD_;\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 123, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n$lft = $_GET['input1'];\n$rgt = $_GET['input2'];\n$width = $_GET['input3'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n\t   $this->sql('UPDATE `' . $table . '` SET rgt = rgt + ' . $width . ' WHERE rgt BETWEEN ' . $lft . ' AND ' . $rgt);\n$query = 'UPDATE `' . _PAD_ . '` SET lft = lft + ' . $width . ' WHERE lft BETWEEN ' . _PAD_ . ' AND ' . _PAD_;\t\t//sink point: $width;\n$res = mysql_query($query);\n\n", "id": 124, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n$lft = $_GET['input1'];\n$rgt = $_GET['input2'];\n$width = $_GET['input3'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n\t   $this->sql('UPDATE `' . $table . '` SET rgt = rgt + ' . $width . ' WHERE rgt BETWEEN ' . $lft . ' AND ' . $rgt);\n$query = 'UPDATE `' . _PAD_ . '` SET lft = lft + ' . _PAD_ . ' WHERE lft BETWEEN ' . _PAD_ . ' AND ' . $rgt;\t\t//sink point: $rgt;\n$res = mysql_query($query);\n\n", "id": 125, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n$lft = $_GET['input1'];\n$rgt = $_GET['input2'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n\t   $this->sql('DELETE FROM `' . $table . '` WHERE lft BETWEEN ' . $lft . ' AND ' . $rgt);\n$query = 'UPDATE `' . $table . '` SET rgt = rgt - ' . _PAD_ . ' WHERE rgt > ' . _PAD_;\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 126, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$lft = $_GET['input0'];\n$rgt = $_GET['input1'];\n\n// php code: \n\t   $width = ($rgt - $lft) + 1;\n$query = 'UPDATE `' . _PAD_ . '` SET rgt = rgt - ' . $width . ' WHERE rgt > ' . _PAD_;\t\t//sink point: $width;\n$res = mysql_query($query);\n\n", "id": 127, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n$lft = $_GET['input1'];\n$rgt = $_GET['input2'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n\t   $this->sql('DELETE FROM `' . $table . '` WHERE lft BETWEEN ' . $lft . ' AND ' . $rgt);\n$query = 'UPDATE `' . _PAD_ . '` SET rgt = rgt - ' . _PAD_ . ' WHERE rgt > ' . $rgt;\t\t//sink point: $rgt;\n$res = mysql_query($query);\n\n", "id": 128, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n$lft = $_GET['input1'];\n$rgt = $_GET['input2'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n\t   $width = ($rgt - $lft) + 1;\n\t   $this->sql('DELETE FROM `' . $table . '` WHERE lft BETWEEN ' . $lft . ' AND ' . $rgt);\n\t   $this->sql('UPDATE `' . $table . '` SET rgt = rgt - ' . $width . ' WHERE rgt > ' . $rgt);\n$query = 'UPDATE `' . $table . '` SET lft = lft - ' . _PAD_ . ' WHERE lft > ' . _PAD_;\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 129, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n$lft = $_GET['input1'];\n$rgt = $_GET['input2'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n\t   $width = ($rgt - $lft) + 1;\n\t   $this->sql('DELETE FROM `' . $table . '` WHERE lft BETWEEN ' . $lft . ' AND ' . $rgt);\n\t   $this->sql('UPDATE `' . $table . '` SET rgt = rgt - ' . $width . ' WHERE rgt > ' . $rgt);\n$query = 'UPDATE `' . _PAD_ . '` SET lft = lft - ' . $width . ' WHERE lft > ' . _PAD_;\t\t//sink point: $width;\n$res = mysql_query($query);\n\n", "id": 130, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n$lft = $_GET['input1'];\n$rgt = $_GET['input2'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n\t   $width = ($rgt - $lft) + 1;\n\t   $this->sql('DELETE FROM `' . $table . '` WHERE lft BETWEEN ' . $lft . ' AND ' . $rgt);\n\t   $this->sql('UPDATE `' . $table . '` SET rgt = rgt - ' . $width . ' WHERE rgt > ' . $rgt);\n$query = 'UPDATE `' . _PAD_ . '` SET lft = lft - ' . _PAD_ . ' WHERE lft > ' . $rgt;\t\t//sink point: $rgt;\n$res = mysql_query($query);\n\n", "id": 131, "slice_label": "bad", "file_name": "D:\\good_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]) {\n$query = \"SELECT user_id FROM session where session_id = '\"._PAD_->escape($_GET[\"sid\"]).\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 132, "slice_label": "bad", "file_name": "D:\\good_2179_9.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB \t= new CentreonDB();\n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]) {\n$query = \"SELECT user_id FROM session where session_id = '\".$pearDB->escape(_PAD_).\"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n}\n\n", "id": 133, "slice_label": "bad", "file_name": "D:\\good_2179_9.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB \t= new CentreonDB();\n\t$is_admin = isUserAdmin($_GET[\"sid\"]);\n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]) {\n\t\t$DBRESULT = $pearDB->query(\"SELECT user_id FROM session where session_id = '\".$pearDB->escape($_GET[\"sid\"]).\"'\");\n\t\t$session = $DBRESULT->fetchRow();\n\t\t$access = new CentreonAcl($session[\"user_id\"], $is_admin);\n}\n\t$normal_mode = 1;\n\t$type = \"root\";\n\tif (strlen($url_var) > 1) {\n\t\t$type = substr($url_var, 0, 2);\n}\n\tif ($normal_mode) {\n\t\tif ($type == \"HG\") {\n}\nelse if ($type == \"ST\") {\n}\nelse if ($type == \"HH\") {\n}\nelse if ($type == \"HS\") {\n}\nelse if ($type == \"HO\") {\n}\nelse if ($type == \"RS\") {\n}\nelse if ($type == \"RR\") {\n\t\t\tif ($search_host != \"\") {\n}\nelse {\n$query = \"SELECT * FROM meta_service \".$access->queryBuilder(\"WHERE\", \"meta_id\", _PAD_).\" ORDER BY `meta_name`\";\t\t//sink point: $access;\n$res = mysql_query($query);\n\t\t\t}\n}\n}\n\n", "id": 134, "slice_label": "bad", "file_name": "D:\\good_2179_9.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB \t= new CentreonDB();\n\t$is_admin = isUserAdmin($_GET[\"sid\"]);\n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]) {\n\t\t$DBRESULT = $pearDB->query(\"SELECT user_id FROM session where session_id = '\".$pearDB->escape($_GET[\"sid\"]).\"'\");\n\t\t$session = $DBRESULT->fetchRow();\n\t\t$access = new CentreonAcl($session[\"user_id\"], $is_admin);\n}\n\t$normal_mode = 1;\n\t$type = \"root\";\n\tif (strlen($url_var) > 1) {\n\t\t$type = substr($url_var, 0, 2);\n}\n\tif ($normal_mode) {\n\t\tif ($type == \"HG\") {\n}\nelse if ($type == \"ST\") {\n}\nelse if ($type == \"HH\") {\n}\nelse if ($type == \"HS\") {\n}\nelse if ($type == \"HO\") {\n}\nelse if ($type == \"RS\") {\n}\nelse if ($type == \"RR\") {\n\t\t\t$metaString = $access->getMetaServiceString();\n\t\t\tif ($metaString == \"\") {\n\t\t\t\t$metaString = \"''\";\n\t\t\t}\n\t\t\tif ($search_host != \"\") {\n}\nelse {\n$query = \"SELECT * FROM meta_service \"._PAD_->queryBuilder(\"WHERE\", \"meta_id\", $metaString).\" ORDER BY `meta_name`\";\t\t//sink point: $metaString;\n$res = mysql_query($query);\n\t\t\t}\n}\n}\n\n", "id": 135, "slice_label": "bad", "file_name": "D:\\good_2179_9.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB \t= new CentreonDB();\n\t$is_admin = isUserAdmin($_GET[\"sid\"]);\n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]) {\n\t\t$DBRESULT = $pearDB->query(\"SELECT user_id FROM session where session_id = '\".$pearDB->escape($_GET[\"sid\"]).\"'\");\n\t\t$session = $DBRESULT->fetchRow();\n\t\t$access = new CentreonAcl($session[\"user_id\"], $is_admin);\n}\n\t$normal_mode = 1;\n\tif ($normal_mode) {\n}\nelse {\n\t\tif ($search_host != \"\") {\n}\nelse {\n$query = \"SELECT hg_id, hg_name FROM hostgroup WHERE hg_id IN (SELECT hostgroup_hg_id FROM hostgroup_relation \".$access->queryBuilder(\"WHERE\", \"host_host_id\", _PAD_).\") ORDER BY `hg_name`\";\t\t//sink point: $access;\n$res = mysql_query($query);\n\t\t}\n}\n\n", "id": 136, "slice_label": "bad", "file_name": "D:\\good_2179_9.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$oreon = $_SESSION[\"centreon\"];\n\t$pearDB \t= new CentreonDB();\n\t$pearDBO \t= new CentreonDB(\"centstorage\");\n\tif ($oreon->broker->getBroker() == \"ndo\") {\n\t\t$pearDBndo \t= new CentreonDB(\"ndo\");\n\t}\n\t$is_admin = isUserAdmin($_GET[\"sid\"]);\n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]) {\n\t\t$DBRESULT = $pearDB->query(\"SELECT user_id FROM session where session_id = '\".$pearDB->escape($_GET[\"sid\"]).\"'\");\n\t\t$session = $DBRESULT->fetchRow();\n\t\t$access = new CentreonAcl($session[\"user_id\"], $is_admin);\n\t\t$hoststr = $access->getHostsString(\"ID\", ($oreon->broker->getBroker() == \"ndo\" ? $pearDBndo : $pearDBO));\n}\n\t$normal_mode = 1;\n\tif ($normal_mode) {\n}\nelse {\n\t\tif ($search_host != \"\") {\n}\nelse {\n$query = \"SELECT hg_id, hg_name FROM hostgroup WHERE hg_id IN (SELECT hostgroup_hg_id FROM hostgroup_relation \"._PAD_->queryBuilder(\"WHERE\", \"host_host_id\", $hoststr).\") ORDER BY `hg_name`\";\t\t//sink point: $hoststr;\n$res = mysql_query($query);\n\t\t}\n}\n\n", "id": 137, "slice_label": "bad", "file_name": "D:\\good_2179_9.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB \t= new CentreonDB();\n\t$is_admin = isUserAdmin($_GET[\"sid\"]);\n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]) {\n\t\t$DBRESULT = $pearDB->query(\"SELECT user_id FROM session where session_id = '\".$pearDB->escape($_GET[\"sid\"]).\"'\");\n\t\t$session = $DBRESULT->fetchRow();\n\t\t$access = new CentreonAcl($session[\"user_id\"], $is_admin);\n}\n\t$normal_mode = 1;\n\tif ($normal_mode) {\n}\nelse {\n\t\tif ($search_host != \"\") {\n}\nelse {\n$query = \"SELECT * FROM meta_service \".$access->queryBuilder(\"WHERE\", \"meta_id\", _PAD_).\" ORDER BY `meta_name`\";\t\t//sink point: $access;\n$res = mysql_query($query);\n\t\t}\n}\n\n", "id": 138, "slice_label": "bad", "file_name": "D:\\good_2179_9.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB \t= new CentreonDB();\n\t$is_admin = isUserAdmin($_GET[\"sid\"]);\n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]) {\n\t\t$DBRESULT = $pearDB->query(\"SELECT user_id FROM session where session_id = '\".$pearDB->escape($_GET[\"sid\"]).\"'\");\n\t\t$session = $DBRESULT->fetchRow();\n\t\t$access = new CentreonAcl($session[\"user_id\"], $is_admin);\n}\n\t$normal_mode = 1;\n\t$type = \"root\";\n\tif (strlen($url_var) > 1) {\n\t\t$type = substr($url_var, 0, 2);\n}\n\tif ($normal_mode) {\n\t\tif ($type == \"HG\") {\n}\nelse if ($type == \"ST\") {\n}\nelse if ($type == \"HH\") {\n}\nelse if ($type == \"HS\") {\n}\nelse if ($type == \"HO\") {\n}\nelse if ($type == \"RS\") {\n}\nelse if ($type == \"RR\") {\n\t\t\t$metaString = $access->getMetaServiceString();\n\t\t\tif ($metaString == \"\") {\n\t\t\t\t$metaString = \"''\";\n\t\t\t}\n}\n}\nelse {\n\t\t$metaString = $access->getMetaServiceString();\n\t\tif ($metaString == \"\") {\n\t\t\t$metaString = \"''\";\n\t\t}\n\t\tif ($search_host != \"\") {\n}\nelse {\n$query = \"SELECT * FROM meta_service \"._PAD_->queryBuilder(\"WHERE\", \"meta_id\", $metaString).\" ORDER BY `meta_name`\";\t\t//sink point: $metaString;\n$res = mysql_query($query);\n\t\t}\n}\n\n", "id": 139, "slice_label": "bad", "file_name": "D:\\good_2179_9.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$query = \"SELECT * FROM session WHERE session_id = '\" . _PAD_->escape($_GET['session']) . \"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 140, "slice_label": "bad", "file_name": "D:\\good_3816_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB \t= new CentreonDB();\n$query = \"SELECT * FROM session WHERE session_id = '\" . $pearDB->escape(_PAD_) . \"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n\n", "id": 141, "slice_label": "bad", "file_name": "D:\\good_3816_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"id\"]) && isset($_GET[\"color\"])){\n$query = \"SELECT  * FROM `log_archive_host` WHERE host_id = \" . _PAD_->escape($_GET[\"id\"]) . \" order by date_start desc\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 142, "slice_label": "bad", "file_name": "D:\\good_3816_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDBO \t= new CentreonDB(\"centstorage\");\n\tif (isset($_GET[\"id\"]) && isset($_GET[\"color\"])){\n$query = \"SELECT  * FROM `log_archive_host` WHERE host_id = \" . $pearDBO->escape(_PAD_) . \" order by date_start desc\";\t\t//sink point: $pearDBO;\n$res = mysql_query($query);\n}\n\n", "id": 143, "slice_label": "bad", "file_name": "D:\\good_3816_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$name = $_GET['input0'];\n\n// php code: \n$query = \"SELECT `category_name`, `cmd_category_id` FROM `command_categories` WHERE `category_name` = '\".htmlentities($name, ENT_QUOTES, \"UTF-8\").\"'\";\t\t//sink point: $name;\n$res = mysql_query($query);\n\n", "id": 144, "slice_label": "bad", "file_name": "D:\\bad_2179_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$sc = $_GET['input0'];\n\n// php code: \n\t\tforeach ($sc as $key => $value)\t{\n$query = \"SELECT * FROM `command_categories` WHERE `cmd_category_id` = '\".$key.\"' LIMIT 1\";\t\t//sink point: $key;\n$res = mysql_query($query);\n}\n\n", "id": 145, "slice_label": "bad", "file_name": "D:\\bad_2179_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$sc = $_GET['input0'];\n$nbrDup = $_GET['input1'];\n\n// php code: \n\t\tforeach ($sc as $key => $value)\t{\n\t\t\tfor ($i = 1; $i <= $nbrDup[$key]; $i++)\t{\n\t\t\t\tif (testCommandCategorieExistence($sc_name))\t{\n$query = \"INSERT INTO `command_categories` VALUES (\"._PAD_.\")\" : $rq = null;\t\t//sink point: $rq;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 146, "slice_label": "bad", "file_name": "D:\\bad_2179_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$sc = $_GET['input0'];\n$nbrDup = $_GET['input1'];\n\n// php code: \n\t\tforeach ($sc as $key => $value)\t{\n\t\t\tfor ($i = 1; $i <= $nbrDup[$key]; $i++)\t{\n\t\t\t\t$val = null;\n\t\t\t\tif (testCommandCategorieExistence($sc_name))\t{\n$query = \"INSERT INTO `command_categories` VALUES (\".$val.\")\" : _PAD_ = null;\t\t//sink point: $val;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 147, "slice_label": "bad", "file_name": "D:\\bad_2179_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n\n// php code: \n\t\tif (testCommandCategorieExistence($_POST[\"category_name\"])){\n$query = \"INSERT INTO `command_categories` (`category_name` , `category_alias`, `category_order`) VALUES ('\".$_POST[\"category_name\"].\"', '\".$_POST[\"category_alias\"].\"', '1')\";\t\t//sink point: $_POST;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 148, "slice_label": "bad", "file_name": "D:\\bad_2179_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n\n// php code: \n$query = \"UPDATE `command_categories` SET `category_name` = '\".$_POST[\"category_name\"].\"' , `category_alias` = '\".$_POST[\"category_alias\"].\"' , `category_order` = '\".$_POST[\"category_order\"].\"' WHERE `cmd_category_id` = '\".$_POST[\"cmd_category_id\"].\"'\";\t\t//sink point: $_POST;\n$res = mysql_query($query);\n\n", "id": 149, "slice_label": "bad", "file_name": "D:\\bad_2179_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$query = \"SELECT * FROM session WHERE session_id = '\" . _PAD_->escape($_GET['session']) . \"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 150, "slice_label": "bad", "file_name": "D:\\good_3816_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB \t= new CentreonDB();\n$query = \"SELECT * FROM session WHERE session_id = '\" . $pearDB->escape(_PAD_) . \"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n\n", "id": 151, "slice_label": "bad", "file_name": "D:\\good_3816_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=31;\n$tabname=array();\n$tabname[31]= MAIN_DB_PREFIX.\"accounting_system\";\n$tablib=array();\n$tablib[31]= \"Pcg_version\";\n$tabfield=array();\n$tabfield[31]= \"pcg_version,label,country_id,country\";\n$tabrowid=array();\n$tabrowid[31]= \"\";\nif (GETPOST('actionadd') || GETPOST('actionmodify'))\n{\n\t$listfield=explode(',', str_replace(' ', '',$tabfield[$id]));\n\t$ok=1;\n\tforeach ($listfield as $f => $value)\n\t{\n\t\tif ((! isset($_POST[$value]) || $_POST[$value]=='')\n\t\t\t&& (! in_array($listfield[$f], array('decalage','module','accountancy_code','accountancy_code_sell','accountancy_code_buy'))  \n\t\t\t&& (! ($id == 10 && $listfield[$f] == 'code')) \n\t\t\t)\n\t\t)\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif ($tabname[$id] == MAIN_DB_PREFIX.\"c_actioncomm\" && isset($_POST[\"type\"]) && in_array($_POST[\"type\"],array('system','systemauto'))) {\n\t\t$ok=0;\n}\n\tif (isset($_POST[\"code\"]))\n\t{\n\t\tif ($_POST[\"code\"]=='0')\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif (isset($_POST[\"country\"]) && ($_POST[\"country\"]=='0') && ($id != 2))\n\t{\n\t\tif (in_array($tablib[$id],array('DictionaryCompanyType','DictionaryHolidayTypes')))\t\n\t\t{\n}\n\t\telse\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif ($id == 3 && ! is_numeric($_POST[\"code\"]))\n\t{\n\t   \t$ok=0;\n}\n\tif ($ok && GETPOST('actionadd'))\n\t{\n\t\tif ($tabrowid[$id])\n\t\t{\n$query = \"SELECT max(\".$tabrowid[_PAD_].\") newid from \".$tabname[_PAD_];\t\t//sink point: $tabrowid;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 152, "slice_label": "bad", "file_name": "D:\\good_684_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=31;\n$tabname=array();\n$tabname[31]= MAIN_DB_PREFIX.\"accounting_system\";\n$tablib=array();\n$tablib[31]= \"Pcg_version\";\n$tabfield=array();\n$tabfield[31]= \"pcg_version,label,country_id,country\";\n$tabrowid=array();\n$tabrowid[31]= \"\";\nif (GETPOST('actionadd') || GETPOST('actionmodify'))\n{\n\t$listfield=explode(',', str_replace(' ', '',$tabfield[$id]));\n\t$ok=1;\n\tforeach ($listfield as $f => $value)\n\t{\n\t\tif ((! isset($_POST[$value]) || $_POST[$value]=='')\n\t\t\t&& (! in_array($listfield[$f], array('decalage','module','accountancy_code','accountancy_code_sell','accountancy_code_buy'))  \n\t\t\t&& (! ($id == 10 && $listfield[$f] == 'code')) \n\t\t\t)\n\t\t)\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif ($tabname[$id] == MAIN_DB_PREFIX.\"c_actioncomm\" && isset($_POST[\"type\"]) && in_array($_POST[\"type\"],array('system','systemauto'))) {\n\t\t$ok=0;\n}\n\tif (isset($_POST[\"code\"]))\n\t{\n\t\tif ($_POST[\"code\"]=='0')\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif (isset($_POST[\"country\"]) && ($_POST[\"country\"]=='0') && ($id != 2))\n\t{\n\t\tif (in_array($tablib[$id],array('DictionaryCompanyType','DictionaryHolidayTypes')))\t\n\t\t{\n}\n\t\telse\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif ($id == 3 && ! is_numeric($_POST[\"code\"]))\n\t{\n\t   \t$ok=0;\n}\n\tif ($ok && GETPOST('actionadd'))\n\t{\n\t\tif ($tabrowid[$id])\n\t\t{\n$query = \"SELECT max(\"._PAD_.\") newid from \".$tabname[_PAD_];\t\t//sink point: $tabname;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 153, "slice_label": "bad", "file_name": "D:\\good_684_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=31;\n$tabname=array();\n$tabname[31]= MAIN_DB_PREFIX.\"accounting_system\";\n$tablib=array();\n$tablib[31]= \"Pcg_version\";\n$tabfield=array();\n$tabfield[31]= \"pcg_version,label,country_id,country\";\nif (GETPOST('actionadd') || GETPOST('actionmodify'))\n{\n\t$listfield=explode(',', str_replace(' ', '',$tabfield[$id]));\n\t$ok=1;\n\tforeach ($listfield as $f => $value)\n\t{\n\t\tif ((! isset($_POST[$value]) || $_POST[$value]=='')\n\t\t\t&& (! in_array($listfield[$f], array('decalage','module','accountancy_code','accountancy_code_sell','accountancy_code_buy'))  \n\t\t\t&& (! ($id == 10 && $listfield[$f] == 'code')) \n\t\t\t)\n\t\t)\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif ($tabname[$id] == MAIN_DB_PREFIX.\"c_actioncomm\" && isset($_POST[\"type\"]) && in_array($_POST[\"type\"],array('system','systemauto'))) {\n\t\t$ok=0;\n}\n\tif (isset($_POST[\"code\"]))\n\t{\n\t\tif ($_POST[\"code\"]=='0')\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif (isset($_POST[\"country\"]) && ($_POST[\"country\"]=='0') && ($id != 2))\n\t{\n\t\tif (in_array($tablib[$id],array('DictionaryCompanyType','DictionaryHolidayTypes')))\t\n\t\t{\n}\n\t\telse\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif ($id == 3 && ! is_numeric($_POST[\"code\"]))\n\t{\n\t   \t$ok=0;\n}\n\tif ($ok && GETPOST('actionadd'))\n\t{\n$query = \"INSERT INTO \".$tabname[_PAD_].\" (\";\t\t//sink point: $tabname;\n$res = mysql_query($query);\n}\n}\n\n", "id": 154, "slice_label": "bad", "file_name": "D:\\good_684_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=31;\n$tabname=array();\n$tabname[31]= MAIN_DB_PREFIX.\"accounting_system\";\n$tablib=array();\n$tablib[31]= \"Pcg_version\";\n$tabfield=array();\n$tabfield[31]= \"pcg_version,label,country_id,country\";\nif (GETPOST('actionadd') || GETPOST('actionmodify'))\n{\n\t$listfield=explode(',', str_replace(' ', '',$tabfield[$id]));\n\t$ok=1;\n\tforeach ($listfield as $f => $value)\n\t{\n\t\tif ((! isset($_POST[$value]) || $_POST[$value]=='')\n\t\t\t&& (! in_array($listfield[$f], array('decalage','module','accountancy_code','accountancy_code_sell','accountancy_code_buy'))  \n\t\t\t&& (! ($id == 10 && $listfield[$f] == 'code')) \n\t\t\t)\n\t\t)\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif ($tabname[$id] == MAIN_DB_PREFIX.\"c_actioncomm\" && isset($_POST[\"type\"]) && in_array($_POST[\"type\"],array('system','systemauto'))) {\n\t\t$ok=0;\n}\n\tif (isset($_POST[\"code\"]))\n\t{\n\t\tif ($_POST[\"code\"]=='0')\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif (isset($_POST[\"country\"]) && ($_POST[\"country\"]=='0') && ($id != 2))\n\t{\n\t\tif (in_array($tablib[$id],array('DictionaryCompanyType','DictionaryHolidayTypes')))\t\n\t\t{\n}\n\t\telse\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif ($id == 3 && ! is_numeric($_POST[\"code\"]))\n\t{\n\t   \t$ok=0;\n}\n\tif ($ok && GETPOST('actionmodify'))\n\t{\n$query = \"UPDATE \".$tabname[_PAD_].\" SET \";\t\t//sink point: $tabname;\n$res = mysql_query($query);\n}\n}\n\n", "id": 155, "slice_label": "bad", "file_name": "D:\\good_684_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$query = \"SELECT * FROM session WHERE session_id = '\" . _PAD_->escape($_GET['session']) . \"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 156, "slice_label": "bad", "file_name": "D:\\good_3816_4.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB \t= new CentreonDB();\n$query = \"SELECT * FROM session WHERE session_id = '\" . $pearDB->escape(_PAD_) . \"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n\n", "id": 157, "slice_label": "bad", "file_name": "D:\\good_3816_4.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"host_id\"]) && isset($_GET[\"id\"]) && isset($_GET[\"color\"])){\n$query = \"SELECT  * FROM `log_archive_service` WHERE host_id = '\"._PAD_->escape($_GET[\"host_id\"]).\"' AND service_id = \"._PAD_->escape($_GET[\"id\"]).\" ORDER BY `date_start` DESC\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 158, "slice_label": "bad", "file_name": "D:\\good_3816_4.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDBO \t= new CentreonDB(\"centstorage\");\n\tif (isset($_GET[\"host_id\"]) && isset($_GET[\"id\"]) && isset($_GET[\"color\"])){\n$query = \"SELECT  * FROM `log_archive_service` WHERE host_id = '\".$pearDBO->escape(_PAD_).\"' AND service_id = \".$pearDBO->escape(_PAD_).\" ORDER BY `date_start` DESC\";\t\t//sink point: $pearDBO;\n$res = mysql_query($query);\n}\n\n", "id": 159, "slice_label": "bad", "file_name": "D:\\good_3816_4.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"host_id\"]) && $_GET[\"host_id\"]){\n$query = \"SELECT host_id, host_name FROM host WHERE host_template_model_htm_id = '\".$_GET[\"host_id\"].\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 160, "slice_label": "bad", "file_name": "D:\\bad_2179_4.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$query = \"SELECT * FROM session WHERE session_id = '\" . _PAD_->escape($_GET['session']) . \"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 161, "slice_label": "bad", "file_name": "D:\\good_3816_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB \t= new CentreonDB();\n$query = \"SELECT * FROM session WHERE session_id = '\" . $pearDB->escape(_PAD_) . \"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n\n", "id": 162, "slice_label": "bad", "file_name": "D:\\good_3816_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$name = $_GET['input0'];\n\n// php code: \n$query = \"SELECT `sc_name`, `sc_id` FROM `service_categories` WHERE `sc_name` = '\".htmlentities($name, ENT_QUOTES, \"UTF-8\").\"'\";\t\t//sink point: $name;\n$res = mysql_query($query);\n\n", "id": 163, "slice_label": "bad", "file_name": "D:\\bad_2179_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$sc = $_GET['input0'];\n\n// php code: \n                foreach($sc as $key => $value)\t{\n$query = \"SELECT * FROM `service_categories` WHERE `sc_id` = '\".$key.\"' LIMIT 1\";\t\t//sink point: $key;\n$res = mysql_query($query);\n}\n\n", "id": 164, "slice_label": "bad", "file_name": "D:\\bad_2179_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$sc = $_GET['input0'];\n$nbrDup = $_GET['input1'];\n\n// php code: \n                foreach($sc as $key => $value)\t{\n\t\t\tfor ($i = 1; $i <= $nbrDup[$key]; $i++)\t{\n\t\t\t\tif (testServiceCategorieExistence($sc_name))\t{\n$query = \"INSERT INTO `service_categories` VALUES (\"._PAD_.\")\" : $rq = null;\t\t//sink point: $rq;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 165, "slice_label": "bad", "file_name": "D:\\bad_2179_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$sc = $_GET['input0'];\n$nbrDup = $_GET['input1'];\n\n// php code: \n                foreach($sc as $key => $value)\t{\n\t\t\tfor ($i = 1; $i <= $nbrDup[$key]; $i++)\t{\n\t\t\t\t$val = null;\n\t\t\t\tif (testServiceCategorieExistence($sc_name))\t{\n$query = \"INSERT INTO `service_categories` VALUES (\".$val.\")\" : _PAD_ = null;\t\t//sink point: $val;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 166, "slice_label": "bad", "file_name": "D:\\bad_2179_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$sc = $_GET['input0'];\n$nbrDup = $_GET['input1'];\n\n// php code: \n                foreach($sc as $key => $value)\t{\n\t\t\tfor ($i = 1; $i <= $nbrDup[$key]; $i++)\t{\n\t\t\t\tif (testServiceCategorieExistence($sc_name))\t{\n$query = \"INSERT INTO service_categories_relation (service_service_id, sc_id) (SELECT service_service_id, \"._PAD_.\" FROM service_categories_relation WHERE sc_id = \".$pearDB->escape(_PAD_).\")\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 167, "slice_label": "bad", "file_name": "D:\\bad_2179_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$sc = $_GET['input0'];\n$nbrDup = $_GET['input1'];\n\n// php code: \n                foreach($sc as $key => $value)\t{\n\t\t\tfor ($i = 1; $i <= $nbrDup[$key]; $i++)\t{\n\t\t\t\tif (testServiceCategorieExistence($sc_name))\t{\n$query = \"INSERT INTO service_categories_relation (service_service_id, sc_id) (SELECT service_service_id, \"._PAD_.\" FROM service_categories_relation WHERE sc_id = \"._PAD_->escape($key).\")\";\t\t//sink point: $key;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 168, "slice_label": "bad", "file_name": "D:\\bad_2179_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$sc = $_GET['input0'];\n$nbrDup = $_GET['input1'];\n\n// php code: \n                $scAcl = array();\n                foreach($sc as $key => $value)\t{\n\t\t\t$DBRESULT = $pearDB->query(\"SELECT * FROM `service_categories` WHERE `sc_id` = '\".$key.\"' LIMIT 1\");\n\t\t\tfor ($i = 1; $i <= $nbrDup[$key]; $i++)\t{\n\t\t\t\tif (testServiceCategorieExistence($sc_name))\t{\n\t\t\t\t\t$DBRESULT = $pearDB->query($rq);\n\t\t\t\t\t$DBRESULT = $pearDB->query(\"SELECT MAX(sc_id) as maxid FROM `service_categories`\");\n\t\t\t\t\t$maxId = $DBRESULT->fetchRow();\n                                        $scAcl[$maxId['MAX(sc_id)']] = $key;\n$query = \"INSERT INTO service_categories_relation (service_service_id, sc_id) (SELECT service_service_id, \".$maxId['maxid'].\" FROM service_categories_relation WHERE sc_id = \"._PAD_->escape(_PAD_).\")\";\t\t//sink point: $maxId;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 169, "slice_label": "bad", "file_name": "D:\\bad_2179_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$sc_id = $_GET['input0'];\n$sc_arr = $_GET['input1'];\n\n// php code: \n\t\tif ($sc_id)\n\t\t\t$sc_arr = array($sc_id=>\"1\");\n\t\tforeach($sc_arr as $key=>$value)\t{\n$query = \"UPDATE service_categories SET sc_activate = '1' WHERE sc_id = '\".$key.\"'\";\t\t//sink point: $key;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 170, "slice_label": "bad", "file_name": "D:\\bad_2179_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$sc_id = $_GET['input0'];\n$sc_arr = $_GET['input1'];\n\n// php code: \n\t\tif ($sc_id)\n\t\t\t$sc_arr = array($sc_id=>\"1\");\n\t\tforeach($sc_arr as $key=>$value)\t{\n$query = \"UPDATE service_categories SET sc_activate = '0' WHERE sc_id = '\".$key.\"'\";\t\t//sink point: $key;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 171, "slice_label": "bad", "file_name": "D:\\bad_2179_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n\n// php code: \n\t\tif (testServiceCategorieExistence($_POST[\"sc_name\"])){\n$query = \"SELECT MAX(sc_id) FROM `service_categories` WHERE sc_name LIKE '\".$_POST[\"sc_name\"].\"'\";\t\t//sink point: $_POST;\n$res = mysql_query($query);\n}\n\n", "id": 172, "slice_label": "bad", "file_name": "D:\\bad_2179_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n\n// php code: \n\t\tif (isset($_POST[\"sc_svcTpl\"]))\n\t\t\tforeach ($_POST[\"sc_svcTpl\"] as $key)\t{\n$query = \"INSERT INTO service_categories_relation (service_service_id, sc_id) VALUES ('\".$key.\"', '\"._PAD_.\"')\";\t\t//sink point: $key;\n$res = mysql_query($query);\n}\n\n", "id": 173, "slice_label": "bad", "file_name": "D:\\bad_2179_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$sc_id = $_GET['input0'];\n\n// php code: \n\t\tif (isset($_POST[\"sc_svcTpl\"]))\n\t\t\tforeach ($_POST[\"sc_svcTpl\"] as $key)\t{\n$query = \"INSERT INTO service_categories_relation (service_service_id, sc_id) VALUES ('\"._PAD_.\"', '\".$sc_id.\"')\";\t\t//sink point: $sc_id;\n$res = mysql_query($query);\n}\n\n", "id": 174, "slice_label": "bad", "file_name": "D:\\bad_2179_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$max_age = $_GET['input0'];\n\n// php code: \n\t\t\tif ($max_age) {\n$query = \"SELECT * FROM bigtree_caches WHERE `identifier` = '_PAD_' AND `key` = '_PAD_' AND timestamp >= '\".date(\"Y-m-d H:i:s\",time() - $max_age).\"'\");\t\t//sink point: $max_age;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 175, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$key = $_GET['input0'];\n$max_age = $_GET['input1'];\n\n// php code: \n\t\t\t$key = sqlescape($key);\n\t\t\tif ($max_age) {\n$query = \"SELECT * FROM bigtree_caches WHERE `identifier` = '_PAD_' AND `key` = '$key' AND timestamp >= '\".date(\"Y-m-d H:i:s\",time() - _PAD_).\"'\");\t\t//sink point: $key;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 176, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$identifier = $_GET['input0'];\n$max_age = $_GET['input1'];\n\n// php code: \n\t\t\t$identifier = sqlescape($identifier);\n\t\t\tif ($max_age) {\n$query = \"SELECT * FROM bigtree_caches WHERE `identifier` = '$identifier' AND `key` = '_PAD_' AND timestamp >= '\".date(\"Y-m-d H:i:s\",time() - _PAD_).\"'\");\t\t//sink point: $identifier;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 177, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$key = $_GET['input0'];\n$max_age = $_GET['input1'];\n\n// php code: \n\t\t\t$key = sqlescape($key);\n\t\t\tif ($max_age) {\n}\nelse {\n$query = \"SELECT * FROM bigtree_caches WHERE `identifier` = '_PAD_' AND `key` = '$key'\");\t\t//sink point: $key;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 178, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$identifier = $_GET['input0'];\n$max_age = $_GET['input1'];\n\n// php code: \n\t\t\t$identifier = sqlescape($identifier);\n\t\t\tif ($max_age) {\n}\nelse {\n$query = \"SELECT * FROM bigtree_caches WHERE `identifier` = '$identifier' AND `key` = '_PAD_'\");\t\t//sink point: $identifier;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 179, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$key = $_GET['input0'];\n\n// php code: \n\t\t\t$key = sqlescape($key);\n$query = \"SELECT * FROM bigtree_caches WHERE `identifier` = '_PAD_' AND `key` = '$key'\");\t\t//sink point: $key;\n$res = mysql_query($query);\n\n", "id": 180, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$identifier = $_GET['input0'];\n\n// php code: \n\t\t\t$identifier = sqlescape($identifier);\n$query = \"SELECT * FROM bigtree_caches WHERE `identifier` = '$identifier' AND `key` = '_PAD_'\");\t\t//sink point: $identifier;\n$res = mysql_query($query);\n\n", "id": 181, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$identifier = $_GET['input0'];\n$key = $_GET['input1'];\n$value = $_GET['input2'];\n\n// php code: \n\t\t\t$identifier = sqlescape($identifier);\n\t\t\t$key = sqlescape($key);\n\t\t\t$f = sqlfetch(sqlquery(\"SELECT * FROM bigtree_caches WHERE `identifier` = '$identifier' AND `key` = '$key'\"));\n\t\t\tif (strnatcmp(phpversion(),'5.3') >= 0) {\n\t\t\t\t$value = sqlescape(json_encode($value,JSON_FORCE_OBJECT));\t\t\t\n\t\t\t}\nelse {\n\t\t\t\t$value = sqlescape(json_encode($value));\n\t\t\t}\n\t\t\tif ($f) {\n$query = \"UPDATE bigtree_caches SET `value` = '$value' WHERE `identifier` = '_PAD_' AND `key` = '_PAD_'\";\t\t//sink point: $value;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 182, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$identifier = $_GET['input0'];\n$key = $_GET['input1'];\n\n// php code: \n\t\t\t$identifier = sqlescape($identifier);\n\t\t\t$key = sqlescape($key);\n\t\t\t$f = sqlfetch(sqlquery(\"SELECT * FROM bigtree_caches WHERE `identifier` = '$identifier' AND `key` = '$key'\"));\n\t\t\tif ($f) {\n$query = \"UPDATE bigtree_caches SET `value` = '_PAD_' WHERE `identifier` = '_PAD_' AND `key` = '$key'\";\t\t//sink point: $key;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 183, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$identifier = $_GET['input0'];\n$key = $_GET['input1'];\n\n// php code: \n\t\t\t$identifier = sqlescape($identifier);\n\t\t\t$key = sqlescape($key);\n\t\t\t$f = sqlfetch(sqlquery(\"SELECT * FROM bigtree_caches WHERE `identifier` = '$identifier' AND `key` = '$key'\"));\n\t\t\tif ($f) {\n$query = \"UPDATE bigtree_caches SET `value` = '_PAD_' WHERE `identifier` = '$identifier' AND `key` = '_PAD_'\";\t\t//sink point: $identifier;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 184, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$identifier = $_GET['input0'];\n$key = $_GET['input1'];\n$value = $_GET['input2'];\n\n// php code: \n\t\t\t$identifier = sqlescape($identifier);\n\t\t\t$key = sqlescape($key);\n\t\t\t$f = sqlfetch(sqlquery(\"SELECT * FROM bigtree_caches WHERE `identifier` = '$identifier' AND `key` = '$key'\"));\n\t\t\tif (strnatcmp(phpversion(),'5.3') >= 0) {\n\t\t\t\t$value = sqlescape(json_encode($value,JSON_FORCE_OBJECT));\t\t\t\n\t\t\t}\nelse {\n\t\t\t\t$value = sqlescape(json_encode($value));\n\t\t\t}\n\t\t\tif ($f) {\n}\nelse {\n$query = \"INSERT INTO bigtree_caches (`identifier`,`key`,`value`) VALUES ('_PAD_','_PAD_','$value')\";\t\t//sink point: $value;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 185, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$identifier = $_GET['input0'];\n$key = $_GET['input1'];\n\n// php code: \n\t\t\t$identifier = sqlescape($identifier);\n\t\t\t$key = sqlescape($key);\n\t\t\t$f = sqlfetch(sqlquery(\"SELECT * FROM bigtree_caches WHERE `identifier` = '$identifier' AND `key` = '$key'\"));\n\t\t\tif ($f) {\n}\nelse {\n$query = \"INSERT INTO bigtree_caches (`identifier`,`key`,`value`) VALUES ('_PAD_','$key','_PAD_')\";\t\t//sink point: $key;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 186, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$identifier = $_GET['input0'];\n$key = $_GET['input1'];\n\n// php code: \n\t\t\t$identifier = sqlescape($identifier);\n\t\t\t$key = sqlescape($key);\n\t\t\t$f = sqlfetch(sqlquery(\"SELECT * FROM bigtree_caches WHERE `identifier` = '$identifier' AND `key` = '$key'\"));\n\t\t\tif ($f) {\n}\nelse {\n$query = \"INSERT INTO bigtree_caches (`identifier`,`key`,`value`) VALUES ('$identifier','_PAD_','_PAD_')\";\t\t//sink point: $identifier;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 187, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$path = $_GET['input0'];\n\n// php code: \n\t\t\t$x = count($path);\n\t\t\twhile ($x) {\n$query = \"SELECT * FROM bigtree_route_history WHERE old_route = '\".implode(\"/\",array_slice(_PAD_,0,$x)).\"'\");\t\t//sink point: $x;\n$res = mysql_query($query);\n}\n\n", "id": 188, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$path = $_GET['input0'];\n\n// php code: \n\t\t\t$x = count($path);\n\t\t\twhile ($x) {\n$query = \"SELECT * FROM bigtree_route_history WHERE old_route = '\".implode(\"/\",array_slice($path,0,_PAD_)).\"'\");\t\t//sink point: $path;\n$res = mysql_query($query);\n}\n\n", "id": 189, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$page = $_GET['input0'];\n\n// php code: \n\t\t\t$pieces = explode(\"/\",$page[\"path\"]);\n\t\t\t$paths = array();\n\t\t\t$path = \"\";\n\t\t\tforeach ($pieces as $piece) {\n\t\t\t\t$path = $path.$piece.\"/\";\n\t\t\t\t$paths[] = \"path = '\".sqlescape(trim($path,\"/\")).\"'\";\n\t\t\t}\n$query = \"SELECT id,nav_title,path,trunk FROM bigtree_pages WHERE (\".implode(\" OR \",$paths).\") ORDER BY LENGTH(path) DESC\";\t\t//sink point: $paths;\n$res = mysql_query($query);\n\n", "id": 190, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$page = $_GET['input0'];\n\n// php code: \n$query = \"SELECT bigtree_modules.class FROM bigtree_modules JOIN bigtree_templates ON bigtree_modules.id = bigtree_templates.module WHERE bigtree_templates.id = '\".$page[\"template\"].\"'\");\t\t//sink point: $page;\n$res = mysql_query($query);\n\n", "id": 191, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$item = $_GET['input0'];\n\n// php code: \n\t\t\tif (!is_array($item)) {\n\t\t\t\t$item = sqlescape($item);\n$query = \"SELECT * FROM bigtree_feeds WHERE id = '$item'\");\t\t//sink point: $item;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 192, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$route = $_GET['input0'];\n\n// php code: \n\t\t\t$route = sqlescape($route);\n$query = \"SELECT * FROM bigtree_feeds WHERE route = '$route'\");\t\t//sink point: $route;\n$res = mysql_query($query);\n\n", "id": 193, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$ipl = $_GET['input0'];\n\n// php code: \n\t\t\t$ipl = explode(\"//\",$ipl);\n\t\t\t$navid = $ipl[1];\n\t\t\tif (isset($this->iplCache[$navid])) {\n}\nelse {\n$query = \"SELECT path FROM bigtree_pages WHERE id = '\".sqlescape($navid).\"'\");\t\t//sink point: $navid;\n$res = mysql_query($query);\n}\n\n", "id": 194, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n\n// php code: \n$query = \"SELECT path FROM bigtree_pages WHERE id = '\".sqlescape($id).\"'\");\t\t//sink point: $id;\n$res = mysql_query($query);\n\n", "id": 195, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$parent = $_GET['input0'];\n\n// php code: \n\t\t\tif (is_array($parent)) {\n\t\t\t\t$where_parent = array();\n\t\t\t\tforeach ($parent as $p) {\n\t\t\t\t\t$where_parent[] = \"parent = '\".sqlescape($p).\"'\";\n\t\t\t\t}\n\t\t\t\t$where_parent = \"(\".implode(\" OR \",$where_parent).\")\";\n\t\t\t}\nelse {\n\t\t\t\t$where_parent = \"parent = '$parent'\";\n\t\t\t}\n$query = \"SELECT id,nav_title,parent,external,new_window,template,route,path FROM bigtree_pages WHERE $where_parent AND in_nav = '_PAD_' AND archived != 'on' AND (publish_at <= NOW() OR publish_at IS NULL) AND (expire_at >= NOW() OR expire_at IS NULL) ORDER BY _PAD_\";\t\t//sink point: $where_parent;\n$res = mysql_query($query);\n\n", "id": 196, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$only_hidden = $_GET['input0'];\n\n// php code: \n\t\t\t$in_nav = $only_hidden ? \"\" : \"on\";\n$query = \"SELECT id,nav_title,parent,external,new_window,template,route,path FROM bigtree_pages WHERE _PAD_ AND in_nav = '$in_nav' AND archived != 'on' AND (publish_at <= NOW() OR publish_at IS NULL) AND (expire_at >= NOW() OR expire_at IS NULL) ORDER BY _PAD_\";\t\t//sink point: $in_nav;\n$res = mysql_query($query);\n\n", "id": 197, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$only_hidden = $_GET['input0'];\n\n// php code: \n\t\t\t$sort = $only_hidden ? \"nav_title ASC\" : \"position DESC, id ASC\";\n$query = \"SELECT id,nav_title,parent,external,new_window,template,route,path FROM bigtree_pages WHERE _PAD_ AND in_nav = '_PAD_' AND archived != 'on' AND (publish_at <= NOW() OR publish_at IS NULL) AND (expire_at >= NOW() OR expire_at IS NULL) ORDER BY $sort\";\t\t//sink point: $sort;\n$res = mysql_query($query);\n\n", "id": 198, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$parent = $_GET['input0'];\n$follow_module = $_GET['input1'];\n\n// php code: \n\t\t\tif (is_array($parent)) {\n\t\t\t\t$where_parent = array();\n\t\t\t\tforeach ($parent as $p) {\n\t\t\t\t\t$where_parent[] = \"parent = '\".sqlescape($p).\"'\";\n\t\t\t\t}\n\t\t\t\t$where_parent = \"(\".implode(\" OR \",$where_parent).\")\";\n\t\t\t}\nelse {\n\t\t\t\t$where_parent = \"parent = '$parent'\";\n\t\t\t}\n\t\t\tif ($follow_module) {\n\t\t\t\tif (is_array($parent)) {\n\t\t\t\t\t$where_parent = array();\n\t\t\t\t\tforeach ($parent as $p) {\n\t\t\t\t\t\t$where_parent[] = \"bigtree_pages.id = '\".sqlescape($p).\"'\";\n\t\t\t\t\t}\n$query = \"SELECT bigtree_modules.class,bigtree_templates.routed,bigtree_templates.module,bigtree_pages.id,bigtree_pages.path,bigtree_pages.template FROM bigtree_modules JOIN bigtree_templates JOIN bigtree_pages ON bigtree_templates.id = bigtree_pages.template WHERE bigtree_modules.id = bigtree_templates.module AND (\".implode(\" OR \",$where_parent).\")\";\t\t//sink point: $where_parent;\n$res = mysql_query($query);\n}\n}\n\n", "id": 199, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$parent = $_GET['input0'];\n$follow_module = $_GET['input1'];\n\n// php code: \n\t\t\tif (is_array($parent)) {\n}\nelse {\n\t\t\t\t$parent = sqlescape($parent);\n}\n\t\t\tif ($follow_module) {\n\t\t\t\tif (is_array($parent)) {\n}\nelse {\n$query = \"SELECT bigtree_modules.class,bigtree_templates.routed,bigtree_templates.module,bigtree_pages.id,bigtree_pages.path,bigtree_pages.template FROM bigtree_modules JOIN bigtree_templates JOIN bigtree_pages ON bigtree_templates.id = bigtree_pages.template WHERE bigtree_modules.id = bigtree_templates.module AND bigtree_pages.id = '$parent'\");\t\t//sink point: $parent;\n$res = mysql_query($query);\n}\n}\n\n", "id": 200, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$path = $_GET['input0'];\n\n// php code: \n\t\t\t$spath = sqlescape(implode(\"/\",$path));\n$query = \"SELECT bigtree_pages.id,bigtree_templates.routed FROM bigtree_pages LEFT JOIN bigtree_templates ON bigtree_pages.template = bigtree_templates.id WHERE path = '$spath' AND archived = '' _PAD_\");\t\t//sink point: $spath;\n$res = mysql_query($query);\n\n", "id": 201, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$previewing = $_GET['input0'];\n\n// php code: \n\t\t\tif (!$previewing) {\n\t\t\t\t$publish_at = \"AND (publish_at <= NOW() OR publish_at IS NULL) AND (expire_at >= NOW() OR expire_at IS NULL)\";\n\t\t\t}\nelse {\n\t\t\t\t$publish_at = \"\";\n\t\t\t}\n$query = \"SELECT bigtree_pages.id,bigtree_templates.routed FROM bigtree_pages LEFT JOIN bigtree_templates ON bigtree_pages.template = bigtree_templates.id WHERE path = '_PAD_' AND archived = '' $publish_at\");\t\t//sink point: $publish_at;\n$res = mysql_query($query);\n\n", "id": 202, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$path = $_GET['input0'];\n\n// php code: \n\t\t\t$spath = sqlescape(implode(\"/\",$path));\n\t\t\t$x = 0;\n\t\t\twhile ($x < count($path)) {\n\t\t\t\t$spath = sqlescape(implode(\"/\",array_slice($path,0,-1 * $x)));\n$query = \"SELECT bigtree_pages.id FROM bigtree_pages JOIN bigtree_templates ON bigtree_pages.template = bigtree_templates.id WHERE bigtree_pages.path = '$spath' AND bigtree_pages.archived = '' AND bigtree_templates.routed = 'on' _PAD_\");\t\t//sink point: $spath;\n$res = mysql_query($query);\n}\n\n", "id": 203, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$path = $_GET['input0'];\n$previewing = $_GET['input1'];\n\n// php code: \n\t\t\tif (!$previewing) {\n\t\t\t\t$publish_at = \"AND (publish_at <= NOW() OR publish_at IS NULL) AND (expire_at >= NOW() OR expire_at IS NULL)\";\n\t\t\t}\nelse {\n\t\t\t\t$publish_at = \"\";\n\t\t\t}\n\t\t\t$x = 0;\n\t\t\twhile ($x < count($path)) {\n$query = \"SELECT bigtree_pages.id FROM bigtree_pages JOIN bigtree_templates ON bigtree_pages.template = bigtree_templates.id WHERE bigtree_pages.path = '_PAD_' AND bigtree_pages.archived = '' AND bigtree_templates.routed = 'on' $publish_at\");\t\t//sink point: $publish_at;\n$res = mysql_query($query);\n}\n\n", "id": 204, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$child = $_GET['input0'];\n\n// php code: \n$query = \"SELECT * FROM bigtree_pages WHERE id = '$child'\");\t\t//sink point: $child;\n$res = mysql_query($query);\n\n", "id": 205, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n$return_tags = $_GET['input1'];\n\n// php code: \n\t\t\tif (is_numeric($id)) {\n\t\t\t\t$page = $this->getPage($id);\n\t\t\t\tif ($return_tags) {\n\t\t\t\t\t$page[\"tags\"] = $this->getTagsForPage($id);\n\t\t\t\t}\n$query = \"SELECT * FROM bigtree_pending_changes WHERE `table` = 'bigtree_pages' AND item_id = '\".$page[\"id\"].\"'\");\t\t//sink point: $page;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 206, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n\n// php code: \n\t\t\tif (is_numeric($id)) {\n}\nelse {\n$query = \"SELECT * FROM bigtree_pending_changes WHERE `id` = '\".sqlescape(substr($id,1)).\"'\");\t\t//sink point: $id;\n$res = mysql_query($query);\n}\n\n", "id": 207, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n$return_tags = $_GET['input1'];\n\n// php code: \n\t\t\tif (is_numeric($id)) {\n\t\t\t\t$page = $this->getPage($id);\n\t\t\t\tif ($return_tags) {\n\t\t\t\t\t$page[\"tags\"] = $this->getTagsForPage($id);\n\t\t\t\t}\n\t\t\t\t$f = sqlfetch(sqlquery(\"SELECT * FROM bigtree_pending_changes WHERE `table` = 'bigtree_pages' AND item_id = '\".$page[\"id\"].\"'\"));\n\t\t\t}\nelse {\n\t\t\t\t$f = sqlfetch(sqlquery(\"SELECT * FROM bigtree_pending_changes WHERE `id` = '\".sqlescape(substr($id,1)).\"'\"));\n\t\t\t\tif ($f) {\n\t\t\t\t\t$f[\"id\"] = $id;\n\t\t\t\t}\n}\n\t\t\tif ($f) {\n\t\t\t\tif ($return_tags) {\n\t\t\t\t\t$tags_changes = json_decode($f[\"tags_changes\"],true);\n\t\t\t\t\tif (is_array($tags_changes)) {\n\t\t\t\t\t\tforeach ($tags_changes as $tag) {\n$query = \"SELECT * FROM bigtree_tags WHERE id = '$tag'\");\t\t//sink point: $tag;\n$res = mysql_query($query);\n\t\t\t\t\t\t}\n}\n}\n}\n\n", "id": 208, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n\n// php code: \n\t\t\tif (substr($id,0,1) == \"p\") {\n}\nelse if ($id == 0) {\n}\nelse {\n$query = \"SELECT path FROM bigtree_pages WHERE id = '\".sqlescape($id).\"'\");\t\t//sink point: $id;\n$res = mysql_query($query);\n}\n\n", "id": 209, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$tags = $_GET['input0'];\n\n// php code: \n\t\t\tforeach ($tags as $tag) {\n$query = \"SELECT * FROM bigtree_tags WHERE tag = '\".sqlescape($tag).\"'\");\t\t//sink point: $tag;\n$res = mysql_query($query);\n}\n\n", "id": 210, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$tags = $_GET['input0'];\n\n// php code: \n\t\t\tforeach ($tags as $tag) {\n\t\t\t\t$tdat = sqlfetch(sqlquery(\"SELECT * FROM bigtree_tags WHERE tag = '\".sqlescape($tag).\"'\"));\n\t\t\t\tif ($tdat) {\n$query = \"SELECT * FROM bigtree_tags_rel WHERE tag = '\".$tdat[\"id\"].\"' AND `table` = 'bigtree_pages'\";\t\t//sink point: $tdat;\n$res = mysql_query($query);\n}\n}\n\n", "id": 211, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n\n// php code: \n\t\t\t$id = sqlescape($id);\n$query = \"SELECT * FROM bigtree_settings WHERE id = '$id'\");\t\t//sink point: $id;\n$res = mysql_query($query);\n\n", "id": 212, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n\n// php code: \n\t\t\t$id = sqlescape($id);\n\t\t\t$f = sqlfetch(sqlquery(\"SELECT * FROM bigtree_settings WHERE id = '$id'\"));\n\t\t\tif ($f[\"encrypted\"]) {\n$query = \"SELECT AES_DECRYPT(`value`,'\".sqlescape($bigtree[\"config\"][\"settings_key\"]).\"') AS `value`, system FROM bigtree_settings WHERE id = '_PAD_'\");\t\t//sink point: $bigtree;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 213, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n\n// php code: \n\t\t\t$id = sqlescape($id);\n\t\t\t$f = sqlfetch(sqlquery(\"SELECT * FROM bigtree_settings WHERE id = '$id'\"));\n\t\t\tif ($f[\"encrypted\"]) {\n$query = \"SELECT AES_DECRYPT(`value`,'\".sqlescape(_PAD_[\"settings_key\"]).\"') AS `value`, system FROM bigtree_settings WHERE id = '$id'\");\t\t//sink point: $id;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 214, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$ids = $_GET['input0'];\n\n// php code: \n\t\t\tif (!is_array($ids)) {\n\t\t\t\t$ids = array($ids);\n\t\t\t}\n\t\t\t$parts = array();\n\t\t\tforeach ($ids as $id) {\n\t\t\t\t$parts[] = \"id = '\".sqlescape($id).\"'\";\n\t\t\t}\n$query = \"SELECT * FROM bigtree_settings WHERE (\".implode(\" OR \",$parts).\") ORDER BY id ASC\";\t\t//sink point: $parts;\n$res = mysql_query($query);\n\n", "id": 215, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$ids = $_GET['input0'];\n\n// php code: \n\t\t\tif (!is_array($ids)) {\n\t\t\t\t$ids = array($ids);\n\t\t\t}\n\t\t\t$parts = array();\n\t\t\tforeach ($ids as $id) {\n\t\t\t\t$parts[] = \"id = '\".sqlescape($id).\"'\";\n\t\t\t}\n\t\t\t$q = sqlquery(\"SELECT * FROM bigtree_settings WHERE (\".implode(\" OR \",$parts).\") ORDER BY id ASC\");\n\t\t\twhile ($f = sqlfetch($q)) {\n\t\t\t\tif ($f[\"encrypted\"]) {\n$query = \"SELECT AES_DECRYPT(`value`,'\".sqlescape($bigtree[\"config\"][\"settings_key\"]).\"') AS `value` FROM bigtree_settings WHERE id = '\"._PAD_.\"'\");\t\t//sink point: $bigtree;\n$res = mysql_query($query);\n\t\t\t\t}\n}\n\n", "id": 216, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$ids = $_GET['input0'];\n\n// php code: \n\t\t\tif (!is_array($ids)) {\n\t\t\t\t$ids = array($ids);\n\t\t\t}\n\t\t\t$parts = array();\n\t\t\tforeach ($ids as $id) {\n\t\t\t\t$parts[] = \"id = '\".sqlescape($id).\"'\";\n\t\t\t}\n\t\t\t$q = sqlquery(\"SELECT * FROM bigtree_settings WHERE (\".implode(\" OR \",$parts).\") ORDER BY id ASC\");\n\t\t\twhile ($f = sqlfetch($q)) {\n\t\t\t\tif ($f[\"encrypted\"]) {\n$query = \"SELECT AES_DECRYPT(`value`,'\".sqlescape(_PAD_[\"settings_key\"]).\"') AS `value` FROM bigtree_settings WHERE id = '\".$f[\"id\"].\"'\");\t\t//sink point: $f;\n$res = mysql_query($query);\n\t\t\t\t}\n}\n\n", "id": 217, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n\n// php code: \n\t\t\t$id = sqlescape($id);\n$query = \"SELECT * FROM bigtree_tags WHERE id = '$id'\");\t\t//sink point: $id;\n$res = mysql_query($query);\n\n", "id": 218, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$route = $_GET['input0'];\n\n// php code: \n\t\t\t$route = sqlescape($route);\n$query = \"SELECT * FROM bigtree_tags WHERE route = '$route'\");\t\t//sink point: $route;\n$res = mysql_query($query);\n\n", "id": 219, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$page = $_GET['input0'];\n\n// php code: \n\t\t\tif (!is_numeric($page)) {\n\t\t\t\t$page = $page[\"id\"];\n\t\t\t}\n$query = \"SELECT bigtree_tags.* FROM bigtree_tags JOIN bigtree_tags_rel ON bigtree_tags.id = bigtree_tags_rel.tag WHERE bigtree_tags_rel.`table` = 'bigtree_pages' AND bigtree_tags_rel.entry = '\".sqlescape($page).\"' ORDER BY bigtree_tags.tag\";\t\t//sink point: $page;\n$res = mysql_query($query);\n\n", "id": 220, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n\n// php code: \n\t\t\t$id = sqlescape($id);\n$query = \"SELECT * FROM bigtree_templates WHERE id = '$id'\");\t\t//sink point: $id;\n$res = mysql_query($query);\n\n", "id": 221, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$page = $_GET['input0'];\n\n// php code: \n\t\t\t$paths = array();\n\t\t\t$path = \"\";\n\t\t\t$parts = explode(\"/\",$page[\"path\"]);\n\t\t\tforeach ($parts as $part) {\n\t\t\t\t$path .= \"/\".$part;\n\t\t\t\t$path = ltrim($path,\"/\");\n\t\t\t\t$paths[] = \"path = '\".sqlescape($path).\"'\";\n\t\t\t}\n$query = \"SELECT id,trunk,path FROM bigtree_pages WHERE (\".implode(\" OR \",$paths).\") AND (trunk = 'on' OR parent = '0') ORDER BY LENGTH(path) DESC LIMIT 1\");\t\t//sink point: $paths;\n$res = mysql_query($query);\n\n", "id": 222, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$page = $_GET['input0'];\n$trunk_as_toplevel = $_GET['input1'];\n\n// php code: \n\t\t\t$paths = array();\n\t\t\t$path = \"\";\n\t\t\t$parts = explode(\"/\",$page[\"path\"]);\n\t\t\tforeach ($parts as $part) {\n\t\t\t\t$path .= \"/\".$part;\n\t\t\t\t$path = ltrim($path,\"/\");\n\t\t\t\t$paths[] = \"path = '\".sqlescape($path).\"'\";\n\t\t\t}\n\t\t\t$f = sqlfetch(sqlquery(\"SELECT id,trunk,path FROM bigtree_pages WHERE (\".implode(\" OR \",$paths).\") AND (trunk = 'on' OR parent = '0') ORDER BY LENGTH(path) DESC LIMIT 1\"));\n\t\t\tif ($f[\"trunk\"] && !$trunk_as_toplevel) {\n$query = \"SELECT id FROM bigtree_pages WHERE (\".implode(\" OR \",_PAD_).\") AND LENGTH(path) < \".strlen($f[\"path\"]).\" ORDER BY LENGTH(path) ASC LIMIT 1\");\t\t//sink point: $f;\n$res = mysql_query($query);\n}\n\n", "id": 223, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$page = $_GET['input0'];\n$trunk_as_toplevel = $_GET['input1'];\n\n// php code: \n\t\t\t$paths = array();\n\t\t\t$path = \"\";\n\t\t\t$parts = explode(\"/\",$page[\"path\"]);\n\t\t\tforeach ($parts as $part) {\n\t\t\t\t$path .= \"/\".$part;\n\t\t\t\t$path = ltrim($path,\"/\");\n\t\t\t\t$paths[] = \"path = '\".sqlescape($path).\"'\";\n\t\t\t}\n\t\t\t$f = sqlfetch(sqlquery(\"SELECT id,trunk,path FROM bigtree_pages WHERE (\".implode(\" OR \",$paths).\") AND (trunk = 'on' OR parent = '0') ORDER BY LENGTH(path) DESC LIMIT 1\"));\n\t\t\tif ($f[\"trunk\"] && !$trunk_as_toplevel) {\n$query = \"SELECT id FROM bigtree_pages WHERE (\".implode(\" OR \",$paths).\") AND LENGTH(path) < \".strlen(_PAD_).\" ORDER BY LENGTH(path) ASC LIMIT 1\");\t\t//sink point: $paths;\n$res = mysql_query($query);\n}\n\n", "id": 224, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$url = $_GET['input0'];\n\n// php code: \n\t\t\t$url = sqlescape(htmlspecialchars(strip_tags(rtrim($url,\"/\"))));\n$query = \"SELECT * FROM bigtree_404s WHERE broken_url = '$url'\");\t\t//sink point: $url;\n$res = mysql_query($query);\n\n", "id": 225, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$url = $_GET['input0'];\n\n// php code: \n\t\t\t$url = sqlescape(htmlspecialchars(strip_tags(rtrim($url,\"/\"))));\n\t\t\t$f = sqlfetch(sqlquery(\"SELECT * FROM bigtree_404s WHERE broken_url = '$url'\"));\n\t\t\tif ($f[\"redirect_url\"]) {\n\t\t\t\tif ($f[\"redirect_url\"] == \"/\") {\n\t\t\t\t\t$f[\"redirect_url\"] = \"\";\n\t\t\t\t}\n$query = \"UPDATE bigtree_404s SET requests = (requests + 1) WHERE = '\".$f[\"id\"].\"'\";\t\t//sink point: $f;\n$res = mysql_query($query);\n}\n\n", "id": 226, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$url = $_GET['input0'];\n\n// php code: \n\t\t\t$url = sqlescape(htmlspecialchars(strip_tags(rtrim($url,\"/\"))));\n\t\t\t$f = sqlfetch(sqlquery(\"SELECT * FROM bigtree_404s WHERE broken_url = '$url'\"));\n\t\t\tif ($f[\"redirect_url\"]) {\n\t\t\t\tif ($f[\"redirect_url\"] == \"/\") {\n\t\t\t\t\t$f[\"redirect_url\"] = \"\";\n\t\t\t\t}\n}\nelse {\n\t\t\t\tif ($f) {\n$query = \"UPDATE bigtree_404s SET requests = (requests + 1) WHERE id = '\".$f[\"id\"].\"'\";\t\t//sink point: $f;\n$res = mysql_query($query);\n\t\t\t\t}\n}\n\n", "id": 227, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$url = $_GET['input0'];\n\n// php code: \n\t\t\t$url = sqlescape(htmlspecialchars(strip_tags(rtrim($url,\"/\"))));\n\t\t\t$f = sqlfetch(sqlquery(\"SELECT * FROM bigtree_404s WHERE broken_url = '$url'\"));\n\t\t\tif ($f[\"redirect_url\"]) {\n}\nelse {\n\t\t\t\tif ($f) {\n}\nelse {\n$query = \"INSERT INTO bigtree_404s (`broken_url`,`requests`) VALUES ('$url','1')\";\t\t//sink point: $url;\n$res = mysql_query($query);\n\t\t\t\t}\n}\n\n", "id": 228, "slice_label": "bad", "file_name": "D:\\bad_5774_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$product_id = $_GET['input0'];\n\n// php code: \n\t\t$rows_uploaded = $this->db->query(\"\n\t\t\tSELECT COUNT(*) count\n\t\t\tFROM `\" . DB_PREFIX . \"amazon_product`\n\t\t\tWHERE `product_id` = '\" . (int)$product_id . \"' AND status = 'uploaded'\")->row;\n\t\t$rows_uploaded = $rows_uploaded['count'];\n\t\t$rows_ok = $this->db->query(\"\n\t\t\tSELECT COUNT(*) count\n\t\t\tFROM `\" . DB_PREFIX . \"amazon_product`\n\t\t\tWHERE `product_id` = '\" . (int)$product_id . \"' AND status = 'ok'\")->row;\n\t\t$rows_ok = $rows_ok['count'];\n\t\t$rows_error = $this->db->query(\"\n\t\t\tSELECT COUNT(*) count\n\t\t\tFROM `\" . DB_PREFIX . \"amazon_product`\n\t\t\tWHERE `product_id` = '\" . (int)$product_id . \"' AND status = 'error'\")->row;\n\t\t$rows_error = $rows_error['count'];\n\t\tif ($rows_uploaded == 0 && $rows_error > 0 && $rows_ok == 0) {\n$query = \"SELECT * FROM `\" . DB_PREFIX . \"amazon_product` WHERE `product_id` = \" . (int)$product_id . \" AND `version` = 3\";\t\t//sink point: $product_id;\n$res = mysql_query($query);\n}\n\n", "id": 229, "slice_label": "bad", "file_name": "D:\\bad_4869_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$product_id = $_GET['input0'];\n$version = $_GET['input1'];\n\n// php code: \n\t\tif ($version == 3) {\n$query = \"SELECT `messages` FROM `\" . DB_PREFIX . \"amazon_product` WHERE `product_id` = '\" . (int)$product_id . \"' AND `version` = 3\";\t\t//sink point: $product_id;\n$res = mysql_query($query);\n}\n\n", "id": 230, "slice_label": "bad", "file_name": "D:\\bad_4869_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$product_id = $_GET['input0'];\n\n// php code: \n$query = \"SELECT `sku`, `insertion_id` FROM `\" . DB_PREFIX . \"amazon_product` WHERE `product_id` = '\" . (int)$product_id . \"' AND `version` = 2\";\t\t//sink point: $product_id;\n$res = mysql_query($query);\n\n", "id": 231, "slice_label": "bad", "file_name": "D:\\bad_4869_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$product_id = $_GET['input0'];\n\n// php code: \n\t\t$insertion_rows = $this->db->query(\"SELECT `sku`, `insertion_id` FROM `\" . DB_PREFIX . \"amazon_product` WHERE `product_id` = '\" . (int)$product_id . \"' AND `version` = 2\")->rows;\n\t\tif (!empty($insertion_rows)) {\n\t\t\tforeach($insertion_rows as $insertion_row) {\n$query = \"SELECT * FROM `\" . DB_PREFIX . \"amazon_product_error` WHERE `sku` = '\" . _PAD_->db->escape($insertion_row['sku']) . \"' AND `insertion_id` = '\" . _PAD_->db->escape($insertion_row['insertion_id']) . \"'\";\t\t//sink point: $insertion_row;\n$res = mysql_query($query);\n}\n}\n\n", "id": 232, "slice_label": "bad", "file_name": "D:\\bad_4869_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$product_id = $_GET['input0'];\n\n// php code: \n\t\t$insertion_rows = $this->db->query(\"SELECT `sku`, `insertion_id` FROM `\" . DB_PREFIX . \"amazon_product` WHERE `product_id` = '\" . (int)$product_id . \"' AND `version` = 2\")->rows;\n\t\tif (!empty($insertion_rows)) {\n\t\t\tforeach($insertion_rows as $insertion_row) {\n$query = \"SELECT * FROM `\" . DB_PREFIX . \"amazon_product_error` WHERE `sku` = '\" . $this->db->escape(_PAD_) . \"' AND `insertion_id` = '\" . $this->db->escape(_PAD_) . \"'\";\t\t//sink point: $this;\n$res = mysql_query($query);\n}\n}\n\n", "id": 233, "slice_label": "bad", "file_name": "D:\\bad_4869_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$amazon_sku = $_GET['input0'];\n$product_id = $_GET['input1'];\n$var = $_GET['input2'];\n\n// php code: \n\t\t$count = $this->db->query(\"SELECT COUNT(*) as 'count' FROM `\" . DB_PREFIX . \"amazon_product_link` WHERE `product_id` = '\" . (int)$product_id . \"' AND `amazon_sku` = '\" . $this->db->escape($amazon_sku) . \"' AND `var` = '\" . $this->db->escape($var) . \"' LIMIT 1\")->row;\n\t\tif ($count['count'] == 0) {\n$query = \"INSERT INTO `\" . DB_PREFIX . \"amazon_product_link` SET `product_id` = '\" . (int)_PAD_ . \"', `amazon_sku` = '\" . _PAD_->db->escape(_PAD_) . \"', `var` = '\" . _PAD_->db->escape($var) . \"'\";\t\t//sink point: $var;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 234, "slice_label": "bad", "file_name": "D:\\bad_4869_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$amazon_sku = $_GET['input0'];\n$product_id = $_GET['input1'];\n$var = $_GET['input2'];\n\n// php code: \n\t\t$count = $this->db->query(\"SELECT COUNT(*) as 'count' FROM `\" . DB_PREFIX . \"amazon_product_link` WHERE `product_id` = '\" . (int)$product_id . \"' AND `amazon_sku` = '\" . $this->db->escape($amazon_sku) . \"' AND `var` = '\" . $this->db->escape($var) . \"' LIMIT 1\")->row;\n\t\tif ($count['count'] == 0) {\n$query = \"INSERT INTO `\" . DB_PREFIX . \"amazon_product_link` SET `product_id` = '\" . (int)_PAD_ . \"', `amazon_sku` = '\" . _PAD_->db->escape($amazon_sku) . \"', `var` = '\" . _PAD_->db->escape(_PAD_) . \"'\";\t\t//sink point: $amazon_sku;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 235, "slice_label": "bad", "file_name": "D:\\bad_4869_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$amazon_sku = $_GET['input0'];\n$product_id = $_GET['input1'];\n$var = $_GET['input2'];\n\n// php code: \n\t\t$count = $this->db->query(\"SELECT COUNT(*) as 'count' FROM `\" . DB_PREFIX . \"amazon_product_link` WHERE `product_id` = '\" . (int)$product_id . \"' AND `amazon_sku` = '\" . $this->db->escape($amazon_sku) . \"' AND `var` = '\" . $this->db->escape($var) . \"' LIMIT 1\")->row;\n\t\tif ($count['count'] == 0) {\n$query = \"INSERT INTO `\" . DB_PREFIX . \"amazon_product_link` SET `product_id` = '\" . (int)$product_id . \"', `amazon_sku` = '\" . _PAD_->db->escape(_PAD_) . \"', `var` = '\" . _PAD_->db->escape(_PAD_) . \"'\";\t\t//sink point: $product_id;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 236, "slice_label": "bad", "file_name": "D:\\bad_4869_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$amazon_sku = $_GET['input0'];\n$product_id = $_GET['input1'];\n$var = $_GET['input2'];\n\n// php code: \n\t\t$count = $this->db->query(\"SELECT COUNT(*) as 'count' FROM `\" . DB_PREFIX . \"amazon_product_link` WHERE `product_id` = '\" . (int)$product_id . \"' AND `amazon_sku` = '\" . $this->db->escape($amazon_sku) . \"' AND `var` = '\" . $this->db->escape($var) . \"' LIMIT 1\")->row;\n\t\tif ($count['count'] == 0) {\n$query = \"INSERT INTO `\" . DB_PREFIX . \"amazon_product_link` SET `product_id` = '\" . (int)_PAD_ . \"', `amazon_sku` = '\" . $this->db->escape(_PAD_) . \"', `var` = '\" . $this->db->escape(_PAD_) . \"'\";\t\t//sink point: $this;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 237, "slice_label": "bad", "file_name": "D:\\bad_4869_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$skus = $_GET['input0'];\n\n// php code: \n\t\t$sku_array = array();\n\t\tforeach ($skus as $sku) {\n\t\t\t$sku_array[] = \"'\" . $this->db->escape($sku) . \"'\";\n\t\t}\n\t\tif ($this->openbay->addonLoad('openstock')) {\n$query = \"SELECT apl.amazon_sku, if (pov.product_id IS NULL, p.quantity, pov.stock) AS 'quantity' FROM \" . DB_PREFIX . \"amazon_product_link apl JOIN \" . DB_PREFIX . \"product p ON apl.product_id = p.product_id LEFT JOIN \" . DB_PREFIX . \"product_option_variant pov ON apl.product_id = pov.product_id AND apl.var = pov.sku WHERE apl.amazon_sku IN (\" . implode(',', $sku_array) . \")\";\t\t//sink point: $sku_array;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 238, "slice_label": "bad", "file_name": "D:\\bad_4869_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$skus = $_GET['input0'];\n\n// php code: \n\t\t$sku_array = array();\n\t\tforeach ($skus as $sku) {\n\t\t\t$sku_array[] = \"'\" . $this->db->escape($sku) . \"'\";\n\t\t}\n\t\tif ($this->openbay->addonLoad('openstock')) {\n}\nelse {\n$query = \"SELECT apl.amazon_sku, p.quantity FROM \" . DB_PREFIX . \"amazon_product_link apl JOIN \" . DB_PREFIX . \"product p ON apl.product_id = p.product_id WHERE apl.amazon_sku IN (\" . implode(',', $sku_array) . \")\";\t\t//sink point: $sku_array;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 239, "slice_label": "bad", "file_name": "D:\\bad_4869_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$query = \"SELECT user_id FROM `session` WHERE session_id = '\"._PAD_->escape(session_id()).\"' AND user_id = '\"._PAD_->escape($_GET['uid']).\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 240, "slice_label": "bad", "file_name": "D:\\good_3816_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n$query = \"SELECT user_id FROM `session` WHERE session_id = '\".$pearDB->escape(session_id()).\"' AND user_id = '\".$pearDB->escape(_PAD_).\"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n\n", "id": 241, "slice_label": "bad", "file_name": "D:\\good_3816_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=32;\n$tabfield=array();\n$tabfield[32]= \"code,label,range_account,category_type,formula,position,country\";\n$tabrowid=array();\n$tabrowid[32]= \"\";\nif (GETPOST('actionadd') || GETPOST('actionmodify'))\n{\n    $listfield=explode(',', str_replace(' ', '',$tabfield[$id]));\n    $ok=1;\n    foreach ($listfield as $f => $value)\n    {\n\t\tif (! isset($_POST[$value]) || $_POST[$value]=='')\n        {\n            $ok=0;\n}\n}\n    if (isset($_POST[\"code\"]))\n    {\n    \tif ($_POST[\"code\"]=='0')\n    \t{\n        \t$ok=0;\n}\n}\n    if (! is_numeric(GETPOST('position','alpha')))\n    {\n   \t\t$ok=0;\n}\n    if ($ok && GETPOST('actionadd','alpha'))\n    {\n        if ($tabrowid[$id])\n        {\n$query = \"SELECT max(\".$tabrowid[_PAD_].\") newid from \".$tabname[_PAD_];\t\t//sink point: $tabrowid;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 242, "slice_label": "bad", "file_name": "D:\\good_684_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=32;\n$tabname=array();\n$tabname[32]= MAIN_DB_PREFIX.\"c_accounting_category\";\n$tabfield=array();\n$tabfield[32]= \"code,label,range_account,category_type,formula,position,country\";\n$tabrowid=array();\n$tabrowid[32]= \"\";\nif (GETPOST('actionadd') || GETPOST('actionmodify'))\n{\n    $listfield=explode(',', str_replace(' ', '',$tabfield[$id]));\n    $ok=1;\n    foreach ($listfield as $f => $value)\n    {\n\t\tif (! isset($_POST[$value]) || $_POST[$value]=='')\n        {\n            $ok=0;\n}\n}\n    if (isset($_POST[\"code\"]))\n    {\n    \tif ($_POST[\"code\"]=='0')\n    \t{\n        \t$ok=0;\n}\n}\n    if (! is_numeric(GETPOST('position','alpha')))\n    {\n   \t\t$ok=0;\n}\n    if ($ok && GETPOST('actionadd','alpha'))\n    {\n        if ($tabrowid[$id])\n        {\n$query = \"SELECT max(\"._PAD_.\") newid from \".$tabname[_PAD_];\t\t//sink point: $tabname;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 243, "slice_label": "bad", "file_name": "D:\\good_684_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=32;\n$tabname=array();\n$tabname[32]= MAIN_DB_PREFIX.\"c_accounting_category\";\n$tabfield=array();\n$tabfield[32]= \"code,label,range_account,category_type,formula,position,country\";\nif (GETPOST('actionadd') || GETPOST('actionmodify'))\n{\n    $listfield=explode(',', str_replace(' ', '',$tabfield[$id]));\n    $ok=1;\n    foreach ($listfield as $f => $value)\n    {\n\t\tif (! isset($_POST[$value]) || $_POST[$value]=='')\n        {\n            $ok=0;\n}\n}\n    if (isset($_POST[\"code\"]))\n    {\n    \tif ($_POST[\"code\"]=='0')\n    \t{\n        \t$ok=0;\n}\n}\n    if (! is_numeric(GETPOST('position','alpha')))\n    {\n   \t\t$ok=0;\n}\n    if ($ok && GETPOST('actionadd','alpha'))\n    {\n$query = \"INSERT INTO \".$tabname[_PAD_].\" (\";\t\t//sink point: $tabname;\n$res = mysql_query($query);\n}\n}\n\n", "id": 244, "slice_label": "bad", "file_name": "D:\\good_684_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=32;\n$tabname=array();\n$tabname[32]= MAIN_DB_PREFIX.\"c_accounting_category\";\n$tabfield=array();\n$tabfield[32]= \"code,label,range_account,category_type,formula,position,country\";\nif (GETPOST('actionadd') || GETPOST('actionmodify'))\n{\n    $listfield=explode(',', str_replace(' ', '',$tabfield[$id]));\n    $ok=1;\n    foreach ($listfield as $f => $value)\n    {\n\t\tif (! isset($_POST[$value]) || $_POST[$value]=='')\n        {\n            $ok=0;\n}\n}\n    if (isset($_POST[\"code\"]))\n    {\n    \tif ($_POST[\"code\"]=='0')\n    \t{\n        \t$ok=0;\n}\n}\n    if (! is_numeric(GETPOST('position','alpha')))\n    {\n   \t\t$ok=0;\n}\n    if ($ok && GETPOST('actionmodify'))\n    {\n$query = \"UPDATE \".$tabname[_PAD_].\" SET \";\t\t//sink point: $tabname;\n$res = mysql_query($query);\n}\n}\n\n", "id": 245, "slice_label": "bad", "file_name": "D:\\good_684_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_SESSION['centreon'])) {\n$query = \"SELECT user_id FROM session WHERE session_id = '\" . htmlentities($_GET['sid'], ENT_QUOTES, \"UTF-8\") . \"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 246, "slice_label": "bad", "file_name": "D:\\bad_3816_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_GET[\"service_id\"]) && $_GET[\"service_id\"]) {\n$query = \"SELECT service_description, service_id FROM service WHERE service_template_model_stm_id = '\".$_GET[\"service_id\"].\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 247, "slice_label": "bad", "file_name": "D:\\bad_2179_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_POST[\"mnftr_id\"])){\n\t\tif ($_POST[\"mnftr_id\"] == -1) {\n}\nelse if ($_POST[\"mnftr_id\"] == -2) {\n}\nelse if ($_POST[\"mnftr_id\"] != 0) {\n$query = \"SELECT traps_id, traps_name FROM traps WHERE manufacturer_id = \" . $_POST[\"mnftr_id\"]. \" ORDER BY traps_name\";\t\t//sink point: $_POST;\n$res = mysql_query($query);\n\t\t}\n}\n\n", "id": 248, "slice_label": "bad", "file_name": "D:\\bad_2179_7.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$object = $_GET['input0'];\n$table = $_GET['input1'];\n$identifier = $_GET['input2'];\n$is_revisioned = $_GET['input3'];\n\n// php code: \n        if ($is_revisioned) {\n            $this->trim_revisions($table, $object->$identifier, WORKFLOW_REVISION_LIMIT);\n}\n$query = \"UPDATE \" . _PAD_->prefix . \"$table SET \";\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 249, "slice_label": "bad", "file_name": "D:\\bad_5278_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$object = $_GET['input0'];\n$table = $_GET['input1'];\n$identifier = $_GET['input2'];\n$is_revisioned = $_GET['input3'];\n\n// php code: \n        if ($is_revisioned) {\n            $this->trim_revisions($table, $object->$identifier, WORKFLOW_REVISION_LIMIT);\n}\n$query = \"UPDATE \" . $this->prefix . \"_PAD_ SET \";\t\t//sink point: $this;\n$res = mysql_query($query);\n\n", "id": 250, "slice_label": "bad", "file_name": "D:\\bad_5278_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_POST[\"index\"])){\n$query = \"SELECT `command_example` FROM `command` WHERE `command_id` = '\". $_POST[\"index\"] .\"'\";\t\t//sink point: $_POST;\n$res = mysql_query($query);\n}\n\n", "id": 251, "slice_label": "bad", "file_name": "D:\\bad_3816_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$query = \"SELECT user_id FROM `session` WHERE session_id = '\"._PAD_->escape($_GET[\"sid\"]).\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 252, "slice_label": "bad", "file_name": "D:\\good_3816_7.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n$query = \"SELECT user_id FROM `session` WHERE session_id = '\".$pearDB->escape(_PAD_).\"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n\n", "id": 253, "slice_label": "bad", "file_name": "D:\\good_3816_7.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$query = \"SELECT css_name FROM `css_color_menu` WHERE menu_nb = '\"._PAD_->escape($_GET[\"menu\"]).\"' LIMIT 1\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 254, "slice_label": "bad", "file_name": "D:\\good_3816_7.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n$query = \"SELECT css_name FROM `css_color_menu` WHERE menu_nb = '\".$pearDB->escape(_PAD_).\"' LIMIT 1\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n\n", "id": 255, "slice_label": "bad", "file_name": "D:\\good_3816_7.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=35;\n$tabrowid=array();\n$tabrowid[35]= \"\";\nif (GETPOST('actionadd') || GETPOST('actionmodify'))\n{\n\t$ok=1;\n\tif (isset($_POST[\"code\"]))\n\t{\n\t\tif ($_POST[\"code\"]=='0')\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif (! GETPOST('label','alpha'))\n\t{\n\t\t$ok=0;\n\t}\n\tif ($ok && GETPOST('actionadd'))\n\t{\n\t\tif ($tabrowid[$id])\n\t\t{\n$query = \"SELECT max(\".$tabrowid[_PAD_].\") newid from \".$tabname[_PAD_];\t\t//sink point: $tabrowid;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 256, "slice_label": "bad", "file_name": "D:\\good_684_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=35;\n$tabname=array();\n$tabname[35]= MAIN_DB_PREFIX.\"accounting_journal\";\n$tabrowid=array();\n$tabrowid[35]= \"\";\nif (GETPOST('actionadd') || GETPOST('actionmodify'))\n{\n\t$ok=1;\n\tif (isset($_POST[\"code\"]))\n\t{\n\t\tif ($_POST[\"code\"]=='0')\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif (! GETPOST('label','alpha'))\n\t{\n\t\t$ok=0;\n\t}\n\tif ($ok && GETPOST('actionadd'))\n\t{\n\t\tif ($tabrowid[$id])\n\t\t{\n$query = \"SELECT max(\"._PAD_.\") newid from \".$tabname[_PAD_];\t\t//sink point: $tabname;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 257, "slice_label": "bad", "file_name": "D:\\good_684_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$tabname=array();\n$tabname[35]= MAIN_DB_PREFIX.\"accounting_journal\";\nif (GETPOST('actionadd') || GETPOST('actionmodify'))\n{\n\t$ok=1;\n\tif (isset($_POST[\"code\"]))\n\t{\n\t\tif ($_POST[\"code\"]=='0')\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif (! GETPOST('label','alpha'))\n\t{\n\t\t$ok=0;\n\t}\n\tif ($ok && GETPOST('actionadd'))\n\t{\n$query = \"INSERT INTO \".$tabname[_PAD_].\" (\";\t\t//sink point: $tabname;\n$res = mysql_query($query);\n}\n}\n\n", "id": 258, "slice_label": "bad", "file_name": "D:\\good_684_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$tabname=array();\n$tabname[35]= MAIN_DB_PREFIX.\"accounting_journal\";\nif (GETPOST('actionadd') || GETPOST('actionmodify'))\n{\n\t$ok=1;\n\tif (isset($_POST[\"code\"]))\n\t{\n\t\tif ($_POST[\"code\"]=='0')\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif (! GETPOST('label','alpha'))\n\t{\n\t\t$ok=0;\n\t}\n\tif ($ok && GETPOST('actionmodify'))\n\t{\n$query = \"UPDATE \".$tabname[_PAD_].\" SET \";\t\t//sink point: $tabname;\n$res = mysql_query($query);\n}\n}\n\n", "id": 259, "slice_label": "bad", "file_name": "D:\\good_684_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=GETPOST('id','int');\n$tabname=array();\n$tabname[31]= MAIN_DB_PREFIX.\"accounting_system\";\n$tabname[32]= MAIN_DB_PREFIX.\"c_accounting_category\";\n$tablib=array();\n$tablib[31]= \"Pcg_version\";\n$tablib[32]= \"DictionaryAccountancyCategory\";\n$tabfield=array();\n$tabfield[31]= \"pcg_version,label,country_id,country\";\n$tabfield[32]= \"code,label,range_account,sens,category_type,formula,position,country_id,country\";\n$tabrowid=array();\n$tabrowid[31]= \"\";\n$tabrowid[32]= \"\";\nif (GETPOST('actionadd') || GETPOST('actionmodify'))\n{\n\t$listfield=explode(',', str_replace(' ', '',$tabfield[$id]));\n\t$ok=1;\n\tforeach ($listfield as $f => $value)\n\t{\n\t\tif ((! isset($_POST[$value]) || $_POST[$value]=='')\n\t\t\t&& (! in_array($listfield[$f], array('decalage','module','accountancy_code','accountancy_code_sell','accountancy_code_buy'))  \n\t\t\t&& (! ($id == 10 && $listfield[$f] == 'code')) \n\t\t\t)\n\t\t)\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif ($tabname[$id] == MAIN_DB_PREFIX.\"c_actioncomm\" && isset($_POST[\"type\"]) && in_array($_POST[\"type\"],array('system','systemauto'))) {\n\t\t$ok=0;\n}\n\tif (isset($_POST[\"code\"]))\n\t{\n\t\tif ($_POST[\"code\"]=='0')\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif (isset($_POST[\"country\"]) && ($_POST[\"country\"]=='0') && ($id != 2))\n\t{\n\t\tif (in_array($tablib[$id],array('DictionaryCompanyType','DictionaryHolidayTypes')))\t\n\t\t{\n}\n\t\telse\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif ($id == 3 && ! is_numeric($_POST[\"code\"]))\n\t{\n\t   \t$ok=0;\n}\n\tif ($ok && GETPOST('actionadd'))\n\t{\n\t\tif ($tabrowid[$id])\n\t\t{\n$query = \"SELECT max(\".$tabrowid[_PAD_].\") newid from \".$tabname[_PAD_];\t\t//sink point: $tabrowid;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 260, "slice_label": "bad", "file_name": "D:\\bad_684_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=GETPOST('id','int');\n$tabname=array();\n$tabname[31]= MAIN_DB_PREFIX.\"accounting_system\";\n$tabname[32]= MAIN_DB_PREFIX.\"c_accounting_category\";\n$tablib=array();\n$tablib[31]= \"Pcg_version\";\n$tablib[32]= \"DictionaryAccountancyCategory\";\n$tabfield=array();\n$tabfield[31]= \"pcg_version,label,country_id,country\";\n$tabfield[32]= \"code,label,range_account,sens,category_type,formula,position,country_id,country\";\n$tabrowid=array();\n$tabrowid[31]= \"\";\n$tabrowid[32]= \"\";\nif (GETPOST('actionadd') || GETPOST('actionmodify'))\n{\n\t$listfield=explode(',', str_replace(' ', '',$tabfield[$id]));\n\t$ok=1;\n\tforeach ($listfield as $f => $value)\n\t{\n\t\tif ((! isset($_POST[$value]) || $_POST[$value]=='')\n\t\t\t&& (! in_array($listfield[$f], array('decalage','module','accountancy_code','accountancy_code_sell','accountancy_code_buy'))  \n\t\t\t&& (! ($id == 10 && $listfield[$f] == 'code')) \n\t\t\t)\n\t\t)\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif ($tabname[$id] == MAIN_DB_PREFIX.\"c_actioncomm\" && isset($_POST[\"type\"]) && in_array($_POST[\"type\"],array('system','systemauto'))) {\n\t\t$ok=0;\n}\n\tif (isset($_POST[\"code\"]))\n\t{\n\t\tif ($_POST[\"code\"]=='0')\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif (isset($_POST[\"country\"]) && ($_POST[\"country\"]=='0') && ($id != 2))\n\t{\n\t\tif (in_array($tablib[$id],array('DictionaryCompanyType','DictionaryHolidayTypes')))\t\n\t\t{\n}\n\t\telse\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif ($id == 3 && ! is_numeric($_POST[\"code\"]))\n\t{\n\t   \t$ok=0;\n}\n\tif ($ok && GETPOST('actionadd'))\n\t{\n\t\tif ($tabrowid[$id])\n\t\t{\n$query = \"SELECT max(\"._PAD_.\") newid from \".$tabname[_PAD_];\t\t//sink point: $tabname;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 261, "slice_label": "bad", "file_name": "D:\\bad_684_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=GETPOST('id','int');\n$tabname=array();\n$tabname[31]= MAIN_DB_PREFIX.\"accounting_system\";\n$tabname[32]= MAIN_DB_PREFIX.\"c_accounting_category\";\n$tablib=array();\n$tablib[31]= \"Pcg_version\";\n$tablib[32]= \"DictionaryAccountancyCategory\";\n$tabfield=array();\n$tabfield[31]= \"pcg_version,label,country_id,country\";\n$tabfield[32]= \"code,label,range_account,sens,category_type,formula,position,country_id,country\";\nif (GETPOST('actionadd') || GETPOST('actionmodify'))\n{\n\t$listfield=explode(',', str_replace(' ', '',$tabfield[$id]));\n\t$ok=1;\n\tforeach ($listfield as $f => $value)\n\t{\n\t\tif ((! isset($_POST[$value]) || $_POST[$value]=='')\n\t\t\t&& (! in_array($listfield[$f], array('decalage','module','accountancy_code','accountancy_code_sell','accountancy_code_buy'))  \n\t\t\t&& (! ($id == 10 && $listfield[$f] == 'code')) \n\t\t\t)\n\t\t)\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif ($tabname[$id] == MAIN_DB_PREFIX.\"c_actioncomm\" && isset($_POST[\"type\"]) && in_array($_POST[\"type\"],array('system','systemauto'))) {\n\t\t$ok=0;\n}\n\tif (isset($_POST[\"code\"]))\n\t{\n\t\tif ($_POST[\"code\"]=='0')\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif (isset($_POST[\"country\"]) && ($_POST[\"country\"]=='0') && ($id != 2))\n\t{\n\t\tif (in_array($tablib[$id],array('DictionaryCompanyType','DictionaryHolidayTypes')))\t\n\t\t{\n}\n\t\telse\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif ($id == 3 && ! is_numeric($_POST[\"code\"]))\n\t{\n\t   \t$ok=0;\n}\n\tif ($ok && GETPOST('actionadd'))\n\t{\n$query = \"INSERT INTO \".$tabname[_PAD_].\" (\";\t\t//sink point: $tabname;\n$res = mysql_query($query);\n}\n}\n\n", "id": 262, "slice_label": "bad", "file_name": "D:\\bad_684_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=GETPOST('id','int');\n$tabname=array();\n$tabname[31]= MAIN_DB_PREFIX.\"accounting_system\";\n$tabname[32]= MAIN_DB_PREFIX.\"c_accounting_category\";\n$tablib=array();\n$tablib[31]= \"Pcg_version\";\n$tablib[32]= \"DictionaryAccountancyCategory\";\n$tabfield=array();\n$tabfield[31]= \"pcg_version,label,country_id,country\";\n$tabfield[32]= \"code,label,range_account,sens,category_type,formula,position,country_id,country\";\nif (GETPOST('actionadd') || GETPOST('actionmodify'))\n{\n\t$listfield=explode(',', str_replace(' ', '',$tabfield[$id]));\n\t$ok=1;\n\tforeach ($listfield as $f => $value)\n\t{\n\t\tif ((! isset($_POST[$value]) || $_POST[$value]=='')\n\t\t\t&& (! in_array($listfield[$f], array('decalage','module','accountancy_code','accountancy_code_sell','accountancy_code_buy'))  \n\t\t\t&& (! ($id == 10 && $listfield[$f] == 'code')) \n\t\t\t)\n\t\t)\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif ($tabname[$id] == MAIN_DB_PREFIX.\"c_actioncomm\" && isset($_POST[\"type\"]) && in_array($_POST[\"type\"],array('system','systemauto'))) {\n\t\t$ok=0;\n}\n\tif (isset($_POST[\"code\"]))\n\t{\n\t\tif ($_POST[\"code\"]=='0')\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif (isset($_POST[\"country\"]) && ($_POST[\"country\"]=='0') && ($id != 2))\n\t{\n\t\tif (in_array($tablib[$id],array('DictionaryCompanyType','DictionaryHolidayTypes')))\t\n\t\t{\n}\n\t\telse\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif ($id == 3 && ! is_numeric($_POST[\"code\"]))\n\t{\n\t   \t$ok=0;\n}\n\tif ($ok && GETPOST('actionmodify'))\n\t{\n$query = \"UPDATE \".$tabname[_PAD_].\" SET \";\t\t//sink point: $tabname;\n$res = mysql_query($query);\n}\n}\n\n", "id": 263, "slice_label": "bad", "file_name": "D:\\bad_684_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$object = $_GET['input0'];\n$where = $_GET['input1'];\n\n// php code: \n\t   if (isset($object->id)) {\n$query = \"UPDATE \" . _PAD_->prefix . _PAD_ . \" SET \" . _PAD_ . \"=0 WHERE \" . $where;\t\t//sink point: $where;\n$res = mysql_query($query);\n}\n\n", "id": 264, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$object = $_GET['input0'];\n$table = $_GET['input1'];\n\n// php code: \n\t   if (isset($object->id)) {\n$query = \"UPDATE \" . _PAD_->prefix . $table . \" SET \" . _PAD_ . \"=0 WHERE \" . _PAD_;\t\t//sink point: $table;\n$res = mysql_query($query);\n}\n\n", "id": 265, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$object = $_GET['input0'];\n$col = $_GET['input1'];\n\n// php code: \n\t   if (isset($object->id)) {\n$query = \"UPDATE \" . _PAD_->prefix . _PAD_ . \" SET \" . $col . \"=0 WHERE \" . _PAD_;\t\t//sink point: $col;\n$res = mysql_query($query);\n}\n\n", "id": 266, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$object = $_GET['input0'];\n\n// php code: \n\t   if (isset($object->id)) {\n$query = \"UPDATE \" . $this->prefix . _PAD_ . \" SET \" . _PAD_ . \"=0 WHERE \" . _PAD_;\t\t//sink point: $this;\n$res = mysql_query($query);\n}\n\n", "id": 267, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$object = $_GET['input0'];\n\n// php code: \n\t   if (isset($object->id)) {\n$query = \"UPDATE \" . _PAD_->prefix . _PAD_ . \" SET \" . _PAD_ . \"=1 WHERE id=\" . $object->id;\t\t//sink point: $object;\n$res = mysql_query($query);\n}\n\n", "id": 268, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$object = $_GET['input0'];\n$table = $_GET['input1'];\n$col = $_GET['input2'];\n$where = $_GET['input3'];\n\n// php code: \n\t   if (isset($object->id)) {\n\t       $this->sql(\"UPDATE \" . $this->prefix . $table . \" SET \" . $col . \"=0 WHERE \" . $where);\n$query = \"UPDATE \" . _PAD_->prefix . $table . \" SET \" . _PAD_ . \"=1 WHERE id=\" . _PAD_->id;\t\t//sink point: $table;\n$res = mysql_query($query);\n}\n\n", "id": 269, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$object = $_GET['input0'];\n$table = $_GET['input1'];\n$col = $_GET['input2'];\n$where = $_GET['input3'];\n\n// php code: \n\t   if (isset($object->id)) {\n\t       $this->sql(\"UPDATE \" . $this->prefix . $table . \" SET \" . $col . \"=0 WHERE \" . $where);\n$query = \"UPDATE \" . _PAD_->prefix . _PAD_ . \" SET \" . $col . \"=1 WHERE id=\" . _PAD_->id;\t\t//sink point: $col;\n$res = mysql_query($query);\n}\n\n", "id": 270, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$object = $_GET['input0'];\n$table = $_GET['input1'];\n$col = $_GET['input2'];\n$where = $_GET['input3'];\n\n// php code: \n\t   if (isset($object->id)) {\n\t       $this->sql(\"UPDATE \" . $this->prefix . $table . \" SET \" . $col . \"=0 WHERE \" . $where);\n$query = \"UPDATE \" . $this->prefix . _PAD_ . \" SET \" . _PAD_ . \"=1 WHERE id=\" . _PAD_->id;\t\t//sink point: $this;\n$res = mysql_query($query);\n}\n\n", "id": 271, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n$query = 'UPDATE `' . $table . '` SET rgt = rgt + ' . _PAD_ . ' WHERE rgt >=' . _PAD_;\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 272, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$width = $_GET['input0'];\n\n// php code: \n$query = 'UPDATE `' . _PAD_ . '` SET rgt = rgt + ' . $width . ' WHERE rgt >=' . _PAD_;\t\t//sink point: $width;\n$res = mysql_query($query);\n\n", "id": 273, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$start = $_GET['input0'];\n\n// php code: \n$query = 'UPDATE `' . _PAD_ . '` SET rgt = rgt + ' . _PAD_ . ' WHERE rgt >=' . $start;\t\t//sink point: $start;\n$res = mysql_query($query);\n\n", "id": 274, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n$start = $_GET['input1'];\n$width = $_GET['input2'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n\t   $this->sql('UPDATE `' . $table . '` SET rgt = rgt + ' . $width . ' WHERE rgt >=' . $start);\n$query = 'UPDATE `' . $table . '` SET lft = lft + ' . _PAD_ . ' WHERE lft >=' . _PAD_;\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 275, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n$start = $_GET['input1'];\n$width = $_GET['input2'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n\t   $this->sql('UPDATE `' . $table . '` SET rgt = rgt + ' . $width . ' WHERE rgt >=' . $start);\n$query = 'UPDATE `' . _PAD_ . '` SET lft = lft + ' . $width . ' WHERE lft >=' . _PAD_;\t\t//sink point: $width;\n$res = mysql_query($query);\n\n", "id": 276, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n$start = $_GET['input1'];\n$width = $_GET['input2'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n\t   $this->sql('UPDATE `' . $table . '` SET rgt = rgt + ' . $width . ' WHERE rgt >=' . $start);\n$query = 'UPDATE `' . _PAD_ . '` SET lft = lft + ' . _PAD_ . ' WHERE lft >=' . $start;\t\t//sink point: $start;\n$res = mysql_query($query);\n\n", "id": 277, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$lft = $_GET['input0'];\n\n// php code: \n$query = 'UPDATE `' . _PAD_ . '` SET rgt = rgt + ' . _PAD_ . ' WHERE rgt BETWEEN ' . $lft . ' AND ' . _PAD_;\t\t//sink point: $lft;\n$res = mysql_query($query);\n\n", "id": 278, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n$query = 'UPDATE `' . $table . '` SET rgt = rgt + ' . _PAD_ . ' WHERE rgt BETWEEN ' . _PAD_ . ' AND ' . _PAD_;\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 279, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$width = $_GET['input0'];\n\n// php code: \n$query = 'UPDATE `' . _PAD_ . '` SET rgt = rgt + ' . $width . ' WHERE rgt BETWEEN ' . _PAD_ . ' AND ' . _PAD_;\t\t//sink point: $width;\n$res = mysql_query($query);\n\n", "id": 280, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$rgt = $_GET['input0'];\n\n// php code: \n$query = 'UPDATE `' . _PAD_ . '` SET rgt = rgt + ' . _PAD_ . ' WHERE rgt BETWEEN ' . _PAD_ . ' AND ' . $rgt;\t\t//sink point: $rgt;\n$res = mysql_query($query);\n\n", "id": 281, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n$lft = $_GET['input1'];\n$rgt = $_GET['input2'];\n$width = $_GET['input3'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n\t   $this->sql('UPDATE `' . $table . '` SET rgt = rgt + ' . $width . ' WHERE rgt BETWEEN ' . $lft . ' AND ' . $rgt);\n$query = 'UPDATE `' . _PAD_ . '` SET lft = lft + ' . _PAD_ . ' WHERE lft BETWEEN ' . $lft . ' AND ' . _PAD_;\t\t//sink point: $lft;\n$res = mysql_query($query);\n\n", "id": 282, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n$lft = $_GET['input1'];\n$rgt = $_GET['input2'];\n$width = $_GET['input3'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n\t   $this->sql('UPDATE `' . $table . '` SET rgt = rgt + ' . $width . ' WHERE rgt BETWEEN ' . $lft . ' AND ' . $rgt);\n$query = 'UPDATE `' . $table . '` SET lft = lft + ' . _PAD_ . ' WHERE lft BETWEEN ' . _PAD_ . ' AND ' . _PAD_;\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 283, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n$lft = $_GET['input1'];\n$rgt = $_GET['input2'];\n$width = $_GET['input3'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n\t   $this->sql('UPDATE `' . $table . '` SET rgt = rgt + ' . $width . ' WHERE rgt BETWEEN ' . $lft . ' AND ' . $rgt);\n$query = 'UPDATE `' . _PAD_ . '` SET lft = lft + ' . $width . ' WHERE lft BETWEEN ' . _PAD_ . ' AND ' . _PAD_;\t\t//sink point: $width;\n$res = mysql_query($query);\n\n", "id": 284, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n$lft = $_GET['input1'];\n$rgt = $_GET['input2'];\n$width = $_GET['input3'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n\t   $this->sql('UPDATE `' . $table . '` SET rgt = rgt + ' . $width . ' WHERE rgt BETWEEN ' . $lft . ' AND ' . $rgt);\n$query = 'UPDATE `' . _PAD_ . '` SET lft = lft + ' . _PAD_ . ' WHERE lft BETWEEN ' . _PAD_ . ' AND ' . $rgt;\t\t//sink point: $rgt;\n$res = mysql_query($query);\n\n", "id": 285, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n$lft = $_GET['input1'];\n$rgt = $_GET['input2'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n\t   $this->sql('DELETE FROM `' . $table . '` WHERE lft BETWEEN ' . $lft . ' AND ' . $rgt);\n$query = 'UPDATE `' . $table . '` SET rgt = rgt - ' . _PAD_ . ' WHERE rgt > ' . _PAD_;\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 286, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$lft = $_GET['input0'];\n$rgt = $_GET['input1'];\n\n// php code: \n\t   $width = ($rgt - $lft) + 1;\n$query = 'UPDATE `' . _PAD_ . '` SET rgt = rgt - ' . $width . ' WHERE rgt > ' . _PAD_;\t\t//sink point: $width;\n$res = mysql_query($query);\n\n", "id": 287, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n$lft = $_GET['input1'];\n$rgt = $_GET['input2'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n\t   $this->sql('DELETE FROM `' . $table . '` WHERE lft BETWEEN ' . $lft . ' AND ' . $rgt);\n$query = 'UPDATE `' . _PAD_ . '` SET rgt = rgt - ' . _PAD_ . ' WHERE rgt > ' . $rgt;\t\t//sink point: $rgt;\n$res = mysql_query($query);\n\n", "id": 288, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n$lft = $_GET['input1'];\n$rgt = $_GET['input2'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n\t   $width = ($rgt - $lft) + 1;\n\t   $this->sql('DELETE FROM `' . $table . '` WHERE lft BETWEEN ' . $lft . ' AND ' . $rgt);\n\t   $this->sql('UPDATE `' . $table . '` SET rgt = rgt - ' . $width . ' WHERE rgt > ' . $rgt);\n$query = 'UPDATE `' . $table . '` SET lft = lft - ' . _PAD_ . ' WHERE lft > ' . _PAD_;\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 289, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n$lft = $_GET['input1'];\n$rgt = $_GET['input2'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n\t   $width = ($rgt - $lft) + 1;\n\t   $this->sql('DELETE FROM `' . $table . '` WHERE lft BETWEEN ' . $lft . ' AND ' . $rgt);\n\t   $this->sql('UPDATE `' . $table . '` SET rgt = rgt - ' . $width . ' WHERE rgt > ' . $rgt);\n$query = 'UPDATE `' . _PAD_ . '` SET lft = lft - ' . $width . ' WHERE lft > ' . _PAD_;\t\t//sink point: $width;\n$res = mysql_query($query);\n\n", "id": 290, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n$lft = $_GET['input1'];\n$rgt = $_GET['input2'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n\t   $width = ($rgt - $lft) + 1;\n\t   $this->sql('DELETE FROM `' . $table . '` WHERE lft BETWEEN ' . $lft . ' AND ' . $rgt);\n\t   $this->sql('UPDATE `' . $table . '` SET rgt = rgt - ' . $width . ' WHERE rgt > ' . $rgt);\n$query = 'UPDATE `' . _PAD_ . '` SET lft = lft - ' . _PAD_ . ' WHERE lft > ' . $rgt;\t\t//sink point: $rgt;\n$res = mysql_query($query);\n\n", "id": 291, "slice_label": "bad", "file_name": "D:\\bad_5278_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$query = \"SELECT * FROM session WHERE session_id = '\" . htmlentities($_GET['session'], ENT_QUOTES, \"UTF-8\") . \"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 292, "slice_label": "bad", "file_name": "D:\\bad_3816_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"id\"]) && isset($_GET[\"color\"])){\n$query = \"SELECT  * FROM `log_archive_host` WHERE host_id = \" . $_GET[\"id\"] . \" order by date_start desc\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 293, "slice_label": "bad", "file_name": "D:\\bad_3816_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]) {\n$query = \"SELECT user_id FROM session where session_id = '\".$_GET[\"sid\"].\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 294, "slice_label": "bad", "file_name": "D:\\bad_2179_9.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB \t= new CentreonDB();\n\t$is_admin = isUserAdmin($_GET[\"sid\"]);\n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]) {\n\t\t$DBRESULT = $pearDB->query(\"SELECT user_id FROM session where session_id = '\".$_GET[\"sid\"].\"'\");\n\t\t$session = $DBRESULT->fetchRow();\n\t\t$access = new CentreonAcl($session[\"user_id\"], $is_admin);\n}\n\t$normal_mode = 1;\n\t$type = \"root\";\n\tif (strlen($url_var) > 1) {\n\t\t$type = substr($url_var, 0, 2);\n}\n\tif ($normal_mode) {\n\t\tif ($type == \"HG\") {\n}\nelse if ($type == \"ST\") {\n}\nelse if ($type == \"HH\") {\n}\nelse if ($type == \"HS\") {\n}\nelse if ($type == \"HO\") {\n}\nelse if ($type == \"RS\") {\n}\nelse if ($type == \"RR\") {\n\t\t\tif ($search_host != \"\") {\n}\nelse {\n$query = \"SELECT * FROM meta_service \".$access->queryBuilder(\"WHERE\", \"meta_id\", _PAD_).\" ORDER BY `meta_name`\";\t\t//sink point: $access;\n$res = mysql_query($query);\n\t\t\t}\n}\n}\n\n", "id": 295, "slice_label": "bad", "file_name": "D:\\bad_2179_9.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB \t= new CentreonDB();\n\t$is_admin = isUserAdmin($_GET[\"sid\"]);\n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]) {\n\t\t$DBRESULT = $pearDB->query(\"SELECT user_id FROM session where session_id = '\".$_GET[\"sid\"].\"'\");\n\t\t$session = $DBRESULT->fetchRow();\n\t\t$access = new CentreonAcl($session[\"user_id\"], $is_admin);\n}\n\t$normal_mode = 1;\n\t$type = \"root\";\n\tif (strlen($url_var) > 1) {\n\t\t$type = substr($url_var, 0, 2);\n}\n\tif ($normal_mode) {\n\t\tif ($type == \"HG\") {\n}\nelse if ($type == \"ST\") {\n}\nelse if ($type == \"HH\") {\n}\nelse if ($type == \"HS\") {\n}\nelse if ($type == \"HO\") {\n}\nelse if ($type == \"RS\") {\n}\nelse if ($type == \"RR\") {\n\t\t\t$metaString = $access->getMetaServiceString();\n\t\t\tif ($metaString == \"\") {\n\t\t\t\t$metaString = \"''\";\n\t\t\t}\n\t\t\tif ($search_host != \"\") {\n}\nelse {\n$query = \"SELECT * FROM meta_service \"._PAD_->queryBuilder(\"WHERE\", \"meta_id\", $metaString).\" ORDER BY `meta_name`\";\t\t//sink point: $metaString;\n$res = mysql_query($query);\n\t\t\t}\n}\n}\n\n", "id": 296, "slice_label": "bad", "file_name": "D:\\bad_2179_9.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB \t= new CentreonDB();\n\t$is_admin = isUserAdmin($_GET[\"sid\"]);\n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]) {\n\t\t$DBRESULT = $pearDB->query(\"SELECT user_id FROM session where session_id = '\".$_GET[\"sid\"].\"'\");\n\t\t$session = $DBRESULT->fetchRow();\n\t\t$access = new CentreonAcl($session[\"user_id\"], $is_admin);\n}\n\t$normal_mode = 1;\n\tif ($normal_mode) {\n}\nelse {\n\t\tif ($search_host != \"\") {\n}\nelse {\n$query = \"SELECT hg_id, hg_name FROM hostgroup WHERE hg_id IN (SELECT hostgroup_hg_id FROM hostgroup_relation \".$access->queryBuilder(\"WHERE\", \"host_host_id\", _PAD_).\") ORDER BY `hg_name`\";\t\t//sink point: $access;\n$res = mysql_query($query);\n\t\t}\n}\n\n", "id": 297, "slice_label": "bad", "file_name": "D:\\bad_2179_9.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$oreon = $_SESSION[\"centreon\"];\n\t$pearDB \t= new CentreonDB();\n\t$pearDBO \t= new CentreonDB(\"centstorage\");\n\tif ($oreon->broker->getBroker() == \"ndo\") {\n\t\t$pearDBndo \t= new CentreonDB(\"ndo\");\n\t}\n\t$is_admin = isUserAdmin($_GET[\"sid\"]);\n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]) {\n\t\t$DBRESULT = $pearDB->query(\"SELECT user_id FROM session where session_id = '\".$_GET[\"sid\"].\"'\");\n\t\t$session = $DBRESULT->fetchRow();\n\t\t$access = new CentreonAcl($session[\"user_id\"], $is_admin);\n\t\t$hoststr = $access->getHostsString(\"ID\", ($oreon->broker->getBroker() == \"ndo\" ? $pearDBndo : $pearDBO));\n}\n\t$normal_mode = 1;\n\tif ($normal_mode) {\n}\nelse {\n\t\tif ($search_host != \"\") {\n}\nelse {\n$query = \"SELECT hg_id, hg_name FROM hostgroup WHERE hg_id IN (SELECT hostgroup_hg_id FROM hostgroup_relation \"._PAD_->queryBuilder(\"WHERE\", \"host_host_id\", $hoststr).\") ORDER BY `hg_name`\";\t\t//sink point: $hoststr;\n$res = mysql_query($query);\n\t\t}\n}\n\n", "id": 298, "slice_label": "bad", "file_name": "D:\\bad_2179_9.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB \t= new CentreonDB();\n\t$is_admin = isUserAdmin($_GET[\"sid\"]);\n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]) {\n\t\t$DBRESULT = $pearDB->query(\"SELECT user_id FROM session where session_id = '\".$_GET[\"sid\"].\"'\");\n\t\t$session = $DBRESULT->fetchRow();\n\t\t$access = new CentreonAcl($session[\"user_id\"], $is_admin);\n}\n\t$normal_mode = 1;\n\tif ($normal_mode) {\n}\nelse {\n\t\tif ($search_host != \"\") {\n}\nelse {\n$query = \"SELECT * FROM meta_service \".$access->queryBuilder(\"WHERE\", \"meta_id\", _PAD_).\" ORDER BY `meta_name`\";\t\t//sink point: $access;\n$res = mysql_query($query);\n\t\t}\n}\n\n", "id": 299, "slice_label": "bad", "file_name": "D:\\bad_2179_9.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB \t= new CentreonDB();\n\t$is_admin = isUserAdmin($_GET[\"sid\"]);\n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]) {\n\t\t$DBRESULT = $pearDB->query(\"SELECT user_id FROM session where session_id = '\".$_GET[\"sid\"].\"'\");\n\t\t$session = $DBRESULT->fetchRow();\n\t\t$access = new CentreonAcl($session[\"user_id\"], $is_admin);\n}\n\t$normal_mode = 1;\n\t$type = \"root\";\n\tif (strlen($url_var) > 1) {\n\t\t$type = substr($url_var, 0, 2);\n}\n\tif ($normal_mode) {\n\t\tif ($type == \"HG\") {\n}\nelse if ($type == \"ST\") {\n}\nelse if ($type == \"HH\") {\n}\nelse if ($type == \"HS\") {\n}\nelse if ($type == \"HO\") {\n}\nelse if ($type == \"RS\") {\n}\nelse if ($type == \"RR\") {\n\t\t\t$metaString = $access->getMetaServiceString();\n\t\t\tif ($metaString == \"\") {\n\t\t\t\t$metaString = \"''\";\n\t\t\t}\n}\n}\nelse {\n\t\t$metaString = $access->getMetaServiceString();\n\t\tif ($metaString == \"\") {\n\t\t\t$metaString = \"''\";\n\t\t}\n\t\tif ($search_host != \"\") {\n}\nelse {\n$query = \"SELECT * FROM meta_service \"._PAD_->queryBuilder(\"WHERE\", \"meta_id\", $metaString).\" ORDER BY `meta_name`\";\t\t//sink point: $metaString;\n$res = mysql_query($query);\n\t\t}\n}\n\n", "id": 300, "slice_label": "bad", "file_name": "D:\\bad_2179_9.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif(isset($_GET[\"domain\"]))\n{\n\t$domain = mysql_real_escape_string($_GET[\"domain\"]);\n}\n$query = \"SELECT * FROM url_referer WHERE referer_domains='\".$domain.\"'GROUP BY url_domains, referer_domains\";\t\t//sink point: $domain;\n$res = mysql_query($query);\n\n", "id": 301, "slice_label": "bad", "file_name": "D:\\good_2318_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif(isset($_GET[\"domain\"]))\n{\n\t$domain = mysql_real_escape_string($_GET[\"domain\"]);\n}\n$query = \"SELECT * FROM url_referer WHERE url_domains='\".$domain.\"'GROUP BY url_domains, referer_domains\";\t\t//sink point: $domain;\n$res = mysql_query($query);\n\n", "id": 302, "slice_label": "bad", "file_name": "D:\\good_2318_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$query = \"SELECT * FROM session WHERE session_id = '\" . htmlentities($_GET['session'], ENT_QUOTES, \"UTF-8\") . \"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 303, "slice_label": "bad", "file_name": "D:\\bad_3816_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$query = \"SELECT * FROM session WHERE session_id = '\" . htmlentities($_GET['session'], ENT_QUOTES, \"UTF-8\") . \"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 304, "slice_label": "bad", "file_name": "D:\\bad_3816_4.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"host_id\"]) && isset($_GET[\"id\"]) && isset($_GET[\"color\"])){\n$query = \"SELECT  * FROM `log_archive_service` WHERE host_id = '\".$_GET[\"host_id\"].\"' AND service_id = \".$_GET[\"id\"].\" ORDER BY `date_start` DESC\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 305, "slice_label": "bad", "file_name": "D:\\bad_3816_4.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=32;\n$tabfield=array();\n$tabfield[32]= \"code,label,range_account,category_type,formula,position,country\";\n$tabrowid=array();\n$tabrowid[32]= \"\";\nif (GETPOST('actionadd') || GETPOST('actionmodify'))\n{\n    $listfield=explode(',', str_replace(' ', '',$tabfield[$id]));\n    $ok=1;\n    foreach ($listfield as $f => $value)\n    {\n\t\tif (! isset($_POST[$value]) || $_POST[$value]=='')\n        {\n            $ok=0;\n}\n}\n    if (isset($_POST[\"code\"]))\n    {\n    \tif ($_POST[\"code\"]=='0')\n    \t{\n        \t$ok=0;\n}\n}\n    if (! is_numeric(GETPOST('position','alpha')))\n    {\n   \t\t$ok=0;\n}\n    if ($ok && GETPOST('actionadd','alpha'))\n    {\n        if ($tabrowid[$id])\n        {\n$query = \"SELECT max(\".$tabrowid[_PAD_].\") newid from \".$tabname[_PAD_];\t\t//sink point: $tabrowid;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 306, "slice_label": "bad", "file_name": "D:\\bad_684_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=32;\n$tabname=array();\n$tabname[32]= MAIN_DB_PREFIX.\"c_accounting_category\";\n$tabfield=array();\n$tabfield[32]= \"code,label,range_account,category_type,formula,position,country\";\n$tabrowid=array();\n$tabrowid[32]= \"\";\nif (GETPOST('actionadd') || GETPOST('actionmodify'))\n{\n    $listfield=explode(',', str_replace(' ', '',$tabfield[$id]));\n    $ok=1;\n    foreach ($listfield as $f => $value)\n    {\n\t\tif (! isset($_POST[$value]) || $_POST[$value]=='')\n        {\n            $ok=0;\n}\n}\n    if (isset($_POST[\"code\"]))\n    {\n    \tif ($_POST[\"code\"]=='0')\n    \t{\n        \t$ok=0;\n}\n}\n    if (! is_numeric(GETPOST('position','alpha')))\n    {\n   \t\t$ok=0;\n}\n    if ($ok && GETPOST('actionadd','alpha'))\n    {\n        if ($tabrowid[$id])\n        {\n$query = \"SELECT max(\"._PAD_.\") newid from \".$tabname[_PAD_];\t\t//sink point: $tabname;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 307, "slice_label": "bad", "file_name": "D:\\bad_684_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=32;\n$tabname=array();\n$tabname[32]= MAIN_DB_PREFIX.\"c_accounting_category\";\n$tabfield=array();\n$tabfield[32]= \"code,label,range_account,category_type,formula,position,country\";\nif (GETPOST('actionadd') || GETPOST('actionmodify'))\n{\n    $listfield=explode(',', str_replace(' ', '',$tabfield[$id]));\n    $ok=1;\n    foreach ($listfield as $f => $value)\n    {\n\t\tif (! isset($_POST[$value]) || $_POST[$value]=='')\n        {\n            $ok=0;\n}\n}\n    if (isset($_POST[\"code\"]))\n    {\n    \tif ($_POST[\"code\"]=='0')\n    \t{\n        \t$ok=0;\n}\n}\n    if (! is_numeric(GETPOST('position','alpha')))\n    {\n   \t\t$ok=0;\n}\n    if ($ok && GETPOST('actionadd','alpha'))\n    {\n$query = \"INSERT INTO \".$tabname[_PAD_].\" (\";\t\t//sink point: $tabname;\n$res = mysql_query($query);\n}\n}\n\n", "id": 308, "slice_label": "bad", "file_name": "D:\\bad_684_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=32;\n$tabname=array();\n$tabname[32]= MAIN_DB_PREFIX.\"c_accounting_category\";\n$tabfield=array();\n$tabfield[32]= \"code,label,range_account,category_type,formula,position,country\";\nif (GETPOST('actionadd') || GETPOST('actionmodify'))\n{\n    $listfield=explode(',', str_replace(' ', '',$tabfield[$id]));\n    $ok=1;\n    foreach ($listfield as $f => $value)\n    {\n\t\tif (! isset($_POST[$value]) || $_POST[$value]=='')\n        {\n            $ok=0;\n}\n}\n    if (isset($_POST[\"code\"]))\n    {\n    \tif ($_POST[\"code\"]=='0')\n    \t{\n        \t$ok=0;\n}\n}\n    if (! is_numeric(GETPOST('position','alpha')))\n    {\n   \t\t$ok=0;\n}\n    if ($ok && GETPOST('actionmodify'))\n    {\n$query = \"UPDATE \".$tabname[_PAD_].\" SET \";\t\t//sink point: $tabname;\n$res = mysql_query($query);\n}\n}\n\n", "id": 309, "slice_label": "bad", "file_name": "D:\\bad_684_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=GETPOST('id','int');\n$tabrowid=array();\n$tabrowid[35]= \"\";\nif (GETPOST('actionadd') || GETPOST('actionmodify'))\n{\n\t$ok=1;\n\tif (isset($_POST[\"code\"]))\n\t{\n\t\tif ($_POST[\"code\"]=='0')\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif (! GETPOST('label','alpha'))\n\t{\n\t\t$ok=0;\n\t}\n\tif ($ok && GETPOST('actionadd'))\n\t{\n\t\tif ($tabrowid[$id])\n\t\t{\n$query = \"SELECT max(\".$tabrowid[_PAD_].\") newid from \".$tabname[_PAD_];\t\t//sink point: $tabrowid;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 310, "slice_label": "bad", "file_name": "D:\\bad_684_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=GETPOST('id','int');\n$tabname=array();\n$tabname[35]= MAIN_DB_PREFIX.\"accounting_journal\";\n$tabrowid=array();\n$tabrowid[35]= \"\";\nif (GETPOST('actionadd') || GETPOST('actionmodify'))\n{\n\t$ok=1;\n\tif (isset($_POST[\"code\"]))\n\t{\n\t\tif ($_POST[\"code\"]=='0')\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif (! GETPOST('label','alpha'))\n\t{\n\t\t$ok=0;\n\t}\n\tif ($ok && GETPOST('actionadd'))\n\t{\n\t\tif ($tabrowid[$id])\n\t\t{\n$query = \"SELECT max(\"._PAD_.\") newid from \".$tabname[_PAD_];\t\t//sink point: $tabname;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 311, "slice_label": "bad", "file_name": "D:\\bad_684_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$tabname=array();\n$tabname[35]= MAIN_DB_PREFIX.\"accounting_journal\";\nif (GETPOST('actionadd') || GETPOST('actionmodify'))\n{\n\t$ok=1;\n\tif (isset($_POST[\"code\"]))\n\t{\n\t\tif ($_POST[\"code\"]=='0')\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif (! GETPOST('label','alpha'))\n\t{\n\t\t$ok=0;\n\t}\n\tif ($ok && GETPOST('actionadd'))\n\t{\n$query = \"INSERT INTO \".$tabname[_PAD_].\" (\";\t\t//sink point: $tabname;\n$res = mysql_query($query);\n}\n}\n\n", "id": 312, "slice_label": "bad", "file_name": "D:\\bad_684_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$tabname=array();\n$tabname[35]= MAIN_DB_PREFIX.\"accounting_journal\";\nif (GETPOST('actionadd') || GETPOST('actionmodify'))\n{\n\t$ok=1;\n\tif (isset($_POST[\"code\"]))\n\t{\n\t\tif ($_POST[\"code\"]=='0')\n\t\t{\n\t\t\t$ok=0;\n}\n}\n\tif (! GETPOST('label','alpha'))\n\t{\n\t\t$ok=0;\n\t}\n\tif ($ok && GETPOST('actionmodify'))\n\t{\n$query = \"UPDATE \".$tabname[_PAD_].\" SET \";\t\t//sink point: $tabname;\n$res = mysql_query($query);\n}\n}\n\n", "id": 313, "slice_label": "bad", "file_name": "D:\\bad_684_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$query = \"SELECT * FROM session WHERE session_id = '\" . htmlentities($_GET['session'], ENT_QUOTES, \"UTF-8\") . \"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 314, "slice_label": "bad", "file_name": "D:\\bad_3816_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$query = \"SELECT user_id FROM `session` WHERE session_id = '\".htmlentities(session_id(), ENT_QUOTES, \"UTF-8\").\"' AND user_id = '\".htmlentities($_GET['uid'], ENT_QUOTES, \"UTF-8\").\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 315, "slice_label": "bad", "file_name": "D:\\bad_3816_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=1;\n$tabfield=array();\n$tabfield[1] = \"ref,description,virtualhost\";\n$tabrowid=array();\n$tabrowid[1] = \"\";\nif (GETPOST('actionadd','alpha') || GETPOST('actionmodify','alpha'))\n{\n    $listfield=explode(',',$tabfield[$id]);\n    $ok=1;\n    foreach ($listfield as $f => $value)\n    {\n    \tif ($value == 'ref' && (! isset($_POST[$value]) || $_POST[$value]==''))\n\t    {\n    \t    $ok=0;\n}\nelse if ($value == 'ref' && ! preg_match('/^[a-z0-9_\\-\\.]+$/i', $_POST[$value]))\n\t    {\n\t\t\t$ok=0;\n}\n}\n    if ($ok && GETPOST('actionadd','alpha'))\n    {\n        if ($tabrowid[$id])\n        {\n$query = \"SELECT max(\".$tabrowid[_PAD_].\") newid from \".$tabname[_PAD_];\t\t//sink point: $tabrowid;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 316, "slice_label": "bad", "file_name": "D:\\good_684_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=1;\n$tabname=array();\n$tabname[1] = MAIN_DB_PREFIX.\"website\";\n$tabfield=array();\n$tabfield[1] = \"ref,description,virtualhost\";\n$tabrowid=array();\n$tabrowid[1] = \"\";\nif (GETPOST('actionadd','alpha') || GETPOST('actionmodify','alpha'))\n{\n    $listfield=explode(',',$tabfield[$id]);\n    $ok=1;\n    foreach ($listfield as $f => $value)\n    {\n    \tif ($value == 'ref' && (! isset($_POST[$value]) || $_POST[$value]==''))\n\t    {\n    \t    $ok=0;\n}\nelse if ($value == 'ref' && ! preg_match('/^[a-z0-9_\\-\\.]+$/i', $_POST[$value]))\n\t    {\n\t\t\t$ok=0;\n}\n}\n    if ($ok && GETPOST('actionadd','alpha'))\n    {\n        if ($tabrowid[$id])\n        {\n$query = \"SELECT max(\"._PAD_.\") newid from \".$tabname[_PAD_];\t\t//sink point: $tabname;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 317, "slice_label": "bad", "file_name": "D:\\good_684_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=1;\n$tabname=array();\n$tabname[1] = MAIN_DB_PREFIX.\"website\";\n$tabfield=array();\n$tabfield[1] = \"ref,description,virtualhost\";\nif (GETPOST('actionadd','alpha') || GETPOST('actionmodify','alpha'))\n{\n    $listfield=explode(',',$tabfield[$id]);\n    $ok=1;\n    foreach ($listfield as $f => $value)\n    {\n    \tif ($value == 'ref' && (! isset($_POST[$value]) || $_POST[$value]==''))\n\t    {\n    \t    $ok=0;\n}\nelse if ($value == 'ref' && ! preg_match('/^[a-z0-9_\\-\\.]+$/i', $_POST[$value]))\n\t    {\n\t\t\t$ok=0;\n}\n}\n    if ($ok && GETPOST('actionadd','alpha'))\n    {\n$query = \"INSERT INTO \".$tabname[_PAD_].\" (\";\t\t//sink point: $tabname;\n$res = mysql_query($query);\n}\n}\n\n", "id": 318, "slice_label": "bad", "file_name": "D:\\good_684_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=1;\n$tabname=array();\n$tabname[1] = MAIN_DB_PREFIX.\"website\";\n$tabfield=array();\n$tabfield[1] = \"ref,description,virtualhost\";\nif (GETPOST('actionadd','alpha') || GETPOST('actionmodify','alpha'))\n{\n    $listfield=explode(',',$tabfield[$id]);\n    $ok=1;\n    foreach ($listfield as $f => $value)\n    {\n    \tif ($value == 'ref' && (! isset($_POST[$value]) || $_POST[$value]==''))\n\t    {\n    \t    $ok=0;\n}\nelse if ($value == 'ref' && ! preg_match('/^[a-z0-9_\\-\\.]+$/i', $_POST[$value]))\n\t    {\n\t\t\t$ok=0;\n}\n}\n    if ($ok && GETPOST('actionmodify','alpha'))\n    {\n$query = \"UPDATE \".$tabname[_PAD_].\" SET \";\t\t//sink point: $tabname;\n$res = mysql_query($query);\n}\n}\n\n", "id": 319, "slice_label": "bad", "file_name": "D:\\good_684_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$action=GETPOST('action','alpha')?GETPOST('action','alpha'):'view';\n$confirm=GETPOST('confirm','alpha');\n$rowid=GETPOST('rowid','alpha');\n$id=1;\n$acts[0] = \"activate\";\n$acts[1] = \"disable\";\n$tabfield=array();\n$tabfield[1] = \"ref,description,virtualhost\";\nif (GETPOST('actionadd','alpha') || GETPOST('actionmodify','alpha'))\n{\n    $listfield=explode(',',$tabfield[$id]);\n    $ok=1;\n    foreach ($listfield as $f => $value)\n    {\n    \tif ($value == 'ref' && (! isset($_POST[$value]) || $_POST[$value]==''))\n\t    {\n    \t    $ok=0;\n}\nelse if ($value == 'ref' && ! preg_match('/^[a-z0-9_\\-\\.]+$/i', $_POST[$value]))\n\t    {\n\t\t\t$ok=0;\n}\n}\n    if ($ok && GETPOST('actionmodify','alpha'))\n    {\n        $db->begin();\n        $website=new Website($db);\n        $rowid=GETPOST('rowid','int');\n        $website->fetch($rowid);\n}\n}\nif ($action == 'confirm_delete' && $confirm == 'yes')       \n{\n    $website->fetch($rowid);\n}\nif ($action == $acts[0])\n{\n    if ($rowid) {\n$query = \"UPDATE \"._PAD_.\" SET status = 1 WHERE rowid ='\".$rowid.\"'\";\t\t//sink point: $rowid;\n$res = mysql_query($query);\n    }\n}\n\n", "id": 320, "slice_label": "bad", "file_name": "D:\\good_684_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$action=GETPOST('action','alpha')?GETPOST('action','alpha'):'view';\n$confirm=GETPOST('confirm','alpha');\n$rowid=GETPOST('rowid','alpha');\n$id=1;\n$acts[0] = \"activate\";\n$acts[1] = \"disable\";\n$tabname=array();\n$tabname[1] = MAIN_DB_PREFIX.\"website\";\n$tabfield=array();\n$tabfield[1] = \"ref,description,virtualhost\";\nif (GETPOST('actionadd','alpha') || GETPOST('actionmodify','alpha'))\n{\n    $listfield=explode(',',$tabfield[$id]);\n    $ok=1;\n    foreach ($listfield as $f => $value)\n    {\n    \tif ($value == 'ref' && (! isset($_POST[$value]) || $_POST[$value]==''))\n\t    {\n    \t    $ok=0;\n}\nelse if ($value == 'ref' && ! preg_match('/^[a-z0-9_\\-\\.]+$/i', $_POST[$value]))\n\t    {\n\t\t\t$ok=0;\n}\n}\n    if ($ok && GETPOST('actionmodify','alpha'))\n    {\n        $db->begin();\n        $website=new Website($db);\n        $rowid=GETPOST('rowid','int');\n        $website->fetch($rowid);\n}\n}\nif ($action == 'confirm_delete' && $confirm == 'yes')       \n{\n    $website->fetch($rowid);\n}\nif ($action == $acts[0])\n{\n    if ($rowid) {\n$query = \"UPDATE \".$tabname[_PAD_].\" SET status = 1 WHERE rowid ='\"._PAD_.\"'\";\t\t//sink point: $tabname;\n$res = mysql_query($query);\n    }\n}\n\n", "id": 321, "slice_label": "bad", "file_name": "D:\\good_684_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$action=GETPOST('action','alpha')?GETPOST('action','alpha'):'view';\n$confirm=GETPOST('confirm','alpha');\n$rowid=GETPOST('rowid','alpha');\n$id=1;\n$acts[0] = \"activate\";\n$acts[1] = \"disable\";\n$tabfield=array();\n$tabfield[1] = \"ref,description,virtualhost\";\nif (GETPOST('actionadd','alpha') || GETPOST('actionmodify','alpha'))\n{\n    $listfield=explode(',',$tabfield[$id]);\n    $ok=1;\n    foreach ($listfield as $f => $value)\n    {\n    \tif ($value == 'ref' && (! isset($_POST[$value]) || $_POST[$value]==''))\n\t    {\n    \t    $ok=0;\n}\nelse if ($value == 'ref' && ! preg_match('/^[a-z0-9_\\-\\.]+$/i', $_POST[$value]))\n\t    {\n\t\t\t$ok=0;\n}\n}\n    if ($ok && GETPOST('actionmodify','alpha'))\n    {\n        $db->begin();\n        $website=new Website($db);\n        $rowid=GETPOST('rowid','int');\n        $website->fetch($rowid);\n}\n}\nif ($action == 'confirm_delete' && $confirm == 'yes')       \n{\n    $website->fetch($rowid);\n}\nif ($action == $acts[1])\n{\n    if ($rowid) {\n$query = \"UPDATE \"._PAD_.\" SET status = 0 WHERE rowid ='\".$rowid.\"'\";\t\t//sink point: $rowid;\n$res = mysql_query($query);\n    }\n}\n\n", "id": 322, "slice_label": "bad", "file_name": "D:\\good_684_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$action=GETPOST('action','alpha')?GETPOST('action','alpha'):'view';\n$confirm=GETPOST('confirm','alpha');\n$rowid=GETPOST('rowid','alpha');\n$id=1;\n$acts[0] = \"activate\";\n$acts[1] = \"disable\";\n$tabname=array();\n$tabname[1] = MAIN_DB_PREFIX.\"website\";\n$tabfield=array();\n$tabfield[1] = \"ref,description,virtualhost\";\nif (GETPOST('actionadd','alpha') || GETPOST('actionmodify','alpha'))\n{\n    $listfield=explode(',',$tabfield[$id]);\n    $ok=1;\n    foreach ($listfield as $f => $value)\n    {\n    \tif ($value == 'ref' && (! isset($_POST[$value]) || $_POST[$value]==''))\n\t    {\n    \t    $ok=0;\n}\nelse if ($value == 'ref' && ! preg_match('/^[a-z0-9_\\-\\.]+$/i', $_POST[$value]))\n\t    {\n\t\t\t$ok=0;\n}\n}\n    if ($ok && GETPOST('actionmodify','alpha'))\n    {\n        $db->begin();\n        $website=new Website($db);\n        $rowid=GETPOST('rowid','int');\n        $website->fetch($rowid);\n}\n}\nif ($action == 'confirm_delete' && $confirm == 'yes')       \n{\n    $website->fetch($rowid);\n}\nif ($action == $acts[1])\n{\n    if ($rowid) {\n$query = \"UPDATE \".$tabname[_PAD_].\" SET status = 0 WHERE rowid ='\"._PAD_.\"'\";\t\t//sink point: $tabname;\n$res = mysql_query($query);\n    }\n}\n\n", "id": 323, "slice_label": "bad", "file_name": "D:\\good_684_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n  $action = (isset($HTTP_GET_VARS['action']) ? $HTTP_GET_VARS['action'] : '');\n  if ($action == 'list') {\n$query = \"select a.association_id, a.zone_country_id, c.countries_name, a.zone_id, a.geo_zone_id, a.last_modified, a.date_added, z.zone_name from \" . TABLE_ZONES_TO_GEO_ZONES . \" a left join \" . TABLE_COUNTRIES . \" c on a.zone_country_id = c.countries_id left join \" . TABLE_ZONES . \" z on a.zone_id = z.zone_id where a.geo_zone_id = \" . (int)$HTTP_GET_VARS['zID'] . \" order by association_id\";\t\t//sink point: $HTTP_GET_VARS;\n$res = mysql_query($query);\n}\n\n", "id": 324, "slice_label": "bad", "file_name": "D:\\good_2048_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n  $action = (isset($HTTP_GET_VARS['action']) ? $HTTP_GET_VARS['action'] : '');\n  if ($action == 'list') {\n    $zones_query_raw = \"select a.association_id, a.zone_country_id, c.countries_name, a.zone_id, a.geo_zone_id, a.last_modified, a.date_added, z.zone_name from \" . TABLE_ZONES_TO_GEO_ZONES . \" a left join \" . TABLE_COUNTRIES . \" c on a.zone_country_id = c.countries_id left join \" . TABLE_ZONES . \" z on a.zone_id = z.zone_id where a.geo_zone_id = \" . (int)$HTTP_GET_VARS['zID'] . \" order by association_id\";\n    $zones_query = tep_db_query($zones_query_raw);\n}\nelse {\n    $zones_query = tep_db_query($zones_query_raw);\n    while ($zones = tep_db_fetch_array($zones_query)) {\n      if ((!isset($HTTP_GET_VARS['zID']) || (isset($HTTP_GET_VARS['zID']) && ($HTTP_GET_VARS['zID'] == $zones['geo_zone_id']))) && !isset($zInfo) && (substr($action, 0, 3) != 'new')) {\n$query = \"select count(*) as num_zones from \" . TABLE_ZONES_TO_GEO_ZONES . \" where geo_zone_id = '\" . (int)$zones['geo_zone_id'] . \"' group by geo_zone_id\";\t\t//sink point: $zones;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 325, "slice_label": "bad", "file_name": "D:\\good_2048_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$edates = $_GET['input0'];\n\n// php code: \n        foreach ($edates as $edate) {\n$query = 'SELECT DISTINCT p.*, er.event_starttime, er.signup_cutoff FROM ' . $db->prefix . 'product p ';\t\t//sink point: $db;\n$res = mysql_query($query);\n}\n\n", "id": 326, "slice_label": "bad", "file_name": "D:\\good_5326_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n\n// php code: \n        if (isset($_FILES['modelaliases']['tmp_name'])) {\n            $file = new stdClass();\n            $file->path = $_FILES['modelaliases']['tmp_name'];\n            $handle = fopen($file->path, \"r\");\n            $data = fgetcsv($handle, 10000, \",\");\n            $db->delete('model_aliases_tmp');\n            while (($data = fgetcsv($handle, 10000, \",\")) !== FALSE) {\n                $tmp = new stdClass();\n                $tmp->field1 = expString::onlyReadables($data[0]);\n                $tmp->field2 = expString::onlyReadables($data[1]);\n                $db->insertObject($tmp, 'model_aliases_tmp');\n            }\n}\n$query = \"SELECT * FROM \".$db->prefix.\"model_aliases_tmp WHERE is_processed = 0\";\t\t//sink point: $db;\n$res = mysql_query($query);\n\n", "id": 327, "slice_label": "bad", "file_name": "D:\\good_5326_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$query = \"SELECT user_id FROM `session` WHERE session_id = '\".htmlentities($_GET[\"sid\"], ENT_QUOTES, \"UTF-8\").\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 328, "slice_label": "bad", "file_name": "D:\\bad_3816_7.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$query = \"SELECT css_name FROM `css_color_menu` WHERE menu_nb = '\".htmlentities($_GET[\"menu\"], ENT_QUOTES, \"UTF-8\").\"' LIMIT 1\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 329, "slice_label": "bad", "file_name": "D:\\bad_3816_7.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif(isset($_GET[\"domain\"]))\n{\n\t$domain = $_GET[\"domain\"];\n}\n$query = \"SELECT * FROM url_referer WHERE referer_domains='\".$domain.\"'GROUP BY url_domains, referer_domains\";\t\t//sink point: $domain;\n$res = mysql_query($query);\n\n", "id": 330, "slice_label": "bad", "file_name": "D:\\bad_2318_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif(isset($_GET[\"domain\"]))\n{\n\t$domain = $_GET[\"domain\"];\n}\n$query = \"SELECT * FROM url_referer WHERE url_domains='\".$domain.\"'GROUP BY url_domains, referer_domains\";\t\t//sink point: $domain;\n$res = mysql_query($query);\n\n", "id": 331, "slice_label": "bad", "file_name": "D:\\bad_2318_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=sanitize($_REQUEST['id'], 3);\r\n$idTemp=base64_decode($id);\r\n$username=sanitize($idTemp ,3);\r\n$query = \"SELECT * FROM `\" . table_users . \"` where `user_login` = '\".$username.\"' AND `last_reset_request` = FROM_UNIXTIME('\"._PAD_.\"') AND user_level!='Spammer'\";\t\t//sink point: $username;\n$res = mysql_query($query);\n\n", "id": 332, "slice_label": "bad", "file_name": "D:\\good_2349_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$n=sanitize($_REQUEST['n'], 3);\r\n$query = \"SELECT * FROM `\" . table_users . \"` where `user_login` = '\"._PAD_.\"' AND `last_reset_request` = FROM_UNIXTIME('\".$n.\"') AND user_level!='Spammer'\";\t\t//sink point: $n;\n$res = mysql_query($query);\n\n", "id": 333, "slice_label": "bad", "file_name": "D:\\good_2349_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$main_smarty = new Smarty;\r\n$navwhere['text1'] = $main_smarty->get_config_vars('PLIGG_Visual_Breadcrumb_Recover_Password');\r\n$navwhere['link1'] = getmyurl('loginNoVar', '');\r\n$main_smarty->assign('navbar_where', $navwhere);\r\n$main_smarty->assign('posttitle', $main_smarty->get_config_vars('PLIGG_Visual_Breadcrumb_Recover_Password'));\r\n$main_smarty = do_sidebar($main_smarty);\r\n$id=sanitize($_REQUEST['id'], 3);\r\n$n=sanitize($_REQUEST['n'], 3);\r\n$idTemp=base64_decode($id);\r\n$username=sanitize($idTemp ,3);\r\n$sql=\"SELECT * FROM `\" . table_users . \"` where `user_login` = '\".$username.\"' AND `last_reset_request` = FROM_UNIXTIME('\".$n.\"') AND user_level!='Spammer'\";\r\n$user = $db->get_row($sql);\r\nif($user){\n\tif( (isset($_POST[\"processrecover\"]) && is_numeric($_POST[\"processrecover\"]))){\n\t\tif($_POST[\"processrecover\"]==1){\n\t\t\t$error=false;\r\n\t\t\t$password = sanitize($_POST[\"reg_password\"], 3);\r\n\t\t\t$password2 = sanitize($_POST[\"reg_password2\"], 3);\r\n\t\t\tif(strlen($password) < 5 ) {\n\t\t\t\t$error = true;\r\n\t\t\t}\n\t\t\tif($password !== $password2) {\n\t\t\t\t$error = true;\r\n\t\t\t}\n\t\t\tif($error==false){\n\t\t\t\t$to = $user->user_email;\r\n\t\t\t\t$subject = $main_smarty->get_config_vars(\"PLIGG_Visual_Name\").' '.$main_smarty->get_config_vars(\"PLIGG_PassEmail_Subject\");\r\n\t\t\t\t$body = sprintf(\r\n\t\t\t\t\t$main_smarty->get_config_vars(\"PLIGG_PassEmail_PassBody\"),\r\n\t\t\t\t\t$main_smarty->get_config_vars(\"PLIGG_Visual_Name\"),\r\n\t\t\t\t\t$my_base_url . $my_pligg_base . '/login.php',\r\n\t\t\t\t\t$user->user_login,\r\n\t\t\t\t\t$password\r\n\t\t\t\t);\r\n\t\t\t\t$headers = 'From: ' . $main_smarty->get_config_vars(\"PLIGG_PassEmail_From\") . \"\\r\\n\";\r\n\t\t\t\t$headers .= \"Content-type: text/html; charset=utf-8\\r\\n\";\r\n\t\t\t\tif (mail($to, $subject, $body, $headers))\r\n\t\t\t\t{\n\t\t\t\t\t$saltedPass = generateHash($password);\r\n$query = 'UPDATE `' . table_users . \"` SET `user_pass` = '$saltedPass' WHERE `user_login` = '\"._PAD_->user_login.\"'\";\t\t//sink point: $saltedPass;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n\n", "id": 334, "slice_label": "bad", "file_name": "D:\\good_2349_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$main_smarty = new Smarty;\r\n$navwhere['text1'] = $main_smarty->get_config_vars('PLIGG_Visual_Breadcrumb_Recover_Password');\r\n$navwhere['link1'] = getmyurl('loginNoVar', '');\r\n$main_smarty->assign('navbar_where', $navwhere);\r\n$main_smarty->assign('posttitle', $main_smarty->get_config_vars('PLIGG_Visual_Breadcrumb_Recover_Password'));\r\n$main_smarty = do_sidebar($main_smarty);\r\n$id=sanitize($_REQUEST['id'], 3);\r\n$n=sanitize($_REQUEST['n'], 3);\r\n$idTemp=base64_decode($id);\r\n$username=sanitize($idTemp ,3);\r\n$sql=\"SELECT * FROM `\" . table_users . \"` where `user_login` = '\".$username.\"' AND `last_reset_request` = FROM_UNIXTIME('\".$n.\"') AND user_level!='Spammer'\";\r\n$user = $db->get_row($sql);\r\nif($user){\n\tif( (isset($_POST[\"processrecover\"]) && is_numeric($_POST[\"processrecover\"]))){\n\t\tif($_POST[\"processrecover\"]==1){\n\t\t\t$error=false;\r\n\t\t\t$password = sanitize($_POST[\"reg_password\"], 3);\r\n\t\t\t$password2 = sanitize($_POST[\"reg_password2\"], 3);\r\n\t\t\tif(strlen($password) < 5 ) {\n\t\t\t\t$error = true;\r\n\t\t\t}\n\t\t\tif($password !== $password2) {\n\t\t\t\t$error = true;\r\n\t\t\t}\n\t\t\tif($error==false){\n\t\t\t\t$to = $user->user_email;\r\n\t\t\t\t$subject = $main_smarty->get_config_vars(\"PLIGG_Visual_Name\").' '.$main_smarty->get_config_vars(\"PLIGG_PassEmail_Subject\");\r\n\t\t\t\t$body = sprintf(\r\n\t\t\t\t\t$main_smarty->get_config_vars(\"PLIGG_PassEmail_PassBody\"),\r\n\t\t\t\t\t$main_smarty->get_config_vars(\"PLIGG_Visual_Name\"),\r\n\t\t\t\t\t$my_base_url . $my_pligg_base . '/login.php',\r\n\t\t\t\t\t$user->user_login,\r\n\t\t\t\t\t$password\r\n\t\t\t\t);\r\n\t\t\t\t$headers = 'From: ' . $main_smarty->get_config_vars(\"PLIGG_PassEmail_From\") . \"\\r\\n\";\r\n\t\t\t\t$headers .= \"Content-type: text/html; charset=utf-8\\r\\n\";\r\n\t\t\t\tif (mail($to, $subject, $body, $headers))\r\n\t\t\t\t{\n$query = 'UPDATE `' . table_users . \"` SET `user_pass` = '_PAD_' WHERE `user_login` = '\".$user->user_login.\"'\";\t\t//sink point: $user;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n\n", "id": 335, "slice_label": "bad", "file_name": "D:\\good_2349_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$columns = $_GET['input0'];\n\n// php code: \n\t\t$map = [];\n\t\t$stack = [];\n\t\tforeach ($columns as $column => $replacements)\n\t\t{\n\t\t\tif (is_array($replacements))\n\t\t\t{\n\t\t\t\tforeach ($replacements as $old => $new)\n\t\t\t\t{\n\t\t\t\t\t$map_key = $this->mapKey();\n\t\t\t\t\t$stack[] = $this->columnQuote($column) . ' = REPLACE(' . $this->columnQuote($column) . ', ' . $map_key . 'a, ' . $map_key . 'b)';\n\t\t\t\t\t$map[ $map_key . 'a' ] = [$old, PDO::PARAM_STR];\n\t\t\t\t\t$map[ $map_key . 'b' ] = [$new, PDO::PARAM_STR];\n\t\t\t\t}\n}\n}\n\t\tif (!empty($stack))\n\t\t{\n$query = 'UPDATE ' . _PAD_->tableQuote(_PAD_) . ' SET ' . implode(', ', _PAD_) . _PAD_->whereClause(_PAD_, $map), $map;\t\t//sink point: $map;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 336, "slice_label": "bad", "file_name": "D:\\good_771_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$columns = $_GET['input0'];\n\n// php code: \n\t\t$stack = [];\n\t\tforeach ($columns as $column => $replacements)\n\t\t{\n\t\t\tif (is_array($replacements))\n\t\t\t{\n\t\t\t\tforeach ($replacements as $old => $new)\n\t\t\t\t{\n\t\t\t\t\t$map_key = $this->mapKey();\n\t\t\t\t\t$stack[] = $this->columnQuote($column) . ' = REPLACE(' . $this->columnQuote($column) . ', ' . $map_key . 'a, ' . $map_key . 'b)';\n}\n}\n}\n\t\tif (!empty($stack))\n\t\t{\n$query = 'UPDATE ' . $this->tableQuote(_PAD_) . ' SET ' . implode(', ', _PAD_) . $this->whereClause(_PAD_, _PAD_), _PAD_;\t\t//sink point: $this;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 337, "slice_label": "bad", "file_name": "D:\\good_771_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n$columns = $_GET['input1'];\n\n// php code: \n\t\t$stack = [];\n\t\tforeach ($columns as $column => $replacements)\n\t\t{\n\t\t\tif (is_array($replacements))\n\t\t\t{\n\t\t\t\tforeach ($replacements as $old => $new)\n\t\t\t\t{\n\t\t\t\t\t$map_key = $this->mapKey();\n\t\t\t\t\t$stack[] = $this->columnQuote($column) . ' = REPLACE(' . $this->columnQuote($column) . ', ' . $map_key . 'a, ' . $map_key . 'b)';\n}\n}\n}\n\t\tif (!empty($stack))\n\t\t{\n$query = 'UPDATE ' . _PAD_->tableQuote($table) . ' SET ' . implode(', ', _PAD_) . _PAD_->whereClause(_PAD_, _PAD_), _PAD_;\t\t//sink point: $table;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 338, "slice_label": "bad", "file_name": "D:\\good_771_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$columns = $_GET['input0'];\n$where = $_GET['input1'];\n\n// php code: \n\t\t$stack = [];\n\t\tforeach ($columns as $column => $replacements)\n\t\t{\n\t\t\tif (is_array($replacements))\n\t\t\t{\n\t\t\t\tforeach ($replacements as $old => $new)\n\t\t\t\t{\n\t\t\t\t\t$map_key = $this->mapKey();\n\t\t\t\t\t$stack[] = $this->columnQuote($column) . ' = REPLACE(' . $this->columnQuote($column) . ', ' . $map_key . 'a, ' . $map_key . 'b)';\n}\n}\n}\n\t\tif (!empty($stack))\n\t\t{\n$query = 'UPDATE ' . _PAD_->tableQuote(_PAD_) . ' SET ' . implode(', ', _PAD_) . _PAD_->whereClause($where, _PAD_), _PAD_;\t\t//sink point: $where;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 339, "slice_label": "bad", "file_name": "D:\\good_771_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$columns = $_GET['input0'];\n\n// php code: \n\t\t$stack = [];\n\t\tforeach ($columns as $column => $replacements)\n\t\t{\n\t\t\tif (is_array($replacements))\n\t\t\t{\n\t\t\t\tforeach ($replacements as $old => $new)\n\t\t\t\t{\n\t\t\t\t\t$map_key = $this->mapKey();\n\t\t\t\t\t$stack[] = $this->columnQuote($column) . ' = REPLACE(' . $this->columnQuote($column) . ', ' . $map_key . 'a, ' . $map_key . 'b)';\n}\n}\n}\n\t\tif (!empty($stack))\n\t\t{\n$query = 'UPDATE ' . _PAD_->tableQuote(_PAD_) . ' SET ' . implode(', ', $stack) . _PAD_->whereClause(_PAD_, _PAD_), _PAD_;\t\t//sink point: $stack;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 340, "slice_label": "bad", "file_name": "D:\\good_771_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=1;\n$tabfield=array();\n$tabfield[1] = \"ref,description,virtualhost\";\n$tabrowid=array();\n$tabrowid[1] = \"\";\nif (GETPOST('actionadd','alpha') || GETPOST('actionmodify','alpha'))\n{\n    $listfield=explode(',',$tabfield[$id]);\n    $ok=1;\n    foreach ($listfield as $f => $value)\n    {\n    \tif ($value == 'ref' && (! isset($_POST[$value]) || $_POST[$value]==''))\n\t    {\n    \t    $ok=0;\n}\nelse if ($value == 'ref' && ! preg_match('/^[a-z0-9_\\-\\.]+$/i', $_POST[$value]))\n\t    {\n\t\t\t$ok=0;\n}\n}\n    if ($ok && GETPOST('actionadd','alpha'))\n    {\n        if ($tabrowid[$id])\n        {\n$query = \"SELECT max(\".$tabrowid[_PAD_].\") newid from \".$tabname[_PAD_];\t\t//sink point: $tabrowid;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 341, "slice_label": "bad", "file_name": "D:\\bad_684_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=1;\n$tabname=array();\n$tabname[1] = MAIN_DB_PREFIX.\"website\";\n$tabfield=array();\n$tabfield[1] = \"ref,description,virtualhost\";\n$tabrowid=array();\n$tabrowid[1] = \"\";\nif (GETPOST('actionadd','alpha') || GETPOST('actionmodify','alpha'))\n{\n    $listfield=explode(',',$tabfield[$id]);\n    $ok=1;\n    foreach ($listfield as $f => $value)\n    {\n    \tif ($value == 'ref' && (! isset($_POST[$value]) || $_POST[$value]==''))\n\t    {\n    \t    $ok=0;\n}\nelse if ($value == 'ref' && ! preg_match('/^[a-z0-9_\\-\\.]+$/i', $_POST[$value]))\n\t    {\n\t\t\t$ok=0;\n}\n}\n    if ($ok && GETPOST('actionadd','alpha'))\n    {\n        if ($tabrowid[$id])\n        {\n$query = \"SELECT max(\"._PAD_.\") newid from \".$tabname[_PAD_];\t\t//sink point: $tabname;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 342, "slice_label": "bad", "file_name": "D:\\bad_684_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=1;\n$tabname=array();\n$tabname[1] = MAIN_DB_PREFIX.\"website\";\n$tabfield=array();\n$tabfield[1] = \"ref,description,virtualhost\";\nif (GETPOST('actionadd','alpha') || GETPOST('actionmodify','alpha'))\n{\n    $listfield=explode(',',$tabfield[$id]);\n    $ok=1;\n    foreach ($listfield as $f => $value)\n    {\n    \tif ($value == 'ref' && (! isset($_POST[$value]) || $_POST[$value]==''))\n\t    {\n    \t    $ok=0;\n}\nelse if ($value == 'ref' && ! preg_match('/^[a-z0-9_\\-\\.]+$/i', $_POST[$value]))\n\t    {\n\t\t\t$ok=0;\n}\n}\n    if ($ok && GETPOST('actionadd','alpha'))\n    {\n$query = \"INSERT INTO \".$tabname[_PAD_].\" (\";\t\t//sink point: $tabname;\n$res = mysql_query($query);\n}\n}\n\n", "id": 343, "slice_label": "bad", "file_name": "D:\\bad_684_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=1;\n$tabname=array();\n$tabname[1] = MAIN_DB_PREFIX.\"website\";\n$tabfield=array();\n$tabfield[1] = \"ref,description,virtualhost\";\nif (GETPOST('actionadd','alpha') || GETPOST('actionmodify','alpha'))\n{\n    $listfield=explode(',',$tabfield[$id]);\n    $ok=1;\n    foreach ($listfield as $f => $value)\n    {\n    \tif ($value == 'ref' && (! isset($_POST[$value]) || $_POST[$value]==''))\n\t    {\n    \t    $ok=0;\n}\nelse if ($value == 'ref' && ! preg_match('/^[a-z0-9_\\-\\.]+$/i', $_POST[$value]))\n\t    {\n\t\t\t$ok=0;\n}\n}\n    if ($ok && GETPOST('actionmodify','alpha'))\n    {\n$query = \"UPDATE \".$tabname[_PAD_].\" SET \";\t\t//sink point: $tabname;\n$res = mysql_query($query);\n}\n}\n\n", "id": 344, "slice_label": "bad", "file_name": "D:\\bad_684_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$action=GETPOST('action','alpha')?GETPOST('action','alpha'):'view';\n$confirm=GETPOST('confirm','alpha');\n$rowid=GETPOST('rowid','alpha');\n$id=1;\n$acts[0] = \"activate\";\n$acts[1] = \"disable\";\n$tabfield=array();\n$tabfield[1] = \"ref,description,virtualhost\";\nif (GETPOST('actionadd','alpha') || GETPOST('actionmodify','alpha'))\n{\n    $listfield=explode(',',$tabfield[$id]);\n    $ok=1;\n    foreach ($listfield as $f => $value)\n    {\n    \tif ($value == 'ref' && (! isset($_POST[$value]) || $_POST[$value]==''))\n\t    {\n    \t    $ok=0;\n}\nelse if ($value == 'ref' && ! preg_match('/^[a-z0-9_\\-\\.]+$/i', $_POST[$value]))\n\t    {\n\t\t\t$ok=0;\n}\n}\n    if ($ok && GETPOST('actionmodify','alpha'))\n    {\n        $db->begin();\n        $website=new Website($db);\n        $rowid=GETPOST('rowid','int');\n        $website->fetch($rowid);\n}\n}\nif ($action == 'confirm_delete' && $confirm == 'yes')       \n{\n    $website->fetch($rowid);\n}\nif ($action == $acts[0])\n{\n    if ($rowid) {\n$query = \"UPDATE \"._PAD_.\" SET status = 1 WHERE rowid ='\".$rowid.\"'\";\t\t//sink point: $rowid;\n$res = mysql_query($query);\n    }\n}\n\n", "id": 345, "slice_label": "bad", "file_name": "D:\\bad_684_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$action=GETPOST('action','alpha')?GETPOST('action','alpha'):'view';\n$confirm=GETPOST('confirm','alpha');\n$rowid=GETPOST('rowid','alpha');\n$id=1;\n$acts[0] = \"activate\";\n$acts[1] = \"disable\";\n$tabname=array();\n$tabname[1] = MAIN_DB_PREFIX.\"website\";\n$tabfield=array();\n$tabfield[1] = \"ref,description,virtualhost\";\nif (GETPOST('actionadd','alpha') || GETPOST('actionmodify','alpha'))\n{\n    $listfield=explode(',',$tabfield[$id]);\n    $ok=1;\n    foreach ($listfield as $f => $value)\n    {\n    \tif ($value == 'ref' && (! isset($_POST[$value]) || $_POST[$value]==''))\n\t    {\n    \t    $ok=0;\n}\nelse if ($value == 'ref' && ! preg_match('/^[a-z0-9_\\-\\.]+$/i', $_POST[$value]))\n\t    {\n\t\t\t$ok=0;\n}\n}\n    if ($ok && GETPOST('actionmodify','alpha'))\n    {\n        $db->begin();\n        $website=new Website($db);\n        $rowid=GETPOST('rowid','int');\n        $website->fetch($rowid);\n}\n}\nif ($action == 'confirm_delete' && $confirm == 'yes')       \n{\n    $website->fetch($rowid);\n}\nif ($action == $acts[0])\n{\n    if ($rowid) {\n$query = \"UPDATE \".$tabname[_PAD_].\" SET status = 1 WHERE rowid ='\"._PAD_.\"'\";\t\t//sink point: $tabname;\n$res = mysql_query($query);\n    }\n}\n\n", "id": 346, "slice_label": "bad", "file_name": "D:\\bad_684_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$action=GETPOST('action','alpha')?GETPOST('action','alpha'):'view';\n$confirm=GETPOST('confirm','alpha');\n$rowid=GETPOST('rowid','alpha');\n$id=1;\n$acts[0] = \"activate\";\n$acts[1] = \"disable\";\n$tabfield=array();\n$tabfield[1] = \"ref,description,virtualhost\";\nif (GETPOST('actionadd','alpha') || GETPOST('actionmodify','alpha'))\n{\n    $listfield=explode(',',$tabfield[$id]);\n    $ok=1;\n    foreach ($listfield as $f => $value)\n    {\n    \tif ($value == 'ref' && (! isset($_POST[$value]) || $_POST[$value]==''))\n\t    {\n    \t    $ok=0;\n}\nelse if ($value == 'ref' && ! preg_match('/^[a-z0-9_\\-\\.]+$/i', $_POST[$value]))\n\t    {\n\t\t\t$ok=0;\n}\n}\n    if ($ok && GETPOST('actionmodify','alpha'))\n    {\n        $db->begin();\n        $website=new Website($db);\n        $rowid=GETPOST('rowid','int');\n        $website->fetch($rowid);\n}\n}\nif ($action == 'confirm_delete' && $confirm == 'yes')       \n{\n    $website->fetch($rowid);\n}\nif ($action == $acts[1])\n{\n    if ($rowid) {\n$query = \"UPDATE \"._PAD_.\" SET status = 0 WHERE rowid ='\".$rowid.\"'\";\t\t//sink point: $rowid;\n$res = mysql_query($query);\n    }\n}\n\n", "id": 347, "slice_label": "bad", "file_name": "D:\\bad_684_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$action=GETPOST('action','alpha')?GETPOST('action','alpha'):'view';\n$confirm=GETPOST('confirm','alpha');\n$rowid=GETPOST('rowid','alpha');\n$id=1;\n$acts[0] = \"activate\";\n$acts[1] = \"disable\";\n$tabname=array();\n$tabname[1] = MAIN_DB_PREFIX.\"website\";\n$tabfield=array();\n$tabfield[1] = \"ref,description,virtualhost\";\nif (GETPOST('actionadd','alpha') || GETPOST('actionmodify','alpha'))\n{\n    $listfield=explode(',',$tabfield[$id]);\n    $ok=1;\n    foreach ($listfield as $f => $value)\n    {\n    \tif ($value == 'ref' && (! isset($_POST[$value]) || $_POST[$value]==''))\n\t    {\n    \t    $ok=0;\n}\nelse if ($value == 'ref' && ! preg_match('/^[a-z0-9_\\-\\.]+$/i', $_POST[$value]))\n\t    {\n\t\t\t$ok=0;\n}\n}\n    if ($ok && GETPOST('actionmodify','alpha'))\n    {\n        $db->begin();\n        $website=new Website($db);\n        $rowid=GETPOST('rowid','int');\n        $website->fetch($rowid);\n}\n}\nif ($action == 'confirm_delete' && $confirm == 'yes')       \n{\n    $website->fetch($rowid);\n}\nif ($action == $acts[1])\n{\n    if ($rowid) {\n$query = \"UPDATE \".$tabname[_PAD_].\" SET status = 0 WHERE rowid ='\"._PAD_.\"'\";\t\t//sink point: $tabname;\n$res = mysql_query($query);\n    }\n}\n\n", "id": 348, "slice_label": "bad", "file_name": "D:\\bad_684_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=sanitize($_REQUEST['id'], 3);\r\n$username=base64_decode($id);\r\n$query = \"SELECT * FROM `\" . table_users . \"` where `user_login` = '\".$username.\"' AND `last_reset_request` = FROM_UNIXTIME('\"._PAD_.\"') AND user_level!='Spammer'\";\t\t//sink point: $username;\n$res = mysql_query($query);\n\n", "id": 349, "slice_label": "bad", "file_name": "D:\\good_2350_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$n=sanitize($_REQUEST['n'], 3);\r\n$query = \"SELECT * FROM `\" . table_users . \"` where `user_login` = '\"._PAD_.\"' AND `last_reset_request` = FROM_UNIXTIME('\".$n.\"') AND user_level!='Spammer'\";\t\t//sink point: $n;\n$res = mysql_query($query);\n\n", "id": 350, "slice_label": "bad", "file_name": "D:\\good_2350_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$main_smarty = new Smarty;\r\n$navwhere['text1'] = $main_smarty->get_config_vars('PLIGG_Visual_Breadcrumb_Recover_Password');\r\n$navwhere['link1'] = getmyurl('loginNoVar', '');\r\n$main_smarty->assign('navbar_where', $navwhere);\r\n$main_smarty->assign('posttitle', $main_smarty->get_config_vars('PLIGG_Visual_Breadcrumb_Recover_Password'));\r\n$main_smarty = do_sidebar($main_smarty);\r\n$id=sanitize($_REQUEST['id'], 3);\r\n$n=sanitize($_REQUEST['n'], 3);\r\n$username=base64_decode($id);\r\n$sql=\"SELECT * FROM `\" . table_users . \"` where `user_login` = '\".$username.\"' AND `last_reset_request` = FROM_UNIXTIME('\".$n.\"') AND user_level!='Spammer'\";\r\n$user = $db->get_row($sql);\r\nif($user){\n\tif( (isset($_POST[\"processrecover\"]) && is_numeric($_POST[\"processrecover\"]))){\n\t\tif($_POST[\"processrecover\"]==1){\n\t\t\t$error=false;\r\n\t\t\t$password = sanitize($_POST[\"reg_password\"], 3);\r\n\t\t\t$password2 = sanitize($_POST[\"reg_password2\"], 3);\r\n\t\t\tif(strlen($password) < 5 ) {\n\t\t\t\t$error = true;\r\n\t\t\t}\n\t\t\tif($password !== $password2) {\n\t\t\t\t$error = true;\r\n\t\t\t}\n\t\t\tif($error==false){\n\t\t\t\t$to = $user->user_email;\r\n\t\t\t\t$subject = $main_smarty->get_config_vars(\"PLIGG_Visual_Name\").' '.$main_smarty->get_config_vars(\"PLIGG_PassEmail_Subject\");\r\n\t\t\t\t$body = sprintf(\r\n\t\t\t\t\t$main_smarty->get_config_vars(\"PLIGG_PassEmail_PassBody\"),\r\n\t\t\t\t\t$main_smarty->get_config_vars(\"PLIGG_Visual_Name\"),\r\n\t\t\t\t\t$my_base_url . $my_pligg_base . '/login.php',\r\n\t\t\t\t\t$user->user_login,\r\n\t\t\t\t\t$password\r\n\t\t\t\t);\r\n\t\t\t\t$headers = 'From: ' . $main_smarty->get_config_vars(\"PLIGG_PassEmail_From\") . \"\\r\\n\";\r\n\t\t\t\t$headers .= \"Content-type: text/html; charset=utf-8\\r\\n\";\r\n\t\t\t\tif (mail($to, $subject, $body, $headers))\r\n\t\t\t\t{\n\t\t\t\t\t$saltedPass = generateHash($password);\r\n$query = 'UPDATE `' . table_users . \"` SET `user_pass` = '$saltedPass' WHERE `user_login` = '\"._PAD_->user_login.\"'\";\t\t//sink point: $saltedPass;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n\n", "id": 351, "slice_label": "bad", "file_name": "D:\\good_2350_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$main_smarty = new Smarty;\r\n$navwhere['text1'] = $main_smarty->get_config_vars('PLIGG_Visual_Breadcrumb_Recover_Password');\r\n$navwhere['link1'] = getmyurl('loginNoVar', '');\r\n$main_smarty->assign('navbar_where', $navwhere);\r\n$main_smarty->assign('posttitle', $main_smarty->get_config_vars('PLIGG_Visual_Breadcrumb_Recover_Password'));\r\n$main_smarty = do_sidebar($main_smarty);\r\n$id=sanitize($_REQUEST['id'], 3);\r\n$n=sanitize($_REQUEST['n'], 3);\r\n$username=base64_decode($id);\r\n$sql=\"SELECT * FROM `\" . table_users . \"` where `user_login` = '\".$username.\"' AND `last_reset_request` = FROM_UNIXTIME('\".$n.\"') AND user_level!='Spammer'\";\r\n$user = $db->get_row($sql);\r\nif($user){\n\tif( (isset($_POST[\"processrecover\"]) && is_numeric($_POST[\"processrecover\"]))){\n\t\tif($_POST[\"processrecover\"]==1){\n\t\t\t$error=false;\r\n\t\t\t$password = sanitize($_POST[\"reg_password\"], 3);\r\n\t\t\t$password2 = sanitize($_POST[\"reg_password2\"], 3);\r\n\t\t\tif(strlen($password) < 5 ) {\n\t\t\t\t$error = true;\r\n\t\t\t}\n\t\t\tif($password !== $password2) {\n\t\t\t\t$error = true;\r\n\t\t\t}\n\t\t\tif($error==false){\n\t\t\t\t$to = $user->user_email;\r\n\t\t\t\t$subject = $main_smarty->get_config_vars(\"PLIGG_Visual_Name\").' '.$main_smarty->get_config_vars(\"PLIGG_PassEmail_Subject\");\r\n\t\t\t\t$body = sprintf(\r\n\t\t\t\t\t$main_smarty->get_config_vars(\"PLIGG_PassEmail_PassBody\"),\r\n\t\t\t\t\t$main_smarty->get_config_vars(\"PLIGG_Visual_Name\"),\r\n\t\t\t\t\t$my_base_url . $my_pligg_base . '/login.php',\r\n\t\t\t\t\t$user->user_login,\r\n\t\t\t\t\t$password\r\n\t\t\t\t);\r\n\t\t\t\t$headers = 'From: ' . $main_smarty->get_config_vars(\"PLIGG_PassEmail_From\") . \"\\r\\n\";\r\n\t\t\t\t$headers .= \"Content-type: text/html; charset=utf-8\\r\\n\";\r\n\t\t\t\tif (mail($to, $subject, $body, $headers))\r\n\t\t\t\t{\n$query = 'UPDATE `' . table_users . \"` SET `user_pass` = '_PAD_' WHERE `user_login` = '\".$user->user_login.\"'\";\t\t//sink point: $user;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n\n", "id": 352, "slice_label": "bad", "file_name": "D:\\good_2350_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$db->begin();\n\t\t\t$db->commit();\n\t\t}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$db->begin();\n\t$db->commit();\n}\nif ($_GET[\"action\"] == 'switch')\n{\n\t$db->begin();\n\t$objfrom=new ModeleBoxes($db);\n\t$objfrom->fetch($_GET[\"switchfrom\"]);\n\t$objto=new ModeleBoxes($db);\n\t$objto->fetch($_GET[\"switchto\"]);\n\tif (is_object($objfrom) && is_object($objto))\n\t{\n$query = \"UPDATE \".MAIN_DB_PREFIX.\"boxes set box_order='\".$objto->box_order.\"' WHERE rowid=\"._PAD_->rowid;\t\t//sink point: $objto;\n$res = mysql_query($query);\n}\n}\n\n", "id": 353, "slice_label": "bad", "file_name": "D:\\good_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$db->begin();\n\t\t\t$db->commit();\n\t\t}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$db->begin();\n\t$db->commit();\n}\nif ($_GET[\"action\"] == 'switch')\n{\n\t$db->begin();\n\t$objfrom=new ModeleBoxes($db);\n\t$objfrom->fetch($_GET[\"switchfrom\"]);\n\t$objto=new ModeleBoxes($db);\n\t$objto->fetch($_GET[\"switchto\"]);\n\tif (is_object($objfrom) && is_object($objto))\n\t{\n$query = \"UPDATE \".MAIN_DB_PREFIX.\"boxes set box_order='\"._PAD_->box_order.\"' WHERE rowid=\".$objfrom->rowid;\t\t//sink point: $objfrom;\n$res = mysql_query($query);\n}\n}\n\n", "id": 354, "slice_label": "bad", "file_name": "D:\\good_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$db->begin();\n\t\t\t$db->commit();\n\t\t}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$db->begin();\n\t$db->commit();\n}\nif ($_GET[\"action\"] == 'switch')\n{\n\t$db->begin();\n\t$objfrom=new ModeleBoxes($db);\n\t$objfrom->fetch($_GET[\"switchfrom\"]);\n\t$objto=new ModeleBoxes($db);\n\t$objto->fetch($_GET[\"switchto\"]);\n\tif (is_object($objfrom) && is_object($objto))\n\t{\n$query = \"UPDATE \".MAIN_DB_PREFIX.\"boxes set box_order='\"._PAD_->box_order.\"' WHERE rowid=\".$objto->rowid;\t\t//sink point: $objto;\n$res = mysql_query($query);\n}\n}\n\n", "id": 355, "slice_label": "bad", "file_name": "D:\\good_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$db->begin();\n\t\t\t$db->commit();\n\t\t}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$db->begin();\n\t$db->commit();\n}\nif ($_GET[\"action\"] == 'switch')\n{\n\t$db->begin();\n\t$objfrom=new ModeleBoxes($db);\n\t$objfrom->fetch($_GET[\"switchfrom\"]);\n\t$objto=new ModeleBoxes($db);\n\t$objto->fetch($_GET[\"switchto\"]);\n\tif (is_object($objfrom) && is_object($objto))\n\t{\n$query = \"UPDATE \".MAIN_DB_PREFIX.\"boxes set box_order='\".$objfrom->box_order.\"' WHERE rowid=\"._PAD_->rowid;\t\t//sink point: $objfrom;\n$res = mysql_query($query);\n}\n}\n\n", "id": 356, "slice_label": "bad", "file_name": "D:\\good_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$boxes = array();\nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$db->begin();\n\t\t\t$resql = $db->query($sql);\n\t\t\t$resql = $db->query($sql);\n\t\t\t$db->commit();\n\t\t}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$db->begin();\n\t$resql = $db->query($sql);\n\t$resql = $db->query($sql);\n\t$db->commit();\n}\nif ($_GET[\"action\"] == 'switch')\n{\n\t$db->begin();\n\t$objfrom=new ModeleBoxes($db);\n\t$objfrom->fetch($_GET[\"switchfrom\"]);\n\t$objto=new ModeleBoxes($db);\n\t$objto->fetch($_GET[\"switchto\"]);\n\tif (is_object($objfrom) && is_object($objto))\n\t{\n\t\t$resultupdatefrom = $db->query($sql);\n\t\t$resultupdateto = $db->query($sql);\n}\n\tif ($resultupdatefrom && $resultupdateto)\n\t{\n\t\t$db->commit();\n\t}\n\telse\n\t{\n\t\t$db->rollback();\n\t}\n}\n$resql = $db->query($sql);\nif ($resql)\n{\n\t$num = $db->num_rows($resql);\n\t$i = 0;\n\t$decalage=0;\n\twhile ($i < $num)\n\t{\n\t\t$obj = $db->fetch_object($resql);\n\t\t$boxes[$obj->position][$obj->box_id]=1;\n\t\tif ($decalage)\n\t\t{\n$query = \"UPDATE \".MAIN_DB_PREFIX.\"boxes set box_order=\"._PAD_.\" WHERE rowid=\".$obj->rowid;\t\t//sink point: $obj;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 357, "slice_label": "bad", "file_name": "D:\\good_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$resql = $db->query($sql);\n\t\t\t$resql = $db->query($sql);\n}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$resql = $db->query($sql);\n\t$resql = $db->query($sql);\n}\n$resql = $db->query($sql);\nif ($resql)\n{\n\t$num = $db->num_rows($resql);\n\t$i = 0;\n\t$decalage=0;\n\twhile ($i < $num)\n\t{\n\t\tif ($decalage)\n\t\t{\n$query = \"UPDATE \".MAIN_DB_PREFIX.\"boxes set box_order=\".$decalage.\" WHERE rowid=\"._PAD_->rowid;\t\t//sink point: $decalage;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 358, "slice_label": "bad", "file_name": "D:\\good_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$db->begin();\n\t\t\t$resql = $db->query($sql);\n\t\t\t$resql = $db->query($sql);\n\t\t\t$db->commit();\n\t\t}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$db->begin();\n\t$resql = $db->query($sql);\n\t$resql = $db->query($sql);\n\t$db->commit();\n}\nif ($_GET[\"action\"] == 'switch')\n{\n\t$db->begin();\n\t$objfrom=new ModeleBoxes($db);\n\t$objfrom->fetch($_GET[\"switchfrom\"]);\n\t$objto=new ModeleBoxes($db);\n\t$objto->fetch($_GET[\"switchto\"]);\n\tif (is_object($objfrom) && is_object($objto))\n\t{\n\t\t$resultupdatefrom = $db->query($sql);\n\t\t$resultupdateto = $db->query($sql);\n}\n\tif ($resultupdatefrom && $resultupdateto)\n\t{\n\t\t$db->commit();\n\t}\n\telse\n\t{\n\t\t$db->rollback();\n\t}\n}\n$resql = $db->query($sql);\nif ($resql)\n{\n\t$i = 0;\n\t$decalage=0;\n\twhile ($i < $num)\n\t{\n\t\tif ($decalage)\n\t\t{\n\t\t\t$db->query($sql);\n\t\t}\n}\n\tif ($decalage)\n\t{\n\t\t$result = $db->query($sql);\n\t\tif ($result)\n\t\t{\n\t\t\twhile ($record = $db->fetch_array($result))\n\t\t\t{\n\t\t\t\tif (dol_strlen($record['box_order']) == 1)\n\t\t\t\t{\n\t\t\t\t\tif (preg_match(\"/[13579]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n\t\t\t\t\t\t$box_order = \"A0\".$record['box_order'];\n$query = \"update llx_boxes set box_order = '\".$box_order.\"' where box_order = \"._PAD_;\t\t//sink point: $box_order;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n}\n\n", "id": 359, "slice_label": "bad", "file_name": "D:\\good_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$db->begin();\n\t\t\t$resql = $db->query($sql);\n\t\t\t$resql = $db->query($sql);\n\t\t\t$db->commit();\n\t\t}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$db->begin();\n\t$resql = $db->query($sql);\n\t$resql = $db->query($sql);\n\t$db->commit();\n}\nif ($_GET[\"action\"] == 'switch')\n{\n\t$db->begin();\n\t$objfrom=new ModeleBoxes($db);\n\t$objfrom->fetch($_GET[\"switchfrom\"]);\n\t$objto=new ModeleBoxes($db);\n\t$objto->fetch($_GET[\"switchto\"]);\n\tif (is_object($objfrom) && is_object($objto))\n\t{\n\t\t$resultupdatefrom = $db->query($sql);\n\t\t$resultupdateto = $db->query($sql);\n}\n\tif ($resultupdatefrom && $resultupdateto)\n\t{\n\t\t$db->commit();\n\t}\n\telse\n\t{\n\t\t$db->rollback();\n\t}\n}\n$resql = $db->query($sql);\nif ($resql)\n{\n\t$i = 0;\n\t$decalage=0;\n\twhile ($i < $num)\n\t{\n\t\tif ($decalage)\n\t\t{\n\t\t\t$db->query($sql);\n\t\t}\n}\n\tif ($decalage)\n\t{\n\t\t$result = $db->query($sql);\n\t\tif ($result)\n\t\t{\n\t\t\twhile ($record = $db->fetch_array($result))\n\t\t\t{\n\t\t\t\tif (dol_strlen($record['box_order']) == 1)\n\t\t\t\t{\n\t\t\t\t\tif (preg_match(\"/[13579]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n$query = \"update llx_boxes set box_order = '\"._PAD_.\"' where box_order = \".$record['box_order'];\t\t//sink point: $record;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n}\n\n", "id": 360, "slice_label": "bad", "file_name": "D:\\good_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$db->begin();\n\t\t\t$resql = $db->query($sql);\n\t\t\t$resql = $db->query($sql);\n\t\t\t$db->commit();\n\t\t}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$db->begin();\n\t$resql = $db->query($sql);\n\t$resql = $db->query($sql);\n\t$db->commit();\n}\nif ($_GET[\"action\"] == 'switch')\n{\n\t$db->begin();\n\t$objfrom=new ModeleBoxes($db);\n\t$objfrom->fetch($_GET[\"switchfrom\"]);\n\t$objto=new ModeleBoxes($db);\n\t$objto->fetch($_GET[\"switchto\"]);\n\tif (is_object($objfrom) && is_object($objto))\n\t{\n\t\t$resultupdatefrom = $db->query($sql);\n\t\t$resultupdateto = $db->query($sql);\n}\n\tif ($resultupdatefrom && $resultupdateto)\n\t{\n\t\t$db->commit();\n\t}\n\telse\n\t{\n\t\t$db->rollback();\n\t}\n}\n$resql = $db->query($sql);\nif ($resql)\n{\n\t$i = 0;\n\t$decalage=0;\n\twhile ($i < $num)\n\t{\n\t\tif ($decalage)\n\t\t{\n\t\t\t$db->query($sql);\n\t\t}\n}\n\tif ($decalage)\n\t{\n\t\t$result = $db->query($sql);\n\t\tif ($result)\n\t\t{\n\t\t\twhile ($record = $db->fetch_array($result))\n\t\t\t{\n\t\t\t\tif (dol_strlen($record['box_order']) == 1)\n\t\t\t\t{\n\t\t\t\t\tif (preg_match(\"/[13579]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n\t\t\t\t\t\t$box_order = \"A0\".$record['box_order'];\n}\nelse if (preg_match(\"/[02468]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n\t\t\t\t\t\t$box_order = \"B0\".$record['box_order'];\n$query = \"update llx_boxes set box_order = '\".$box_order.\"' where box_order = \"._PAD_;\t\t//sink point: $box_order;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n}\n\n", "id": 361, "slice_label": "bad", "file_name": "D:\\good_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$db->begin();\n\t\t\t$resql = $db->query($sql);\n\t\t\t$resql = $db->query($sql);\n\t\t\t$db->commit();\n\t\t}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$db->begin();\n\t$resql = $db->query($sql);\n\t$resql = $db->query($sql);\n\t$db->commit();\n}\nif ($_GET[\"action\"] == 'switch')\n{\n\t$db->begin();\n\t$objfrom=new ModeleBoxes($db);\n\t$objfrom->fetch($_GET[\"switchfrom\"]);\n\t$objto=new ModeleBoxes($db);\n\t$objto->fetch($_GET[\"switchto\"]);\n\tif (is_object($objfrom) && is_object($objto))\n\t{\n\t\t$resultupdatefrom = $db->query($sql);\n\t\t$resultupdateto = $db->query($sql);\n}\n\tif ($resultupdatefrom && $resultupdateto)\n\t{\n\t\t$db->commit();\n\t}\n\telse\n\t{\n\t\t$db->rollback();\n\t}\n}\n$resql = $db->query($sql);\nif ($resql)\n{\n\t$i = 0;\n\t$decalage=0;\n\twhile ($i < $num)\n\t{\n\t\tif ($decalage)\n\t\t{\n\t\t\t$db->query($sql);\n\t\t}\n}\n\tif ($decalage)\n\t{\n\t\t$result = $db->query($sql);\n\t\tif ($result)\n\t\t{\n\t\t\twhile ($record = $db->fetch_array($result))\n\t\t\t{\n\t\t\t\tif (dol_strlen($record['box_order']) == 1)\n\t\t\t\t{\n\t\t\t\t\tif (preg_match(\"/[13579]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n}\nelse if (preg_match(\"/[02468]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n$query = \"update llx_boxes set box_order = '\"._PAD_.\"' where box_order = \".$record['box_order'];\t\t//sink point: $record;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n}\n\n", "id": 362, "slice_label": "bad", "file_name": "D:\\good_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$db->begin();\n\t\t\t$resql = $db->query($sql);\n\t\t\t$resql = $db->query($sql);\n\t\t\t$db->commit();\n\t\t}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$db->begin();\n\t$resql = $db->query($sql);\n\t$resql = $db->query($sql);\n\t$db->commit();\n}\nif ($_GET[\"action\"] == 'switch')\n{\n\t$db->begin();\n\t$objfrom=new ModeleBoxes($db);\n\t$objfrom->fetch($_GET[\"switchfrom\"]);\n\t$objto=new ModeleBoxes($db);\n\t$objto->fetch($_GET[\"switchto\"]);\n\tif (is_object($objfrom) && is_object($objto))\n\t{\n\t\t$resultupdatefrom = $db->query($sql);\n\t\t$resultupdateto = $db->query($sql);\n}\n\tif ($resultupdatefrom && $resultupdateto)\n\t{\n\t\t$db->commit();\n\t}\n\telse\n\t{\n\t\t$db->rollback();\n\t}\n}\n$resql = $db->query($sql);\nif ($resql)\n{\n\t$i = 0;\n\t$decalage=0;\n\twhile ($i < $num)\n\t{\n\t\tif ($decalage)\n\t\t{\n\t\t\t$db->query($sql);\n\t\t}\n}\n\tif ($decalage)\n\t{\n\t\t$result = $db->query($sql);\n\t\tif ($result)\n\t\t{\n\t\t\twhile ($record = $db->fetch_array($result))\n\t\t\t{\n\t\t\t\tif (dol_strlen($record['box_order']) == 1)\n\t\t\t\t{\n\t\t\t\t\tif (preg_match(\"/[13579]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n\t\t\t\t\t\t$box_order = \"A0\".$record['box_order'];\n}\nelse if (preg_match(\"/[02468]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n\t\t\t\t\t\t$box_order = \"B0\".$record['box_order'];\n}\n}\nelse if (dol_strlen($record['box_order']) == 2)\n\t\t\t\t{\n\t\t\t\t\tif (preg_match(\"/[13579]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n\t\t\t\t\t\t$box_order = \"A\".$record['box_order'];\n$query = \"update llx_boxes set box_order = '\".$box_order.\"' where box_order = \"._PAD_;\t\t//sink point: $box_order;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n}\n\n", "id": 363, "slice_label": "bad", "file_name": "D:\\good_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$db->begin();\n\t\t\t$resql = $db->query($sql);\n\t\t\t$resql = $db->query($sql);\n\t\t\t$db->commit();\n\t\t}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$db->begin();\n\t$resql = $db->query($sql);\n\t$resql = $db->query($sql);\n\t$db->commit();\n}\nif ($_GET[\"action\"] == 'switch')\n{\n\t$db->begin();\n\t$objfrom=new ModeleBoxes($db);\n\t$objfrom->fetch($_GET[\"switchfrom\"]);\n\t$objto=new ModeleBoxes($db);\n\t$objto->fetch($_GET[\"switchto\"]);\n\tif (is_object($objfrom) && is_object($objto))\n\t{\n\t\t$resultupdatefrom = $db->query($sql);\n\t\t$resultupdateto = $db->query($sql);\n}\n\tif ($resultupdatefrom && $resultupdateto)\n\t{\n\t\t$db->commit();\n\t}\n\telse\n\t{\n\t\t$db->rollback();\n\t}\n}\n$resql = $db->query($sql);\nif ($resql)\n{\n\t$i = 0;\n\t$decalage=0;\n\twhile ($i < $num)\n\t{\n\t\tif ($decalage)\n\t\t{\n\t\t\t$db->query($sql);\n\t\t}\n}\n\tif ($decalage)\n\t{\n\t\t$result = $db->query($sql);\n\t\tif ($result)\n\t\t{\n\t\t\twhile ($record = $db->fetch_array($result))\n\t\t\t{\n\t\t\t\tif (dol_strlen($record['box_order']) == 1)\n\t\t\t\t{\n}\nelse if (dol_strlen($record['box_order']) == 2)\n\t\t\t\t{\n\t\t\t\t\tif (preg_match(\"/[13579]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n$query = \"update llx_boxes set box_order = '\"._PAD_.\"' where box_order = \".$record['box_order'];\t\t//sink point: $record;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n}\n\n", "id": 364, "slice_label": "bad", "file_name": "D:\\good_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$db->begin();\n\t\t\t$resql = $db->query($sql);\n\t\t\t$resql = $db->query($sql);\n\t\t\t$db->commit();\n\t\t}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$db->begin();\n\t$resql = $db->query($sql);\n\t$resql = $db->query($sql);\n\t$db->commit();\n}\nif ($_GET[\"action\"] == 'switch')\n{\n\t$db->begin();\n\t$objfrom=new ModeleBoxes($db);\n\t$objfrom->fetch($_GET[\"switchfrom\"]);\n\t$objto=new ModeleBoxes($db);\n\t$objto->fetch($_GET[\"switchto\"]);\n\tif (is_object($objfrom) && is_object($objto))\n\t{\n\t\t$resultupdatefrom = $db->query($sql);\n\t\t$resultupdateto = $db->query($sql);\n}\n\tif ($resultupdatefrom && $resultupdateto)\n\t{\n\t\t$db->commit();\n\t}\n\telse\n\t{\n\t\t$db->rollback();\n\t}\n}\n$resql = $db->query($sql);\nif ($resql)\n{\n\t$i = 0;\n\t$decalage=0;\n\twhile ($i < $num)\n\t{\n\t\tif ($decalage)\n\t\t{\n\t\t\t$db->query($sql);\n\t\t}\n}\n\tif ($decalage)\n\t{\n\t\t$result = $db->query($sql);\n\t\tif ($result)\n\t\t{\n\t\t\twhile ($record = $db->fetch_array($result))\n\t\t\t{\n\t\t\t\tif (dol_strlen($record['box_order']) == 1)\n\t\t\t\t{\n\t\t\t\t\tif (preg_match(\"/[13579]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n\t\t\t\t\t\t$box_order = \"A0\".$record['box_order'];\n}\nelse if (preg_match(\"/[02468]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n\t\t\t\t\t\t$box_order = \"B0\".$record['box_order'];\n}\n}\nelse if (dol_strlen($record['box_order']) == 2)\n\t\t\t\t{\n\t\t\t\t\tif (preg_match(\"/[13579]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n\t\t\t\t\t\t$box_order = \"A\".$record['box_order'];\n$query = \"update llx_boxes set box_order = '\".$box_order.\"' where box_order = \"._PAD_;\t\t//sink point: $box_order;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n}\n\n", "id": 365, "slice_label": "bad", "file_name": "D:\\good_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$db->begin();\n\t\t\t$resql = $db->query($sql);\n\t\t\t$resql = $db->query($sql);\n\t\t\t$db->commit();\n\t\t}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$db->begin();\n\t$resql = $db->query($sql);\n\t$resql = $db->query($sql);\n\t$db->commit();\n}\nif ($_GET[\"action\"] == 'switch')\n{\n\t$db->begin();\n\t$objfrom=new ModeleBoxes($db);\n\t$objfrom->fetch($_GET[\"switchfrom\"]);\n\t$objto=new ModeleBoxes($db);\n\t$objto->fetch($_GET[\"switchto\"]);\n\tif (is_object($objfrom) && is_object($objto))\n\t{\n\t\t$resultupdatefrom = $db->query($sql);\n\t\t$resultupdateto = $db->query($sql);\n}\n\tif ($resultupdatefrom && $resultupdateto)\n\t{\n\t\t$db->commit();\n\t}\n\telse\n\t{\n\t\t$db->rollback();\n\t}\n}\n$resql = $db->query($sql);\nif ($resql)\n{\n\t$i = 0;\n\t$decalage=0;\n\twhile ($i < $num)\n\t{\n\t\tif ($decalage)\n\t\t{\n\t\t\t$db->query($sql);\n\t\t}\n}\n\tif ($decalage)\n\t{\n\t\t$result = $db->query($sql);\n\t\tif ($result)\n\t\t{\n\t\t\twhile ($record = $db->fetch_array($result))\n\t\t\t{\n\t\t\t\tif (dol_strlen($record['box_order']) == 1)\n\t\t\t\t{\n}\nelse if (dol_strlen($record['box_order']) == 2)\n\t\t\t\t{\n\t\t\t\t\tif (preg_match(\"/[13579]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n$query = \"update llx_boxes set box_order = '\"._PAD_.\"' where box_order = \".$record['box_order'];\t\t//sink point: $record;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n}\n\n", "id": 366, "slice_label": "bad", "file_name": "D:\\good_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (($_REQUEST['event_id'] || !isset($_REQUEST['event_id'])) && !isset($_REQUEST[assignment_id])) {\n    if ($_REQUEST['event_id'] != 'new' && isset($_REQUEST['event_id'])) {\n$query = \"SELECT TITLE,DESCRIPTION,SCHOOL_DATE,CALENDAR_ID FROM calendar_events WHERE ID='$_REQUEST[event_id]'\");\t\t//sink point: $_REQUEST;\n$res = mysql_query($query);\n}\n}\n\n", "id": 367, "slice_label": "bad", "file_name": "D:\\good_4024_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (($_REQUEST['event_id'] || !isset($_REQUEST['event_id'])) && !isset($_REQUEST[assignment_id])) {\n}\nelse {\n$query = 'SELECT TITLE,STAFF_ID,DATE_FORMAT(DUE_DATE,\\'%d-%b-%y\\') AS SCHOOL_DATE,ASSIGNED_DATE,DUE_DATE,DESCRIPTION FROM gradebook_assignments WHERE ASSIGNMENT_ID=\\'' . $_REQUEST[assignment_id] . '\\'');\t\t//sink point: $_REQUEST;\n$res = mysql_query($query);\n}\n\n", "id": 368, "slice_label": "bad", "file_name": "D:\\good_4024_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$edates = $_GET['input0'];\n\n// php code: \n        foreach ($edates as $edate) {\n$query = 'SELECT DISTINCT p.*, er.event_starttime, er.signup_cutoff FROM ' . $db->prefix . 'product p ';\t\t//sink point: $db;\n$res = mysql_query($query);\n}\n\n", "id": 369, "slice_label": "bad", "file_name": "D:\\bad_5326_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n\n// php code: \n        if (isset($_FILES['modelaliases']['tmp_name'])) {\n            $file = new stdClass();\n            $file->path = $_FILES['modelaliases']['tmp_name'];\n            $handle = fopen($file->path, \"r\");\n            $data = fgetcsv($handle, 10000, \",\");\n            $db->delete('model_aliases_tmp');\n            while (($data = fgetcsv($handle, 10000, \",\")) !== FALSE) {\n                $tmp = new stdClass();\n                $tmp->field1 = expString::onlyReadables($data[0]);\n                $tmp->field2 = expString::onlyReadables($data[1]);\n                $db->insertObject($tmp, 'model_aliases_tmp');\n            }\n}\n$query = \"SELECT * FROM \".$db->prefix.\"model_aliases_tmp WHERE is_processed = 0\";\t\t//sink point: $db;\n$res = mysql_query($query);\n\n", "id": 370, "slice_label": "bad", "file_name": "D:\\bad_5326_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$parent = $_GET['input0'];\n$include_first = $_GET['input1'];\n$content_type = $_GET['input2'];\n\n// php code: \n        $table = $db_categories = $this->tables['categories'];\n        if ($parent == false) {\n            $include_first = false;\n        }\n        $content_type = addslashes($content_type);\n        if ($content_type == false) {\n            if ($include_first == true) {\n}\nelse {\n$query = \"SELECT * FROM $table WHERE parent_id=_PAD_ AND data_type='category' AND is_deleted='n' \";\t\t//sink point: $table;\n$res = mysql_query($query);\n}\n}\n\n", "id": 371, "slice_label": "bad", "file_name": "D:\\good_2379_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$parent = $_GET['input0'];\n$include_first = $_GET['input1'];\n$content_type = $_GET['input2'];\n\n// php code: \n        if ($parent == false) {\n            $parent = (0);\n            $include_first = false;\n        }\nelse {\n            $parent = (int)$parent;\n        }\n        $content_type = addslashes($content_type);\n        if ($content_type == false) {\n            if ($include_first == true) {\n}\nelse {\n$query = \"SELECT * FROM _PAD_ WHERE parent_id=$parent AND data_type='category' AND is_deleted='n' \";\t\t//sink point: $parent;\n$res = mysql_query($query);\n}\n}\n\n", "id": 372, "slice_label": "bad", "file_name": "D:\\good_2379_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$parent = $_GET['input0'];\n$include_first = $_GET['input1'];\n$content_type = $_GET['input2'];\n\n// php code: \n        $table = $db_categories = $this->tables['categories'];\n        if ($parent == false) {\n            $include_first = false;\n        }\n        $content_type = addslashes($content_type);\n        if ($content_type == false) {\n}\nelse {\n            if ($include_first == true) {\n$query = \"SELECT * FROM $table WHERE id=_PAD_  AND is_deleted='n'  \";\t\t//sink point: $table;\n$res = mysql_query($query);\n}\n}\n\n", "id": 373, "slice_label": "bad", "file_name": "D:\\good_2379_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$parent = $_GET['input0'];\n$include_first = $_GET['input1'];\n$content_type = $_GET['input2'];\n\n// php code: \n        if ($parent == false) {\n            $parent = (0);\n            $include_first = false;\n        }\nelse {\n            $parent = (int)$parent;\n        }\n        $content_type = addslashes($content_type);\n        if ($content_type == false) {\n}\nelse {\n            if ($include_first == true) {\n$query = \"SELECT * FROM _PAD_ WHERE id=$parent  AND is_deleted='n'  \";\t\t//sink point: $parent;\n$res = mysql_query($query);\n}\n}\n\n", "id": 374, "slice_label": "bad", "file_name": "D:\\good_2379_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$parent = $_GET['input0'];\n$include_first = $_GET['input1'];\n$content_type = $_GET['input2'];\n\n// php code: \n        if ($parent == false) {\n            $include_first = false;\n        }\n        $content_type = addslashes($content_type);\n        if ($content_type == false) {\n}\nelse {\n            if ($include_first == true) {\n}\nelse {\n$query = \"SELECT * FROM _PAD_ WHERE parent_id=_PAD_ AND is_deleted='n' AND data_type='category' AND (categories_content_type='$content_type' OR categories_content_type='inherit';\t\t//sink point: $content_type;\n$res = mysql_query($query);\n}\n}\n\n", "id": 375, "slice_label": "bad", "file_name": "D:\\good_2379_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$parent = $_GET['input0'];\n$include_first = $_GET['input1'];\n$content_type = $_GET['input2'];\n\n// php code: \n        $table = $db_categories = $this->tables['categories'];\n        if ($parent == false) {\n            $include_first = false;\n        }\n        $content_type = addslashes($content_type);\n        if ($content_type == false) {\n}\nelse {\n            if ($include_first == true) {\n}\nelse {\n$query = \"SELECT * FROM $table WHERE parent_id=_PAD_ AND is_deleted='n' AND data_type='category' AND (categories_content_type='_PAD_' OR categories_content_type='inherit';\t\t//sink point: $table;\n$res = mysql_query($query);\n}\n}\n\n", "id": 376, "slice_label": "bad", "file_name": "D:\\good_2379_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$parent = $_GET['input0'];\n$include_first = $_GET['input1'];\n$content_type = $_GET['input2'];\n\n// php code: \n        if ($parent == false) {\n            $parent = (0);\n            $include_first = false;\n        }\nelse {\n            $parent = (int)$parent;\n        }\n        $content_type = addslashes($content_type);\n        if ($content_type == false) {\n}\nelse {\n            if ($include_first == true) {\n}\nelse {\n$query = \"SELECT * FROM _PAD_ WHERE parent_id=$parent AND is_deleted='n' AND data_type='category' AND (categories_content_type='_PAD_' OR categories_content_type='inherit';\t\t//sink point: $parent;\n$res = mysql_query($query);\n}\n}\n\n", "id": 377, "slice_label": "bad", "file_name": "D:\\good_2379_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$columns = $_GET['input0'];\n\n// php code: \n\t\t$map = [];\n\t\t$stack = [];\n\t\tforeach ($columns as $column => $replacements)\n\t\t{\n\t\t\tif (is_array($replacements))\n\t\t\t{\n\t\t\t\tforeach ($replacements as $old => $new)\n\t\t\t\t{\n\t\t\t\t\t$map_key = $this->mapKey();\n\t\t\t\t\t$stack[] = $this->columnQuote($column) . ' = REPLACE(' . $this->columnQuote($column) . ', ' . $map_key . 'a, ' . $map_key . 'b)';\n\t\t\t\t\t$map[ $map_key . 'a' ] = [$old, PDO::PARAM_STR];\n\t\t\t\t\t$map[ $map_key . 'b' ] = [$new, PDO::PARAM_STR];\n\t\t\t\t}\n}\n}\n\t\tif (!empty($stack))\n\t\t{\n$query = 'UPDATE ' . _PAD_->tableQuote(_PAD_) . ' SET ' . implode(', ', _PAD_) . _PAD_->whereClause(_PAD_, $map), $map;\t\t//sink point: $map;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 378, "slice_label": "bad", "file_name": "D:\\bad_771_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$columns = $_GET['input0'];\n\n// php code: \n\t\t$stack = [];\n\t\tforeach ($columns as $column => $replacements)\n\t\t{\n\t\t\tif (is_array($replacements))\n\t\t\t{\n\t\t\t\tforeach ($replacements as $old => $new)\n\t\t\t\t{\n\t\t\t\t\t$map_key = $this->mapKey();\n\t\t\t\t\t$stack[] = $this->columnQuote($column) . ' = REPLACE(' . $this->columnQuote($column) . ', ' . $map_key . 'a, ' . $map_key . 'b)';\n}\n}\n}\n\t\tif (!empty($stack))\n\t\t{\n$query = 'UPDATE ' . $this->tableQuote(_PAD_) . ' SET ' . implode(', ', _PAD_) . $this->whereClause(_PAD_, _PAD_), _PAD_;\t\t//sink point: $this;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 379, "slice_label": "bad", "file_name": "D:\\bad_771_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n$columns = $_GET['input1'];\n\n// php code: \n\t\t$stack = [];\n\t\tforeach ($columns as $column => $replacements)\n\t\t{\n\t\t\tif (is_array($replacements))\n\t\t\t{\n\t\t\t\tforeach ($replacements as $old => $new)\n\t\t\t\t{\n\t\t\t\t\t$map_key = $this->mapKey();\n\t\t\t\t\t$stack[] = $this->columnQuote($column) . ' = REPLACE(' . $this->columnQuote($column) . ', ' . $map_key . 'a, ' . $map_key . 'b)';\n}\n}\n}\n\t\tif (!empty($stack))\n\t\t{\n$query = 'UPDATE ' . _PAD_->tableQuote($table) . ' SET ' . implode(', ', _PAD_) . _PAD_->whereClause(_PAD_, _PAD_), _PAD_;\t\t//sink point: $table;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 380, "slice_label": "bad", "file_name": "D:\\bad_771_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$columns = $_GET['input0'];\n$where = $_GET['input1'];\n\n// php code: \n\t\t$stack = [];\n\t\tforeach ($columns as $column => $replacements)\n\t\t{\n\t\t\tif (is_array($replacements))\n\t\t\t{\n\t\t\t\tforeach ($replacements as $old => $new)\n\t\t\t\t{\n\t\t\t\t\t$map_key = $this->mapKey();\n\t\t\t\t\t$stack[] = $this->columnQuote($column) . ' = REPLACE(' . $this->columnQuote($column) . ', ' . $map_key . 'a, ' . $map_key . 'b)';\n}\n}\n}\n\t\tif (!empty($stack))\n\t\t{\n$query = 'UPDATE ' . _PAD_->tableQuote(_PAD_) . ' SET ' . implode(', ', _PAD_) . _PAD_->whereClause($where, _PAD_), _PAD_;\t\t//sink point: $where;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 381, "slice_label": "bad", "file_name": "D:\\bad_771_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$columns = $_GET['input0'];\n\n// php code: \n\t\t$stack = [];\n\t\tforeach ($columns as $column => $replacements)\n\t\t{\n\t\t\tif (is_array($replacements))\n\t\t\t{\n\t\t\t\tforeach ($replacements as $old => $new)\n\t\t\t\t{\n\t\t\t\t\t$map_key = $this->mapKey();\n\t\t\t\t\t$stack[] = $this->columnQuote($column) . ' = REPLACE(' . $this->columnQuote($column) . ', ' . $map_key . 'a, ' . $map_key . 'b)';\n}\n}\n}\n\t\tif (!empty($stack))\n\t\t{\n$query = 'UPDATE ' . _PAD_->tableQuote(_PAD_) . ' SET ' . implode(', ', $stack) . _PAD_->whereClause(_PAD_, _PAD_), _PAD_;\t\t//sink point: $stack;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 382, "slice_label": "bad", "file_name": "D:\\bad_771_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=sanitize($_REQUEST['id'], 3);\r\n$username=base64_decode($id);\r\n$query = \"SELECT * FROM `\" . table_users . \"` where `user_login` = '\".$username.\"' AND `last_reset_request` = FROM_UNIXTIME('\"._PAD_.\"') AND user_level!='Spammer'\";\t\t//sink point: $username;\n$res = mysql_query($query);\n\n", "id": 383, "slice_label": "bad", "file_name": "D:\\bad_2349_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$n=sanitize($_REQUEST['n'], 3);\r\n$query = \"SELECT * FROM `\" . table_users . \"` where `user_login` = '\"._PAD_.\"' AND `last_reset_request` = FROM_UNIXTIME('\".$n.\"') AND user_level!='Spammer'\";\t\t//sink point: $n;\n$res = mysql_query($query);\n\n", "id": 384, "slice_label": "bad", "file_name": "D:\\bad_2349_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$main_smarty = new Smarty;\r\n$navwhere['text1'] = $main_smarty->get_config_vars('PLIGG_Visual_Breadcrumb_Recover_Password');\r\n$navwhere['link1'] = getmyurl('loginNoVar', '');\r\n$main_smarty->assign('navbar_where', $navwhere);\r\n$main_smarty->assign('posttitle', $main_smarty->get_config_vars('PLIGG_Visual_Breadcrumb_Recover_Password'));\r\n$main_smarty = do_sidebar($main_smarty);\r\n$id=sanitize($_REQUEST['id'], 3);\r\n$n=sanitize($_REQUEST['n'], 3);\r\n$username=base64_decode($id);\r\n$sql=\"SELECT * FROM `\" . table_users . \"` where `user_login` = '\".$username.\"' AND `last_reset_request` = FROM_UNIXTIME('\".$n.\"') AND user_level!='Spammer'\";\r\n$user = $db->get_row($sql);\r\nif($user){\n\tif( (isset($_POST[\"processrecover\"]) && is_numeric($_POST[\"processrecover\"]))){\n\t\tif($_POST[\"processrecover\"]==1){\n\t\t\t$error=false;\r\n\t\t\t$password = sanitize($_POST[\"reg_password\"], 3);\r\n\t\t\t$password2 = sanitize($_POST[\"reg_password2\"], 3);\r\n\t\t\tif(strlen($password) < 5 ) {\n\t\t\t\t$error = true;\r\n\t\t\t}\n\t\t\tif($password !== $password2) {\n\t\t\t\t$error = true;\r\n\t\t\t}\n\t\t\tif($error==false){\n\t\t\t\t$to = $user->user_email;\r\n\t\t\t\t$subject = $main_smarty->get_config_vars(\"PLIGG_Visual_Name\").' '.$main_smarty->get_config_vars(\"PLIGG_PassEmail_Subject\");\r\n\t\t\t\t$body = sprintf(\r\n\t\t\t\t\t$main_smarty->get_config_vars(\"PLIGG_PassEmail_PassBody\"),\r\n\t\t\t\t\t$main_smarty->get_config_vars(\"PLIGG_Visual_Name\"),\r\n\t\t\t\t\t$my_base_url . $my_pligg_base . '/login.php',\r\n\t\t\t\t\t$user->user_login,\r\n\t\t\t\t\t$password\r\n\t\t\t\t);\r\n\t\t\t\t$headers = 'From: ' . $main_smarty->get_config_vars(\"PLIGG_PassEmail_From\") . \"\\r\\n\";\r\n\t\t\t\t$headers .= \"Content-type: text/html; charset=utf-8\\r\\n\";\r\n\t\t\t\tif (mail($to, $subject, $body, $headers))\r\n\t\t\t\t{\n\t\t\t\t\t$saltedPass = generateHash($password);\r\n$query = 'UPDATE `' . table_users . \"` SET `user_pass` = '$saltedPass' WHERE `user_login` = '\"._PAD_->user_login.\"'\";\t\t//sink point: $saltedPass;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n\n", "id": 385, "slice_label": "bad", "file_name": "D:\\bad_2349_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$main_smarty = new Smarty;\r\n$navwhere['text1'] = $main_smarty->get_config_vars('PLIGG_Visual_Breadcrumb_Recover_Password');\r\n$navwhere['link1'] = getmyurl('loginNoVar', '');\r\n$main_smarty->assign('navbar_where', $navwhere);\r\n$main_smarty->assign('posttitle', $main_smarty->get_config_vars('PLIGG_Visual_Breadcrumb_Recover_Password'));\r\n$main_smarty = do_sidebar($main_smarty);\r\n$id=sanitize($_REQUEST['id'], 3);\r\n$n=sanitize($_REQUEST['n'], 3);\r\n$username=base64_decode($id);\r\n$sql=\"SELECT * FROM `\" . table_users . \"` where `user_login` = '\".$username.\"' AND `last_reset_request` = FROM_UNIXTIME('\".$n.\"') AND user_level!='Spammer'\";\r\n$user = $db->get_row($sql);\r\nif($user){\n\tif( (isset($_POST[\"processrecover\"]) && is_numeric($_POST[\"processrecover\"]))){\n\t\tif($_POST[\"processrecover\"]==1){\n\t\t\t$error=false;\r\n\t\t\t$password = sanitize($_POST[\"reg_password\"], 3);\r\n\t\t\t$password2 = sanitize($_POST[\"reg_password2\"], 3);\r\n\t\t\tif(strlen($password) < 5 ) {\n\t\t\t\t$error = true;\r\n\t\t\t}\n\t\t\tif($password !== $password2) {\n\t\t\t\t$error = true;\r\n\t\t\t}\n\t\t\tif($error==false){\n\t\t\t\t$to = $user->user_email;\r\n\t\t\t\t$subject = $main_smarty->get_config_vars(\"PLIGG_Visual_Name\").' '.$main_smarty->get_config_vars(\"PLIGG_PassEmail_Subject\");\r\n\t\t\t\t$body = sprintf(\r\n\t\t\t\t\t$main_smarty->get_config_vars(\"PLIGG_PassEmail_PassBody\"),\r\n\t\t\t\t\t$main_smarty->get_config_vars(\"PLIGG_Visual_Name\"),\r\n\t\t\t\t\t$my_base_url . $my_pligg_base . '/login.php',\r\n\t\t\t\t\t$user->user_login,\r\n\t\t\t\t\t$password\r\n\t\t\t\t);\r\n\t\t\t\t$headers = 'From: ' . $main_smarty->get_config_vars(\"PLIGG_PassEmail_From\") . \"\\r\\n\";\r\n\t\t\t\t$headers .= \"Content-type: text/html; charset=utf-8\\r\\n\";\r\n\t\t\t\tif (mail($to, $subject, $body, $headers))\r\n\t\t\t\t{\n$query = 'UPDATE `' . table_users . \"` SET `user_pass` = '_PAD_' WHERE `user_login` = '\".$user->user_login.\"'\";\t\t//sink point: $user;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n\n", "id": 386, "slice_label": "bad", "file_name": "D:\\bad_2349_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$manipulation = $_GET['input0'];\n\n// php code: \n\t\t$tables = array_keys($manipulation);\n\t\tforeach($tables as $table) {\n\t\t\t$id = $manipulation[$table]['id'] ? $manipulation[$table]['id'] : $manipulation[$table]['fields']['ID'];\n;\n\t\t\tif(!isset($manipulation[$table]['fields']['Version'])) {\n$query = \"SELECT * FROM \\\"_PAD_\\\" WHERE \\\"ID\\\" = $id\")->record(;\t\t//sink point: $id;\n$res = mysql_query($query);\n}\n}\n\n", "id": 387, "slice_label": "bad", "file_name": "D:\\good_3551_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$manipulation = $_GET['input0'];\n\n// php code: \n\t\t$tables = array_keys($manipulation);\n\t\tforeach($tables as $table) {\n\t\t\tif($this->migratingVersion) {\n\t\t\t\t$manipulation[$table]['fields']['Version'] = $this->migratingVersion;\n\t\t\t}\n\t\t\tif(!isset($manipulation[$table]['fields']['Version'])) {\n$query = \"SELECT * FROM \\\"$table\\\" WHERE \\\"ID\\\" = _PAD_\")->record(;\t\t//sink point: $table;\n$res = mysql_query($query);\n}\n}\n\n", "id": 388, "slice_label": "bad", "file_name": "D:\\good_3551_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$class = $_GET['input0'];\n$stage = $_GET['input1'];\n\n// php code: \n\t\t$baseClass = ClassInfo::baseDataClass($class);\n\t\t$stageTable = ($stage == 'Stage') ? $baseClass : \"{\n$baseClass}\n_{\n$stage}\n\";\n$query = \"SELECT \\\"Version\\\" FROM \\\"$stageTable\\\" WHERE \\\"ID\\\" = _PAD_\")->value(;\t\t//sink point: $stageTable;\n$res = mysql_query($query);\n\n", "id": 389, "slice_label": "bad", "file_name": "D:\\good_3551_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n\n// php code: \n$query = \"SELECT \\\"Version\\\" FROM \\\"_PAD_\\\" WHERE \\\"ID\\\" = $id\")->value(;\t\t//sink point: $id;\n$res = mysql_query($query);\n\n", "id": 390, "slice_label": "bad", "file_name": "D:\\good_3551_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$class = $_GET['input0'];\n$stage = $_GET['input1'];\n\n// php code: \n\t\t$baseClass = ClassInfo::baseDataClass($class);\n\t\t$stageTable = ($stage == 'Stage') ? $baseClass : \"{\n$baseClass}\n_{\n$stage}\n\";\n$query = \"SELECT \\\"ID\\\", \\\"Version\\\" FROM \\\"$stageTable\\\" _PAD_\")->map(;\t\t//sink point: $stageTable;\n$res = mysql_query($query);\n\n", "id": 391, "slice_label": "bad", "file_name": "D:\\good_3551_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$idList = $_GET['input0'];\n\n// php code: \n\t\t$filter = \"\";\n\t\tif($idList) {\n\t\t\t$filter = \"WHERE \\\"ID\\\" IN(\" .implode(\", \", $idList) . \")\";\n\t\t}\n$query = \"SELECT \\\"ID\\\", \\\"Version\\\" FROM \\\"_PAD_\\\" $filter\")->map(;\t\t//sink point: $filter;\n$res = mysql_query($query);\n\n", "id": 392, "slice_label": "bad", "file_name": "D:\\good_3551_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$range = $_GET['input0'];\n\n// php code: \n        if (is_numeric($range)) {\n            $range = 'first';\n        }\n        if (strcasecmp($range, 'all') == 0) {\n}\nelse if (strcasecmp($range, 'revisions') == 0) {\n}\nelse if (strcasecmp($range, 'first') == 0) {\n}\nelse if (strcasecmp($range, 'bytitle') == 0) {\n}\nelse if (strcasecmp($range, 'count') == 0) {\n}\nelse if (strcasecmp($range, 'in') == 0) {\n}\nelse if (strcasecmp($range, 'bytag') == 0) {\n$query = 'SELECT DISTINCT m.id FROM ' . $db->prefix . _PAD_->tablename . ' m ';\t\t//sink point: $db;\n$res = mysql_query($query);\n}\n\n", "id": 393, "slice_label": "bad", "file_name": "D:\\good_5327_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$range = $_GET['input0'];\n\n// php code: \n        if (is_numeric($range)) {\n            $range = 'first';\n        }\n        if (strcasecmp($range, 'all') == 0) {\n}\nelse if (strcasecmp($range, 'revisions') == 0) {\n}\nelse if (strcasecmp($range, 'first') == 0) {\n}\nelse if (strcasecmp($range, 'bytitle') == 0) {\n}\nelse if (strcasecmp($range, 'count') == 0) {\n}\nelse if (strcasecmp($range, 'in') == 0) {\n}\nelse if (strcasecmp($range, 'bytag') == 0) {\n$query = 'SELECT DISTINCT m.id FROM ' . _PAD_->prefix . $this->tablename . ' m ';\t\t//sink point: $this;\n$res = mysql_query($query);\n}\n\n", "id": 394, "slice_label": "bad", "file_name": "D:\\good_5327_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$range = $_GET['input0'];\n\n// php code: \n        if (is_numeric($range)) {\n            $range = 'first';\n        }\n        if (strcasecmp($range, 'all') == 0) {\n}\nelse if (strcasecmp($range, 'revisions') == 0) {\n}\nelse if (strcasecmp($range, 'first') == 0) {\n}\nelse if (strcasecmp($range, 'bytitle') == 0) {\n}\nelse if (strcasecmp($range, 'count') == 0) {\n}\nelse if (strcasecmp($range, 'in') == 0) {\n}\nelse if (strcasecmp($range, 'bytag') == 0) {\n}\nelse if (strcasecmp($range, 'bycat') == 0) {\n$query = 'SELECT DISTINCT m.id FROM ' . $db->prefix . _PAD_->tablename . ' m ';\t\t//sink point: $db;\n$res = mysql_query($query);\n}\n\n", "id": 395, "slice_label": "bad", "file_name": "D:\\good_5327_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$range = $_GET['input0'];\n\n// php code: \n        if (is_numeric($range)) {\n            $range = 'first';\n        }\n        if (strcasecmp($range, 'all') == 0) {\n}\nelse if (strcasecmp($range, 'revisions') == 0) {\n}\nelse if (strcasecmp($range, 'first') == 0) {\n}\nelse if (strcasecmp($range, 'bytitle') == 0) {\n}\nelse if (strcasecmp($range, 'count') == 0) {\n}\nelse if (strcasecmp($range, 'in') == 0) {\n}\nelse if (strcasecmp($range, 'bytag') == 0) {\n}\nelse if (strcasecmp($range, 'bycat') == 0) {\n$query = 'SELECT DISTINCT m.id FROM ' . _PAD_->prefix . $this->tablename . ' m ';\t\t//sink point: $this;\n$res = mysql_query($query);\n}\n\n", "id": 396, "slice_label": "bad", "file_name": "D:\\good_5327_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id=$_REQUEST['id'];\r\n$username=base64_decode($id);\r\n$query = \"SELECT * FROM `\" . table_users . \"` where `user_login` = '\".$username.\"' AND `last_reset_request` = FROM_UNIXTIME('\"._PAD_.\"') AND user_level!='Spammer'\";\t\t//sink point: $username;\n$res = mysql_query($query);\n\n", "id": 397, "slice_label": "bad", "file_name": "D:\\bad_2350_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$n=$_REQUEST['n'];\r\n$query = \"SELECT * FROM `\" . table_users . \"` where `user_login` = '\"._PAD_.\"' AND `last_reset_request` = FROM_UNIXTIME('\".$n.\"') AND user_level!='Spammer'\";\t\t//sink point: $n;\n$res = mysql_query($query);\n\n", "id": 398, "slice_label": "bad", "file_name": "D:\\bad_2350_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$main_smarty = new Smarty;\r\n$navwhere['text1'] = $main_smarty->get_config_vars('PLIGG_Visual_Breadcrumb_Recover_Password');\r\n$navwhere['link1'] = getmyurl('loginNoVar', '');\r\n$main_smarty->assign('navbar_where', $navwhere);\r\n$main_smarty->assign('posttitle', $main_smarty->get_config_vars('PLIGG_Visual_Breadcrumb_Recover_Password'));\r\n$main_smarty = do_sidebar($main_smarty);\r\n$id=$_REQUEST['id'];\r\n$n=$_REQUEST['n'];\r\n$username=base64_decode($id);\r\n$sql=\"SELECT * FROM `\" . table_users . \"` where `user_login` = '\".$username.\"' AND `last_reset_request` = FROM_UNIXTIME('\".$n.\"') AND user_level!='Spammer'\";\r\n$user = $db->get_row($sql);\r\nif($user){\n\tif( (isset($_POST[\"processrecover\"]) && is_numeric($_POST[\"processrecover\"]))){\n\t\tif($_POST[\"processrecover\"]==1){\n\t\t\t$error=false;\r\n\t\t\t$password = sanitize($_POST[\"reg_password\"], 3);\r\n\t\t\t$password2 = sanitize($_POST[\"reg_password2\"], 3);\r\n\t\t\tif(strlen($password) < 5 ) {\n\t\t\t\t$error = true;\r\n\t\t\t}\n\t\t\tif($password !== $password2) {\n\t\t\t\t$error = true;\r\n\t\t\t}\n\t\t\tif($error==false){\n\t\t\t\t$to = $user->user_email;\r\n\t\t\t\t$subject = $main_smarty->get_config_vars(\"PLIGG_Visual_Name\").' '.$main_smarty->get_config_vars(\"PLIGG_PassEmail_Subject\");\r\n\t\t\t\t$body = sprintf(\r\n\t\t\t\t\t$main_smarty->get_config_vars(\"PLIGG_PassEmail_PassBody\"),\r\n\t\t\t\t\t$main_smarty->get_config_vars(\"PLIGG_Visual_Name\"),\r\n\t\t\t\t\t$my_base_url . $my_pligg_base . '/login.php',\r\n\t\t\t\t\t$user->user_login,\r\n\t\t\t\t\t$password\r\n\t\t\t\t);\r\n\t\t\t\t$headers = 'From: ' . $main_smarty->get_config_vars(\"PLIGG_PassEmail_From\") . \"\\r\\n\";\r\n\t\t\t\t$headers .= \"Content-type: text/html; charset=utf-8\\r\\n\";\r\n\t\t\t\tif (mail($to, $subject, $body, $headers))\r\n\t\t\t\t{\n\t\t\t\t\t$saltedPass = generateHash($password);\r\n$query = 'UPDATE `' . table_users . \"` SET `user_pass` = '$saltedPass' WHERE `user_login` = '\"._PAD_->user_login.\"'\";\t\t//sink point: $saltedPass;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n\n", "id": 399, "slice_label": "bad", "file_name": "D:\\bad_2350_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$main_smarty = new Smarty;\r\n$navwhere['text1'] = $main_smarty->get_config_vars('PLIGG_Visual_Breadcrumb_Recover_Password');\r\n$navwhere['link1'] = getmyurl('loginNoVar', '');\r\n$main_smarty->assign('navbar_where', $navwhere);\r\n$main_smarty->assign('posttitle', $main_smarty->get_config_vars('PLIGG_Visual_Breadcrumb_Recover_Password'));\r\n$main_smarty = do_sidebar($main_smarty);\r\n$id=$_REQUEST['id'];\r\n$n=$_REQUEST['n'];\r\n$username=base64_decode($id);\r\n$sql=\"SELECT * FROM `\" . table_users . \"` where `user_login` = '\".$username.\"' AND `last_reset_request` = FROM_UNIXTIME('\".$n.\"') AND user_level!='Spammer'\";\r\n$user = $db->get_row($sql);\r\nif($user){\n\tif( (isset($_POST[\"processrecover\"]) && is_numeric($_POST[\"processrecover\"]))){\n\t\tif($_POST[\"processrecover\"]==1){\n\t\t\t$error=false;\r\n\t\t\t$password = sanitize($_POST[\"reg_password\"], 3);\r\n\t\t\t$password2 = sanitize($_POST[\"reg_password2\"], 3);\r\n\t\t\tif(strlen($password) < 5 ) {\n\t\t\t\t$error = true;\r\n\t\t\t}\n\t\t\tif($password !== $password2) {\n\t\t\t\t$error = true;\r\n\t\t\t}\n\t\t\tif($error==false){\n\t\t\t\t$to = $user->user_email;\r\n\t\t\t\t$subject = $main_smarty->get_config_vars(\"PLIGG_Visual_Name\").' '.$main_smarty->get_config_vars(\"PLIGG_PassEmail_Subject\");\r\n\t\t\t\t$body = sprintf(\r\n\t\t\t\t\t$main_smarty->get_config_vars(\"PLIGG_PassEmail_PassBody\"),\r\n\t\t\t\t\t$main_smarty->get_config_vars(\"PLIGG_Visual_Name\"),\r\n\t\t\t\t\t$my_base_url . $my_pligg_base . '/login.php',\r\n\t\t\t\t\t$user->user_login,\r\n\t\t\t\t\t$password\r\n\t\t\t\t);\r\n\t\t\t\t$headers = 'From: ' . $main_smarty->get_config_vars(\"PLIGG_PassEmail_From\") . \"\\r\\n\";\r\n\t\t\t\t$headers .= \"Content-type: text/html; charset=utf-8\\r\\n\";\r\n\t\t\t\tif (mail($to, $subject, $body, $headers))\r\n\t\t\t\t{\n$query = 'UPDATE `' . table_users . \"` SET `user_pass` = '_PAD_' WHERE `user_login` = '\".$user->user_login.\"'\";\t\t//sink point: $user;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n\n", "id": 400, "slice_label": "bad", "file_name": "D:\\bad_2350_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$main_smarty = new Smarty;\r\n$navwhere['text1'] = $main_smarty->get_config_vars('PLIGG_Visual_Breadcrumb_Recover_Password');\r\n$navwhere['link1'] = getmyurl('loginNoVar', '');\r\n$main_smarty->assign('navbar_where', $navwhere);\r\n$main_smarty->assign('posttitle', $main_smarty->get_config_vars('PLIGG_Visual_Breadcrumb_Recover_Password'));\r\n$main_smarty = do_sidebar($main_smarty);\r\n$id=$_REQUEST['id'];\r\n$n=$_REQUEST['n'];\r\n$username=base64_decode($id);\r\n$sql=\"SELECT * FROM `\" . table_users . \"` where `user_login` = '\".$username.\"' AND `last_reset_request` = FROM_UNIXTIME('\".$n.\"') AND user_level!='Spammer'\";\r\n$user = $db->get_row($sql);\r\nif($user){\n\tif( (isset($_POST[\"processrecover\"]) && is_numeric($_POST[\"processrecover\"]))){\n\t\tif($_POST[\"processrecover\"]==1){\n\t\t\t$error=false;\r\n\t\t\t$password = sanitize($_POST[\"reg_password\"], 3);\r\n\t\t\t$password2 = sanitize($_POST[\"reg_password2\"], 3);\r\n\t\t\tif(strlen($password) < 5 ) {\n\t\t\t\t$error = true;\r\n\t\t\t}\n\t\t\tif($password !== $password2) {\n\t\t\t\t$error = true;\r\n\t\t\t}\n\t\t\tif($error==false){\n\t\t\t\t$to = $user->user_email;\r\n\t\t\t\t$subject = $main_smarty->get_config_vars(\"PLIGG_Visual_Name\").' '.$main_smarty->get_config_vars(\"PLIGG_PassEmail_Subject\");\r\n\t\t\t\t$body = sprintf(\r\n\t\t\t\t\t$main_smarty->get_config_vars(\"PLIGG_PassEmail_PassBody\"),\r\n\t\t\t\t\t$main_smarty->get_config_vars(\"PLIGG_Visual_Name\"),\r\n\t\t\t\t\t$my_base_url . $my_pligg_base . '/login.php',\r\n\t\t\t\t\t$user->user_login,\r\n\t\t\t\t\t$password\r\n\t\t\t\t);\r\n\t\t\t\t$headers = 'From: ' . $main_smarty->get_config_vars(\"PLIGG_PassEmail_From\") . \"\\r\\n\";\r\n\t\t\t\t$headers .= \"Content-type: text/html; charset=utf-8\\r\\n\";\r\n\t\t\t\tif (mail($to, $subject, $body, $headers))\r\n\t\t\t\t{\n\t\t\t\t\t$saltedPass = generateHash($password);\r\n\t\t\t\t\t$db->query('UPDATE `' . table_users . \"` SET `user_pass` = '$saltedPass' WHERE `user_login` = '\".$user->user_login.\"'\");\r\n$query = 'UPDATE `' . table_users . '` SET `last_reset_request` = FROM_UNIXTIME('.time().') WHERE `user_login` = \"'.$user->user_login.'\"';\t\t//sink point: $user;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n\n", "id": 401, "slice_label": "bad", "file_name": "D:\\bad_2350_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$db->begin();\n\t\t\t$db->commit();\n\t\t}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$db->begin();\n\t$db->commit();\n}\nif ($_GET[\"action\"] == 'switch')\n{\n\t$db->begin();\n\t$objfrom=new ModeleBoxes($db);\n\t$objfrom->fetch($_GET[\"switchfrom\"]);\n\t$objto=new ModeleBoxes($db);\n\t$objto->fetch($_GET[\"switchto\"]);\n\tif (is_object($objfrom) && is_object($objto))\n\t{\n$query = \"UPDATE \".MAIN_DB_PREFIX.\"boxes set box_order='\".$objto->box_order.\"' WHERE rowid=\"._PAD_->rowid;\t\t//sink point: $objto;\n$res = mysql_query($query);\n}\n}\n\n", "id": 402, "slice_label": "bad", "file_name": "D:\\bad_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$db->begin();\n\t\t\t$db->commit();\n\t\t}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$db->begin();\n\t$db->commit();\n}\nif ($_GET[\"action\"] == 'switch')\n{\n\t$db->begin();\n\t$objfrom=new ModeleBoxes($db);\n\t$objfrom->fetch($_GET[\"switchfrom\"]);\n\t$objto=new ModeleBoxes($db);\n\t$objto->fetch($_GET[\"switchto\"]);\n\tif (is_object($objfrom) && is_object($objto))\n\t{\n$query = \"UPDATE \".MAIN_DB_PREFIX.\"boxes set box_order='\"._PAD_->box_order.\"' WHERE rowid=\".$objfrom->rowid;\t\t//sink point: $objfrom;\n$res = mysql_query($query);\n}\n}\n\n", "id": 403, "slice_label": "bad", "file_name": "D:\\bad_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$db->begin();\n\t\t\t$db->commit();\n\t\t}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$db->begin();\n\t$db->commit();\n}\nif ($_GET[\"action\"] == 'switch')\n{\n\t$db->begin();\n\t$objfrom=new ModeleBoxes($db);\n\t$objfrom->fetch($_GET[\"switchfrom\"]);\n\t$objto=new ModeleBoxes($db);\n\t$objto->fetch($_GET[\"switchto\"]);\n\tif (is_object($objfrom) && is_object($objto))\n\t{\n$query = \"UPDATE \".MAIN_DB_PREFIX.\"boxes set box_order='\"._PAD_->box_order.\"' WHERE rowid=\".$objto->rowid;\t\t//sink point: $objto;\n$res = mysql_query($query);\n}\n}\n\n", "id": 404, "slice_label": "bad", "file_name": "D:\\bad_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$db->begin();\n\t\t\t$db->commit();\n\t\t}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$db->begin();\n\t$db->commit();\n}\nif ($_GET[\"action\"] == 'switch')\n{\n\t$db->begin();\n\t$objfrom=new ModeleBoxes($db);\n\t$objfrom->fetch($_GET[\"switchfrom\"]);\n\t$objto=new ModeleBoxes($db);\n\t$objto->fetch($_GET[\"switchto\"]);\n\tif (is_object($objfrom) && is_object($objto))\n\t{\n$query = \"UPDATE \".MAIN_DB_PREFIX.\"boxes set box_order='\".$objfrom->box_order.\"' WHERE rowid=\"._PAD_->rowid;\t\t//sink point: $objfrom;\n$res = mysql_query($query);\n}\n}\n\n", "id": 405, "slice_label": "bad", "file_name": "D:\\bad_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$boxes = array();\nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$db->begin();\n\t\t\t$resql = $db->query($sql);\n\t\t\t$resql = $db->query($sql);\n\t\t\t$db->commit();\n\t\t}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$db->begin();\n\t$resql = $db->query($sql);\n\t$resql = $db->query($sql);\n\t$db->commit();\n}\nif ($_GET[\"action\"] == 'switch')\n{\n\t$db->begin();\n\t$objfrom=new ModeleBoxes($db);\n\t$objfrom->fetch($_GET[\"switchfrom\"]);\n\t$objto=new ModeleBoxes($db);\n\t$objto->fetch($_GET[\"switchto\"]);\n\tif (is_object($objfrom) && is_object($objto))\n\t{\n\t\t$resultupdatefrom = $db->query($sql);\n\t\t$resultupdateto = $db->query($sql);\n}\n\tif ($resultupdatefrom && $resultupdateto)\n\t{\n\t\t$db->commit();\n\t}\n\telse\n\t{\n\t\t$db->rollback();\n\t}\n}\n$resql = $db->query($sql);\nif ($resql)\n{\n\t$num = $db->num_rows($resql);\n\t$i = 0;\n\t$decalage=0;\n\twhile ($i < $num)\n\t{\n\t\t$obj = $db->fetch_object($resql);\n\t\t$boxes[$obj->position][$obj->box_id]=1;\n\t\tif ($decalage)\n\t\t{\n$query = \"UPDATE \".MAIN_DB_PREFIX.\"boxes set box_order=\"._PAD_.\" WHERE rowid=\".$obj->rowid;\t\t//sink point: $obj;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 406, "slice_label": "bad", "file_name": "D:\\bad_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$resql = $db->query($sql);\n\t\t\t$resql = $db->query($sql);\n}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$resql = $db->query($sql);\n\t$resql = $db->query($sql);\n}\n$resql = $db->query($sql);\nif ($resql)\n{\n\t$num = $db->num_rows($resql);\n\t$i = 0;\n\t$decalage=0;\n\twhile ($i < $num)\n\t{\n\t\tif ($decalage)\n\t\t{\n$query = \"UPDATE \".MAIN_DB_PREFIX.\"boxes set box_order=\".$decalage.\" WHERE rowid=\"._PAD_->rowid;\t\t//sink point: $decalage;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 407, "slice_label": "bad", "file_name": "D:\\bad_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$db->begin();\n\t\t\t$resql = $db->query($sql);\n\t\t\t$resql = $db->query($sql);\n\t\t\t$db->commit();\n\t\t}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$db->begin();\n\t$resql = $db->query($sql);\n\t$resql = $db->query($sql);\n\t$db->commit();\n}\nif ($_GET[\"action\"] == 'switch')\n{\n\t$db->begin();\n\t$objfrom=new ModeleBoxes($db);\n\t$objfrom->fetch($_GET[\"switchfrom\"]);\n\t$objto=new ModeleBoxes($db);\n\t$objto->fetch($_GET[\"switchto\"]);\n\tif (is_object($objfrom) && is_object($objto))\n\t{\n\t\t$resultupdatefrom = $db->query($sql);\n\t\t$resultupdateto = $db->query($sql);\n}\n\tif ($resultupdatefrom && $resultupdateto)\n\t{\n\t\t$db->commit();\n\t}\n\telse\n\t{\n\t\t$db->rollback();\n\t}\n}\n$resql = $db->query($sql);\nif ($resql)\n{\n\t$i = 0;\n\t$decalage=0;\n\twhile ($i < $num)\n\t{\n\t\tif ($decalage)\n\t\t{\n\t\t\t$db->query($sql);\n\t\t}\n}\n\tif ($decalage)\n\t{\n\t\t$result = $db->query($sql);\n\t\tif ($result)\n\t\t{\n\t\t\twhile ($record = $db->fetch_array($result))\n\t\t\t{\n\t\t\t\tif (dol_strlen($record['box_order']) == 1)\n\t\t\t\t{\n\t\t\t\t\tif (preg_match(\"/[13579]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n\t\t\t\t\t\t$box_order = \"A0\".$record['box_order'];\n$query = \"update llx_boxes set box_order = '\".$box_order.\"' where box_order = \"._PAD_;\t\t//sink point: $box_order;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n}\n\n", "id": 408, "slice_label": "bad", "file_name": "D:\\bad_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$db->begin();\n\t\t\t$resql = $db->query($sql);\n\t\t\t$resql = $db->query($sql);\n\t\t\t$db->commit();\n\t\t}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$db->begin();\n\t$resql = $db->query($sql);\n\t$resql = $db->query($sql);\n\t$db->commit();\n}\nif ($_GET[\"action\"] == 'switch')\n{\n\t$db->begin();\n\t$objfrom=new ModeleBoxes($db);\n\t$objfrom->fetch($_GET[\"switchfrom\"]);\n\t$objto=new ModeleBoxes($db);\n\t$objto->fetch($_GET[\"switchto\"]);\n\tif (is_object($objfrom) && is_object($objto))\n\t{\n\t\t$resultupdatefrom = $db->query($sql);\n\t\t$resultupdateto = $db->query($sql);\n}\n\tif ($resultupdatefrom && $resultupdateto)\n\t{\n\t\t$db->commit();\n\t}\n\telse\n\t{\n\t\t$db->rollback();\n\t}\n}\n$resql = $db->query($sql);\nif ($resql)\n{\n\t$i = 0;\n\t$decalage=0;\n\twhile ($i < $num)\n\t{\n\t\tif ($decalage)\n\t\t{\n\t\t\t$db->query($sql);\n\t\t}\n}\n\tif ($decalage)\n\t{\n\t\t$result = $db->query($sql);\n\t\tif ($result)\n\t\t{\n\t\t\twhile ($record = $db->fetch_array($result))\n\t\t\t{\n\t\t\t\tif (dol_strlen($record['box_order']) == 1)\n\t\t\t\t{\n\t\t\t\t\tif (preg_match(\"/[13579]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n$query = \"update llx_boxes set box_order = '\"._PAD_.\"' where box_order = \".$record['box_order'];\t\t//sink point: $record;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n}\n\n", "id": 409, "slice_label": "bad", "file_name": "D:\\bad_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$db->begin();\n\t\t\t$resql = $db->query($sql);\n\t\t\t$resql = $db->query($sql);\n\t\t\t$db->commit();\n\t\t}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$db->begin();\n\t$resql = $db->query($sql);\n\t$resql = $db->query($sql);\n\t$db->commit();\n}\nif ($_GET[\"action\"] == 'switch')\n{\n\t$db->begin();\n\t$objfrom=new ModeleBoxes($db);\n\t$objfrom->fetch($_GET[\"switchfrom\"]);\n\t$objto=new ModeleBoxes($db);\n\t$objto->fetch($_GET[\"switchto\"]);\n\tif (is_object($objfrom) && is_object($objto))\n\t{\n\t\t$resultupdatefrom = $db->query($sql);\n\t\t$resultupdateto = $db->query($sql);\n}\n\tif ($resultupdatefrom && $resultupdateto)\n\t{\n\t\t$db->commit();\n\t}\n\telse\n\t{\n\t\t$db->rollback();\n\t}\n}\n$resql = $db->query($sql);\nif ($resql)\n{\n\t$i = 0;\n\t$decalage=0;\n\twhile ($i < $num)\n\t{\n\t\tif ($decalage)\n\t\t{\n\t\t\t$db->query($sql);\n\t\t}\n}\n\tif ($decalage)\n\t{\n\t\t$result = $db->query($sql);\n\t\tif ($result)\n\t\t{\n\t\t\twhile ($record = $db->fetch_array($result))\n\t\t\t{\n\t\t\t\tif (dol_strlen($record['box_order']) == 1)\n\t\t\t\t{\n\t\t\t\t\tif (preg_match(\"/[13579]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n\t\t\t\t\t\t$box_order = \"A0\".$record['box_order'];\n}\nelse if (preg_match(\"/[02468]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n\t\t\t\t\t\t$box_order = \"B0\".$record['box_order'];\n$query = \"update llx_boxes set box_order = '\".$box_order.\"' where box_order = \"._PAD_;\t\t//sink point: $box_order;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n}\n\n", "id": 410, "slice_label": "bad", "file_name": "D:\\bad_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$db->begin();\n\t\t\t$resql = $db->query($sql);\n\t\t\t$resql = $db->query($sql);\n\t\t\t$db->commit();\n\t\t}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$db->begin();\n\t$resql = $db->query($sql);\n\t$resql = $db->query($sql);\n\t$db->commit();\n}\nif ($_GET[\"action\"] == 'switch')\n{\n\t$db->begin();\n\t$objfrom=new ModeleBoxes($db);\n\t$objfrom->fetch($_GET[\"switchfrom\"]);\n\t$objto=new ModeleBoxes($db);\n\t$objto->fetch($_GET[\"switchto\"]);\n\tif (is_object($objfrom) && is_object($objto))\n\t{\n\t\t$resultupdatefrom = $db->query($sql);\n\t\t$resultupdateto = $db->query($sql);\n}\n\tif ($resultupdatefrom && $resultupdateto)\n\t{\n\t\t$db->commit();\n\t}\n\telse\n\t{\n\t\t$db->rollback();\n\t}\n}\n$resql = $db->query($sql);\nif ($resql)\n{\n\t$i = 0;\n\t$decalage=0;\n\twhile ($i < $num)\n\t{\n\t\tif ($decalage)\n\t\t{\n\t\t\t$db->query($sql);\n\t\t}\n}\n\tif ($decalage)\n\t{\n\t\t$result = $db->query($sql);\n\t\tif ($result)\n\t\t{\n\t\t\twhile ($record = $db->fetch_array($result))\n\t\t\t{\n\t\t\t\tif (dol_strlen($record['box_order']) == 1)\n\t\t\t\t{\n\t\t\t\t\tif (preg_match(\"/[13579]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n}\nelse if (preg_match(\"/[02468]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n$query = \"update llx_boxes set box_order = '\"._PAD_.\"' where box_order = \".$record['box_order'];\t\t//sink point: $record;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n}\n\n", "id": 411, "slice_label": "bad", "file_name": "D:\\bad_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$db->begin();\n\t\t\t$resql = $db->query($sql);\n\t\t\t$resql = $db->query($sql);\n\t\t\t$db->commit();\n\t\t}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$db->begin();\n\t$resql = $db->query($sql);\n\t$resql = $db->query($sql);\n\t$db->commit();\n}\nif ($_GET[\"action\"] == 'switch')\n{\n\t$db->begin();\n\t$objfrom=new ModeleBoxes($db);\n\t$objfrom->fetch($_GET[\"switchfrom\"]);\n\t$objto=new ModeleBoxes($db);\n\t$objto->fetch($_GET[\"switchto\"]);\n\tif (is_object($objfrom) && is_object($objto))\n\t{\n\t\t$resultupdatefrom = $db->query($sql);\n\t\t$resultupdateto = $db->query($sql);\n}\n\tif ($resultupdatefrom && $resultupdateto)\n\t{\n\t\t$db->commit();\n\t}\n\telse\n\t{\n\t\t$db->rollback();\n\t}\n}\n$resql = $db->query($sql);\nif ($resql)\n{\n\t$i = 0;\n\t$decalage=0;\n\twhile ($i < $num)\n\t{\n\t\tif ($decalage)\n\t\t{\n\t\t\t$db->query($sql);\n\t\t}\n}\n\tif ($decalage)\n\t{\n\t\t$result = $db->query($sql);\n\t\tif ($result)\n\t\t{\n\t\t\twhile ($record = $db->fetch_array($result))\n\t\t\t{\n\t\t\t\tif (dol_strlen($record['box_order']) == 1)\n\t\t\t\t{\n\t\t\t\t\tif (preg_match(\"/[13579]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n\t\t\t\t\t\t$box_order = \"A0\".$record['box_order'];\n}\nelse if (preg_match(\"/[02468]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n\t\t\t\t\t\t$box_order = \"B0\".$record['box_order'];\n$query = \"update llx_boxes set box_order = '\".$box_order.\"' where box_order = \"._PAD_;\t\t//sink point: $box_order;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n}\n\n", "id": 412, "slice_label": "bad", "file_name": "D:\\bad_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$db->begin();\n\t\t\t$resql = $db->query($sql);\n\t\t\t$resql = $db->query($sql);\n\t\t\t$db->commit();\n\t\t}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$db->begin();\n\t$resql = $db->query($sql);\n\t$resql = $db->query($sql);\n\t$db->commit();\n}\nif ($_GET[\"action\"] == 'switch')\n{\n\t$db->begin();\n\t$objfrom=new ModeleBoxes($db);\n\t$objfrom->fetch($_GET[\"switchfrom\"]);\n\t$objto=new ModeleBoxes($db);\n\t$objto->fetch($_GET[\"switchto\"]);\n\tif (is_object($objfrom) && is_object($objto))\n\t{\n\t\t$resultupdatefrom = $db->query($sql);\n\t\t$resultupdateto = $db->query($sql);\n}\n\tif ($resultupdatefrom && $resultupdateto)\n\t{\n\t\t$db->commit();\n\t}\n\telse\n\t{\n\t\t$db->rollback();\n\t}\n}\n$resql = $db->query($sql);\nif ($resql)\n{\n\t$i = 0;\n\t$decalage=0;\n\twhile ($i < $num)\n\t{\n\t\tif ($decalage)\n\t\t{\n\t\t\t$db->query($sql);\n\t\t}\n}\n\tif ($decalage)\n\t{\n\t\t$result = $db->query($sql);\n\t\tif ($result)\n\t\t{\n\t\t\twhile ($record = $db->fetch_array($result))\n\t\t\t{\n\t\t\t\tif (dol_strlen($record['box_order']) == 1)\n\t\t\t\t{\n\t\t\t\t\tif (preg_match(\"/[13579]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n}\nelse if (preg_match(\"/[02468]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n$query = \"update llx_boxes set box_order = '\"._PAD_.\"' where box_order = \".$record['box_order'];\t\t//sink point: $record;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n}\n\n", "id": 413, "slice_label": "bad", "file_name": "D:\\bad_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$db->begin();\n\t\t\t$resql = $db->query($sql);\n\t\t\t$resql = $db->query($sql);\n\t\t\t$db->commit();\n\t\t}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$db->begin();\n\t$resql = $db->query($sql);\n\t$resql = $db->query($sql);\n\t$db->commit();\n}\nif ($_GET[\"action\"] == 'switch')\n{\n\t$db->begin();\n\t$objfrom=new ModeleBoxes($db);\n\t$objfrom->fetch($_GET[\"switchfrom\"]);\n\t$objto=new ModeleBoxes($db);\n\t$objto->fetch($_GET[\"switchto\"]);\n\tif (is_object($objfrom) && is_object($objto))\n\t{\n\t\t$resultupdatefrom = $db->query($sql);\n\t\t$resultupdateto = $db->query($sql);\n}\n\tif ($resultupdatefrom && $resultupdateto)\n\t{\n\t\t$db->commit();\n\t}\n\telse\n\t{\n\t\t$db->rollback();\n\t}\n}\n$resql = $db->query($sql);\nif ($resql)\n{\n\t$i = 0;\n\t$decalage=0;\n\twhile ($i < $num)\n\t{\n\t\tif ($decalage)\n\t\t{\n\t\t\t$db->query($sql);\n\t\t}\n}\n\tif ($decalage)\n\t{\n\t\t$result = $db->query($sql);\n\t\tif ($result)\n\t\t{\n\t\t\twhile ($record = $db->fetch_array($result))\n\t\t\t{\n\t\t\t\tif (dol_strlen($record['box_order']) == 1)\n\t\t\t\t{\n\t\t\t\t\tif (preg_match(\"/[13579]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n\t\t\t\t\t\t$box_order = \"A0\".$record['box_order'];\n}\nelse if (preg_match(\"/[02468]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n\t\t\t\t\t\t$box_order = \"B0\".$record['box_order'];\n}\n}\nelse if (dol_strlen($record['box_order']) == 2)\n\t\t\t\t{\n\t\t\t\t\tif (preg_match(\"/[13579]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n\t\t\t\t\t\t$box_order = \"A\".$record['box_order'];\n}\nelse if (preg_match(\"/[02468]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n\t\t\t\t\t\t$box_order = \"B\".$record['box_order'];\n$query = \"update llx_boxes set box_order = '\".$box_order.\"' where box_order = \"._PAD_;\t\t//sink point: $box_order;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n}\n\n", "id": 414, "slice_label": "bad", "file_name": "D:\\bad_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif ($_POST[\"action\"] == 'add')\n{\n\t$sql = \"SELECT rowid\";\n\t$sql.= \" FROM \".MAIN_DB_PREFIX.\"boxes\";\n\t$sql.= \" WHERE fk_user = 0\";\n\t$sql.= \" AND box_id = \".$_POST[\"boxid\"];\n\t$sql.= \" AND position = \".$_POST[\"pos\"];\n\t$resql = $db->query($sql);\n\tif ($resql)\n\t{\n\t\t$num = $db->num_rows($resql);\n\t\tif ($num == 0)\n\t\t{\n\t\t\t$db->begin();\n\t\t\t$resql = $db->query($sql);\n\t\t\t$resql = $db->query($sql);\n\t\t\t$db->commit();\n\t\t}\n}\n}\nif ($_GET[\"action\"] == 'delete')\n{\n\t$db->begin();\n\t$resql = $db->query($sql);\n\t$resql = $db->query($sql);\n\t$db->commit();\n}\nif ($_GET[\"action\"] == 'switch')\n{\n\t$db->begin();\n\t$objfrom=new ModeleBoxes($db);\n\t$objfrom->fetch($_GET[\"switchfrom\"]);\n\t$objto=new ModeleBoxes($db);\n\t$objto->fetch($_GET[\"switchto\"]);\n\tif (is_object($objfrom) && is_object($objto))\n\t{\n\t\t$resultupdatefrom = $db->query($sql);\n\t\t$resultupdateto = $db->query($sql);\n}\n\tif ($resultupdatefrom && $resultupdateto)\n\t{\n\t\t$db->commit();\n\t}\n\telse\n\t{\n\t\t$db->rollback();\n\t}\n}\n$resql = $db->query($sql);\nif ($resql)\n{\n\t$i = 0;\n\t$decalage=0;\n\twhile ($i < $num)\n\t{\n\t\tif ($decalage)\n\t\t{\n\t\t\t$db->query($sql);\n\t\t}\n}\n\tif ($decalage)\n\t{\n\t\t$result = $db->query($sql);\n\t\tif ($result)\n\t\t{\n\t\t\twhile ($record = $db->fetch_array($result))\n\t\t\t{\n\t\t\t\tif (dol_strlen($record['box_order']) == 1)\n\t\t\t\t{\n}\nelse if (dol_strlen($record['box_order']) == 2)\n\t\t\t\t{\n\t\t\t\t\tif (preg_match(\"/[13579]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n}\nelse if (preg_match(\"/[02468]{\n1}\n/\",substr($record['box_order'],-1)))\n\t\t\t\t\t{\n$query = \"update llx_boxes set box_order = '\"._PAD_.\"' where box_order = \".$record['box_order'];\t\t//sink point: $record;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n}\n\n", "id": 415, "slice_label": "bad", "file_name": "D:\\bad_3545_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$parent = $_GET['input0'];\n$include_first = $_GET['input1'];\n$content_type = $_GET['input2'];\n\n// php code: \n        $table = $db_categories = $this->tables['categories'];\n        if ($parent == false) {\n            $include_first = false;\n        }\n        $content_type = addslashes($content_type);\n        if ($content_type == false) {\n            if ($include_first == true) {\n}\nelse {\n$query = \"SELECT * FROM $table WHERE parent_id=_PAD_ AND data_type='category' AND is_deleted='n' \";\t\t//sink point: $table;\n$res = mysql_query($query);\n}\n}\n\n", "id": 416, "slice_label": "bad", "file_name": "D:\\bad_2379_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$parent = $_GET['input0'];\n$include_first = $_GET['input1'];\n$content_type = $_GET['input2'];\n\n// php code: \n        if ($parent == false) {\n            $parent = (0);\n            $include_first = false;\n        }\nelse {\n            $parent = (int)$parent;\n        }\n        $content_type = addslashes($content_type);\n        if ($content_type == false) {\n            if ($include_first == true) {\n}\nelse {\n$query = \"SELECT * FROM _PAD_ WHERE parent_id=$parent AND data_type='category' AND is_deleted='n' \";\t\t//sink point: $parent;\n$res = mysql_query($query);\n}\n}\n\n", "id": 417, "slice_label": "bad", "file_name": "D:\\bad_2379_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$parent = $_GET['input0'];\n$include_first = $_GET['input1'];\n$content_type = $_GET['input2'];\n\n// php code: \n        $table = $db_categories = $this->tables['categories'];\n        if ($parent == false) {\n            $include_first = false;\n        }\n        $content_type = addslashes($content_type);\n        if ($content_type == false) {\n}\nelse {\n            if ($include_first == true) {\n$query = \"SELECT * FROM $table WHERE id=_PAD_  AND is_deleted='n'  \";\t\t//sink point: $table;\n$res = mysql_query($query);\n}\n}\n\n", "id": 418, "slice_label": "bad", "file_name": "D:\\bad_2379_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$parent = $_GET['input0'];\n$include_first = $_GET['input1'];\n$content_type = $_GET['input2'];\n\n// php code: \n        if ($parent == false) {\n            $parent = (0);\n            $include_first = false;\n        }\nelse {\n            $parent = (int)$parent;\n        }\n        $content_type = addslashes($content_type);\n        if ($content_type == false) {\n}\nelse {\n            if ($include_first == true) {\n$query = \"SELECT * FROM _PAD_ WHERE id=$parent  AND is_deleted='n'  \";\t\t//sink point: $parent;\n$res = mysql_query($query);\n}\n}\n\n", "id": 419, "slice_label": "bad", "file_name": "D:\\bad_2379_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$parent = $_GET['input0'];\n$include_first = $_GET['input1'];\n$content_type = $_GET['input2'];\n\n// php code: \n        if ($parent == false) {\n            $include_first = false;\n        }\n        $content_type = addslashes($content_type);\n        if ($content_type == false) {\n}\nelse {\n            if ($include_first == true) {\n}\nelse {\n$query = \"SELECT * FROM _PAD_ WHERE parent_id=_PAD_ AND is_deleted='n' AND data_type='category' AND (categories_content_type='$content_type' OR categories_content_type='inherit';\t\t//sink point: $content_type;\n$res = mysql_query($query);\n}\n}\n\n", "id": 420, "slice_label": "bad", "file_name": "D:\\bad_2379_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$parent = $_GET['input0'];\n$include_first = $_GET['input1'];\n$content_type = $_GET['input2'];\n\n// php code: \n        $table = $db_categories = $this->tables['categories'];\n        if ($parent == false) {\n            $include_first = false;\n        }\n        $content_type = addslashes($content_type);\n        if ($content_type == false) {\n}\nelse {\n            if ($include_first == true) {\n}\nelse {\n$query = \"SELECT * FROM $table WHERE parent_id=_PAD_ AND is_deleted='n' AND data_type='category' AND (categories_content_type='_PAD_' OR categories_content_type='inherit';\t\t//sink point: $table;\n$res = mysql_query($query);\n}\n}\n\n", "id": 421, "slice_label": "bad", "file_name": "D:\\bad_2379_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$parent = $_GET['input0'];\n$include_first = $_GET['input1'];\n$content_type = $_GET['input2'];\n\n// php code: \n        if ($parent == false) {\n            $parent = (0);\n            $include_first = false;\n        }\nelse {\n            $parent = (int)$parent;\n        }\n        $content_type = addslashes($content_type);\n        if ($content_type == false) {\n}\nelse {\n            if ($include_first == true) {\n}\nelse {\n$query = \"SELECT * FROM _PAD_ WHERE parent_id=$parent AND is_deleted='n' AND data_type='category' AND (categories_content_type='_PAD_' OR categories_content_type='inherit';\t\t//sink point: $parent;\n$res = mysql_query($query);\n}\n}\n\n", "id": 422, "slice_label": "bad", "file_name": "D:\\bad_2379_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n\n// php code: \n\t \tif($_REQUEST['OnlyShow']) {\n\t \t\t$pageList = array();\n\t \t\tforeach($_REQUEST['OnlyShow'] as $section => $checked) {\n\t \t\t\t$items = explode(\",\", $section);\n\t \t\t\tforeach($items as $item) {\n\t \t\t\t\t$page = DataObject::get_one('SiteTree', \"\\\"URLSegment\\\" = '\" . Convert::raw2sql($item) . \"'\");\n\t \t\t\t\t$pageList[] = $page->ID;\n\t \t\t\t\t$page->loadDescendantIDListInto($pageList);\n\t \t\t\t}\n}\n$query = \"SELECT \\\"FileID\\\" FROM \\\"Page_ImageTracking\\\" WHERE \\\"PageID\\\" IN (\" . implode(\",\", $pageList) . \")\")->column(;\t\t//sink point: $pageList;\n$res = mysql_query($query);\n}\n\n", "id": 423, "slice_label": "bad", "file_name": "D:\\good_3551_8.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (($_REQUEST['event_id'] || !isset($_REQUEST['event_id'])) && !isset($_REQUEST[assignment_id])) {\n    if ($_REQUEST['event_id'] != 'new' && isset($_REQUEST['event_id'])) {\n$query = \"SELECT TITLE,DESCRIPTION,SCHOOL_DATE,CALENDAR_ID FROM calendar_events WHERE ID='$_REQUEST[event_id]'\");\t\t//sink point: $_REQUEST;\n$res = mysql_query($query);\n}\n}\n\n", "id": 424, "slice_label": "bad", "file_name": "D:\\bad_4024_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (($_REQUEST['event_id'] || !isset($_REQUEST['event_id'])) && !isset($_REQUEST[assignment_id])) {\n}\nelse {\n$query = 'SELECT TITLE,STAFF_ID,DATE_FORMAT(DUE_DATE,\\'%d-%b-%y\\') AS SCHOOL_DATE,ASSIGNED_DATE,DUE_DATE,DESCRIPTION FROM gradebook_assignments WHERE ASSIGNMENT_ID=\\'' . $_REQUEST[assignment_id] . '\\'');\t\t//sink point: $_REQUEST;\n$res = mysql_query($query);\n}\n\n", "id": 425, "slice_label": "bad", "file_name": "D:\\bad_4024_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$range = $_GET['input0'];\n\n// php code: \n        if (is_numeric($range)) {\n            $range = 'first';\n        }\n        if (strcasecmp($range, 'all') == 0) {\n}\nelse if (strcasecmp($range, 'revisions') == 0) {\n}\nelse if (strcasecmp($range, 'first') == 0) {\n}\nelse if (strcasecmp($range, 'bytitle') == 0) {\n}\nelse if (strcasecmp($range, 'count') == 0) {\n}\nelse if (strcasecmp($range, 'in') == 0) {\n}\nelse if (strcasecmp($range, 'bytag') == 0) {\n$query = 'SELECT DISTINCT m.id FROM ' . $db->prefix . _PAD_->tablename . ' m ';\t\t//sink point: $db;\n$res = mysql_query($query);\n}\n\n", "id": 426, "slice_label": "bad", "file_name": "D:\\bad_5327_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$range = $_GET['input0'];\n\n// php code: \n        if (is_numeric($range)) {\n            $range = 'first';\n        }\n        if (strcasecmp($range, 'all') == 0) {\n}\nelse if (strcasecmp($range, 'revisions') == 0) {\n}\nelse if (strcasecmp($range, 'first') == 0) {\n}\nelse if (strcasecmp($range, 'bytitle') == 0) {\n}\nelse if (strcasecmp($range, 'count') == 0) {\n}\nelse if (strcasecmp($range, 'in') == 0) {\n}\nelse if (strcasecmp($range, 'bytag') == 0) {\n$query = 'SELECT DISTINCT m.id FROM ' . _PAD_->prefix . $this->tablename . ' m ';\t\t//sink point: $this;\n$res = mysql_query($query);\n}\n\n", "id": 427, "slice_label": "bad", "file_name": "D:\\bad_5327_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$range = $_GET['input0'];\n\n// php code: \n        if (is_numeric($range)) {\n            $range = 'first';\n        }\n        if (strcasecmp($range, 'all') == 0) {\n}\nelse if (strcasecmp($range, 'revisions') == 0) {\n}\nelse if (strcasecmp($range, 'first') == 0) {\n}\nelse if (strcasecmp($range, 'bytitle') == 0) {\n}\nelse if (strcasecmp($range, 'count') == 0) {\n}\nelse if (strcasecmp($range, 'in') == 0) {\n}\nelse if (strcasecmp($range, 'bytag') == 0) {\n}\nelse if (strcasecmp($range, 'bycat') == 0) {\n$query = 'SELECT DISTINCT m.id FROM ' . $db->prefix . _PAD_->tablename . ' m ';\t\t//sink point: $db;\n$res = mysql_query($query);\n}\n\n", "id": 428, "slice_label": "bad", "file_name": "D:\\bad_5327_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$range = $_GET['input0'];\n\n// php code: \n        if (is_numeric($range)) {\n            $range = 'first';\n        }\n        if (strcasecmp($range, 'all') == 0) {\n}\nelse if (strcasecmp($range, 'revisions') == 0) {\n}\nelse if (strcasecmp($range, 'first') == 0) {\n}\nelse if (strcasecmp($range, 'bytitle') == 0) {\n}\nelse if (strcasecmp($range, 'count') == 0) {\n}\nelse if (strcasecmp($range, 'in') == 0) {\n}\nelse if (strcasecmp($range, 'bytag') == 0) {\n}\nelse if (strcasecmp($range, 'bycat') == 0) {\n$query = 'SELECT DISTINCT m.id FROM ' . _PAD_->prefix . $this->tablename . ' m ';\t\t//sink point: $this;\n$res = mysql_query($query);\n}\n\n", "id": 429, "slice_label": "bad", "file_name": "D:\\bad_5327_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$manipulation = $_GET['input0'];\n\n// php code: \n\t\t$tables = array_keys($manipulation);\n\t\tforeach($tables as $table) {\n\t\t\t$id = $manipulation[$table]['id'] ? $manipulation[$table]['id'] : $manipulation[$table]['fields']['ID'];\n;\n\t\t\tif(!isset($manipulation[$table]['fields']['Version'])) {\n$query = \"SELECT * FROM \\\"_PAD_\\\" WHERE \\\"ID\\\" = $id\")->record(;\t\t//sink point: $id;\n$res = mysql_query($query);\n}\n}\n\n", "id": 430, "slice_label": "bad", "file_name": "D:\\bad_3551_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$manipulation = $_GET['input0'];\n\n// php code: \n\t\t$tables = array_keys($manipulation);\n\t\tforeach($tables as $table) {\n\t\t\tif($this->migratingVersion) {\n\t\t\t\t$manipulation[$table]['fields']['Version'] = $this->migratingVersion;\n\t\t\t}\n\t\t\tif(!isset($manipulation[$table]['fields']['Version'])) {\n$query = \"SELECT * FROM \\\"$table\\\" WHERE \\\"ID\\\" = _PAD_\")->record(;\t\t//sink point: $table;\n$res = mysql_query($query);\n}\n}\n\n", "id": 431, "slice_label": "bad", "file_name": "D:\\bad_3551_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$class = $_GET['input0'];\n$stage = $_GET['input1'];\n\n// php code: \n\t\t$baseClass = ClassInfo::baseDataClass($class);\n\t\t$stageTable = ($stage == 'Stage') ? $baseClass : \"{\n$baseClass}\n_{\n$stage}\n\";\n$query = \"SELECT \\\"Version\\\" FROM \\\"$stageTable\\\" WHERE \\\"ID\\\" = _PAD_\")->value(;\t\t//sink point: $stageTable;\n$res = mysql_query($query);\n\n", "id": 432, "slice_label": "bad", "file_name": "D:\\bad_3551_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n\n// php code: \n$query = \"SELECT \\\"Version\\\" FROM \\\"_PAD_\\\" WHERE \\\"ID\\\" = $id\")->value(;\t\t//sink point: $id;\n$res = mysql_query($query);\n\n", "id": 433, "slice_label": "bad", "file_name": "D:\\bad_3551_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$class = $_GET['input0'];\n$stage = $_GET['input1'];\n\n// php code: \n\t\t$baseClass = ClassInfo::baseDataClass($class);\n\t\t$stageTable = ($stage == 'Stage') ? $baseClass : \"{\n$baseClass}\n_{\n$stage}\n\";\n$query = \"SELECT \\\"ID\\\", \\\"Version\\\" FROM \\\"$stageTable\\\" _PAD_\")->map(;\t\t//sink point: $stageTable;\n$res = mysql_query($query);\n\n", "id": 434, "slice_label": "bad", "file_name": "D:\\bad_3551_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$idList = $_GET['input0'];\n\n// php code: \n\t\t$filter = \"\";\n\t\tif($idList) {\n\t\t\t$filter = \"WHERE \\\"ID\\\" IN(\" .implode(\", \", $idList) . \")\";\n\t\t}\n$query = \"SELECT \\\"ID\\\", \\\"Version\\\" FROM \\\"_PAD_\\\" $filter\")->map(;\t\t//sink point: $filter;\n$res = mysql_query($query);\n\n", "id": 435, "slice_label": "bad", "file_name": "D:\\bad_3551_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n\n// php code: \n$query = \"SELECT MAX(ID)+1 FROM `$table`\")->value(;\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 436, "slice_label": "bad", "file_name": "D:\\good_3552_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$args = $_GET['input0'];\n\n// php code: \n\t\t$defaults = array(\n\t\t\t'per_page' => 10,\n\t\t\t'paged'    => 1\n\t\t);\n\t\t$args     = wp_parse_args( $args, $defaults );\n$query = \"SELECT `pages`.`uri`,`pages`.`id`,`pages`.`type`, SUM(`pages`.`count`) + IFNULL(`historical`.`value`, 0) AS `count_sum` FROM `\" . DB::table( 'pages' ) . \"` `pages` LEFT JOIN `\" . DB::table( 'historical' ) . \"` `historical` ON `pages`.`uri`=`historical`.`uri` AND `historical`.`category`='uri' GROUP BY `uri` ORDER BY `count_sum` DESC LIMIT \" . ( $args['paged'] - 1 ) * $args['per_page'] . \",\" . $args['per_page'];\t\t//sink point: $args;\n$res = mysql_query($query);\n\n", "id": 437, "slice_label": "bad", "file_name": "D:\\bad_921_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$args = $_GET['input0'];\n\n// php code: \n\t\t$defaults = array(\n\t\t\t'per_page' => 10,\n\t\t\t'paged'    => 1\n\t\t);\n\t\t$args     = wp_parse_args( $args, $defaults );\n$query = \"SELECT `pages`.`uri`,`pages`.`id`,`pages`.`type`, SUM(`pages`.`count`) + IFNULL(`historical`.`value`, 0) AS `count_sum` FROM `\" . DB::table( 'pages' ) . \"` `pages` LEFT JOIN `\" . DB::table( 'historical' ) . \"` `historical` ON `pages`.`uri`=`historical`.`uri` AND `historical`.`category`='uri' GROUP BY `uri` ORDER BY `count_sum` DESC LIMIT \" . ( $args['paged'] - 1 ) * $args['per_page'] . \",\" . $args['per_page'];\t\t//sink point: $args;\n$res = mysql_query($query);\n\n", "id": 438, "slice_label": "bad", "file_name": "D:\\good_921_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n\n// php code: \n\t \tif($_REQUEST['OnlyShow']) {\n\t \t\t$pageList = array();\n\t \t\tforeach($_REQUEST['OnlyShow'] as $section => $checked) {\n\t \t\t\t$items = explode(\",\", $section);\n\t \t\t\tforeach($items as $item) {\n\t \t\t\t\t$page = DataObject::get_one('SiteTree', \"\\\"URLSegment\\\" = '\" . DB::getConn()->addslashes($item) . \"'\");\n\t \t\t\t\t$pageList[] = $page->ID;\n\t \t\t\t\t$page->loadDescendantIDListInto($pageList);\n\t \t\t\t}\n}\n$query = \"SELECT \\\"FileID\\\" FROM \\\"Page_ImageTracking\\\" WHERE \\\"PageID\\\" IN (\" . implode(\",\", $pageList) . \")\")->column(;\t\t//sink point: $pageList;\n$res = mysql_query($query);\n}\n\n", "id": 439, "slice_label": "bad", "file_name": "D:\\bad_3551_8.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (\n    filter_var($_GET['code'], FILTER_SANITIZE_STRING) != \"\"\n    && filter_var($_GET['item_id'], FILTER_SANITIZE_STRING) >= 0\n    && filter_var($_GET['stamp'], FILTER_SANITIZE_STRING) >= 0\n    && filter_var($_GET['otv_id'], FILTER_SANITIZE_STRING) >= 0\n) {\n    $db = new SplClassLoader('Database\\Core', '../includes/libraries');\n    $db->register();\n    $db = new Database\\Core\\DbCore($server, $user, $pass, $database, $pre);\n    $db->connect();\n    $data = $db->queryGetRow(\n        \"otv\",\n        array(\n            \"timestamp\",\n            \"code\",\n            \"item_id\"\n        ),\n        array(\n            \"id\" => intval($_GET['otv_id'])\n        )\n    );\n    if (\n        $data[0] == $_GET['stamp']\n        && $data[1] == $_GET['code']\n        && $data[2] == $_GET['item_id']\n    ) {\n        if ($data[0] < (time() - $k['otv_expiration_period']) ) {\n}\nelse {\n$query = 'SELECT rand_key FROM `'.$pre.'keys` WHERE `table` LIKE \"items\" AND `id` ='.intval(_PAD_);\t\t//sink point: $pre;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 440, "slice_label": "bad", "file_name": "D:\\good_2178_8.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (\n    filter_var($_GET['code'], FILTER_SANITIZE_STRING) != \"\"\n    && filter_var($_GET['item_id'], FILTER_SANITIZE_STRING) >= 0\n    && filter_var($_GET['stamp'], FILTER_SANITIZE_STRING) >= 0\n    && filter_var($_GET['otv_id'], FILTER_SANITIZE_STRING) >= 0\n) {\n    $db = new SplClassLoader('Database\\Core', '../includes/libraries');\n    $db->register();\n    $db = new Database\\Core\\DbCore($server, $user, $pass, $database, $pre);\n    $db->connect();\n    $data = $db->queryGetRow(\n        \"otv\",\n        array(\n            \"timestamp\",\n            \"code\",\n            \"item_id\"\n        ),\n        array(\n            \"id\" => intval($_GET['otv_id'])\n        )\n    );\n    if (\n        $data[0] == $_GET['stamp']\n        && $data[1] == $_GET['code']\n        && $data[2] == $_GET['item_id']\n    ) {\n        if ($data[0] < (time() - $k['otv_expiration_period']) ) {\n}\nelse {\n$query = 'SELECT rand_key FROM `'._PAD_.'keys` WHERE `table` LIKE \"items\" AND `id` ='.intval($_GET['item_id']);\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 441, "slice_label": "bad", "file_name": "D:\\good_2178_8.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n\n// php code: \n\t\t$interval = (isset($_GET[\"i\"]) AND ! empty($_GET[\"i\"]))\n\t\t    ? $_GET[\"i\"]\n\t\t    : \"month\";\n\t\t$select_date_text = \"DATE_FORMAT(incident_date, '%Y-%m-01')\";\n\t\tif ($interval == 'day')\n\t\t{\n\t\t\t$select_date_text = \"DATE_FORMAT(incident_date, '%Y-%m-%d')\";\n}\nelse if ($interval == 'hour')\n\t\t{\n\t\t\t$select_date_text = \"DATE_FORMAT(incident_date, '%Y-%m-%d %H:%M')\";\n}\nelse if ($interval == 'week')\n\t\t{\n\t\t\t$select_date_text = \"STR_TO_DATE(CONCAT(CAST(YEARWEEK(incident_date) AS CHAR), ' Sunday'), '%X%V %W')\";\n}\n$query = 'SELECT UNIX_TIMESTAMP('.$select_date_text.') AS time, COUNT(id;\t\t//sink point: $select_date_text;\n$res = mysql_query($query);\n\t\t    . 'FROM '.$this->table_prefix.'incident '\n\t\t    . 'WHERE incident_active = 1 '.$incident_id_in.' '\n\t\t    . 'GROUP BY '.$groupby_date_text;\n\n", "id": 442, "slice_label": "bad", "file_name": "D:\\good_3701_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n\n// php code: \n$query = \"SELECT MAX(ID)+1 FROM `$table`\")->value(;\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 443, "slice_label": "bad", "file_name": "D:\\bad_3552_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$query = \"SELECT * FROM `session` WHERE session_id = '\"._PAD_->escape($_GET[\"session_id\"]).\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 444, "slice_label": "bad", "file_name": "D:\\good_2179_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n$query = \"SELECT * FROM `session` WHERE session_id = '\".$pearDB->escape(_PAD_).\"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n\n", "id": 445, "slice_label": "bad", "file_name": "D:\\good_2179_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]){\n$query = \"SELECT user_id FROM session where session_id = '\"._PAD_->escape($_GET[\"sid\"]).\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 446, "slice_label": "bad", "file_name": "D:\\good_2179_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB \t= new CentreonDB();\n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]){\n$query = \"SELECT user_id FROM session where session_id = '\".$pearDB->escape(_PAD_).\"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n}\n\n", "id": 447, "slice_label": "bad", "file_name": "D:\\good_2179_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB \t= new CentreonDB();\n\t$is_admin = isUserAdmin($_GET[\"sid\"]);\n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]){\n\t\t$DBRESULT = $pearDB->query(\"SELECT user_id FROM session where session_id = '\".$pearDB->escape($_GET[\"sid\"]).\"'\");\n\t\t$session = $DBRESULT->fetchRow();\n\t\t$access = new CentreonAcl($session[\"user_id\"], $is_admin);\n}\n\t$normal_mode = 1;\n\t$type = \"root\";\n\tif (strlen($url_var) > 1){\n\t\t$type = substr($url_var, 0, 2);\n}\n\tif ($normal_mode){\n\t\tif ($type == \"HG\") {\n}\nelse if ($type == \"ST\") {\n}\nelse if ($type == \"HH\") {\n}\nelse if ($type == \"HS\") {\n}\nelse if ($type == \"HO\") {\n}\nelse if ($type == \"RS\") {\n}\nelse if ($type == \"RR\") {\n$query = \"SELECT hg_id, hg_name FROM hostgroup WHERE hg_id IN (SELECT hostgroup_hg_id FROM hostgroup_relation \".$access->queryBuilder(\"WHERE\", \"host_host_id\", _PAD_).\") ORDER BY `hg_name`\";\t\t//sink point: $access;\n$res = mysql_query($query);\n}\n}\n\n", "id": 448, "slice_label": "bad", "file_name": "D:\\good_2179_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB \t= new CentreonDB();\n\t$pearDBndo \t= new CentreonDB(\"ndo\");\n\t$is_admin = isUserAdmin($_GET[\"sid\"]);\n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]){\n\t\t$DBRESULT = $pearDB->query(\"SELECT user_id FROM session where session_id = '\".$pearDB->escape($_GET[\"sid\"]).\"'\");\n\t\t$session = $DBRESULT->fetchRow();\n\t\t$access = new CentreonAcl($session[\"user_id\"], $is_admin);\n\t\t$hoststr = $access->getHostsString(\"ID\", $pearDBndo);\n}\n\t$normal_mode = 1;\n\t$type = \"root\";\n\tif (strlen($url_var) > 1){\n\t\t$type = substr($url_var, 0, 2);\n}\n\tif ($normal_mode){\n\t\tif ($type == \"HG\") {\n}\nelse if ($type == \"ST\") {\n}\nelse if ($type == \"HH\") {\n}\nelse if ($type == \"HS\") {\n}\nelse if ($type == \"HO\") {\n}\nelse if ($type == \"RS\") {\n}\nelse if ($type == \"RR\") {\n$query = \"SELECT hg_id, hg_name FROM hostgroup WHERE hg_id IN (SELECT hostgroup_hg_id FROM hostgroup_relation \"._PAD_->queryBuilder(\"WHERE\", \"host_host_id\", $hoststr).\") ORDER BY `hg_name`\";\t\t//sink point: $hoststr;\n$res = mysql_query($query);\n}\n}\n\n", "id": 449, "slice_label": "bad", "file_name": "D:\\good_2179_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"o\"]) && $_GET[\"o\"] == \"r\"){\n$query = \"UPDATE session SET update_acl = '1' WHERE session_id = '\"._PAD_->escape($_GET[\"session_id\"]).\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 450, "slice_label": "bad", "file_name": "D:\\good_2179_10.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"o\"]) && $_GET[\"o\"] == \"r\"){\n$query = \"UPDATE session SET update_acl = '1' WHERE session_id = '\".$pearDB->escape(_PAD_).\"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n}\n\n", "id": 451, "slice_label": "bad", "file_name": "D:\\good_2179_10.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"o\"]) && $_GET[\"o\"] == \"r\"){\n\t\t$pearDB->query(\"UPDATE session SET update_acl = '1' WHERE session_id = '\".$pearDB->escape($_GET[\"session_id\"]).\"'\");\n\t\t$pearDB->query(\"UPDATE acl_resources SET changed = '1'\");\n}\nelse if (isset($_POST[\"o\"]) && $_POST[\"o\"] == \"u\") {\n\t\t$pearDB->query(\"UPDATE acl_resources SET changed = '1'\");\n\t\t$query0 = \"UPDATE session SET update_acl = '1' WHERE user_id IN (\";\n\t\t$i = 0;\n\t\tif (isset($sel))\n\t\t\tforeach ($sel as $key => $val) {\n\t\t\t\tif ($i)\n\t\t\t\t\t$query0 .= \", \";\n\t\t\t\t$query0 .= \"'\".$key.\"'\";\n}\n\t\tif (!$i) {\n\t\t\t$query0 .= \"'')\";\n\t\t}\nelse {\n\t\t\t$query0 .= \")\";\n\t\t}\n\t\t$pearDB->query($query0);\n}\n\t$res = $pearDB->query(\"SELECT DISTINCT * FROM session\");\n\twhile ($r = $res->fetchRow()){\n$query = \"SELECT contact_name, contact_admin FROM contact WHERE contact_id = '\".$r[\"user_id\"].\"'\";\t\t//sink point: $r;\n$res = mysql_query($query);\n}\n\n", "id": 452, "slice_label": "bad", "file_name": "D:\\good_2179_10.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"o\"]) && $_GET[\"o\"] == \"r\"){\n\t\t$pearDB->query(\"UPDATE session SET update_acl = '1' WHERE session_id = '\".$pearDB->escape($_GET[\"session_id\"]).\"'\");\n\t\t$pearDB->query(\"UPDATE acl_resources SET changed = '1'\");\n}\nelse if (isset($_POST[\"o\"]) && $_POST[\"o\"] == \"u\") {\n\t\t$pearDB->query(\"UPDATE acl_resources SET changed = '1'\");\n\t\t$query0 = \"UPDATE session SET update_acl = '1' WHERE user_id IN (\";\n\t\t$i = 0;\n\t\tif (isset($sel))\n\t\t\tforeach ($sel as $key => $val) {\n\t\t\t\tif ($i)\n\t\t\t\t\t$query0 .= \", \";\n\t\t\t\t$query0 .= \"'\".$key.\"'\";\n}\n\t\tif (!$i) {\n\t\t\t$query0 .= \"'')\";\n\t\t}\nelse {\n\t\t\t$query0 .= \")\";\n\t\t}\n\t\t$pearDB->query($query0);\n}\n\t$res = $pearDB->query(\"SELECT DISTINCT * FROM session\");\n\twhile ($r = $res->fetchRow()){\n\t\t$resUser = $pearDB->query(\"SELECT contact_name, contact_admin FROM contact WHERE contact_id = '\".$r[\"user_id\"].\"'\");\n\t\t$rU = $resUser->fetchRow();\n\t\tif ($rU[\"contact_admin\"] != \"1\") {\n$query = \"SELECT topology_name, topology_icone, topology_page, topology_url_opt FROM topology WHERE topology_page = '\".$r[\"current_page\"].\"'\";\t\t//sink point: $r;\n$res = mysql_query($query);\n}\n}\n\n", "id": 453, "slice_label": "bad", "file_name": "D:\\good_2179_10.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$mobileid = $_GET['input0'];\n\n// php code: \n\t\tif ( ! User_Devices_Model::device_registered($mobileid))\n\t\t{\n$query = 'SELECT id FROM `'.$this->table_prefix.'users` WHERE `email` = ? LIMIT 1;';\t\t//sink point: $this;\n$res = mysql_query($query);\n}\n\n", "id": 454, "slice_label": "bad", "file_name": "D:\\good_3703_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"session_id\"])) {\n$query = \"SELECT * FROM session WHERE session_id = '\"._PAD_->escape($_GET[\"session_id\"]).\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 455, "slice_label": "bad", "file_name": "D:\\good_2179_11.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n\tif (isset($_GET[\"session_id\"])) {\n$query = \"SELECT * FROM session WHERE session_id = '\".$pearDB->escape(_PAD_).\"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n}\n\n", "id": 456, "slice_label": "bad", "file_name": "D:\\good_2179_11.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$dir = $_GET['input0'];\n\n// php code: \n$query = \"SELECT dir_id FROM view_img_dir WHERE dir_alias = '\".$dir.\"'\";\t\t//sink point: $dir;\n$res = mysql_query($query);\n\n", "id": 457, "slice_label": "bad", "file_name": "D:\\good_2179_11.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$dir = $_GET['input0'];\n$pearDB = $_GET['input1'];\n\n// php code: \n \t\t$DBRESULT = $pearDB->query(\"SELECT dir_id FROM view_img_dir WHERE dir_alias = '\".$dir.\"'\");\n \t\tif (!$DBRESULT->numRows()) {\n$query = \"INSERT INTO view_img_dir (`dir_name`, `dir_alias`) VALUES ('\".$dir.\"', '\".$dir.\"')\";\t\t//sink point: $dir;\n$res = mysql_query($query);\n}\n\n", "id": 458, "slice_label": "bad", "file_name": "D:\\good_2179_11.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$dir = $_GET['input0'];\n\n// php code: \n$query = \"SELECT dir_id FROM view_img_dir WHERE dir_alias = '\".$dir.\"'\";\t\t//sink point: $dir;\n$res = mysql_query($query);\n\n", "id": 459, "slice_label": "bad", "file_name": "D:\\good_2179_11.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$picture = $_GET['input0'];\n$dir_id = $_GET['input1'];\n$pearDB = $_GET['input2'];\n\n// php code: \n\t\t$img_info = pathinfo($picture);\n        if (!isset($img_info[\"filename\"])) {\n\t\t    $img_parts = explode(\".\", $img_info[\"basename\"]);\n            $img_info[\"filename\"] = $img_parts[0];\n        }\n\t\tif ($img_info[\"extension\"] == 'gd2' && !is_file($img_info[\"filename\"] . \".png\") ) {\n\t\t\t$picture = $img_info[\"filename\"] . \".png\";\n}\n \t\t$DBRESULT = $pearDB->query(\"SELECT img_id \" .\n \t\t\t\t\t\t\t\t\t\"FROM view_img, view_img_dir_relation vidh \" .\n \t\t\t\t\t\t\t\t\t\"WHERE img_path = '\".$picture.\"' \" .\n \t\t\t\t\t\t\t\t\t\"\tAND vidh.dir_dir_parent_id = '\".$dir_id.\"'\" .\n \t\t\t\t\t\t\t\t\t\"\tAND vidh.img_img_id = img_id\");\n \t\tif (!$DBRESULT->numRows()) {\n$query = \"INSERT INTO view_img (`img_name`, `img_path`) VALUES ('\"._PAD_.\"', '\".$picture.\"')\";\t\t//sink point: $picture;\n$res = mysql_query($query);\n}\n\n", "id": 460, "slice_label": "bad", "file_name": "D:\\good_2179_11.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$picture = $_GET['input0'];\n$dir_id = $_GET['input1'];\n$pearDB = $_GET['input2'];\n\n// php code: \n\t\t$img_info = pathinfo($picture);\n        if (!isset($img_info[\"filename\"])) {\n\t\t    $img_parts = explode(\".\", $img_info[\"basename\"]);\n            $img_info[\"filename\"] = $img_parts[0];\n        }\n \t\t$DBRESULT = $pearDB->query(\"SELECT img_id \" .\n \t\t\t\t\t\t\t\t\t\"FROM view_img, view_img_dir_relation vidh \" .\n \t\t\t\t\t\t\t\t\t\"WHERE img_path = '\".$picture.\"' \" .\n \t\t\t\t\t\t\t\t\t\"\tAND vidh.dir_dir_parent_id = '\".$dir_id.\"'\" .\n \t\t\t\t\t\t\t\t\t\"\tAND vidh.img_img_id = img_id\");\n \t\tif (!$DBRESULT->numRows()) {\n$query = \"INSERT INTO view_img (`img_name`, `img_path`) VALUES ('\".$img_info[\"filename\"].\"', '\"._PAD_.\"')\";\t\t//sink point: $img_info;\n$res = mysql_query($query);\n}\n\n", "id": 461, "slice_label": "bad", "file_name": "D:\\good_2179_11.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$picture = $_GET['input0'];\n$dir_id = $_GET['input1'];\n$pearDB = $_GET['input2'];\n\n// php code: \n\t\t$img_info = pathinfo($picture);\n        if (!isset($img_info[\"filename\"])) {\n\t\t    $img_parts = explode(\".\", $img_info[\"basename\"]);\n            $img_info[\"filename\"] = $img_parts[0];\n        }\n\t\tif ($img_info[\"extension\"] == 'gd2' && !is_file($img_info[\"filename\"] . \".png\") ) {\n\t\t\t$picture = $img_info[\"filename\"] . \".png\";\n}\n \t\t$DBRESULT = $pearDB->query(\"SELECT img_id \" .\n \t\t\t\t\t\t\t\t\t\"FROM view_img, view_img_dir_relation vidh \" .\n \t\t\t\t\t\t\t\t\t\"WHERE img_path = '\".$picture.\"' \" .\n \t\t\t\t\t\t\t\t\t\"\tAND vidh.dir_dir_parent_id = '\".$dir_id.\"'\" .\n \t\t\t\t\t\t\t\t\t\"\tAND vidh.img_img_id = img_id\");\n \t\tif (!$DBRESULT->numRows()) {\n$query = \"SELECT img_id FROM view_img WHERE `img_name` = '\"._PAD_.\"' AND `img_path` = '\".$picture.\"'\";\t\t//sink point: $picture;\n$res = mysql_query($query);\n}\n\n", "id": 462, "slice_label": "bad", "file_name": "D:\\good_2179_11.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$picture = $_GET['input0'];\n$dir_id = $_GET['input1'];\n$pearDB = $_GET['input2'];\n\n// php code: \n\t\t$img_info = pathinfo($picture);\n        if (!isset($img_info[\"filename\"])) {\n\t\t    $img_parts = explode(\".\", $img_info[\"basename\"]);\n            $img_info[\"filename\"] = $img_parts[0];\n        }\n \t\t$DBRESULT = $pearDB->query(\"SELECT img_id \" .\n \t\t\t\t\t\t\t\t\t\"FROM view_img, view_img_dir_relation vidh \" .\n \t\t\t\t\t\t\t\t\t\"WHERE img_path = '\".$picture.\"' \" .\n \t\t\t\t\t\t\t\t\t\"\tAND vidh.dir_dir_parent_id = '\".$dir_id.\"'\" .\n \t\t\t\t\t\t\t\t\t\"\tAND vidh.img_img_id = img_id\");\n \t\tif (!$DBRESULT->numRows()) {\n$query = \"SELECT img_id FROM view_img WHERE `img_name` = '\".$img_info[\"filename\"].\"' AND `img_path` = '\"._PAD_.\"'\";\t\t//sink point: $img_info;\n$res = mysql_query($query);\n}\n\n", "id": 463, "slice_label": "bad", "file_name": "D:\\good_2179_11.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$picture = $_GET['input0'];\n$dir_id = $_GET['input1'];\n$pearDB = $_GET['input2'];\n\n// php code: \n\t\t$img_info = pathinfo($picture);\n        if (!isset($img_info[\"filename\"])) {\n\t\t    $img_parts = explode(\".\", $img_info[\"basename\"]);\n            $img_info[\"filename\"] = $img_parts[0];\n        }\n\t\tif ($img_info[\"extension\"] == 'gd2' && !is_file($img_info[\"filename\"] . \".png\") ) {\n\t\t\t$picture = $img_info[\"filename\"] . \".png\";\n}\n \t\t$DBRESULT = $pearDB->query(\"SELECT img_id \" .\n \t\t\t\t\t\t\t\t\t\"FROM view_img, view_img_dir_relation vidh \" .\n \t\t\t\t\t\t\t\t\t\"WHERE img_path = '\".$picture.\"' \" .\n \t\t\t\t\t\t\t\t\t\"\tAND vidh.dir_dir_parent_id = '\".$dir_id.\"'\" .\n \t\t\t\t\t\t\t\t\t\"\tAND vidh.img_img_id = img_id\");\n \t\tif (!$DBRESULT->numRows()) {\n$query = \"INSERT INTO view_img_dir_relation (`dir_dir_parent_id`, `img_img_id`) VALUES ('\".$dir_id.\"', '\"._PAD_.\"')\";\t\t//sink point: $dir_id;\n$res = mysql_query($query);\n}\n\n", "id": 464, "slice_label": "bad", "file_name": "D:\\good_2179_11.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$picture = $_GET['input0'];\n$dir_id = $_GET['input1'];\n$pearDB = $_GET['input2'];\n\n// php code: \n\t\t$img_info = pathinfo($picture);\n        if (!isset($img_info[\"filename\"])) {\n\t\t    $img_parts = explode(\".\", $img_info[\"basename\"]);\n            $img_info[\"filename\"] = $img_parts[0];\n        }\n\t\tif ($img_info[\"extension\"] == 'gd2' && !is_file($img_info[\"filename\"] . \".png\") ) {\n\t\t\t$picture = $img_info[\"filename\"] . \".png\";\n}\n \t\t$DBRESULT = $pearDB->query(\"SELECT img_id \" .\n \t\t\t\t\t\t\t\t\t\"FROM view_img, view_img_dir_relation vidh \" .\n \t\t\t\t\t\t\t\t\t\"WHERE img_path = '\".$picture.\"' \" .\n \t\t\t\t\t\t\t\t\t\"\tAND vidh.dir_dir_parent_id = '\".$dir_id.\"'\" .\n \t\t\t\t\t\t\t\t\t\"\tAND vidh.img_img_id = img_id\");\n \t\tif (!$DBRESULT->numRows()) {\n \t\t\t$data = $DBRESULT->fetchRow();\n$query = \"INSERT INTO view_img_dir_relation (`dir_dir_parent_id`, `img_img_id`) VALUES ('\"._PAD_.\"', '\".$data['img_id'].\"')\";\t\t//sink point: $data;\n$res = mysql_query($query);\n}\n\n", "id": 465, "slice_label": "bad", "file_name": "D:\\good_2179_11.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"o\"]) && $_GET[\"o\"] == \"k\"){\n\t\t$pearDB->query(\"DELETE FROM session WHERE session_id = '\".$pearDB->escape($_GET[\"session_id\"]).\"'\");\n}\n\t$res = $pearDB->query(\"SELECT session.*, contact_name, contact_admin FROM session, contact WHERE contact_id = user_id ORDER BY contact_name, contact_admin\");\n\tfor ($cpt = 0;$r = $res->fetchRow();$cpt++){\n$query = \"SELECT topology_name, topology_icone, topology_page, topology_url_opt FROM topology WHERE topology_page = '\".$r[\"current_page\"].\"'\";\t\t//sink point: $r;\n$res = mysql_query($query);\n}\n\n", "id": 466, "slice_label": "bad", "file_name": "D:\\good_2179_12.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]){\n$query = \"SELECT user_id FROM session where session_id = '\"._PAD_->escape($_GET[\"sid\"]).\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 467, "slice_label": "bad", "file_name": "D:\\good_2179_13.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB \t= new CentreonDB();\n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]){\n$query = \"SELECT user_id FROM session where session_id = '\".$pearDB->escape(_PAD_).\"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n}\n\n", "id": 468, "slice_label": "bad", "file_name": "D:\\good_2179_13.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB \t= new CentreonDB();\n\t$is_admin = isUserAdmin($_GET[\"sid\"]);\n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]){\n\t\t$DBRESULT = $pearDB->query(\"SELECT user_id FROM session where session_id = '\".$pearDB->escape($_GET[\"sid\"]).\"'\");\n\t\t$session = $DBRESULT->fetchRow();\n\t\t$access = new CentreonAcl($session[\"user_id\"], $is_admin);\n}\n\t$normal_mode = 1;\n\t$type = \"root\";\n\tif (strlen($url_var) > 1){\n\t\t$type = substr($url_var, 0, 2);\n}\n\tif ($normal_mode){\n\t\tif ($type == \"HG\") {\n}\nelse if ($type == \"ST\") {\n}\nelse if ($type == \"HH\") {\n}\nelse if ($type == \"HS\") {\n}\nelse if ($type == \"HO\") {\n}\nelse if ($type == \"RS\") {\n}\nelse if ($type == \"MT\") {\n\t\t\tif ($is_admin)\n;\n$query = \"SELECT * FROM meta_service WHERE `meta_activate` = '1' AND `meta_id` IN (\".$access->getMetaServiceString().\") ORDER BY `meta_name`\";\t\t//sink point: $access;\n$res = mysql_query($query);\n}\n}\n\n", "id": 469, "slice_label": "bad", "file_name": "D:\\good_2179_13.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$query = \"SELECT * FROM `session` WHERE session_id = '\".$_GET[\"session_id\"].\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 470, "slice_label": "bad", "file_name": "D:\\bad_2179_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"index_id\"]) && $_GET[\"index_id\"] != 0) {\n$query = \"SELECT metric_id, metric_name FROM metrics as ms, index_data as ixd WHERE ms.index_id = ixd.id and ms.index_id='\"._PAD_->escape($_GET[\"index_id\"]).\"';\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 471, "slice_label": "bad", "file_name": "D:\\good_2179_14.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n\tif (isset($_GET[\"index_id\"]) && $_GET[\"index_id\"] != 0) {\n$query = \"SELECT metric_id, metric_name FROM metrics as ms, index_data as ixd WHERE ms.index_id = ixd.id and ms.index_id='\".$pearDB->escape(_PAD_).\"';\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n}\n\n", "id": 472, "slice_label": "bad", "file_name": "D:\\good_2179_14.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$where = \"\";\n\tif (isset($_GET[\"vdef\"]) && $_GET[\"vdef\"] == 0)\n\t\t$where = \" AND def_type='\".$_GET[\"vdef\"].\"'\";\n\tif (isset($_GET[\"index_id\"]) && $_GET[\"index_id\"] != 0) {\n$query = \"SELECT vmetric_id, vmetric_name, def_type FROM virtual_metrics WHERE index_id='\"._PAD_->escape(_PAD_).\"'\".$where.\";\";\t\t//sink point: $where;\n$res = mysql_query($query);\n}\n\n", "id": 473, "slice_label": "bad", "file_name": "D:\\good_2179_14.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"index_id\"]) && $_GET[\"index_id\"] != 0) {\n$query = \"SELECT vmetric_id, vmetric_name, def_type FROM virtual_metrics WHERE index_id='\"._PAD_->escape($_GET[\"index_id\"]).\"'\"._PAD_.\";\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 474, "slice_label": "bad", "file_name": "D:\\good_2179_14.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n\tif (isset($_GET[\"index_id\"]) && $_GET[\"index_id\"] != 0) {\n$query = \"SELECT vmetric_id, vmetric_name, def_type FROM virtual_metrics WHERE index_id='\".$pearDB->escape(_PAD_).\"'\"._PAD_.\";\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n}\n\n", "id": 475, "slice_label": "bad", "file_name": "D:\\good_2179_14.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]){\n$query = \"SELECT user_id FROM session where session_id = '\".$_GET[\"sid\"].\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 476, "slice_label": "bad", "file_name": "D:\\bad_2179_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB \t= new CentreonDB();\n\t$is_admin = isUserAdmin($_GET[\"sid\"]);\n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]){\n\t\t$DBRESULT = $pearDB->query(\"SELECT user_id FROM session where session_id = '\".$_GET[\"sid\"].\"'\");\n\t\t$session = $DBRESULT->fetchRow();\n\t\t$access = new CentreonAcl($session[\"user_id\"], $is_admin);\n}\n\t$normal_mode = 1;\n\t$type = \"root\";\n\tif (strlen($url_var) > 1){\n\t\t$type = substr($url_var, 0, 2);\n}\n\tif ($normal_mode){\n\t\tif ($type == \"HG\") {\n}\nelse if ($type == \"ST\") {\n}\nelse if ($type == \"HH\") {\n}\nelse if ($type == \"HS\") {\n}\nelse if ($type == \"HO\") {\n}\nelse if ($type == \"RS\") {\n}\nelse if ($type == \"RR\") {\n$query = \"SELECT hg_id, hg_name FROM hostgroup WHERE hg_id IN (SELECT hostgroup_hg_id FROM hostgroup_relation \".$access->queryBuilder(\"WHERE\", \"host_host_id\", _PAD_).\") ORDER BY `hg_name`\";\t\t//sink point: $access;\n$res = mysql_query($query);\n}\n}\n\n", "id": 477, "slice_label": "bad", "file_name": "D:\\bad_2179_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB \t= new CentreonDB();\n\t$pearDBndo \t= new CentreonDB(\"ndo\");\n\t$is_admin = isUserAdmin($_GET[\"sid\"]);\n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]){\n\t\t$DBRESULT = $pearDB->query(\"SELECT user_id FROM session where session_id = '\".$_GET[\"sid\"].\"'\");\n\t\t$session = $DBRESULT->fetchRow();\n\t\t$access = new CentreonAcl($session[\"user_id\"], $is_admin);\n\t\t$hoststr = $access->getHostsString(\"ID\", $pearDBndo);\n}\n\t$normal_mode = 1;\n\t$type = \"root\";\n\tif (strlen($url_var) > 1){\n\t\t$type = substr($url_var, 0, 2);\n}\n\tif ($normal_mode){\n\t\tif ($type == \"HG\") {\n}\nelse if ($type == \"ST\") {\n}\nelse if ($type == \"HH\") {\n}\nelse if ($type == \"HS\") {\n}\nelse if ($type == \"HO\") {\n}\nelse if ($type == \"RS\") {\n}\nelse if ($type == \"RR\") {\n$query = \"SELECT hg_id, hg_name FROM hostgroup WHERE hg_id IN (SELECT hostgroup_hg_id FROM hostgroup_relation \"._PAD_->queryBuilder(\"WHERE\", \"host_host_id\", $hoststr).\") ORDER BY `hg_name`\";\t\t//sink point: $hoststr;\n$res = mysql_query($query);\n}\n}\n\n", "id": 478, "slice_label": "bad", "file_name": "D:\\bad_2179_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$query = \"SELECT * FROM `session` WHERE session_id = '\"._PAD_->escape($_GET[\"session_id\"]).\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 479, "slice_label": "bad", "file_name": "D:\\good_2179_15.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n$query = \"SELECT * FROM `session` WHERE session_id = '\".$pearDB->escape(_PAD_).\"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n\n", "id": 480, "slice_label": "bad", "file_name": "D:\\good_2179_15.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n    $session = $pearDB->query(\"SELECT * FROM `session` WHERE session_id = '\".$pearDB->escape($_GET[\"session_id\"]).\"'\");\n\tif (!$session->numRows()){\n}\nelse {\n\t \t$CentreonGMT = new CentreonGMT($pearDB);\n\t \t$CentreonGMT->getMyGMTFromSession($_GET[\"session_id\"], $pearDB);\n\t\tif (!isset($_GET[\"host_name\"]) && !isset($_GET[\"service_description\"])){\n$query = \"SELECT * FROM index_data WHERE `id` = '\".$_GET[\"index\"].\"' LIMIT 1\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\t\t}\n}\n\n", "id": 481, "slice_label": "bad", "file_name": "D:\\good_2179_15.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n    $session = $pearDB->query(\"SELECT * FROM `session` WHERE session_id = '\".$pearDB->escape($_GET[\"session_id\"]).\"'\");\n\tif (!$session->numRows()){\n}\nelse {\n\t \t$CentreonGMT = new CentreonGMT($pearDB);\n\t \t$CentreonGMT->getMyGMTFromSession($_GET[\"session_id\"], $pearDB);\n\t\tif (!isset($_GET[\"host_name\"]) && !isset($_GET[\"service_description\"])){\n}\nelse {\n$query = \"SELECT * FROM index_data WHERE host_name = '\".utf8_encode($_GET[\"host_name\"]).\"' AND `service_description` = '\".utf8_encode($_GET[\"service_description\"]).\"' LIMIT 1\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\t\t}\n}\n\n", "id": 482, "slice_label": "bad", "file_name": "D:\\good_2179_15.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n    $session = $pearDB->query(\"SELECT * FROM `session` WHERE session_id = '\".$pearDB->escape($_GET[\"session_id\"]).\"'\");\n\tif (!$session->numRows()){\n}\nelse {\n\t \t$CentreonGMT = new CentreonGMT($pearDB);\n\t \t$CentreonGMT->getMyGMTFromSession($_GET[\"session_id\"], $pearDB);\n$query = \"SELECT * FROM giv_graphs_template WHERE graph_id = '\".$pearDB->escape(_PAD_).\"' LIMIT 1\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n}\n\n", "id": 483, "slice_label": "bad", "file_name": "D:\\good_2179_15.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n    $session = $pearDB->query(\"SELECT * FROM `session` WHERE session_id = '\".$pearDB->escape($_GET[\"session_id\"]).\"'\");\n\tif (!$session->numRows()){\n}\nelse {\n\t\t$pearDBO = new CentreonDB(\"centstorage\");\n\t\tif (!isset($_GET[\"host_name\"]) && !isset($_GET[\"service_description\"])){\n\t\t\t$DBRESULT = $pearDBO->query(\"SELECT * FROM index_data WHERE `id` = '\".$_GET[\"index\"].\"' LIMIT 1\");\n\t\t}\nelse {\n\t\t\t$DBRESULT = $pearDBO->query(\"SELECT * FROM index_data WHERE host_name = '\".utf8_encode($_GET[\"host_name\"]).\"' AND `service_description` = '\".utf8_encode($_GET[\"service_description\"]).\"' LIMIT 1\");\n\t\t}\n\t\t$index_data_ODS = $DBRESULT->fetchRow();\n\t\tif (!isset($_GET[\"template_id\"])|| !$_GET[\"template_id\"]){\n\t\t\t$host_id = getMyHostID($index_data_ODS[\"host_name\"]);\n\t\t\t$svc_id = getMyServiceID($index_data_ODS[\"service_description\"], $host_id);\n\t\t\t$template_id = getDefaultGraph($svc_id, 1);\n}\n\t\t\t$template_id = $_GET[\"template_id\"];\n$query = \"SELECT * FROM giv_graphs_template WHERE graph_id = '\"._PAD_->escape($template_id).\"' LIMIT 1\";\t\t//sink point: $template_id;\n$res = mysql_query($query);\n}\n\n", "id": 484, "slice_label": "bad", "file_name": "D:\\good_2179_15.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n    $session = $pearDB->query(\"SELECT * FROM `session` WHERE session_id = '\".$pearDB->escape($_GET[\"session_id\"]).\"'\");\n\tif (!$session->numRows()){\n}\nelse {\n\t\t$pearDBO = new CentreonDB(\"centstorage\");\n\t\tif (!isset($_GET[\"host_name\"]) && !isset($_GET[\"service_description\"])){\n\t\t\t$DBRESULT = $pearDBO->query(\"SELECT * FROM index_data WHERE `id` = '\".$_GET[\"index\"].\"' LIMIT 1\");\n\t\t}\nelse {\n\t\t\t$DBRESULT = $pearDBO->query(\"SELECT * FROM index_data WHERE host_name = '\".utf8_encode($_GET[\"host_name\"]).\"' AND `service_description` = '\".utf8_encode($_GET[\"service_description\"]).\"' LIMIT 1\");\n\t\t}\n\t\t$index_data_ODS = $DBRESULT->fetchRow();\n\t\tif (preg_match(\"/meta_([0-9]*)/\", $index_data_ODS[\"service_description\"], $matches)) {\n$query = \"SELECT meta_name FROM meta_service WHERE `meta_id` = '\".$matches[1].\"'\";\t\t//sink point: $matches;\n$res = mysql_query($query);\n}\n}\n\n", "id": 485, "slice_label": "bad", "file_name": "D:\\good_2179_15.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action'])) {\n    if (!empty($_POST['id']) && !empty($_POST['title']) && !empty($_POST['duration']) && !empty($_POST['category']) && !empty($_POST['description']) && !empty($_POST['min_bid'])) {\n        if ($_POST['quantity'] < 1) {\n}\nelse if (isset($_POST['current_bid']) && $_POST['current_bid'] < $_POST['min_bid'] && $_POST['current_bid'] != 0) {\n}\nelse {\n$query = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 486, "slice_label": "bad", "file_name": "D:\\good_56_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action'])) {\n    if (!empty($_POST['id']) && !empty($_POST['title']) && !empty($_POST['duration']) && !empty($_POST['category']) && !empty($_POST['description']) && !empty($_POST['min_bid'])) {\n        if ($_POST['quantity'] < 1) {\n}\nelse if (isset($_POST['current_bid']) && $_POST['current_bid'] < $_POST['min_bid'] && $_POST['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_POST['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_POST['category']) {\n$query = \"SELECT left_id, right_id, level FROM \" . $DBPrefix . \"categories WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n\n", "id": 487, "slice_label": "bad", "file_name": "D:\\good_56_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$catscontrol = new MPTTcategories();\nif (isset($_POST['action'])) {\n    if (!empty($_POST['id']) && !empty($_POST['title']) && !empty($_POST['duration']) && !empty($_POST['category']) && !empty($_POST['description']) && !empty($_POST['min_bid'])) {\n        if ($_POST['quantity'] < 1) {\n}\nelse if (isset($_POST['current_bid']) && $_POST['current_bid'] < $_POST['min_bid'] && $_POST['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_POST['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_POST['category']) {\n                $ct = intval($_POST['category']);\n                $parent_node = $db->result();\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                for ($i = 0; $i < count($crumbs); $i++) {\n                    if ($crumbs[$i]['cat_id'] == $ct) {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET counter = counter + 1, sub_counter = sub_counter + 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                    }\n}\n}\n}\n}\n}\n\n", "id": 488, "slice_label": "bad", "file_name": "D:\\good_56_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$catscontrol = new MPTTcategories();\nif (isset($_POST['action'])) {\n    if (!empty($_POST['id']) && !empty($_POST['title']) && !empty($_POST['duration']) && !empty($_POST['category']) && !empty($_POST['description']) && !empty($_POST['min_bid'])) {\n        if ($_POST['quantity'] < 1) {\n}\nelse if (isset($_POST['current_bid']) && $_POST['current_bid'] < $_POST['min_bid'] && $_POST['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_POST['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_POST['category']) {\n                $ct = intval($_POST['category']);\n                $parent_node = $db->result();\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                for ($i = 0; $i < count($crumbs); $i++) {\n                    if ($crumbs[$i]['cat_id'] == $ct) {\n}\nelse {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET sub_counter = sub_counter + 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                    }\n}\n}\n}\n}\n}\n\n", "id": 489, "slice_label": "bad", "file_name": "D:\\good_56_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action'])) {\n    if (!empty($_POST['id']) && !empty($_POST['title']) && !empty($_POST['duration']) && !empty($_POST['category']) && !empty($_POST['description']) && !empty($_POST['min_bid'])) {\n        if ($_POST['quantity'] < 1) {\n}\nelse if (isset($_POST['current_bid']) && $_POST['current_bid'] < $_POST['min_bid'] && $_POST['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_POST['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_POST['category']) {\n$query = \"SELECT left_id, right_id, level FROM \" . $DBPrefix . \"categories WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n\n", "id": 490, "slice_label": "bad", "file_name": "D:\\good_56_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$catscontrol = new MPTTcategories();\nif (isset($_POST['action'])) {\n    if (!empty($_POST['id']) && !empty($_POST['title']) && !empty($_POST['duration']) && !empty($_POST['category']) && !empty($_POST['description']) && !empty($_POST['min_bid'])) {\n        if ($_POST['quantity'] < 1) {\n}\nelse if (isset($_POST['current_bid']) && $_POST['current_bid'] < $_POST['min_bid'] && $_POST['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_POST['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_POST['category']) {\n                $parent_node = $db->result();\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                $cta = intval($AUCTION['category']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                for ($i = 0; $i < count($crumbs); $i++) {\n                    if ($crumbs[$i]['cat_id'] == $cta) {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET counter = counter - 1, sub_counter = sub_counter - 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                    }\n}\n}\n}\n}\n}\n\n", "id": 491, "slice_label": "bad", "file_name": "D:\\good_56_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$catscontrol = new MPTTcategories();\nif (isset($_POST['action'])) {\n    if (!empty($_POST['id']) && !empty($_POST['title']) && !empty($_POST['duration']) && !empty($_POST['category']) && !empty($_POST['description']) && !empty($_POST['min_bid'])) {\n        if ($_POST['quantity'] < 1) {\n}\nelse if (isset($_POST['current_bid']) && $_POST['current_bid'] < $_POST['min_bid'] && $_POST['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_POST['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_POST['category']) {\n                $parent_node = $db->result();\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                $cta = intval($AUCTION['category']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                for ($i = 0; $i < count($crumbs); $i++) {\n                    if ($crumbs[$i]['cat_id'] == $cta) {\n}\nelse {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET sub_counter = sub_counter - 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                    }\n}\n}\n}\n}\n}\n\n", "id": 492, "slice_label": "bad", "file_name": "D:\\good_56_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action'])) {\n    if (!empty($_POST['id']) && !empty($_POST['title']) && !empty($_POST['duration']) && !empty($_POST['category']) && !empty($_POST['description']) && !empty($_POST['min_bid'])) {\n        if ($_POST['quantity'] < 1) {\n}\nelse if (isset($_POST['current_bid']) && $_POST['current_bid'] < $_POST['min_bid'] && $_POST['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_POST['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['secondcat'] != $_POST['secondcat']) {\n$query = \"SELECT left_id, right_id, level FROM \" . $DBPrefix . \"categories WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n\n", "id": 493, "slice_label": "bad", "file_name": "D:\\good_56_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$catscontrol = new MPTTcategories();\nif (isset($_POST['action'])) {\n    if (!empty($_POST['id']) && !empty($_POST['title']) && !empty($_POST['duration']) && !empty($_POST['category']) && !empty($_POST['description']) && !empty($_POST['min_bid'])) {\n        if ($_POST['quantity'] < 1) {\n}\nelse if (isset($_POST['current_bid']) && $_POST['current_bid'] < $_POST['min_bid'] && $_POST['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_POST['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_POST['category']) {\n                $ct = intval($_POST['category']);\n                $parent_node = $db->result();\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n}\n            if ($AUCTION['secondcat'] != $_POST['secondcat']) {\n                $ct = intval($_POST['secondcat']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                for ($i = 0; $i < count($crumbs); $i++) {\n                    if ($crumbs[$i]['cat_id'] == $ct) {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET counter = counter + 1, sub_counter = sub_counter + 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                    }\n}\n}\n}\n}\n}\n\n", "id": 494, "slice_label": "bad", "file_name": "D:\\good_56_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$catscontrol = new MPTTcategories();\nif (isset($_POST['action'])) {\n    if (!empty($_POST['id']) && !empty($_POST['title']) && !empty($_POST['duration']) && !empty($_POST['category']) && !empty($_POST['description']) && !empty($_POST['min_bid'])) {\n        if ($_POST['quantity'] < 1) {\n}\nelse if (isset($_POST['current_bid']) && $_POST['current_bid'] < $_POST['min_bid'] && $_POST['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_POST['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_POST['category']) {\n                $ct = intval($_POST['category']);\n                $parent_node = $db->result();\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n}\n            if ($AUCTION['secondcat'] != $_POST['secondcat']) {\n                $ct = intval($_POST['secondcat']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                for ($i = 0; $i < count($crumbs); $i++) {\n                    if ($crumbs[$i]['cat_id'] == $ct) {\n}\nelse {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET sub_counter = sub_counter + 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                    }\n}\n}\n}\n}\n}\n\n", "id": 495, "slice_label": "bad", "file_name": "D:\\good_56_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action'])) {\n    if (!empty($_POST['id']) && !empty($_POST['title']) && !empty($_POST['duration']) && !empty($_POST['category']) && !empty($_POST['description']) && !empty($_POST['min_bid'])) {\n        if ($_POST['quantity'] < 1) {\n}\nelse if (isset($_POST['current_bid']) && $_POST['current_bid'] < $_POST['min_bid'] && $_POST['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_POST['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['secondcat'] != $_POST['secondcat']) {\n$query = \"SELECT left_id, right_id, level FROM \" . $DBPrefix . \"categories WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n\n", "id": 496, "slice_label": "bad", "file_name": "D:\\good_56_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$catscontrol = new MPTTcategories();\nif (isset($_POST['action'])) {\n    if (!empty($_POST['id']) && !empty($_POST['title']) && !empty($_POST['duration']) && !empty($_POST['category']) && !empty($_POST['description']) && !empty($_POST['min_bid'])) {\n        if ($_POST['quantity'] < 1) {\n}\nelse if (isset($_POST['current_bid']) && $_POST['current_bid'] < $_POST['min_bid'] && $_POST['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_POST['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_POST['category']) {\n                $parent_node = $db->result();\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                $cta = intval($AUCTION['category']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n}\n            if ($AUCTION['secondcat'] != $_POST['secondcat']) {\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                $cta = intval($AUCTION['secondcat']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                for ($i = 0; $i < count($crumbs); $i++) {\n                    if ($crumbs[$i]['cat_id'] == $cta) {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET counter = counter - 1, sub_counter = sub_counter - 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                    }\n}\n}\n}\n}\n}\n\n", "id": 497, "slice_label": "bad", "file_name": "D:\\good_56_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$catscontrol = new MPTTcategories();\nif (isset($_POST['action'])) {\n    if (!empty($_POST['id']) && !empty($_POST['title']) && !empty($_POST['duration']) && !empty($_POST['category']) && !empty($_POST['description']) && !empty($_POST['min_bid'])) {\n        if ($_POST['quantity'] < 1) {\n}\nelse if (isset($_POST['current_bid']) && $_POST['current_bid'] < $_POST['min_bid'] && $_POST['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_POST['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_POST['category']) {\n                $parent_node = $db->result();\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                $cta = intval($AUCTION['category']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n}\n            if ($AUCTION['secondcat'] != $_POST['secondcat']) {\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                $cta = intval($AUCTION['secondcat']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                for ($i = 0; $i < count($crumbs); $i++) {\n                    if ($crumbs[$i]['cat_id'] == $cta) {\n}\nelse {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET sub_counter = sub_counter - 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                    }\n}\n}\n}\n}\n}\n\n", "id": 498, "slice_label": "bad", "file_name": "D:\\good_56_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"o\"]) && $_GET[\"o\"] == \"r\"){\n$query = \"UPDATE session SET update_acl = '1' WHERE session_id = '\".$_GET[\"session_id\"].\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 499, "slice_label": "bad", "file_name": "D:\\bad_2179_10.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"o\"]) && $_GET[\"o\"] == \"r\"){\n\t\t$pearDB->query(\"UPDATE session SET update_acl = '1' WHERE session_id = '\".$_GET[\"session_id\"].\"'\");\n\t\t$pearDB->query(\"UPDATE acl_resources SET changed = '1'\");\n}\nelse if (isset($_POST[\"o\"]) && $_POST[\"o\"] == \"u\") {\n\t\t$pearDB->query(\"UPDATE acl_resources SET changed = '1'\");\n\t\t$query0 = \"UPDATE session SET update_acl = '1' WHERE user_id IN (\";\n\t\t$i = 0;\n\t\tif (isset($sel))\n\t\t\tforeach ($sel as $key => $val) {\n\t\t\t\tif ($i)\n\t\t\t\t\t$query0 .= \", \";\n\t\t\t\t$query0 .= \"'\".$key.\"'\";\n}\n\t\tif (!$i) {\n\t\t\t$query0 .= \"'')\";\n\t\t}\nelse {\n\t\t\t$query0 .= \")\";\n\t\t}\n\t\t$pearDB->query($query0);\n}\n\t$res = $pearDB->query(\"SELECT DISTINCT * FROM session\");\n\twhile ($r = $res->fetchRow()){\n$query = \"SELECT contact_name, contact_admin FROM contact WHERE contact_id = '\".$r[\"user_id\"].\"'\";\t\t//sink point: $r;\n$res = mysql_query($query);\n}\n\n", "id": 500, "slice_label": "bad", "file_name": "D:\\bad_2179_10.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"o\"]) && $_GET[\"o\"] == \"r\"){\n\t\t$pearDB->query(\"UPDATE session SET update_acl = '1' WHERE session_id = '\".$_GET[\"session_id\"].\"'\");\n\t\t$pearDB->query(\"UPDATE acl_resources SET changed = '1'\");\n}\nelse if (isset($_POST[\"o\"]) && $_POST[\"o\"] == \"u\") {\n\t\t$pearDB->query(\"UPDATE acl_resources SET changed = '1'\");\n\t\t$query0 = \"UPDATE session SET update_acl = '1' WHERE user_id IN (\";\n\t\t$i = 0;\n\t\tif (isset($sel))\n\t\t\tforeach ($sel as $key => $val) {\n\t\t\t\tif ($i)\n\t\t\t\t\t$query0 .= \", \";\n\t\t\t\t$query0 .= \"'\".$key.\"'\";\n}\n\t\tif (!$i) {\n\t\t\t$query0 .= \"'')\";\n\t\t}\nelse {\n\t\t\t$query0 .= \")\";\n\t\t}\n\t\t$pearDB->query($query0);\n}\n\t$res = $pearDB->query(\"SELECT DISTINCT * FROM session\");\n\twhile ($r = $res->fetchRow()){\n\t\t$resUser = $pearDB->query(\"SELECT contact_name, contact_admin FROM contact WHERE contact_id = '\".$r[\"user_id\"].\"'\");\n\t\t$rU = $resUser->fetchRow();\n\t\tif ($rU[\"contact_admin\"] != \"1\") {\n$query = \"SELECT topology_name, topology_icone, topology_page, topology_url_opt FROM topology WHERE topology_page = '\".$r[\"current_page\"].\"'\";\t\t//sink point: $r;\n$res = mysql_query($query);\n}\n}\n\n", "id": 501, "slice_label": "bad", "file_name": "D:\\bad_2179_10.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"id\"]) && $_GET[\"id\"] && is_numeric($_GET[\"id\"])) {\n$query = \"SELECT dir_name, img_path FROM view_img_dir, view_img, view_img_dir_relation vidr WHERE view_img_dir.dir_id = vidr.dir_dir_parent_id AND vidr.img_img_id = img_id AND img_id = '\"._PAD_->escape($_GET[\"id\"]).\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 502, "slice_label": "bad", "file_name": "D:\\good_2179_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n\tif (isset($_GET[\"id\"]) && $_GET[\"id\"] && is_numeric($_GET[\"id\"])) {\n$query = \"SELECT dir_name, img_path FROM view_img_dir, view_img, view_img_dir_relation vidr WHERE view_img_dir.dir_id = vidr.dir_dir_parent_id AND vidr.img_img_id = img_id AND img_id = '\".$pearDB->escape(_PAD_).\"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n}\n\n", "id": 503, "slice_label": "bad", "file_name": "D:\\good_2179_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$sc = $_GET['input0'];\n\n// php code: \n\t\tforeach ($sc as $key => $value)\t{\n$query = \"SELECT * FROM `command_categories` WHERE `cmd_category_id` = '\".$key.\"' LIMIT 1\";\t\t//sink point: $key;\n$res = mysql_query($query);\n}\n\n", "id": 504, "slice_label": "bad", "file_name": "D:\\good_2179_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$sc = $_GET['input0'];\n$nbrDup = $_GET['input1'];\n\n// php code: \n\t\tforeach ($sc as $key => $value)\t{\n\t\t\tfor ($i = 1; $i <= $nbrDup[$key]; $i++)\t{\n\t\t\t\tif (testCommandCategorieExistence($sc_name))\t{\n$query = \"INSERT INTO `command_categories` VALUES (\"._PAD_.\")\" : $rq = null;\t\t//sink point: $rq;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 505, "slice_label": "bad", "file_name": "D:\\good_2179_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$sc = $_GET['input0'];\n$nbrDup = $_GET['input1'];\n\n// php code: \n\t\tforeach ($sc as $key => $value)\t{\n\t\t\tfor ($i = 1; $i <= $nbrDup[$key]; $i++)\t{\n\t\t\t\t$val = null;\n\t\t\t\tif (testCommandCategorieExistence($sc_name))\t{\n$query = \"INSERT INTO `command_categories` VALUES (\".$val.\")\" : _PAD_ = null;\t\t//sink point: $val;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 506, "slice_label": "bad", "file_name": "D:\\good_2179_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n\n// php code: \n\t\tif (testCommandCategorieExistence($_POST[\"category_name\"])){\n$query = \"INSERT INTO `command_categories` (`category_name` , `category_alias`, `category_order`) VALUES ('\"._PAD_->escape($_POST[\"category_name\"]).\"', '\"._PAD_->escape($_POST[\"category_alias\"]).\"', '1')\";\t\t//sink point: $_POST;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 507, "slice_label": "bad", "file_name": "D:\\good_2179_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n\n// php code: \n\t\tif (testCommandCategorieExistence($_POST[\"category_name\"])){\n$query = \"INSERT INTO `command_categories` (`category_name` , `category_alias`, `category_order`) VALUES ('\".$pearDB->escape(_PAD_).\"', '\".$pearDB->escape(_PAD_).\"', '1')\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 508, "slice_label": "bad", "file_name": "D:\\good_2179_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n\n// php code: \n$query = \"UPDATE `command_categories` SET `category_name` = '\"._PAD_->escape($_POST[\"category_name\"]).\"' , `category_alias` = '\"._PAD_->escape($_POST[\"category_alias\"]).\"' , `category_order` = '\"._PAD_->escape($_POST[\"category_order\"]).\"' WHERE `cmd_category_id` = '\"._PAD_->escape($_POST[\"cmd_category_id\"]).\"'\";\t\t//sink point: $_POST;\n$res = mysql_query($query);\n\n", "id": 509, "slice_label": "bad", "file_name": "D:\\good_2179_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n\n// php code: \n$query = \"UPDATE `command_categories` SET `category_name` = '\".$pearDB->escape(_PAD_).\"' , `category_alias` = '\".$pearDB->escape(_PAD_).\"' , `category_order` = '\".$pearDB->escape(_PAD_).\"' WHERE `cmd_category_id` = '\".$pearDB->escape(_PAD_).\"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n\n", "id": 510, "slice_label": "bad", "file_name": "D:\\good_2179_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && isset($_POST['username']) && isset($_POST['password'])) {\n$query = \"SELECT id, hash, suspended, password, password_type FROM \" . $DBPrefix . \"users WHERE nick = :nick OR email = :email\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 511, "slice_label": "bad", "file_name": "D:\\good_56_14.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && isset($_POST['username']) && isset($_POST['password'])) {\n    $query0 = \"SELECT id, hash, suspended, password, password_type FROM \" . $DBPrefix . \"users WHERE nick = :nick OR email = :email\";\n    $params = array();\n    $params[] = array(':nick', $system->cleanvars($_POST['username']), 'str');\n    $params[] = array(':email', $system->cleanvars($_POST['username']), 'str');\n    $db->query($query0, $params);\n    $user_data = $db->result();\n    if ($user_data['password_type'] == 0 && $user_data['password'] == md5($MD5_PREFIX . $_POST['password'])) {\n$query = \"UPDATE \" . $DBPrefix . \"users SET password = :password, password_type = 1 WHERE id = :user_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 512, "slice_label": "bad", "file_name": "D:\\good_56_14.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && isset($_POST['username']) && isset($_POST['password'])) {\n$query = \"SELECT id, hash, suspended, password, password_type FROM \" . $DBPrefix . \"users WHERE nick = :nick OR email = :email\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n    $params = array();\n    $params[] = array(':nick', $system->cleanvars($_POST['username']), 'str');\n    $params[] = array(':email', $system->cleanvars($_POST['username']), 'str');\n    $db->query($query0, $params);\n    $user_data = $db->result();\n    if ($user_data['password_type'] == 0 && $user_data['password'] == md5($MD5_PREFIX . $_POST['password'])) {\n$query = \"SELECT id, hash, suspended, password, password_type FROM \" . $DBPrefix . \"users WHERE nick = :nick OR email = :email\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 513, "slice_label": "bad", "file_name": "D:\\good_56_14.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && isset($_POST['username']) && isset($_POST['password'])) {\n    $phpass = new PasswordHash(8, false);\n    $query0 = \"SELECT id, hash, suspended, password, password_type FROM \" . $DBPrefix . \"users WHERE nick = :nick OR email = :email\";\n    $params = array();\n    $params[] = array(':nick', $system->cleanvars($_POST['username']), 'str');\n    $params[] = array(':email', $system->cleanvars($_POST['username']), 'str');\n    $db->query($query0, $params);\n    $user_data = $db->result();\n    if ($user_data['password_type'] == 0 && $user_data['password'] == md5($MD5_PREFIX . $_POST['password'])) {\n        $user_data = $db->result();\n    }\n    if ($phpass->CheckPassword($_POST['password'], $user_data['password'])) {\n        if ($user_data['suspended'] == 1) {\n}\nelse if ($user_data['suspended'] == 8) {\n}\nelse if ($user_data['suspended'] == 10) {\n}\nelse {\n$query = \"UPDATE \" . $DBPrefix . \"users SET lastlogin = CURRENT_TIMESTAMP WHERE id = :user_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 514, "slice_label": "bad", "file_name": "D:\\good_56_14.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && isset($_POST['username']) && isset($_POST['password'])) {\n    $phpass = new PasswordHash(8, false);\n    $query0 = \"SELECT id, hash, suspended, password, password_type FROM \" . $DBPrefix . \"users WHERE nick = :nick OR email = :email\";\n    $params = array();\n    $params[] = array(':nick', $system->cleanvars($_POST['username']), 'str');\n    $params[] = array(':email', $system->cleanvars($_POST['username']), 'str');\n    $db->query($query0, $params);\n    $user_data = $db->result();\n    if ($user_data['password_type'] == 0 && $user_data['password'] == md5($MD5_PREFIX . $_POST['password'])) {\n        $user_data = $db->result();\n    }\n    if ($phpass->CheckPassword($_POST['password'], $user_data['password'])) {\n        if ($user_data['suspended'] == 1) {\n}\nelse if ($user_data['suspended'] == 8) {\n}\nelse if ($user_data['suspended'] == 10) {\n}\nelse {\n            if (isset($_POST['rememberme'])) {\n$query = \"INSERT INTO \" . $DBPrefix . \"rememberme VALUES (:user_id, :remember_key;\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n\n", "id": 515, "slice_label": "bad", "file_name": "D:\\good_56_14.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && isset($_POST['username']) && isset($_POST['password'])) {\n    $phpass = new PasswordHash(8, false);\n    $query0 = \"SELECT id, hash, suspended, password, password_type FROM \" . $DBPrefix . \"users WHERE nick = :nick OR email = :email\";\n    $params = array();\n    $params[] = array(':nick', $system->cleanvars($_POST['username']), 'str');\n    $params[] = array(':email', $system->cleanvars($_POST['username']), 'str');\n    $db->query($query0, $params);\n    $user_data = $db->result();\n    if ($user_data['password_type'] == 0 && $user_data['password'] == md5($MD5_PREFIX . $_POST['password'])) {\n        $user_data = $db->result();\n    }\n    if ($phpass->CheckPassword($_POST['password'], $user_data['password'])) {\n        if ($user_data['suspended'] == 1) {\n}\nelse if ($user_data['suspended'] == 8) {\n}\nelse if ($user_data['suspended'] == 10) {\n}\nelse {\n$query = \"SELECT id FROM \" . $DBPrefix . \"usersips WHERE USER = :user_id AND ip = :user_ip\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 516, "slice_label": "bad", "file_name": "D:\\good_56_14.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && isset($_POST['username']) && isset($_POST['password'])) {\n    $phpass = new PasswordHash(8, false);\n    $query0 = \"SELECT id, hash, suspended, password, password_type FROM \" . $DBPrefix . \"users WHERE nick = :nick OR email = :email\";\n    $params = array();\n    $params[] = array(':nick', $system->cleanvars($_POST['username']), 'str');\n    $params[] = array(':email', $system->cleanvars($_POST['username']), 'str');\n    $db->query($query0, $params);\n    $user_data = $db->result();\n    if ($user_data['password_type'] == 0 && $user_data['password'] == md5($MD5_PREFIX . $_POST['password'])) {\n        $db->query($query0, $params);\n        $db->query($query0, $params);\n        $user_data = $db->result();\n    }\n    if ($phpass->CheckPassword($_POST['password'], $user_data['password'])) {\n        if ($user_data['suspended'] == 1) {\n}\nelse if ($user_data['suspended'] == 8) {\n}\nelse if ($user_data['suspended'] == 10) {\n}\nelse {\n            $db->query($query0, $params);\n            if (isset($_POST['rememberme'])) {\n                $db->query($query0, $params);\n}\n            $db->query($query0, $params);\n            if ($db->numrows() == 0) {\n$query = \"INSERT INTO \" . $DBPrefix . \"usersips (user, ip, type, action;\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n\t\t\t\t\t\tVALUES (:user_id, :user_ip, 'login', 'accept')\";\n}\n}\n}\n}\n\n", "id": 517, "slice_label": "bad", "file_name": "D:\\good_56_14.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"session_id\"])) {\n$query = \"SELECT * FROM session WHERE session_id = '\".$_GET[\"session_id\"].\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 518, "slice_label": "bad", "file_name": "D:\\bad_2179_11.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$dir = $_GET['input0'];\n\n// php code: \n$query = \"SELECT dir_id FROM view_img_dir WHERE dir_alias = '\".$dir.\"'\";\t\t//sink point: $dir;\n$res = mysql_query($query);\n\n", "id": 519, "slice_label": "bad", "file_name": "D:\\bad_2179_11.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$dir = $_GET['input0'];\n$pearDB = $_GET['input1'];\n\n// php code: \n \t\t$DBRESULT = $pearDB->query(\"SELECT dir_id FROM view_img_dir WHERE dir_alias = '\".$dir.\"'\");\n \t\tif (!$DBRESULT->numRows()) {\n$query = \"INSERT INTO view_img_dir (`dir_name`, `dir_alias`) VALUES ('\".$dir.\"', '\".$dir.\"')\";\t\t//sink point: $dir;\n$res = mysql_query($query);\n}\n\n", "id": 520, "slice_label": "bad", "file_name": "D:\\bad_2179_11.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$dir = $_GET['input0'];\n\n// php code: \n$query = \"SELECT dir_id FROM view_img_dir WHERE dir_alias = '\".$dir.\"'\";\t\t//sink point: $dir;\n$res = mysql_query($query);\n\n", "id": 521, "slice_label": "bad", "file_name": "D:\\bad_2179_11.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$picture = $_GET['input0'];\n$dir_id = $_GET['input1'];\n$pearDB = $_GET['input2'];\n\n// php code: \n\t\t$img_info = pathinfo($picture);\n        if (!isset($img_info[\"filename\"])) {\n\t\t    $img_parts = explode(\".\", $img_info[\"basename\"]);\n            $img_info[\"filename\"] = $img_parts[0];\n        }\n\t\tif ($img_info[\"extension\"] == 'gd2' && !is_file($img_info[\"filename\"] . \".png\") ) {\n\t\t\t$picture = $img_info[\"filename\"] . \".png\";\n}\n \t\t$DBRESULT = $pearDB->query(\"SELECT img_id \" .\n \t\t\t\t\t\t\t\t\t\"FROM view_img, view_img_dir_relation vidh \" .\n \t\t\t\t\t\t\t\t\t\"WHERE img_path = '\".$picture.\"' \" .\n \t\t\t\t\t\t\t\t\t\"\tAND vidh.dir_dir_parent_id = '\".$dir_id.\"'\" .\n \t\t\t\t\t\t\t\t\t\"\tAND vidh.img_img_id = img_id\");\n \t\tif (!$DBRESULT->numRows()) {\n$query = \"INSERT INTO view_img (`img_name`, `img_path`) VALUES ('\"._PAD_.\"', '\".$picture.\"')\";\t\t//sink point: $picture;\n$res = mysql_query($query);\n}\n\n", "id": 522, "slice_label": "bad", "file_name": "D:\\bad_2179_11.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$picture = $_GET['input0'];\n$dir_id = $_GET['input1'];\n$pearDB = $_GET['input2'];\n\n// php code: \n\t\t$img_info = pathinfo($picture);\n        if (!isset($img_info[\"filename\"])) {\n\t\t    $img_parts = explode(\".\", $img_info[\"basename\"]);\n            $img_info[\"filename\"] = $img_parts[0];\n        }\n \t\t$DBRESULT = $pearDB->query(\"SELECT img_id \" .\n \t\t\t\t\t\t\t\t\t\"FROM view_img, view_img_dir_relation vidh \" .\n \t\t\t\t\t\t\t\t\t\"WHERE img_path = '\".$picture.\"' \" .\n \t\t\t\t\t\t\t\t\t\"\tAND vidh.dir_dir_parent_id = '\".$dir_id.\"'\" .\n \t\t\t\t\t\t\t\t\t\"\tAND vidh.img_img_id = img_id\");\n \t\tif (!$DBRESULT->numRows()) {\n$query = \"INSERT INTO view_img (`img_name`, `img_path`) VALUES ('\".$img_info[\"filename\"].\"', '\"._PAD_.\"')\";\t\t//sink point: $img_info;\n$res = mysql_query($query);\n}\n\n", "id": 523, "slice_label": "bad", "file_name": "D:\\bad_2179_11.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$picture = $_GET['input0'];\n$dir_id = $_GET['input1'];\n$pearDB = $_GET['input2'];\n\n// php code: \n\t\t$img_info = pathinfo($picture);\n        if (!isset($img_info[\"filename\"])) {\n\t\t    $img_parts = explode(\".\", $img_info[\"basename\"]);\n            $img_info[\"filename\"] = $img_parts[0];\n        }\n\t\tif ($img_info[\"extension\"] == 'gd2' && !is_file($img_info[\"filename\"] . \".png\") ) {\n\t\t\t$picture = $img_info[\"filename\"] . \".png\";\n}\n \t\t$DBRESULT = $pearDB->query(\"SELECT img_id \" .\n \t\t\t\t\t\t\t\t\t\"FROM view_img, view_img_dir_relation vidh \" .\n \t\t\t\t\t\t\t\t\t\"WHERE img_path = '\".$picture.\"' \" .\n \t\t\t\t\t\t\t\t\t\"\tAND vidh.dir_dir_parent_id = '\".$dir_id.\"'\" .\n \t\t\t\t\t\t\t\t\t\"\tAND vidh.img_img_id = img_id\");\n \t\tif (!$DBRESULT->numRows()) {\n$query = \"SELECT img_id FROM view_img WHERE `img_name` = '\"._PAD_.\"' AND `img_path` = '\".$picture.\"'\";\t\t//sink point: $picture;\n$res = mysql_query($query);\n}\n\n", "id": 524, "slice_label": "bad", "file_name": "D:\\bad_2179_11.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$picture = $_GET['input0'];\n$dir_id = $_GET['input1'];\n$pearDB = $_GET['input2'];\n\n// php code: \n\t\t$img_info = pathinfo($picture);\n        if (!isset($img_info[\"filename\"])) {\n\t\t    $img_parts = explode(\".\", $img_info[\"basename\"]);\n            $img_info[\"filename\"] = $img_parts[0];\n        }\n \t\t$DBRESULT = $pearDB->query(\"SELECT img_id \" .\n \t\t\t\t\t\t\t\t\t\"FROM view_img, view_img_dir_relation vidh \" .\n \t\t\t\t\t\t\t\t\t\"WHERE img_path = '\".$picture.\"' \" .\n \t\t\t\t\t\t\t\t\t\"\tAND vidh.dir_dir_parent_id = '\".$dir_id.\"'\" .\n \t\t\t\t\t\t\t\t\t\"\tAND vidh.img_img_id = img_id\");\n \t\tif (!$DBRESULT->numRows()) {\n$query = \"SELECT img_id FROM view_img WHERE `img_name` = '\".$img_info[\"filename\"].\"' AND `img_path` = '\"._PAD_.\"'\";\t\t//sink point: $img_info;\n$res = mysql_query($query);\n}\n\n", "id": 525, "slice_label": "bad", "file_name": "D:\\bad_2179_11.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$picture = $_GET['input0'];\n$dir_id = $_GET['input1'];\n$pearDB = $_GET['input2'];\n\n// php code: \n\t\t$img_info = pathinfo($picture);\n        if (!isset($img_info[\"filename\"])) {\n\t\t    $img_parts = explode(\".\", $img_info[\"basename\"]);\n            $img_info[\"filename\"] = $img_parts[0];\n        }\n\t\tif ($img_info[\"extension\"] == 'gd2' && !is_file($img_info[\"filename\"] . \".png\") ) {\n\t\t\t$picture = $img_info[\"filename\"] . \".png\";\n}\n \t\t$DBRESULT = $pearDB->query(\"SELECT img_id \" .\n \t\t\t\t\t\t\t\t\t\"FROM view_img, view_img_dir_relation vidh \" .\n \t\t\t\t\t\t\t\t\t\"WHERE img_path = '\".$picture.\"' \" .\n \t\t\t\t\t\t\t\t\t\"\tAND vidh.dir_dir_parent_id = '\".$dir_id.\"'\" .\n \t\t\t\t\t\t\t\t\t\"\tAND vidh.img_img_id = img_id\");\n \t\tif (!$DBRESULT->numRows()) {\n$query = \"INSERT INTO view_img_dir_relation (`dir_dir_parent_id`, `img_img_id`) VALUES ('\".$dir_id.\"', '\"._PAD_.\"')\";\t\t//sink point: $dir_id;\n$res = mysql_query($query);\n}\n\n", "id": 526, "slice_label": "bad", "file_name": "D:\\bad_2179_11.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$picture = $_GET['input0'];\n$dir_id = $_GET['input1'];\n$pearDB = $_GET['input2'];\n\n// php code: \n\t\t$img_info = pathinfo($picture);\n        if (!isset($img_info[\"filename\"])) {\n\t\t    $img_parts = explode(\".\", $img_info[\"basename\"]);\n            $img_info[\"filename\"] = $img_parts[0];\n        }\n\t\tif ($img_info[\"extension\"] == 'gd2' && !is_file($img_info[\"filename\"] . \".png\") ) {\n\t\t\t$picture = $img_info[\"filename\"] . \".png\";\n}\n \t\t$DBRESULT = $pearDB->query(\"SELECT img_id \" .\n \t\t\t\t\t\t\t\t\t\"FROM view_img, view_img_dir_relation vidh \" .\n \t\t\t\t\t\t\t\t\t\"WHERE img_path = '\".$picture.\"' \" .\n \t\t\t\t\t\t\t\t\t\"\tAND vidh.dir_dir_parent_id = '\".$dir_id.\"'\" .\n \t\t\t\t\t\t\t\t\t\"\tAND vidh.img_img_id = img_id\");\n \t\tif (!$DBRESULT->numRows()) {\n \t\t\t$data = $DBRESULT->fetchRow();\n$query = \"INSERT INTO view_img_dir_relation (`dir_dir_parent_id`, `img_img_id`) VALUES ('\"._PAD_.\"', '\".$data['img_id'].\"')\";\t\t//sink point: $data;\n$res = mysql_query($query);\n}\n\n", "id": 527, "slice_label": "bad", "file_name": "D:\\bad_2179_11.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n\n// php code: \n\t\t$interval = (isset($_GET[\"i\"]) AND ! empty($_GET[\"i\"]))\n\t\t    ? $_GET[\"i\"]\n\t\t    : \"month\";\n\t\t$select_date_text = \"DATE_FORMAT(incident_date, '%Y-%m-01')\";\n\t\tif ($interval == 'day')\n\t\t{\n\t\t\t$select_date_text = \"DATE_FORMAT(incident_date, '%Y-%m-%d')\";\n}\nelse if ($interval == 'hour')\n\t\t{\n\t\t\t$select_date_text = \"DATE_FORMAT(incident_date, '%Y-%m-%d %H:%M')\";\n}\nelse if ($interval == 'week')\n\t\t{\n\t\t\t$select_date_text = \"STR_TO_DATE(CONCAT(CAST(YEARWEEK(incident_date) AS CHAR), ' Sunday'), '%X%V %W')\";\n}\n$query = 'SELECT UNIX_TIMESTAMP('.$select_date_text.') AS time, COUNT(id;\t\t//sink point: $select_date_text;\n$res = mysql_query($query);\n\t\t    . 'FROM '.$this->table_prefix.'incident '\n\t\t    . 'WHERE incident_active = 1 '.$incident_id_in.' '\n\t\t    . 'GROUP BY '.$groupby_date_text;\n\n", "id": 528, "slice_label": "bad", "file_name": "D:\\bad_3701_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"o\"]) && $_GET[\"o\"] == \"k\"){\n\t\t$pearDB->query(\"DELETE FROM session WHERE session_id = '\".$_GET[\"session_id\"].\"'\");\n}\n\t$res = $pearDB->query(\"SELECT session.*, contact_name, contact_admin FROM session, contact WHERE contact_id = user_id ORDER BY contact_name, contact_admin\");\n\tfor ($cpt = 0;$r = $res->fetchRow();$cpt++){\n$query = \"SELECT topology_name, topology_icone, topology_page, topology_url_opt FROM topology WHERE topology_page = '\".$r[\"current_page\"].\"'\";\t\t//sink point: $r;\n$res = mysql_query($query);\n}\n\n", "id": 529, "slice_label": "bad", "file_name": "D:\\bad_2179_12.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'delopenauctions') {\n    if (isset($_POST['O_delete']) && is_array($_POST['O_delete']) && count($_POST['O_delete']) > 0) {\n$query = \"UPDATE \" . $DBPrefix . \"counters SET auctions = (auctions - :removed;\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 530, "slice_label": "bad", "file_name": "D:\\good_56_15.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'delopenauctions') {\n    if (isset($_POST['O_delete']) && is_array($_POST['O_delete']) && count($_POST['O_delete']) > 0) {\n        foreach ($_POST['O_delete'] as $k => $v) {\n            $v = intval($v);\n}\n}\n    if (isset($_POST['closenow']) && is_array($_POST['closenow']) && count($_POST['closenow']) > 0) {\n        foreach ($_POST['closenow'] as $k => $v) {\n$query = \"UPDATE \" . $DBPrefix . \"auctions SET ends = CURRENT_TIMESTAMP, relist = relisted WHERE id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 531, "slice_label": "bad", "file_name": "D:\\good_56_15.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'delopenauctions') {\n    if (isset($_POST['O_delete']) && is_array($_POST['O_delete']) && count($_POST['O_delete']) > 0) {\n        foreach ($_POST['O_delete'] as $k => $v) {\n            $query0 = \"DELETE FROM \" . $DBPrefix . \"auccounter WHERE auction_id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $v, 'int');\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n}\n        $db->query($query0, $params);\n}\n    if (isset($_POST['closenow']) && is_array($_POST['closenow']) && count($_POST['closenow']) > 0) {\n        foreach ($_POST['closenow'] as $k => $v) {\n            $db->query($query0, $params);\n        }\n}\n}\n$db->query($query0, $params);\n$db->query($query0, $params);\nwhile ($item = $db->fetch()) {\n    if ($item['num_bids'] > 0) {\n$query = \"SELECT bid FROM \" . $DBPrefix . \"bids WHERE auction = :auc_id ORDER BY bid DESC, id DESC LIMIT 1\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 532, "slice_label": "bad", "file_name": "D:\\good_56_15.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'delopenauctions') {\n    if (isset($_POST['O_delete']) && is_array($_POST['O_delete']) && count($_POST['O_delete']) > 0) {\n        foreach ($_POST['O_delete'] as $k => $v) {\n            $query0 = \"DELETE FROM \" . $DBPrefix . \"auccounter WHERE auction_id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $v, 'int');\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n}\n        $db->query($query0, $params);\n}\n    if (isset($_POST['closenow']) && is_array($_POST['closenow']) && count($_POST['closenow']) > 0) {\n        foreach ($_POST['closenow'] as $k => $v) {\n            $db->query($query0, $params);\n        }\n}\n}\n$db->query($query0, $params);\n$db->query($query0, $params);\nwhile ($item = $db->fetch()) {\n$query = \"SELECT counter FROM \" . $DBPrefix . \"auccounter WHERE auction_id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 533, "slice_label": "bad", "file_name": "D:\\good_56_15.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"host_id\"]) && $_GET[\"host_id\"]){\n$query = \"SELECT host_id, host_name FROM host WHERE host_template_model_htm_id = '\"._PAD_->escape($_GET[\"host_id\"]).\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 534, "slice_label": "bad", "file_name": "D:\\good_2179_4.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"host_id\"]) && $_GET[\"host_id\"]){\n$query = \"SELECT host_id, host_name FROM host WHERE host_template_model_htm_id = '\".$pearDB->escape(_PAD_).\"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n}\n\n", "id": 535, "slice_label": "bad", "file_name": "D:\\good_2179_4.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'update') {\n    if (isset($_POST['delete']) && is_array($_POST['delete']) && count($_POST['delete']) > 0) {\n        foreach ($_POST['delete'] as $k => $v) {\n$query = \"UPDATE \" . $DBPrefix . \"counters SET closedauctions = closedauctions - 1\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 536, "slice_label": "bad", "file_name": "D:\\good_56_16.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'update') {\n    if (isset($_POST['delete']) && is_array($_POST['delete']) && count($_POST['delete']) > 0) {\n        foreach ($_POST['delete'] as $k => $v) {\n            $v = intval($v);\n}\n}\n    if (isset($_POST['sell']) && is_array($_POST['sell']) && count($_POST['sell']) > 0) {\n        foreach ($_POST['sell'] as $v) {\n$query = \"UPDATE \" . $DBPrefix . \"auctions SET sold = 's' WHERE id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 537, "slice_label": "bad", "file_name": "D:\\good_56_16.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'update') {\n    if (isset($_POST['relist']) && is_array($_POST['relist']) && count($_POST['relist']) > 0) {\n        foreach ($_POST['relist'] as $k) {\n$query = \"SELECT duration, category, quantity FROM \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 538, "slice_label": "bad", "file_name": "D:\\good_56_16.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$user->checkSuspended();\n$query0 = \"SELECT value FROM \" . $DBPrefix . \"fees WHERE type = 'relist_fee'\";\n$db->direct_query($query0);\n$relist_fee = $db->result('value');\nif (isset($_POST['action']) && $_POST['action'] == 'update') {\n    if (isset($_POST['relist']) && is_array($_POST['relist']) && count($_POST['relist']) > 0) {\n        foreach ($_POST['relist'] as $k) {\n            if ($system->SETTINGS['fees'] == 'y' && !$user->permissions['no_fees'] && $relist_fee > 0) {\n                if ($system->SETTINGS['fee_type'] == 1) {\n$query = \"UPDATE \" . $DBPrefix . \"users SET balance = balance - :relist_fee WHERE id = :user_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n\n", "id": 539, "slice_label": "bad", "file_name": "D:\\good_56_16.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'update') {\n    if (isset($_POST['relist']) && is_array($_POST['relist']) && count($_POST['relist']) > 0) {\n        foreach ($_POST['relist'] as $k) {\n$query = \"UPDATE \" . $DBPrefix . \"counters SET auctions = auctions + 1\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 540, "slice_label": "bad", "file_name": "D:\\good_56_16.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'update') {\n    if (isset($_POST['relist']) && is_array($_POST['relist']) && count($_POST['relist']) > 0) {\n        foreach ($_POST['relist'] as $k) {\n$query = \"SELECT left_id, right_id, level FROM \" . $DBPrefix . \"categories WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 541, "slice_label": "bad", "file_name": "D:\\good_56_16.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$user->checkSuspended();\n$catscontrol = new MPTTcategories();\n$query0 = \"SELECT value FROM \" . $DBPrefix . \"fees WHERE type = 'relist_fee'\";\n$db->direct_query($query0);\n$relist_fee = $db->result('value');\nif (isset($_POST['action']) && $_POST['action'] == 'update') {\n    if (isset($_POST['delete']) && is_array($_POST['delete']) && count($_POST['delete']) > 0) {\n        foreach ($_POST['delete'] as $k => $v) {\n            $db->direct_query($query0);\n            $params = array();\n            $params[] = array(':auc_id', $v, 'int');\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n        }\n}\n    if (isset($_POST['sell']) && is_array($_POST['sell']) && count($_POST['sell']) > 0) {\n        foreach ($_POST['sell'] as $v) {\n            $db->query($query0, $params);\n        }\n}\n    if (isset($_POST['relist']) && is_array($_POST['relist']) && count($_POST['relist']) > 0) {\n        foreach ($_POST['relist'] as $k) {\n            $db->query($query0, $params);\n            if ($system->SETTINGS['fees'] == 'y' && !$user->permissions['no_fees'] && $relist_fee > 0) {\n                if ($system->SETTINGS['fee_type'] == 1) {\n                    $db->query($query0, $params);\n                }\n}\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n            $db->direct_query($query0);\n            $db->query($query0, $params);\n            $parent_node = $db->result();\n            $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n            for ($i = 0; $i < count($crumbs); $i++) {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET sub_counter = sub_counter + 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n\n", "id": 542, "slice_label": "bad", "file_name": "D:\\good_56_16.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$name = $_GET['input0'];\n\n// php code: \n$query = \"SELECT `sc_name`, `sc_id` FROM `service_categories` WHERE `sc_name` = '\".htmlentities($name, ENT_QUOTES, \"UTF-8\").\"'\";\t\t//sink point: $name;\n$res = mysql_query($query);\n\n", "id": 543, "slice_label": "bad", "file_name": "D:\\good_2179_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$sc = $_GET['input0'];\n\n// php code: \n                foreach($sc as $key => $value)\t{\n$query = \"SELECT * FROM `service_categories` WHERE `sc_id` = '\".$key.\"' LIMIT 1\";\t\t//sink point: $key;\n$res = mysql_query($query);\n}\n\n", "id": 544, "slice_label": "bad", "file_name": "D:\\good_2179_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$sc = $_GET['input0'];\n$nbrDup = $_GET['input1'];\n\n// php code: \n                foreach($sc as $key => $value)\t{\n\t\t\tfor ($i = 1; $i <= $nbrDup[$key]; $i++)\t{\n\t\t\t\tif (testServiceCategorieExistence($sc_name))\t{\n$query = \"INSERT INTO `service_categories` VALUES (\"._PAD_.\")\" : $rq = null;\t\t//sink point: $rq;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 545, "slice_label": "bad", "file_name": "D:\\good_2179_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$sc = $_GET['input0'];\n$nbrDup = $_GET['input1'];\n\n// php code: \n                foreach($sc as $key => $value)\t{\n\t\t\tfor ($i = 1; $i <= $nbrDup[$key]; $i++)\t{\n\t\t\t\t$val = null;\n\t\t\t\tif (testServiceCategorieExistence($sc_name))\t{\n$query = \"INSERT INTO `service_categories` VALUES (\".$val.\")\" : _PAD_ = null;\t\t//sink point: $val;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 546, "slice_label": "bad", "file_name": "D:\\good_2179_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$sc = $_GET['input0'];\n$nbrDup = $_GET['input1'];\n\n// php code: \n                foreach($sc as $key => $value)\t{\n\t\t\tfor ($i = 1; $i <= $nbrDup[$key]; $i++)\t{\n\t\t\t\tif (testServiceCategorieExistence($sc_name))\t{\n$query = \"INSERT INTO service_categories_relation (service_service_id, sc_id) (SELECT service_service_id, \"._PAD_.\" FROM service_categories_relation WHERE sc_id = \".$pearDB->escape(_PAD_).\")\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 547, "slice_label": "bad", "file_name": "D:\\good_2179_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$sc = $_GET['input0'];\n$nbrDup = $_GET['input1'];\n\n// php code: \n                foreach($sc as $key => $value)\t{\n\t\t\tfor ($i = 1; $i <= $nbrDup[$key]; $i++)\t{\n\t\t\t\tif (testServiceCategorieExistence($sc_name))\t{\n$query = \"INSERT INTO service_categories_relation (service_service_id, sc_id) (SELECT service_service_id, \"._PAD_.\" FROM service_categories_relation WHERE sc_id = \"._PAD_->escape($key).\")\";\t\t//sink point: $key;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 548, "slice_label": "bad", "file_name": "D:\\good_2179_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$sc = $_GET['input0'];\n$nbrDup = $_GET['input1'];\n\n// php code: \n                $scAcl = array();\n                foreach($sc as $key => $value)\t{\n\t\t\t$DBRESULT = $pearDB->query(\"SELECT * FROM `service_categories` WHERE `sc_id` = '\".$key.\"' LIMIT 1\");\n\t\t\tfor ($i = 1; $i <= $nbrDup[$key]; $i++)\t{\n\t\t\t\tif (testServiceCategorieExistence($sc_name))\t{\n\t\t\t\t\t$DBRESULT = $pearDB->query($rq);\n\t\t\t\t\t$DBRESULT = $pearDB->query(\"SELECT MAX(sc_id) as maxid FROM `service_categories`\");\n\t\t\t\t\t$maxId = $DBRESULT->fetchRow();\n                                        $scAcl[$maxId['MAX(sc_id)']] = $key;\n$query = \"INSERT INTO service_categories_relation (service_service_id, sc_id) (SELECT service_service_id, \".$maxId['maxid'].\" FROM service_categories_relation WHERE sc_id = \"._PAD_->escape(_PAD_).\")\";\t\t//sink point: $maxId;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 549, "slice_label": "bad", "file_name": "D:\\good_2179_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$sc_id = $_GET['input0'];\n$sc_arr = $_GET['input1'];\n\n// php code: \n\t\tif ($sc_id)\n\t\t\t$sc_arr = array($sc_id=>\"1\");\n\t\tforeach($sc_arr as $key=>$value)\t{\n$query = \"UPDATE service_categories SET sc_activate = '1' WHERE sc_id = '\".$key.\"'\";\t\t//sink point: $key;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 550, "slice_label": "bad", "file_name": "D:\\good_2179_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$sc_id = $_GET['input0'];\n$sc_arr = $_GET['input1'];\n\n// php code: \n\t\tif ($sc_id)\n\t\t\t$sc_arr = array($sc_id=>\"1\");\n\t\tforeach($sc_arr as $key=>$value)\t{\n$query = \"UPDATE service_categories SET sc_activate = '0' WHERE sc_id = '\".$key.\"'\";\t\t//sink point: $key;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 551, "slice_label": "bad", "file_name": "D:\\good_2179_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n\n// php code: \n\t\tif (testServiceCategorieExistence($_POST[\"sc_name\"])){\n$query = \"SELECT MAX(sc_id) FROM `service_categories` WHERE sc_name LIKE '\"._PAD_->escape($_POST[\"sc_name\"]).\"'\";\t\t//sink point: $_POST;\n$res = mysql_query($query);\n}\n\n", "id": 552, "slice_label": "bad", "file_name": "D:\\good_2179_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n\n// php code: \n\t\tif (testServiceCategorieExistence($_POST[\"sc_name\"])){\n$query = \"SELECT MAX(sc_id) FROM `service_categories` WHERE sc_name LIKE '\".$pearDB->escape(_PAD_).\"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n}\n\n", "id": 553, "slice_label": "bad", "file_name": "D:\\good_2179_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n\n// php code: \n\t\tif (isset($_POST[\"sc_svcTpl\"]))\n\t\t\tforeach ($_POST[\"sc_svcTpl\"] as $key)\t{\n$query = \"INSERT INTO service_categories_relation (service_service_id, sc_id) VALUES ('\".$key.\"', '\"._PAD_.\"')\";\t\t//sink point: $key;\n$res = mysql_query($query);\n}\n\n", "id": 554, "slice_label": "bad", "file_name": "D:\\good_2179_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$sc_id = $_GET['input0'];\n\n// php code: \n\t\tif (isset($_POST[\"sc_svcTpl\"]))\n\t\t\tforeach ($_POST[\"sc_svcTpl\"] as $key)\t{\n$query = \"INSERT INTO service_categories_relation (service_service_id, sc_id) VALUES ('\"._PAD_.\"', '\".$sc_id.\"')\";\t\t//sink point: $sc_id;\n$res = mysql_query($query);\n}\n\n", "id": 555, "slice_label": "bad", "file_name": "D:\\good_2179_5.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'delopenauctions') {\n    if (isset($_POST['O_delete']) && is_array($_POST['O_delete']) && count($_POST['O_delete']) > 0) {\n$query = \"UPDATE \" . $DBPrefix . \"counters SET auctions = (auctions - :removed;\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 556, "slice_label": "bad", "file_name": "D:\\good_56_17.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'delopenauctions') {\n    if (isset($_POST['O_delete']) && is_array($_POST['O_delete']) && count($_POST['O_delete']) > 0) {\n        foreach ($_POST['O_delete'] as $k => $v) {\n            $v = intval($v);\n}\n}\n    if (isset($_POST['startnow']) && is_array($_POST['startnow']) && count($_POST['startnow']) > 0) {\n        foreach ($_POST['startnow'] as $k => $v) {\n$query = \"SELECT duration FROM \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 557, "slice_label": "bad", "file_name": "D:\\good_56_17.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'delopenauctions') {\n    if (isset($_POST['O_delete']) && is_array($_POST['O_delete']) && count($_POST['O_delete']) > 0) {\n        foreach ($_POST['O_delete'] as $k => $v) {\n            $v = intval($v);\n}\n}\n    if (isset($_POST['startnow']) && is_array($_POST['startnow']) && count($_POST['startnow']) > 0) {\n        foreach ($_POST['startnow'] as $k => $v) {\n$query = \"UPDATE \" . $DBPrefix . \"auctions SET starts = CURRENT_TIMESTAMP, ends = :ends WHERE id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 558, "slice_label": "bad", "file_name": "D:\\good_56_17.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'delopenauctions') {\n    if (isset($_POST['O_delete']) && is_array($_POST['O_delete']) && count($_POST['O_delete']) > 0) {\n$query = \"UPDATE \" . $DBPrefix . \"counters SET auctions = (auctions - :removed;\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 559, "slice_label": "bad", "file_name": "D:\\good_56_18.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'update') {\n    if (isset($_POST['relist']) && is_array($_POST['relist']) && count($_POST['relist']) > 0) {\n        foreach ($_POST['relist'] as $k) {\n$query = \"SELECT duration, category FROM \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 560, "slice_label": "bad", "file_name": "D:\\good_56_19.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$user->checkSuspended();\n$query0 = \"SELECT value FROM \" . $DBPrefix . \"fees WHERE type = 'relist_fee'\";\n$db->direct_query($query0);\n$relist_fee = $db->result('value');\nif (isset($_POST['action']) && $_POST['action'] == 'update') {\n    if (isset($_POST['relist']) && is_array($_POST['relist']) && count($_POST['relist']) > 0) {\n        foreach ($_POST['relist'] as $k) {\n            if ($system->SETTINGS['fees'] == 'y' && !$user->permissions['no_fees'] && $relist_fee > 0) {\n                if ($system->SETTINGS['fee_type'] == 1) {\n$query = \"UPDATE \" . $DBPrefix . \"users SET balance = balance - :relist_fee WHERE id = :user_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n\n", "id": 561, "slice_label": "bad", "file_name": "D:\\good_56_19.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'update') {\n    if (isset($_POST['relist']) && is_array($_POST['relist']) && count($_POST['relist']) > 0) {\n        foreach ($_POST['relist'] as $k) {\n$query = \"UPDATE \" . $DBPrefix . \"counters SET auctions = auctions + 1\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 562, "slice_label": "bad", "file_name": "D:\\good_56_19.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'update') {\n    if (isset($_POST['relist']) && is_array($_POST['relist']) && count($_POST['relist']) > 0) {\n        foreach ($_POST['relist'] as $k) {\n$query = \"SELECT left_id, right_id, level FROM \" . $DBPrefix . \"categories WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 563, "slice_label": "bad", "file_name": "D:\\good_56_19.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$user->checkSuspended();\n$query0 = \"SELECT value FROM \" . $DBPrefix . \"fees WHERE type = 'relist_fee'\";\n$db->direct_query($query0);\n$relist_fee = $db->result('value');\nif (isset($_POST['action']) && $_POST['action'] == 'update') {\n    if (isset($_POST['relist']) && is_array($_POST['relist']) && count($_POST['relist']) > 0) {\n        foreach ($_POST['relist'] as $k) {\n            $params = array();\n            $params[] = array(':auc_id', $k, 'int');\n            $db->query($query0, $params);\n            if ($system->SETTINGS['fees'] == 'y' && !$user->permissions['no_fees'] && $relist_fee > 0) {\n                if ($system->SETTINGS['fee_type'] == 1) {\n                    $db->query($query0, $params);\n                }\n}\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n            $db->direct_query($query0);\n            $db->query($query0, $params);\n            $parent_node = $db->result();\n            $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n            for ($i = 0; $i < count($crumbs); $i++) {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET sub_counter = sub_counter + 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n\n", "id": 564, "slice_label": "bad", "file_name": "D:\\good_56_19.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action'])) {\n    if (!empty($_POST['id']) && !empty($_POST['title']) && !empty($_POST['duration']) && !empty($_POST['category']) && !empty($_POST['description']) && !empty($_POST['min_bid'])) {\n        if ($_POST['quantity'] < 1) {\n}\nelse if (isset($_POST['current_bid']) && $_POST['current_bid'] < $_POST['min_bid'] && $_POST['current_bid'] != 0) {\n}\nelse {\n$query = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 565, "slice_label": "bad", "file_name": "D:\\bad_56_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action'])) {\n    if (!empty($_POST['id']) && !empty($_POST['title']) && !empty($_POST['duration']) && !empty($_POST['category']) && !empty($_POST['description']) && !empty($_POST['min_bid'])) {\n        if ($_POST['quantity'] < 1) {\n}\nelse if (isset($_POST['current_bid']) && $_POST['current_bid'] < $_POST['min_bid'] && $_POST['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_POST['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_POST['category']) {\n$query = \"SELECT left_id, right_id, level FROM \" . $DBPrefix . \"categories WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n\n", "id": 566, "slice_label": "bad", "file_name": "D:\\bad_56_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$catscontrol = new MPTTcategories();\nif (isset($_POST['action'])) {\n    if (!empty($_POST['id']) && !empty($_POST['title']) && !empty($_POST['duration']) && !empty($_POST['category']) && !empty($_POST['description']) && !empty($_POST['min_bid'])) {\n        if ($_POST['quantity'] < 1) {\n}\nelse if (isset($_POST['current_bid']) && $_POST['current_bid'] < $_POST['min_bid'] && $_POST['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_POST['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_POST['category']) {\n                $ct = intval($_POST['category']);\n                $parent_node = $db->result();\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                for ($i = 0; $i < count($crumbs); $i++) {\n                    if ($crumbs[$i]['cat_id'] == $ct) {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET counter = counter + 1, sub_counter = sub_counter + 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                    }\n}\n}\n}\n}\n}\n\n", "id": 567, "slice_label": "bad", "file_name": "D:\\bad_56_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$catscontrol = new MPTTcategories();\nif (isset($_POST['action'])) {\n    if (!empty($_POST['id']) && !empty($_POST['title']) && !empty($_POST['duration']) && !empty($_POST['category']) && !empty($_POST['description']) && !empty($_POST['min_bid'])) {\n        if ($_POST['quantity'] < 1) {\n}\nelse if (isset($_POST['current_bid']) && $_POST['current_bid'] < $_POST['min_bid'] && $_POST['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_POST['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_POST['category']) {\n                $ct = intval($_POST['category']);\n                $parent_node = $db->result();\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                for ($i = 0; $i < count($crumbs); $i++) {\n                    if ($crumbs[$i]['cat_id'] == $ct) {\n}\nelse {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET sub_counter = sub_counter + 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                    }\n}\n}\n}\n}\n}\n\n", "id": 568, "slice_label": "bad", "file_name": "D:\\bad_56_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action'])) {\n    if (!empty($_POST['id']) && !empty($_POST['title']) && !empty($_POST['duration']) && !empty($_POST['category']) && !empty($_POST['description']) && !empty($_POST['min_bid'])) {\n        if ($_POST['quantity'] < 1) {\n}\nelse if (isset($_POST['current_bid']) && $_POST['current_bid'] < $_POST['min_bid'] && $_POST['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_POST['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_POST['category']) {\n$query = \"SELECT left_id, right_id, level FROM \" . $DBPrefix . \"categories WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n\n", "id": 569, "slice_label": "bad", "file_name": "D:\\bad_56_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$catscontrol = new MPTTcategories();\nif (isset($_POST['action'])) {\n    if (!empty($_POST['id']) && !empty($_POST['title']) && !empty($_POST['duration']) && !empty($_POST['category']) && !empty($_POST['description']) && !empty($_POST['min_bid'])) {\n        if ($_POST['quantity'] < 1) {\n}\nelse if (isset($_POST['current_bid']) && $_POST['current_bid'] < $_POST['min_bid'] && $_POST['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_POST['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_POST['category']) {\n                $parent_node = $db->result();\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                $cta = intval($AUCTION['category']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                for ($i = 0; $i < count($crumbs); $i++) {\n                    if ($crumbs[$i]['cat_id'] == $cta) {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET counter = counter - 1, sub_counter = sub_counter - 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                    }\n}\n}\n}\n}\n}\n\n", "id": 570, "slice_label": "bad", "file_name": "D:\\bad_56_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$catscontrol = new MPTTcategories();\nif (isset($_POST['action'])) {\n    if (!empty($_POST['id']) && !empty($_POST['title']) && !empty($_POST['duration']) && !empty($_POST['category']) && !empty($_POST['description']) && !empty($_POST['min_bid'])) {\n        if ($_POST['quantity'] < 1) {\n}\nelse if (isset($_POST['current_bid']) && $_POST['current_bid'] < $_POST['min_bid'] && $_POST['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_POST['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_POST['category']) {\n                $parent_node = $db->result();\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                $cta = intval($AUCTION['category']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                for ($i = 0; $i < count($crumbs); $i++) {\n                    if ($crumbs[$i]['cat_id'] == $cta) {\n}\nelse {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET sub_counter = sub_counter - 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                    }\n}\n}\n}\n}\n}\n\n", "id": 571, "slice_label": "bad", "file_name": "D:\\bad_56_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action'])) {\n    if (!empty($_POST['id']) && !empty($_POST['title']) && !empty($_POST['duration']) && !empty($_POST['category']) && !empty($_POST['description']) && !empty($_POST['min_bid'])) {\n        if ($_POST['quantity'] < 1) {\n}\nelse if (isset($_POST['current_bid']) && $_POST['current_bid'] < $_POST['min_bid'] && $_POST['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_POST['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['secondcat'] != $_POST['secondcat']) {\n$query = \"SELECT left_id, right_id, level FROM \" . $DBPrefix . \"categories WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n\n", "id": 572, "slice_label": "bad", "file_name": "D:\\bad_56_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$catscontrol = new MPTTcategories();\nif (isset($_POST['action'])) {\n    if (!empty($_POST['id']) && !empty($_POST['title']) && !empty($_POST['duration']) && !empty($_POST['category']) && !empty($_POST['description']) && !empty($_POST['min_bid'])) {\n        if ($_POST['quantity'] < 1) {\n}\nelse if (isset($_POST['current_bid']) && $_POST['current_bid'] < $_POST['min_bid'] && $_POST['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_POST['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_POST['category']) {\n                $ct = intval($_POST['category']);\n                $parent_node = $db->result();\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n}\n            if ($AUCTION['secondcat'] != $_POST['secondcat']) {\n                $ct = intval($_POST['secondcat']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                for ($i = 0; $i < count($crumbs); $i++) {\n                    if ($crumbs[$i]['cat_id'] == $ct) {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET counter = counter + 1, sub_counter = sub_counter + 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                    }\n}\n}\n}\n}\n}\n\n", "id": 573, "slice_label": "bad", "file_name": "D:\\bad_56_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$catscontrol = new MPTTcategories();\nif (isset($_POST['action'])) {\n    if (!empty($_POST['id']) && !empty($_POST['title']) && !empty($_POST['duration']) && !empty($_POST['category']) && !empty($_POST['description']) && !empty($_POST['min_bid'])) {\n        if ($_POST['quantity'] < 1) {\n}\nelse if (isset($_POST['current_bid']) && $_POST['current_bid'] < $_POST['min_bid'] && $_POST['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_POST['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_POST['category']) {\n                $ct = intval($_POST['category']);\n                $parent_node = $db->result();\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n}\n            if ($AUCTION['secondcat'] != $_POST['secondcat']) {\n                $ct = intval($_POST['secondcat']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                for ($i = 0; $i < count($crumbs); $i++) {\n                    if ($crumbs[$i]['cat_id'] == $ct) {\n}\nelse {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET sub_counter = sub_counter + 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                    }\n}\n}\n}\n}\n}\n\n", "id": 574, "slice_label": "bad", "file_name": "D:\\bad_56_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action'])) {\n    if (!empty($_POST['id']) && !empty($_POST['title']) && !empty($_POST['duration']) && !empty($_POST['category']) && !empty($_POST['description']) && !empty($_POST['min_bid'])) {\n        if ($_POST['quantity'] < 1) {\n}\nelse if (isset($_POST['current_bid']) && $_POST['current_bid'] < $_POST['min_bid'] && $_POST['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_POST['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['secondcat'] != $_POST['secondcat']) {\n$query = \"SELECT left_id, right_id, level FROM \" . $DBPrefix . \"categories WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n\n", "id": 575, "slice_label": "bad", "file_name": "D:\\bad_56_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$catscontrol = new MPTTcategories();\nif (isset($_POST['action'])) {\n    if (!empty($_POST['id']) && !empty($_POST['title']) && !empty($_POST['duration']) && !empty($_POST['category']) && !empty($_POST['description']) && !empty($_POST['min_bid'])) {\n        if ($_POST['quantity'] < 1) {\n}\nelse if (isset($_POST['current_bid']) && $_POST['current_bid'] < $_POST['min_bid'] && $_POST['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_POST['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_POST['category']) {\n                $parent_node = $db->result();\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                $cta = intval($AUCTION['category']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n}\n            if ($AUCTION['secondcat'] != $_POST['secondcat']) {\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                $cta = intval($AUCTION['secondcat']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                for ($i = 0; $i < count($crumbs); $i++) {\n                    if ($crumbs[$i]['cat_id'] == $cta) {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET counter = counter - 1, sub_counter = sub_counter - 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                    }\n}\n}\n}\n}\n}\n\n", "id": 576, "slice_label": "bad", "file_name": "D:\\bad_56_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$catscontrol = new MPTTcategories();\nif (isset($_POST['action'])) {\n    if (!empty($_POST['id']) && !empty($_POST['title']) && !empty($_POST['duration']) && !empty($_POST['category']) && !empty($_POST['description']) && !empty($_POST['min_bid'])) {\n        if ($_POST['quantity'] < 1) {\n}\nelse if (isset($_POST['current_bid']) && $_POST['current_bid'] < $_POST['min_bid'] && $_POST['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_POST['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_POST['category']) {\n                $parent_node = $db->result();\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                $cta = intval($AUCTION['category']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n}\n            if ($AUCTION['secondcat'] != $_POST['secondcat']) {\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                $cta = intval($AUCTION['secondcat']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                for ($i = 0; $i < count($crumbs); $i++) {\n                    if ($crumbs[$i]['cat_id'] == $cta) {\n}\nelse {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET sub_counter = sub_counter - 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                    }\n}\n}\n}\n}\n}\n\n", "id": 577, "slice_label": "bad", "file_name": "D:\\bad_56_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && isset($_POST['username']) && isset($_POST['password'])) {\n$query = \"SELECT id, hash, suspended, password, password_type FROM \" . $DBPrefix . \"users WHERE nick = :nick OR email = :email\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 578, "slice_label": "bad", "file_name": "D:\\bad_56_14.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && isset($_POST['username']) && isset($_POST['password'])) {\n    $query0 = \"SELECT id, hash, suspended, password, password_type FROM \" . $DBPrefix . \"users WHERE nick = :nick OR email = :email\";\n    $params = array();\n    $params[] = array(':nick', $system->cleanvars($_POST['username']), 'str');\n    $params[] = array(':email', $system->cleanvars($_POST['username']), 'str');\n    $db->query($query0, $params);\n    $user_data = $db->result();\n    if ($user_data['password_type'] == 0 && $user_data['password'] == md5($MD5_PREFIX . $_POST['password'])) {\n$query = \"UPDATE \" . $DBPrefix . \"users SET password = :password, password_type = 1 WHERE id = :user_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 579, "slice_label": "bad", "file_name": "D:\\bad_56_14.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && isset($_POST['username']) && isset($_POST['password'])) {\n$query = \"SELECT id, hash, suspended, password, password_type FROM \" . $DBPrefix . \"users WHERE nick = :nick OR email = :email\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n    $params = array();\n    $params[] = array(':nick', $system->cleanvars($_POST['username']), 'str');\n    $params[] = array(':email', $system->cleanvars($_POST['username']), 'str');\n    $db->query($query0, $params);\n    $user_data = $db->result();\n    if ($user_data['password_type'] == 0 && $user_data['password'] == md5($MD5_PREFIX . $_POST['password'])) {\n$query = \"SELECT id, hash, suspended, password, password_type FROM \" . $DBPrefix . \"users WHERE nick = :nick OR email = :email\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 580, "slice_label": "bad", "file_name": "D:\\bad_56_14.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && isset($_POST['username']) && isset($_POST['password'])) {\n    $phpass = new PasswordHash(8, false);\n    $query0 = \"SELECT id, hash, suspended, password, password_type FROM \" . $DBPrefix . \"users WHERE nick = :nick OR email = :email\";\n    $params = array();\n    $params[] = array(':nick', $system->cleanvars($_POST['username']), 'str');\n    $params[] = array(':email', $system->cleanvars($_POST['username']), 'str');\n    $db->query($query0, $params);\n    $user_data = $db->result();\n    if ($user_data['password_type'] == 0 && $user_data['password'] == md5($MD5_PREFIX . $_POST['password'])) {\n        $user_data = $db->result();\n    }\n    if ($phpass->CheckPassword($_POST['password'], $user_data['password'])) {\n        if ($user_data['suspended'] == 1) {\n}\nelse if ($user_data['suspended'] == 8) {\n}\nelse if ($user_data['suspended'] == 10) {\n}\nelse {\n$query = \"UPDATE \" . $DBPrefix . \"users SET lastlogin = CURRENT_TIMESTAMP WHERE id = :user_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 581, "slice_label": "bad", "file_name": "D:\\bad_56_14.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && isset($_POST['username']) && isset($_POST['password'])) {\n    $phpass = new PasswordHash(8, false);\n    $query0 = \"SELECT id, hash, suspended, password, password_type FROM \" . $DBPrefix . \"users WHERE nick = :nick OR email = :email\";\n    $params = array();\n    $params[] = array(':nick', $system->cleanvars($_POST['username']), 'str');\n    $params[] = array(':email', $system->cleanvars($_POST['username']), 'str');\n    $db->query($query0, $params);\n    $user_data = $db->result();\n    if ($user_data['password_type'] == 0 && $user_data['password'] == md5($MD5_PREFIX . $_POST['password'])) {\n        $user_data = $db->result();\n    }\n    if ($phpass->CheckPassword($_POST['password'], $user_data['password'])) {\n        if ($user_data['suspended'] == 1) {\n}\nelse if ($user_data['suspended'] == 8) {\n}\nelse if ($user_data['suspended'] == 10) {\n}\nelse {\n            if (isset($_POST['rememberme'])) {\n$query = \"INSERT INTO \" . $DBPrefix . \"rememberme VALUES (:user_id, :remember_key;\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n\n", "id": 582, "slice_label": "bad", "file_name": "D:\\bad_56_14.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && isset($_POST['username']) && isset($_POST['password'])) {\n    $phpass = new PasswordHash(8, false);\n    $query0 = \"SELECT id, hash, suspended, password, password_type FROM \" . $DBPrefix . \"users WHERE nick = :nick OR email = :email\";\n    $params = array();\n    $params[] = array(':nick', $system->cleanvars($_POST['username']), 'str');\n    $params[] = array(':email', $system->cleanvars($_POST['username']), 'str');\n    $db->query($query0, $params);\n    $user_data = $db->result();\n    if ($user_data['password_type'] == 0 && $user_data['password'] == md5($MD5_PREFIX . $_POST['password'])) {\n        $user_data = $db->result();\n    }\n    if ($phpass->CheckPassword($_POST['password'], $user_data['password'])) {\n        if ($user_data['suspended'] == 1) {\n}\nelse if ($user_data['suspended'] == 8) {\n}\nelse if ($user_data['suspended'] == 10) {\n}\nelse {\n$query = \"SELECT id FROM \" . $DBPrefix . \"usersips WHERE USER = :user_id AND ip = :user_ip\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 583, "slice_label": "bad", "file_name": "D:\\bad_56_14.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && isset($_POST['username']) && isset($_POST['password'])) {\n    $phpass = new PasswordHash(8, false);\n    $query0 = \"SELECT id, hash, suspended, password, password_type FROM \" . $DBPrefix . \"users WHERE nick = :nick OR email = :email\";\n    $params = array();\n    $params[] = array(':nick', $system->cleanvars($_POST['username']), 'str');\n    $params[] = array(':email', $system->cleanvars($_POST['username']), 'str');\n    $db->query($query0, $params);\n    $user_data = $db->result();\n    if ($user_data['password_type'] == 0 && $user_data['password'] == md5($MD5_PREFIX . $_POST['password'])) {\n        $db->query($query0, $params);\n        $db->query($query0, $params);\n        $user_data = $db->result();\n    }\n    if ($phpass->CheckPassword($_POST['password'], $user_data['password'])) {\n        if ($user_data['suspended'] == 1) {\n}\nelse if ($user_data['suspended'] == 8) {\n}\nelse if ($user_data['suspended'] == 10) {\n}\nelse {\n            $db->query($query0, $params);\n            if (isset($_POST['rememberme'])) {\n                $db->query($query0, $params);\n}\n            $db->query($query0, $params);\n            if ($db->numrows() == 0) {\n$query = \"INSERT INTO \" . $DBPrefix . \"usersips (user, ip, type, action;\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n\t\t\t\t\t\tVALUES (:user_id, :user_ip, 'login', 'accept')\";\n}\n}\n}\n}\n\n", "id": 584, "slice_label": "bad", "file_name": "D:\\bad_56_14.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$ends = $_GET['input0'];\n\n// php code: \n    if ($system->SETTINGS['ae_status'] == 'y' && (strtotime($ends) - $system->SETTINGS['ae_timebefore']) < time()) {\n$query = \"UPDATE \" . $DBPrefix . \"auctions SET ends = DATE_ADD(ends, INTERVAL \" . _PAD_->SETTINGS['ae_extend'] . \" SECOND;\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 585, "slice_label": "bad", "file_name": "D:\\good_56_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$ends = $_GET['input0'];\n\n// php code: \n    if ($system->SETTINGS['ae_status'] == 'y' && (strtotime($ends) - $system->SETTINGS['ae_timebefore']) < time()) {\n$query = \"UPDATE \" . _PAD_ . \"auctions SET ends = DATE_ADD(ends, INTERVAL \" . $system->SETTINGS['ae_extend'] . \" SECOND;\t\t//sink point: $system;\n$res = mysql_query($query);\n}\n\n", "id": 586, "slice_label": "bad", "file_name": "D:\\good_56_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = intval($_REQUEST['id']);\n$bid = (isset($_POST['bid'])) ? $_POST['bid'] : 0;\n$qty = (isset($_POST['qty'])) ? intval($_POST['qty']) : 1;\n$query0 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $DBPrefix . \"auctions a\n          LEFT JOIN \" . $DBPrefix . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$params = array();\n$params[] = array(':auc_id', $id, 'int');\n$db->query($query0, $params);\nif (empty($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_072;\n}\nif (!$system->CheckMoney($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_058;\n}\nelse {\n    $bid = round($system->input_money($bid), 2);\n}\n$Data = $db->result();\n$atype = $Data['auction_type'];\n$aquantity = $Data['quantity'];\n$current_bid = $Data['current_bid'];\nif ((strtotime($Data['ends']) <= time() || $Data['closed']) && !isset($errmsg)) {\n    $errmsg = $ERR_614;\n}\nif ((strtotime($Data['starts']) > time()) && !isset($errmsg)) {\n    $errmsg = $ERR_073;\n}\nif ($aquantity < $qty) {\n    $errmsg = $ERR_608;\n}\n$tmpmsg = CheckBidData();\nif ($tmpmsg != 0 && !isset($errmsg)) {\n    $errmsg = ${\n'ERR_' . $tmpmsg}\n;\n}\nif (isset($_POST['action']) && !isset($errmsg)) {\n    if ($atype == 1 && !isset($errmsg)) {\n        if ($system->SETTINGS['proxy_bidding'] == 'n') {\n            if ($current_bid < $bid) {\n$query = \"SELECT u.id FROM \" . $DBPrefix . \"bids b, \" . $DBPrefix . \"users u WHERE b.auction = :auc_id AND b.bidder = u.id and u.suspended = 0 ORDER BY bid DESC\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n\n", "id": 587, "slice_label": "bad", "file_name": "D:\\good_56_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = intval($_REQUEST['id']);\n$bid = (isset($_POST['bid'])) ? $_POST['bid'] : 0;\n$qty = (isset($_POST['qty'])) ? intval($_POST['qty']) : 1;\n$query0 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $DBPrefix . \"auctions a\n          LEFT JOIN \" . $DBPrefix . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$params = array();\n$params[] = array(':auc_id', $id, 'int');\n$db->query($query0, $params);\nif (empty($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_072;\n}\nif (!$system->CheckMoney($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_058;\n}\nelse {\n    $bid = round($system->input_money($bid), 2);\n}\n$Data = $db->result();\n$atype = $Data['auction_type'];\n$aquantity = $Data['quantity'];\n$current_bid = $Data['current_bid'];\nif ((strtotime($Data['ends']) <= time() || $Data['closed']) && !isset($errmsg)) {\n    $errmsg = $ERR_614;\n}\nif ((strtotime($Data['starts']) > time()) && !isset($errmsg)) {\n    $errmsg = $ERR_073;\n}\nif ($aquantity < $qty) {\n    $errmsg = $ERR_608;\n}\n$tmpmsg = CheckBidData();\nif ($tmpmsg != 0 && !isset($errmsg)) {\n    $errmsg = ${\n'ERR_' . $tmpmsg}\n;\n}\nif (isset($_POST['action']) && !isset($errmsg)) {\n    if ($atype == 1 && !isset($errmsg)) {\n        if ($system->SETTINGS['proxy_bidding'] == 'n') {\n            if ($current_bid < $bid) {\n$query = \"INSERT INTO \" . $DBPrefix . \"bids (auction, bidder, bid, quantity;\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                          VALUES (:auc_id, :bidder_id, :bid, :qty)\";\n}\n}\n}\n}\n\n", "id": 588, "slice_label": "bad", "file_name": "D:\\good_56_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = intval($_REQUEST['id']);\n$bid = (isset($_POST['bid'])) ? $_POST['bid'] : 0;\n$qty = (isset($_POST['qty'])) ? intval($_POST['qty']) : 1;\n$query0 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $DBPrefix . \"auctions a\n          LEFT JOIN \" . $DBPrefix . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$params = array();\n$params[] = array(':auc_id', $id, 'int');\n$db->query($query0, $params);\nif (empty($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_072;\n}\nif (!$system->CheckMoney($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_058;\n}\nelse {\n    $bid = round($system->input_money($bid), 2);\n}\n$Data = $db->result();\n$atype = $Data['auction_type'];\n$aquantity = $Data['quantity'];\n$current_bid = $Data['current_bid'];\nif ((strtotime($Data['ends']) <= time() || $Data['closed']) && !isset($errmsg)) {\n    $errmsg = $ERR_614;\n}\nif ((strtotime($Data['starts']) > time()) && !isset($errmsg)) {\n    $errmsg = $ERR_073;\n}\nif ($aquantity < $qty) {\n    $errmsg = $ERR_608;\n}\n$tmpmsg = CheckBidData();\nif ($tmpmsg != 0 && !isset($errmsg)) {\n    $errmsg = ${\n'ERR_' . $tmpmsg}\n;\n}\nif (isset($_POST['action']) && !isset($errmsg)) {\n    if ($atype == 1 && !isset($errmsg)) {\n        if ($system->SETTINGS['proxy_bidding'] == 'n') {\n            if ($current_bid < $bid) {\n$query = \"UPDATE \" . $DBPrefix . \"auctions SET current_bid = :bid, current_bid_id = :current_bid_id, num_bids = num_bids + 1 WHERE id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n\n", "id": 589, "slice_label": "bad", "file_name": "D:\\good_56_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = intval($_REQUEST['id']);\n$bid = (isset($_POST['bid'])) ? $_POST['bid'] : 0;\n$qty = (isset($_POST['qty'])) ? intval($_POST['qty']) : 1;\n$query0 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $DBPrefix . \"auctions a\n          LEFT JOIN \" . $DBPrefix . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$params = array();\n$params[] = array(':auc_id', $id, 'int');\n$db->query($query0, $params);\nif (empty($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_072;\n}\nif (!$system->CheckMoney($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_058;\n}\n$Data = $db->result();\n$atype = $Data['auction_type'];\n$aquantity = $Data['quantity'];\nif ((strtotime($Data['ends']) <= time() || $Data['closed']) && !isset($errmsg)) {\n    $errmsg = $ERR_614;\n}\nif ((strtotime($Data['starts']) > time()) && !isset($errmsg)) {\n    $errmsg = $ERR_073;\n}\nif ($aquantity < $qty) {\n    $errmsg = $ERR_608;\n}\n$tmpmsg = CheckBidData();\nif ($tmpmsg != 0 && !isset($errmsg)) {\n    $errmsg = ${\n'ERR_' . $tmpmsg}\n;\n}\nif (isset($_POST['action']) && !isset($errmsg)) {\n    if ($atype == 1 && !isset($errmsg)) {\n}\nelse if ($atype == 2 && !isset($errmsg)) {\n$query = \"SELECT bid, quantity FROM \" . $DBPrefix . \"bids WHERE bidder = :bidder_id AND auction = :auc_id ORDER BY bid DESC LIMIT 1\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 590, "slice_label": "bad", "file_name": "D:\\good_56_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = intval($_REQUEST['id']);\n$bid = (isset($_POST['bid'])) ? $_POST['bid'] : 0;\n$qty = (isset($_POST['qty'])) ? intval($_POST['qty']) : 1;\n$query0 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $DBPrefix . \"auctions a\n          LEFT JOIN \" . $DBPrefix . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$params = array();\n$params[] = array(':auc_id', $id, 'int');\n$db->query($query0, $params);\nif (empty($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_072;\n}\nif (!$system->CheckMoney($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_058;\n}\n$Data = $db->result();\n$atype = $Data['auction_type'];\n$aquantity = $Data['quantity'];\nif ((strtotime($Data['ends']) <= time() || $Data['closed']) && !isset($errmsg)) {\n    $errmsg = $ERR_614;\n}\nif ((strtotime($Data['starts']) > time()) && !isset($errmsg)) {\n    $errmsg = $ERR_073;\n}\nif ($aquantity < $qty) {\n    $errmsg = $ERR_608;\n}\n$tmpmsg = CheckBidData();\nif ($tmpmsg != 0 && !isset($errmsg)) {\n    $errmsg = ${\n'ERR_' . $tmpmsg}\n;\n}\nif (isset($_POST['action']) && !isset($errmsg)) {\n    if ($atype == 1 && !isset($errmsg)) {\n}\nelse if ($atype == 2 && !isset($errmsg)) {\n        if (!isset($errmsg)) {\n$query = \"INSERT INTO \" . $DBPrefix . \"bids (auction, bidder, bid, quantity;\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                      VALUES (:auc_id, :bidder_id, :bid, :qty)\";\n}\n}\n}\n\n", "id": 591, "slice_label": "bad", "file_name": "D:\\good_56_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = intval($_REQUEST['id']);\n$bid = (isset($_POST['bid'])) ? $_POST['bid'] : 0;\n$qty = (isset($_POST['qty'])) ? intval($_POST['qty']) : 1;\n$query0 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $DBPrefix . \"auctions a\n          LEFT JOIN \" . $DBPrefix . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$params = array();\n$params[] = array(':auc_id', $id, 'int');\n$db->query($query0, $params);\nif (empty($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_072;\n}\nif (!$system->CheckMoney($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_058;\n}\n$Data = $db->result();\n$atype = $Data['auction_type'];\n$aquantity = $Data['quantity'];\nif ((strtotime($Data['ends']) <= time() || $Data['closed']) && !isset($errmsg)) {\n    $errmsg = $ERR_614;\n}\nif ((strtotime($Data['starts']) > time()) && !isset($errmsg)) {\n    $errmsg = $ERR_073;\n}\nif ($aquantity < $qty) {\n    $errmsg = $ERR_608;\n}\n$tmpmsg = CheckBidData();\nif ($tmpmsg != 0 && !isset($errmsg)) {\n    $errmsg = ${\n'ERR_' . $tmpmsg}\n;\n}\nif (isset($_POST['action']) && !isset($errmsg)) {\n    if ($atype == 1 && !isset($errmsg)) {\n}\nelse if ($atype == 2 && !isset($errmsg)) {\n        if (!isset($errmsg)) {\n$query = \"UPDATE \" . $DBPrefix . \"counters SET bids = (bids + 1;\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 592, "slice_label": "bad", "file_name": "D:\\good_56_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = intval($_REQUEST['id']);\n$bid = (isset($_POST['bid'])) ? $_POST['bid'] : 0;\n$qty = (isset($_POST['qty'])) ? intval($_POST['qty']) : 1;\n$query0 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $DBPrefix . \"auctions a\n          LEFT JOIN \" . $DBPrefix . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$params = array();\n$params[] = array(':auc_id', $id, 'int');\n$db->query($query0, $params);\nif (empty($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_072;\n}\nif (!$system->CheckMoney($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_058;\n}\n$Data = $db->result();\n$atype = $Data['auction_type'];\n$aquantity = $Data['quantity'];\nif ((strtotime($Data['ends']) <= time() || $Data['closed']) && !isset($errmsg)) {\n    $errmsg = $ERR_614;\n}\nif ((strtotime($Data['starts']) > time()) && !isset($errmsg)) {\n    $errmsg = $ERR_073;\n}\nif ($aquantity < $qty) {\n    $errmsg = $ERR_608;\n}\n$tmpmsg = CheckBidData();\nif ($tmpmsg != 0 && !isset($errmsg)) {\n    $errmsg = ${\n'ERR_' . $tmpmsg}\n;\n}\nif (isset($_POST['action']) && !isset($errmsg)) {\n    if ($atype == 1 && !isset($errmsg)) {\n}\nelse if ($atype == 2 && !isset($errmsg)) {\n        if (!isset($errmsg)) {\n$query = \"UPDATE \" . $DBPrefix . \"auctions SET current_bid = :bid, current_bid_id = :current_bid_id, num_bids = num_bids + 1 WHERE id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 593, "slice_label": "bad", "file_name": "D:\\good_56_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = intval($_REQUEST['id']);\n$bid = (isset($_POST['bid'])) ? $_POST['bid'] : 0;\n$qty = (isset($_POST['qty'])) ? intval($_POST['qty']) : 1;\n$query0 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $DBPrefix . \"auctions a\n          LEFT JOIN \" . $DBPrefix . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$params = array();\n$params[] = array(':auc_id', $id, 'int');\n$db->query($query0, $params);\nif (empty($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_072;\n}\nif (!$system->CheckMoney($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_058;\n}\n$Data = $db->result();\n$aquantity = $Data['quantity'];\nif ((strtotime($Data['ends']) <= time() || $Data['closed']) && !isset($errmsg)) {\n    $errmsg = $ERR_614;\n}\nif ((strtotime($Data['starts']) > time()) && !isset($errmsg)) {\n    $errmsg = $ERR_073;\n}\nif ($aquantity < $qty) {\n    $errmsg = $ERR_608;\n}\n$db->query($query0, $params);\n$last_highest_bid = array();\nif ($db->numrows() > 0) {\n    $last_highest_bid = $db->result();\n}\n$tmpmsg = CheckBidData();\nif ($tmpmsg != 0 && !isset($errmsg)) {\n    $errmsg = ${\n'ERR_' . $tmpmsg}\n;\n}\nif (isset($_POST['action']) && !isset($errmsg)) {\n    if (count($last_highest_bid) > 0) {\n$query = \"SELECT nick, name, email FROM \" . $DBPrefix . \"users WHERE id = :user_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 594, "slice_label": "bad", "file_name": "D:\\good_56_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = intval($_REQUEST['id']);\n$bid = (isset($_POST['bid'])) ? $_POST['bid'] : 0;\n$qty = (isset($_POST['qty'])) ? intval($_POST['qty']) : 1;\n$query0 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $DBPrefix . \"auctions a\n          LEFT JOIN \" . $DBPrefix . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$params = array();\n$params[] = array(':auc_id', $id, 'int');\n$db->query($query0, $params);\nif (empty($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_072;\n}\nif (!$system->CheckMoney($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_058;\n}\n$Data = $db->result();\n$aquantity = $Data['quantity'];\nif ((strtotime($Data['ends']) <= time() || $Data['closed']) && !isset($errmsg)) {\n    $errmsg = $ERR_614;\n}\nif ((strtotime($Data['starts']) > time()) && !isset($errmsg)) {\n    $errmsg = $ERR_073;\n}\nif ($aquantity < $qty) {\n    $errmsg = $ERR_608;\n}\n$tmpmsg = CheckBidData();\nif ($tmpmsg != 0 && !isset($errmsg)) {\n    $errmsg = ${\n'ERR_' . $tmpmsg}\n;\n}\nif (isset($_POST['action']) && !isset($errmsg)) {\n$query = \"SELECT name, email, item_watch, id FROM \" . $DBPrefix . \"users WHERE item_watch LIKE :auc_id AND id != :user_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 595, "slice_label": "bad", "file_name": "D:\\good_56_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (!empty($_GET['user_id'])) {\n    $user_id = intval($_GET['user_id']);\n    $user->checkUserValid($user_id);\n}\nelse if ($user->logged_in) {\n    $user_id = $user->user_data['id'];\n}\n$query0 = \"SELECT count(id) AS auctions FROM \" . $DBPrefix . \"auctions\n\t\tWHERE user = :user_id\n\t\tAND closed = 1\";\n$params = array();\n$params[] = array(':user_id', $user_id, 'int');\n$db->query($query0, $params);\n$db->query($query0, $params);\n$auction_data = $db->fetchall();\nforeach ($auction_data as $row) {\n$query = \"SELECT bid FROM \" . $DBPrefix . \"bids WHERE auction = :user_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 596, "slice_label": "bad", "file_name": "D:\\good_56_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'delopenauctions') {\n    if (isset($_POST['O_delete']) && is_array($_POST['O_delete']) && count($_POST['O_delete']) > 0) {\n$query = \"UPDATE \" . $DBPrefix . \"counters SET auctions = (auctions - :removed;\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 597, "slice_label": "bad", "file_name": "D:\\bad_56_15.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'delopenauctions') {\n    if (isset($_POST['O_delete']) && is_array($_POST['O_delete']) && count($_POST['O_delete']) > 0) {\n        foreach ($_POST['O_delete'] as $k => $v) {\n            $v = intval($v);\n}\n}\n    if (isset($_POST['closenow']) && is_array($_POST['closenow']) && count($_POST['closenow']) > 0) {\n        foreach ($_POST['closenow'] as $k => $v) {\n$query = \"UPDATE \" . $DBPrefix . \"auctions SET ends = CURRENT_TIMESTAMP, relist = relisted WHERE id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 598, "slice_label": "bad", "file_name": "D:\\bad_56_15.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'delopenauctions') {\n    if (isset($_POST['O_delete']) && is_array($_POST['O_delete']) && count($_POST['O_delete']) > 0) {\n        foreach ($_POST['O_delete'] as $k => $v) {\n            $query0 = \"DELETE FROM \" . $DBPrefix . \"auccounter WHERE auction_id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $v, 'int');\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n}\n        $db->query($query0, $params);\n}\n    if (isset($_POST['closenow']) && is_array($_POST['closenow']) && count($_POST['closenow']) > 0) {\n        foreach ($_POST['closenow'] as $k => $v) {\n            $db->query($query0, $params);\n        }\n}\n}\n$db->query($query0, $params);\n$db->query($query0, $params);\nwhile ($item = $db->fetch()) {\n    if ($item['num_bids'] > 0) {\n$query = \"SELECT bid FROM \" . $DBPrefix . \"bids WHERE auction = :auc_id ORDER BY bid DESC, id DESC LIMIT 1\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 599, "slice_label": "bad", "file_name": "D:\\bad_56_15.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'delopenauctions') {\n    if (isset($_POST['O_delete']) && is_array($_POST['O_delete']) && count($_POST['O_delete']) > 0) {\n        foreach ($_POST['O_delete'] as $k => $v) {\n            $query0 = \"DELETE FROM \" . $DBPrefix . \"auccounter WHERE auction_id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $v, 'int');\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n}\n        $db->query($query0, $params);\n}\n    if (isset($_POST['closenow']) && is_array($_POST['closenow']) && count($_POST['closenow']) > 0) {\n        foreach ($_POST['closenow'] as $k => $v) {\n            $db->query($query0, $params);\n        }\n}\n}\n$db->query($query0, $params);\n$db->query($query0, $params);\nwhile ($item = $db->fetch()) {\n$query = \"SELECT counter FROM \" . $DBPrefix . \"auccounter WHERE auction_id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 600, "slice_label": "bad", "file_name": "D:\\bad_56_15.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'update') {\n    if (isset($_POST['delete']) && is_array($_POST['delete']) && count($_POST['delete']) > 0) {\n        foreach ($_POST['delete'] as $k => $v) {\n$query = \"UPDATE \" . $DBPrefix . \"counters SET closedauctions = closedauctions - 1\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 601, "slice_label": "bad", "file_name": "D:\\bad_56_16.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'update') {\n    if (isset($_POST['delete']) && is_array($_POST['delete']) && count($_POST['delete']) > 0) {\n        foreach ($_POST['delete'] as $k => $v) {\n            $v = intval($v);\n}\n}\n    if (isset($_POST['sell']) && is_array($_POST['sell']) && count($_POST['sell']) > 0) {\n        foreach ($_POST['sell'] as $v) {\n$query = \"UPDATE \" . $DBPrefix . \"auctions SET sold = 's' WHERE id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 602, "slice_label": "bad", "file_name": "D:\\bad_56_16.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'update') {\n    if (isset($_POST['relist']) && is_array($_POST['relist']) && count($_POST['relist']) > 0) {\n        foreach ($_POST['relist'] as $k) {\n$query = \"SELECT duration, category, quantity FROM \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 603, "slice_label": "bad", "file_name": "D:\\bad_56_16.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$user->checkSuspended();\n$query0 = \"SELECT value FROM \" . $DBPrefix . \"fees WHERE type = 'relist_fee'\";\n$db->direct_query($query0);\n$relist_fee = $db->result('value');\nif (isset($_POST['action']) && $_POST['action'] == 'update') {\n    if (isset($_POST['relist']) && is_array($_POST['relist']) && count($_POST['relist']) > 0) {\n        foreach ($_POST['relist'] as $k) {\n            if ($system->SETTINGS['fees'] == 'y' && !$user->permissions['no_fees'] && $relist_fee > 0) {\n                if ($system->SETTINGS['fee_type'] == 1) {\n$query = \"UPDATE \" . $DBPrefix . \"users SET balance = balance - :relist_fee WHERE id = :user_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n\n", "id": 604, "slice_label": "bad", "file_name": "D:\\bad_56_16.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'update') {\n    if (isset($_POST['relist']) && is_array($_POST['relist']) && count($_POST['relist']) > 0) {\n        foreach ($_POST['relist'] as $k) {\n$query = \"UPDATE \" . $DBPrefix . \"counters SET auctions = auctions + 1\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 605, "slice_label": "bad", "file_name": "D:\\bad_56_16.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'update') {\n    if (isset($_POST['relist']) && is_array($_POST['relist']) && count($_POST['relist']) > 0) {\n        foreach ($_POST['relist'] as $k) {\n$query = \"SELECT left_id, right_id, level FROM \" . $DBPrefix . \"categories WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 606, "slice_label": "bad", "file_name": "D:\\bad_56_16.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$user->checkSuspended();\n$catscontrol = new MPTTcategories();\n$query0 = \"SELECT value FROM \" . $DBPrefix . \"fees WHERE type = 'relist_fee'\";\n$db->direct_query($query0);\n$relist_fee = $db->result('value');\nif (isset($_POST['action']) && $_POST['action'] == 'update') {\n    if (isset($_POST['delete']) && is_array($_POST['delete']) && count($_POST['delete']) > 0) {\n        foreach ($_POST['delete'] as $k => $v) {\n            $db->direct_query($query0);\n            $params = array();\n            $params[] = array(':auc_id', $v, 'int');\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n        }\n}\n    if (isset($_POST['sell']) && is_array($_POST['sell']) && count($_POST['sell']) > 0) {\n        foreach ($_POST['sell'] as $v) {\n            $db->query($query0, $params);\n        }\n}\n    if (isset($_POST['relist']) && is_array($_POST['relist']) && count($_POST['relist']) > 0) {\n        foreach ($_POST['relist'] as $k) {\n            $db->query($query0, $params);\n            if ($system->SETTINGS['fees'] == 'y' && !$user->permissions['no_fees'] && $relist_fee > 0) {\n                if ($system->SETTINGS['fee_type'] == 1) {\n                    $db->query($query0, $params);\n                }\n}\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n            $db->direct_query($query0);\n            $db->query($query0, $params);\n            $parent_node = $db->result();\n            $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n            for ($i = 0; $i < count($crumbs); $i++) {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET sub_counter = sub_counter + 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n\n", "id": 607, "slice_label": "bad", "file_name": "D:\\bad_56_16.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'delopenauctions') {\n    if (isset($_POST['O_delete']) && is_array($_POST['O_delete']) && count($_POST['O_delete']) > 0) {\n$query = \"UPDATE \" . $DBPrefix . \"counters SET auctions = (auctions - :removed;\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 608, "slice_label": "bad", "file_name": "D:\\bad_56_17.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'delopenauctions') {\n    if (isset($_POST['O_delete']) && is_array($_POST['O_delete']) && count($_POST['O_delete']) > 0) {\n        foreach ($_POST['O_delete'] as $k => $v) {\n            $v = intval($v);\n}\n}\n    if (isset($_POST['startnow']) && is_array($_POST['startnow']) && count($_POST['startnow']) > 0) {\n        foreach ($_POST['startnow'] as $k => $v) {\n$query = \"SELECT duration FROM \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 609, "slice_label": "bad", "file_name": "D:\\bad_56_17.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'delopenauctions') {\n    if (isset($_POST['O_delete']) && is_array($_POST['O_delete']) && count($_POST['O_delete']) > 0) {\n        foreach ($_POST['O_delete'] as $k => $v) {\n            $v = intval($v);\n}\n}\n    if (isset($_POST['startnow']) && is_array($_POST['startnow']) && count($_POST['startnow']) > 0) {\n        foreach ($_POST['startnow'] as $k => $v) {\n$query = \"UPDATE \" . $DBPrefix . \"auctions SET starts = CURRENT_TIMESTAMP, ends = :ends WHERE id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 610, "slice_label": "bad", "file_name": "D:\\bad_56_17.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$add = $_GET['input0'];\n$second_category = $_GET['input1'];\n\n// php code: \n    $addsub = ($add) ? '+' : '-';\n    if ($second_category > 0) {\n$query = \"UPDATE \" . _PAD_ . \"categories SET counter = counter \" . $addsub . \" 1 WHERE cat_id = :cat_id\";\t\t//sink point: $addsub;\n$res = mysql_query($query);\n}\n\n", "id": 611, "slice_label": "bad", "file_name": "D:\\good_56_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$second_category = $_GET['input0'];\n\n// php code: \n    if ($second_category > 0) {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET counter = counter \" . _PAD_ . \" 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 612, "slice_label": "bad", "file_name": "D:\\good_56_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$second_category = $_GET['input0'];\n\n// php code: \n    if ($second_category > 0) {\n$query = \"SELECT left_id, right_id, level FROM \" . $DBPrefix . \"categories WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 613, "slice_label": "bad", "file_name": "D:\\good_56_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$add = $_GET['input0'];\n$category = $_GET['input1'];\n$second_category = $_GET['input2'];\n\n// php code: \n    $addsub = ($add) ? '+' : '-';\n    $query0 = \"UPDATE \" . $DBPrefix . \"categories SET counter = counter \" . $addsub . \" 1 WHERE cat_id = :cat_id\";\n    $params = array();\n    $params[] = array(':cat_id', $category, 'int');\n    $db->query($query0, $params);\n    $db->query($query0, $params);\n    $parent_node = $db->result();\n    $category_crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n    if ($second_category > 0) {\n        $second_category_crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n        $crumbs = $category_crumbs + $second_category_crumbs;\n    }\nelse {\n        $crumbs = $category_crumbs;\n    }\n    for ($i = 0; $i < count($crumbs); $i++) {\n$query = \"UPDATE \" . _PAD_ . \"categories SET sub_counter = sub_counter \" . $addsub . \" 1 WHERE cat_id = :cat_id\";\t\t//sink point: $addsub;\n$res = mysql_query($query);\n}\n\n", "id": 614, "slice_label": "bad", "file_name": "D:\\good_56_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$add = $_GET['input0'];\n$category = $_GET['input1'];\n$second_category = $_GET['input2'];\n\n// php code: \n    $addsub = ($add) ? '+' : '-';\n    $query0 = \"UPDATE \" . $DBPrefix . \"categories SET counter = counter \" . $addsub . \" 1 WHERE cat_id = :cat_id\";\n    $params = array();\n    $params[] = array(':cat_id', $category, 'int');\n    $db->query($query0, $params);\n    $db->query($query0, $params);\n    $parent_node = $db->result();\n    $category_crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n    if ($second_category > 0) {\n        $second_category_crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n        $crumbs = $category_crumbs + $second_category_crumbs;\n    }\nelse {\n        $crumbs = $category_crumbs;\n    }\n    for ($i = 0; $i < count($crumbs); $i++) {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET sub_counter = sub_counter \" . _PAD_ . \" 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 615, "slice_label": "bad", "file_name": "D:\\good_56_6.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'delopenauctions') {\n    if (isset($_POST['O_delete']) && is_array($_POST['O_delete']) && count($_POST['O_delete']) > 0) {\n$query = \"UPDATE \" . $DBPrefix . \"counters SET auctions = (auctions - :removed;\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 616, "slice_label": "bad", "file_name": "D:\\bad_56_18.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'update') {\n    if (isset($_POST['relist']) && is_array($_POST['relist']) && count($_POST['relist']) > 0) {\n        foreach ($_POST['relist'] as $k) {\n$query = \"SELECT duration, category FROM \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 617, "slice_label": "bad", "file_name": "D:\\bad_56_19.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$user->checkSuspended();\n$query0 = \"SELECT value FROM \" . $DBPrefix . \"fees WHERE type = 'relist_fee'\";\n$db->direct_query($query0);\n$relist_fee = $db->result('value');\nif (isset($_POST['action']) && $_POST['action'] == 'update') {\n    if (isset($_POST['relist']) && is_array($_POST['relist']) && count($_POST['relist']) > 0) {\n        foreach ($_POST['relist'] as $k) {\n            if ($system->SETTINGS['fees'] == 'y' && !$user->permissions['no_fees'] && $relist_fee > 0) {\n                if ($system->SETTINGS['fee_type'] == 1) {\n$query = \"UPDATE \" . $DBPrefix . \"users SET balance = balance - :relist_fee WHERE id = :user_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n\n", "id": 618, "slice_label": "bad", "file_name": "D:\\bad_56_19.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'update') {\n    if (isset($_POST['relist']) && is_array($_POST['relist']) && count($_POST['relist']) > 0) {\n        foreach ($_POST['relist'] as $k) {\n$query = \"UPDATE \" . $DBPrefix . \"counters SET auctions = auctions + 1\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 619, "slice_label": "bad", "file_name": "D:\\bad_56_19.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (isset($_POST['action']) && $_POST['action'] == 'update') {\n    if (isset($_POST['relist']) && is_array($_POST['relist']) && count($_POST['relist']) > 0) {\n        foreach ($_POST['relist'] as $k) {\n$query = \"SELECT left_id, right_id, level FROM \" . $DBPrefix . \"categories WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 620, "slice_label": "bad", "file_name": "D:\\bad_56_19.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$user->checkSuspended();\n$query0 = \"SELECT value FROM \" . $DBPrefix . \"fees WHERE type = 'relist_fee'\";\n$db->direct_query($query0);\n$relist_fee = $db->result('value');\nif (isset($_POST['action']) && $_POST['action'] == 'update') {\n    if (isset($_POST['relist']) && is_array($_POST['relist']) && count($_POST['relist']) > 0) {\n        foreach ($_POST['relist'] as $k) {\n            $params = array();\n            $params[] = array(':auc_id', $k, 'int');\n            $db->query($query0, $params);\n            if ($system->SETTINGS['fees'] == 'y' && !$user->permissions['no_fees'] && $relist_fee > 0) {\n                if ($system->SETTINGS['fee_type'] == 1) {\n                    $db->query($query0, $params);\n                }\n}\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n            $db->direct_query($query0);\n            $db->query($query0, $params);\n            $parent_node = $db->result();\n            $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n            for ($i = 0; $i < count($crumbs); $i++) {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET sub_counter = sub_counter + 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n\n", "id": 621, "slice_label": "bad", "file_name": "D:\\bad_56_19.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = (isset($_SESSION['CURRENT_ITEM'])) ? intval($_SESSION['CURRENT_ITEM']) : 0;\n$id = (isset($_REQUEST['id'])) ? intval($_REQUEST['id']) : 0;\n$query0 = \"SELECT a.*, ac.counter, u.nick, u.reg_date, u.city, u.country, u.zip FROM \" . $DBPrefix . \"auctions a\n\t        LEFT JOIN \" . $DBPrefix . \"users u ON (u.id = a.user)\n\t        LEFT JOIN \" . $DBPrefix . \"auccounter ac ON (ac.auction_id = a.id)\n\t        WHERE a.id = :auction_id LIMIT 1\";\n$params = array();\n$params[] = array(':auction_id', $id, 'int');\n$db->query($query0, $params);\n$auction_data = $db->result();\nif (!isset($auction_data['counter'])) {\n$query = \"INSERT INTO `\" . $DBPrefix . \"auccounter` (`auction_id`, `counter`) VALUES (:counter, 1;\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 622, "slice_label": "bad", "file_name": "D:\\good_56_8.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = (isset($_SESSION['CURRENT_ITEM'])) ? intval($_SESSION['CURRENT_ITEM']) : 0;\n$id = (isset($_REQUEST['id'])) ? intval($_REQUEST['id']) : 0;\n$_SESSION['CURRENT_ITEM'] = $id;\n$_SESSION['REDIRECT_AFTER_LOGIN'] = $system->SETTINGS['siteurl'] . 'item.php?id=' . $id;\n$query0 = \"SELECT a.*, ac.counter, u.nick, u.reg_date, u.city, u.country, u.zip FROM \" . $DBPrefix . \"auctions a\n\t        LEFT JOIN \" . $DBPrefix . \"users u ON (u.id = a.user)\n\t        LEFT JOIN \" . $DBPrefix . \"auccounter ac ON (ac.auction_id = a.id)\n\t        WHERE a.id = :auction_id LIMIT 1\";\n$params = array();\n$params[] = array(':auction_id', $id, 'int');\n$db->query($query0, $params);\nif ($db->numrows() == 0) {\n    $_SESSION['msg_title'] = $ERR_622;\n    $_SESSION['msg_body'] = $ERR_623;\n}\n$auction_data = $db->result();\nif (!isset($auction_data['counter'])) {\n}\nelse {\n    if (!isset($_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n        $_SESSION['WEBID_VIEWED_AUCTIONS'] = array();\n    }\n    if (!in_array($id, $_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n$query = \"UPDATE \" . $DBPrefix . \"auccounter set counter = counter + 1 WHERE auction_id = :auction_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 623, "slice_label": "bad", "file_name": "D:\\good_56_8.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = (isset($_SESSION['CURRENT_ITEM'])) ? intval($_SESSION['CURRENT_ITEM']) : 0;\n$id = (isset($_REQUEST['id'])) ? intval($_REQUEST['id']) : 0;\n$query0 = \"SELECT a.*, ac.counter, u.nick, u.reg_date, u.city, u.country, u.zip FROM \" . $DBPrefix . \"auctions a\n\t        LEFT JOIN \" . $DBPrefix . \"users u ON (u.id = a.user)\n\t        LEFT JOIN \" . $DBPrefix . \"auccounter ac ON (ac.auction_id = a.id)\n\t        WHERE a.id = :auction_id LIMIT 1\";\n$params = array();\n$params[] = array(':auction_id', $id, 'int');\n$db->query($query0, $params);\n$auction_data = $db->result();\nif (!isset($auction_data['counter'])) {\n    $auction_data['counter'] = 1;\n}\nif ($system->SETTINGS['extra_cat'] == 'y' && intval($auction_data['secondcat']) > 0) {\n$query = \"SELECT left_id, right_id, level FROM \" . $DBPrefix . \"categories WHERE cat_id = :sec_cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 624, "slice_label": "bad", "file_name": "D:\\good_56_8.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = (isset($_SESSION['CURRENT_ITEM'])) ? intval($_SESSION['CURRENT_ITEM']) : 0;\n$id = (isset($_REQUEST['id'])) ? intval($_REQUEST['id']) : 0;\n$_SESSION['CURRENT_ITEM'] = $id;\n$_SESSION['REDIRECT_AFTER_LOGIN'] = $system->SETTINGS['siteurl'] . 'item.php?id=' . $id;\n$query0 = \"SELECT a.*, ac.counter, u.nick, u.reg_date, u.city, u.country, u.zip FROM \" . $DBPrefix . \"auctions a\n\t        LEFT JOIN \" . $DBPrefix . \"users u ON (u.id = a.user)\n\t        LEFT JOIN \" . $DBPrefix . \"auccounter ac ON (ac.auction_id = a.id)\n\t        WHERE a.id = :auction_id LIMIT 1\";\n$params = array();\n$params[] = array(':auction_id', $id, 'int');\n$db->query($query0, $params);\nif ($db->numrows() == 0) {\n    $_SESSION['msg_title'] = $ERR_622;\n    $_SESSION['msg_body'] = $ERR_623;\n}\n$auction_data = $db->result();\nif (!isset($auction_data['counter'])) {\n    $params[] = array(':counter', $id, 'int');\n    $db->query($query0, $params);\n}\nelse {\n    if (!isset($_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n        $_SESSION['WEBID_VIEWED_AUCTIONS'] = array();\n    }\n    if (!in_array($id, $_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n        $db->query($query0, $params);\n}\n}\nif ($user->logged_in) {\n    $db->query($query0, $params);\n}\n$db->query($query0, $params);\nif ($system->SETTINGS['extra_cat'] == 'y' && intval($auction_data['secondcat']) > 0) {\n    $db->query($query0, $params);\n}\n$db->query($query0, $params);\n$left = $auction_data['quantity'];\n$hbidder_data = array();\nforeach ($db->fetchall() as $bidrec) {\n    if ($left > 0 && !in_array($bidrec['bidder'], $hbidder_data)) {\n$query = \"SELECT rate FROM \" . $DBPrefix . \"feedbacks WHERE rated_user_id = :rate_users_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 625, "slice_label": "bad", "file_name": "D:\\good_56_8.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = (isset($_SESSION['CURRENT_ITEM'])) ? intval($_SESSION['CURRENT_ITEM']) : 0;\n$id = (isset($_REQUEST['id'])) ? intval($_REQUEST['id']) : 0;\n$_SESSION['CURRENT_ITEM'] = $id;\n$_SESSION['REDIRECT_AFTER_LOGIN'] = $system->SETTINGS['siteurl'] . 'item.php?id=' . $id;\n$query0 = \"SELECT a.*, ac.counter, u.nick, u.reg_date, u.city, u.country, u.zip FROM \" . $DBPrefix . \"auctions a\n\t        LEFT JOIN \" . $DBPrefix . \"users u ON (u.id = a.user)\n\t        LEFT JOIN \" . $DBPrefix . \"auccounter ac ON (ac.auction_id = a.id)\n\t        WHERE a.id = :auction_id LIMIT 1\";\n$params = array();\n$params[] = array(':auction_id', $id, 'int');\n$db->query($query0, $params);\nif ($db->numrows() == 0) {\n    $_SESSION['msg_title'] = $ERR_622;\n    $_SESSION['msg_body'] = $ERR_623;\n}\n$auction_data = $db->result();\nif (!isset($auction_data['counter'])) {\n    $params[] = array(':counter', $id, 'int');\n    $db->query($query0, $params);\n}\nelse {\n    if (!isset($_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n        $_SESSION['WEBID_VIEWED_AUCTIONS'] = array();\n    }\n    if (!in_array($id, $_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n        $db->query($query0, $params);\n}\n}\nif ($user->logged_in) {\n    $db->query($query0, $params);\n}\n$db->query($query0, $params);\nif ($system->SETTINGS['extra_cat'] == 'y' && intval($auction_data['secondcat']) > 0) {\n    $db->query($query0, $params);\n}\n$db->query($query0, $params);\n$left = $auction_data['quantity'];\n$hbidder_data = array();\nforeach ($db->fetchall() as $bidrec) {\n    if ($left > 0 && !in_array($bidrec['bidder'], $hbidder_data)) {\n$query = \"SELECT icon FROM \" . $DBPrefix . \"membertypes WHERE feedbacks <= :feedback ORDER BY feedbacks DESC LIMIT 1;\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 626, "slice_label": "bad", "file_name": "D:\\good_56_8.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = (isset($_SESSION['CURRENT_ITEM'])) ? intval($_SESSION['CURRENT_ITEM']) : 0;\n$id = (isset($_REQUEST['id'])) ? intval($_REQUEST['id']) : 0;\n$_SESSION['CURRENT_ITEM'] = $id;\n$_SESSION['REDIRECT_AFTER_LOGIN'] = $system->SETTINGS['siteurl'] . 'item.php?id=' . $id;\n$query0 = \"SELECT a.*, ac.counter, u.nick, u.reg_date, u.city, u.country, u.zip FROM \" . $DBPrefix . \"auctions a\n\t        LEFT JOIN \" . $DBPrefix . \"users u ON (u.id = a.user)\n\t        LEFT JOIN \" . $DBPrefix . \"auccounter ac ON (ac.auction_id = a.id)\n\t        WHERE a.id = :auction_id LIMIT 1\";\n$params = array();\n$params[] = array(':auction_id', $id, 'int');\n$db->query($query0, $params);\nif ($db->numrows() == 0) {\n    $_SESSION['msg_title'] = $ERR_622;\n    $_SESSION['msg_body'] = $ERR_623;\n}\n$auction_data = $db->result();\nif (!isset($auction_data['counter'])) {\n    $params[] = array(':counter', $id, 'int');\n    $db->query($query0, $params);\n}\nelse {\n    if (!isset($_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n        $_SESSION['WEBID_VIEWED_AUCTIONS'] = array();\n    }\n    if (!in_array($id, $_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n        $db->query($query0, $params);\n}\n}\nif ($user->logged_in) {\n    $db->query($query0, $params);\n}\n$db->query($query0, $params);\nif ($system->SETTINGS['extra_cat'] == 'y' && intval($auction_data['secondcat']) > 0) {\n    $db->query($query0, $params);\n}\n$db->query($query0, $params);\n$num_bids = $db->numrows();\nif ($user->logged_in && $num_bids > 0) {\n$query = \"SELECT bid FROM \" . $DBPrefix . \"bids WHERE auction = :auction AND bidder = :bidder LIMIT 1\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 627, "slice_label": "bad", "file_name": "D:\\good_56_8.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = (isset($_SESSION['CURRENT_ITEM'])) ? intval($_SESSION['CURRENT_ITEM']) : 0;\n$id = (isset($_REQUEST['id'])) ? intval($_REQUEST['id']) : 0;\n$_SESSION['CURRENT_ITEM'] = $id;\n$_SESSION['REDIRECT_AFTER_LOGIN'] = $system->SETTINGS['siteurl'] . 'item.php?id=' . $id;\n$query0 = \"SELECT a.*, ac.counter, u.nick, u.reg_date, u.city, u.country, u.zip FROM \" . $DBPrefix . \"auctions a\n\t        LEFT JOIN \" . $DBPrefix . \"users u ON (u.id = a.user)\n\t        LEFT JOIN \" . $DBPrefix . \"auccounter ac ON (ac.auction_id = a.id)\n\t        WHERE a.id = :auction_id LIMIT 1\";\n$params = array();\n$params[] = array(':auction_id', $id, 'int');\n$db->query($query0, $params);\nif ($db->numrows() == 0) {\n    $_SESSION['msg_title'] = $ERR_622;\n    $_SESSION['msg_body'] = $ERR_623;\n}\n$auction_data = $db->result();\nif (!isset($auction_data['counter'])) {\n    $params[] = array(':counter', $id, 'int');\n    $db->query($query0, $params);\n}\nelse {\n    if (!isset($_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n        $_SESSION['WEBID_VIEWED_AUCTIONS'] = array();\n    }\n    if (!in_array($id, $_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n        $db->query($query0, $params);\n}\n}\nif ($user->logged_in) {\n    $db->query($query0, $params);\n}\n$db->query($query0, $params);\nif ($system->SETTINGS['extra_cat'] == 'y' && intval($auction_data['secondcat']) > 0) {\n    $db->query($query0, $params);\n}\n$db->query($query0, $params);\n$num_bids = $db->numrows();\n$left = $auction_data['quantity'];\n$hbidder_data = array();\nforeach ($db->fetchall() as $bidrec) {\n    if ($left > 0 && !in_array($bidrec['bidder'], $hbidder_data)) {\n        $db->query($query0, $params);\n        $db->query($query0, $params);\n}\n}\nif ($user->logged_in && $num_bids > 0) {\n    $db->query($query0, $params);\n}\n$db->query($query0, $params);\nforeach ($db->fetchall() as $row) {\n$query = \"SELECT sentfrom, message FROM \" . $DBPrefix . \"messages WHERE question = :id AND reply_of = :reply_of OR id = :message_id ORDER BY sentat ASC\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 628, "slice_label": "bad", "file_name": "D:\\good_56_8.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$id_column = 'user' == $meta_type ? 'umeta_id' : 'meta_id';\n$query = \"SELECT $id_column FROM _PAD_ WHERE meta_key = %s AND _PAD_ = %d\", _PAD_, _PAD_ );\t\t//sink point: $id_column;\n$res = mysql_query($query);\n\n", "id": 629, "slice_label": "bad", "file_name": "D:\\good_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$table = _get_meta_table( $meta_type );\n$query = \"SELECT _PAD_ FROM $table WHERE meta_key = %s AND _PAD_ = %d\", _PAD_, _PAD_ );\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 630, "slice_label": "bad", "file_name": "D:\\good_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$column = sanitize_key($meta_type . '_id');\n$query = \"SELECT _PAD_ FROM _PAD_ WHERE meta_key = %s AND $column = %d\", _PAD_, _PAD_ );\t\t//sink point: $column;\n$res = mysql_query($query);\n\n", "id": 631, "slice_label": "bad", "file_name": "D:\\good_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_key = $_GET['input0'];\n\n// php code: \n\t$meta_key = wp_unslash($meta_key);\n$query = \"SELECT _PAD_ FROM _PAD_ WHERE meta_key = %s AND _PAD_ = %d\", $meta_key, _PAD_ );\t\t//sink point: $meta_key;\n$res = mysql_query($query);\n\n", "id": 632, "slice_label": "bad", "file_name": "D:\\good_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$object_id = $_GET['input0'];\n\n// php code: \n\t$object_id = absint( $object_id );\n$query = \"SELECT _PAD_ FROM _PAD_ WHERE meta_key = %s AND _PAD_ = %d\", _PAD_, $object_id );\t\t//sink point: $object_id;\n$res = mysql_query($query);\n\n", "id": 633, "slice_label": "bad", "file_name": "D:\\good_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$id_column = 'user' == $meta_type ? 'umeta_id' : 'meta_id';\n$query = \"SELECT $id_column FROM _PAD_ WHERE meta_key = %s\", _PAD_;\t\t//sink point: $id_column;\n$res = mysql_query($query);\n\n", "id": 634, "slice_label": "bad", "file_name": "D:\\good_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_key = $_GET['input0'];\n\n// php code: \n\t$meta_key = wp_unslash($meta_key);\n$query = \"SELECT _PAD_ FROM _PAD_ WHERE meta_key = %s\", $meta_key;\t\t//sink point: $meta_key;\n$res = mysql_query($query);\n\n", "id": 635, "slice_label": "bad", "file_name": "D:\\good_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$table = _get_meta_table( $meta_type );\n$query = \"SELECT _PAD_ FROM $table WHERE meta_key = %s\", _PAD_;\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 636, "slice_label": "bad", "file_name": "D:\\good_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_key = $_GET['input0'];\n$meta_value = $_GET['input1'];\n$delete_all = $_GET['input2'];\n\n// php code: \n\t$meta_key = wp_unslash($meta_key);\n\t$meta_value = wp_unslash($meta_value);\n\t$meta_value = maybe_serialize( $meta_value );\n\tif ( $delete_all ) {\n\t\tif ( '' !== $meta_value && null !== $meta_value && false !== $meta_value ) {\n$query = \"SELECT _PAD_ FROM _PAD_ WHERE meta_key = %s AND meta_value = %s\", $meta_key, _PAD_ );\t\t//sink point: $meta_key;\n$res = mysql_query($query);\n\t\t}\n}\n\n", "id": 637, "slice_label": "bad", "file_name": "D:\\good_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n$meta_value = $_GET['input1'];\n$delete_all = $_GET['input2'];\n\n// php code: \n\t$table = _get_meta_table( $meta_type );\n\t$meta_value = wp_unslash($meta_value);\n\t$meta_value = maybe_serialize( $meta_value );\n\tif ( $delete_all ) {\n\t\tif ( '' !== $meta_value && null !== $meta_value && false !== $meta_value ) {\n$query = \"SELECT _PAD_ FROM $table WHERE meta_key = %s AND meta_value = %s\", _PAD_, _PAD_ );\t\t//sink point: $table;\n$res = mysql_query($query);\n\t\t}\n}\n\n", "id": 638, "slice_label": "bad", "file_name": "D:\\good_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_value = $_GET['input0'];\n$delete_all = $_GET['input1'];\n\n// php code: \n\t$meta_value = wp_unslash($meta_value);\n\t$meta_value = maybe_serialize( $meta_value );\n\tif ( $delete_all ) {\n\t\tif ( '' !== $meta_value && null !== $meta_value && false !== $meta_value ) {\n$query = \"SELECT _PAD_ FROM _PAD_ WHERE meta_key = %s AND meta_value = %s\", _PAD_, $meta_value );\t\t//sink point: $meta_value;\n$res = mysql_query($query);\n\t\t}\n}\n\n", "id": 639, "slice_label": "bad", "file_name": "D:\\good_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n$meta_value = $_GET['input1'];\n$delete_all = $_GET['input2'];\n\n// php code: \n\t$type_column = sanitize_key($meta_type . '_id');\n\t$meta_value = wp_unslash($meta_value);\n\t$meta_value = maybe_serialize( $meta_value );\n\tif ( $delete_all ) {\n\t\tif ( '' !== $meta_value && null !== $meta_value && false !== $meta_value ) {\n$query = \"SELECT $type_column FROM _PAD_ WHERE meta_key = %s AND meta_value = %s\", _PAD_, _PAD_ );\t\t//sink point: $type_column;\n$res = mysql_query($query);\n\t\t}\n}\n\n", "id": 640, "slice_label": "bad", "file_name": "D:\\good_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_key = $_GET['input0'];\n$meta_value = $_GET['input1'];\n$delete_all = $_GET['input2'];\n\n// php code: \n\t$meta_key = wp_unslash($meta_key);\n\t$meta_value = wp_unslash($meta_value);\n\t$meta_value = maybe_serialize( $meta_value );\n\tif ( $delete_all ) {\n\t\tif ( '' !== $meta_value && null !== $meta_value && false !== $meta_value ) {\n}\nelse {\n$query = \"SELECT _PAD_ FROM _PAD_ WHERE meta_key = %s\", $meta_key );\t\t//sink point: $meta_key;\n$res = mysql_query($query);\n\t\t}\n}\n\n", "id": 641, "slice_label": "bad", "file_name": "D:\\good_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n$meta_value = $_GET['input1'];\n$delete_all = $_GET['input2'];\n\n// php code: \n\t$table = _get_meta_table( $meta_type );\n\t$meta_value = wp_unslash($meta_value);\n\t$meta_value = maybe_serialize( $meta_value );\n\tif ( $delete_all ) {\n\t\tif ( '' !== $meta_value && null !== $meta_value && false !== $meta_value ) {\n}\nelse {\n$query = \"SELECT _PAD_ FROM $table WHERE meta_key = %s\", _PAD_ );\t\t//sink point: $table;\n$res = mysql_query($query);\n\t\t}\n}\n\n", "id": 642, "slice_label": "bad", "file_name": "D:\\good_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n$meta_value = $_GET['input1'];\n$delete_all = $_GET['input2'];\n\n// php code: \n\t$type_column = sanitize_key($meta_type . '_id');\n\t$meta_value = wp_unslash($meta_value);\n\t$meta_value = maybe_serialize( $meta_value );\n\tif ( $delete_all ) {\n\t\tif ( '' !== $meta_value && null !== $meta_value && false !== $meta_value ) {\n}\nelse {\n$query = \"SELECT $type_column FROM _PAD_ WHERE meta_key = %s\", _PAD_ );\t\t//sink point: $type_column;\n$res = mysql_query($query);\n\t\t}\n}\n\n", "id": 643, "slice_label": "bad", "file_name": "D:\\good_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$id_column = ( 'user' == $meta_type ) ? 'umeta_id' : 'meta_id';\n$query = \"SELECT * FROM _PAD_ WHERE $id_column = %d\", _PAD_ );\t\t//sink point: $id_column;\n$res = mysql_query($query);\n\n", "id": 644, "slice_label": "bad", "file_name": "D:\\good_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$table = _get_meta_table( $meta_type );\n$query = \"SELECT * FROM $table WHERE _PAD_ = %d\", _PAD_ );\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 645, "slice_label": "bad", "file_name": "D:\\good_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_id = $_GET['input0'];\n\n// php code: \n\t$meta_id = intval( $meta_id );\n$query = \"SELECT * FROM _PAD_ WHERE _PAD_ = %d\", $meta_id );\t\t//sink point: $meta_id;\n$res = mysql_query($query);\n\n", "id": 646, "slice_label": "bad", "file_name": "D:\\good_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$column = sanitize_key($meta_type . '_id');\n$query = \"SELECT $column, meta_key, meta_value FROM _PAD_ WHERE $column IN (_PAD_) ORDER BY _PAD_ ASC\", ARRAY_A;\t\t//sink point: $column;\n$res = mysql_query($query);\n\n", "id": 647, "slice_label": "bad", "file_name": "D:\\good_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$id_column = 'user' == $meta_type ? 'umeta_id' : 'meta_id';\n$query = \"SELECT _PAD_, meta_key, meta_value FROM _PAD_ WHERE _PAD_ IN (_PAD_) ORDER BY $id_column ASC\", ARRAY_A;\t\t//sink point: $id_column;\n$res = mysql_query($query);\n\n", "id": 648, "slice_label": "bad", "file_name": "D:\\good_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$table = _get_meta_table( $meta_type );\n$query = \"SELECT _PAD_, meta_key, meta_value FROM $table WHERE _PAD_ IN (_PAD_) ORDER BY _PAD_ ASC\", ARRAY_A;\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 649, "slice_label": "bad", "file_name": "D:\\good_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n$object_ids = $_GET['input1'];\n\n// php code: \n\tif ( !is_array($object_ids) ) {\n\t\t$object_ids = preg_replace('|[^0-9,]|', '', $object_ids);\n\t\t$object_ids = explode(',', $object_ids);\n\t}\n\t$object_ids = array_map('intval', $object_ids);\n\t$cache_key = $meta_type . '_meta';\n\t$ids = array();\n\tforeach ( $object_ids as $id ) {\n\t\t$cached_object = wp_cache_get( $id, $cache_key );\n\t\tif ( false === $cached_object )\n\t\t\t$ids[] = $id;\n}\n\t$id_list = join( ',', $ids );\n$query = \"SELECT _PAD_, meta_key, meta_value FROM _PAD_ WHERE _PAD_ IN ($id_list) ORDER BY _PAD_ ASC\", ARRAY_A;\t\t//sink point: $id_list;\n$res = mysql_query($query);\n\n", "id": 650, "slice_label": "bad", "file_name": "D:\\good_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$ends = $_GET['input0'];\n\n// php code: \n    if ($system->SETTINGS['ae_status'] == 'y' && (strtotime($ends) - $system->SETTINGS['ae_timebefore']) < time()) {\n$query = \"UPDATE \" . $DBPrefix . \"auctions SET ends = DATE_ADD(ends, INTERVAL \" . _PAD_->SETTINGS['ae_extend'] . \" SECOND;\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 651, "slice_label": "bad", "file_name": "D:\\bad_56_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$ends = $_GET['input0'];\n\n// php code: \n    if ($system->SETTINGS['ae_status'] == 'y' && (strtotime($ends) - $system->SETTINGS['ae_timebefore']) < time()) {\n$query = \"UPDATE \" . _PAD_ . \"auctions SET ends = DATE_ADD(ends, INTERVAL \" . $system->SETTINGS['ae_extend'] . \" SECOND;\t\t//sink point: $system;\n$res = mysql_query($query);\n}\n\n", "id": 652, "slice_label": "bad", "file_name": "D:\\bad_56_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = intval($_REQUEST['id']);\n$bid = (isset($_POST['bid'])) ? $_POST['bid'] : 0;\n$qty = (isset($_POST['qty'])) ? intval($_POST['qty']) : 1;\n$query0 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $DBPrefix . \"auctions a\n          LEFT JOIN \" . $DBPrefix . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$params = array();\n$params[] = array(':auc_id', $id, 'int');\n$db->query($query0, $params);\nif (empty($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_072;\n}\nif (!$system->CheckMoney($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_058;\n}\nelse {\n    $bid = round($system->input_money($bid), 2);\n}\n$Data = $db->result();\n$atype = $Data['auction_type'];\n$aquantity = $Data['quantity'];\n$current_bid = $Data['current_bid'];\nif ((strtotime($Data['ends']) <= time() || $Data['closed']) && !isset($errmsg)) {\n    $errmsg = $ERR_614;\n}\nif ((strtotime($Data['starts']) > time()) && !isset($errmsg)) {\n    $errmsg = $ERR_073;\n}\nif ($aquantity < $qty) {\n    $errmsg = $ERR_608;\n}\n$tmpmsg = CheckBidData();\nif ($tmpmsg != 0 && !isset($errmsg)) {\n    $errmsg = ${\n'ERR_' . $tmpmsg}\n;\n}\nif (isset($_POST['action']) && !isset($errmsg)) {\n    if ($atype == 1 && !isset($errmsg)) {\n        if ($system->SETTINGS['proxy_bidding'] == 'n') {\n            if ($current_bid < $bid) {\n$query = \"SELECT u.id FROM \" . $DBPrefix . \"bids b, \" . $DBPrefix . \"users u WHERE b.auction = :auc_id AND b.bidder = u.id and u.suspended = 0 ORDER BY bid DESC\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n\n", "id": 653, "slice_label": "bad", "file_name": "D:\\bad_56_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = intval($_REQUEST['id']);\n$bid = (isset($_POST['bid'])) ? $_POST['bid'] : 0;\n$qty = (isset($_POST['qty'])) ? intval($_POST['qty']) : 1;\n$query0 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $DBPrefix . \"auctions a\n          LEFT JOIN \" . $DBPrefix . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$params = array();\n$params[] = array(':auc_id', $id, 'int');\n$db->query($query0, $params);\nif (empty($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_072;\n}\nif (!$system->CheckMoney($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_058;\n}\nelse {\n    $bid = round($system->input_money($bid), 2);\n}\n$Data = $db->result();\n$atype = $Data['auction_type'];\n$aquantity = $Data['quantity'];\n$current_bid = $Data['current_bid'];\nif ((strtotime($Data['ends']) <= time() || $Data['closed']) && !isset($errmsg)) {\n    $errmsg = $ERR_614;\n}\nif ((strtotime($Data['starts']) > time()) && !isset($errmsg)) {\n    $errmsg = $ERR_073;\n}\nif ($aquantity < $qty) {\n    $errmsg = $ERR_608;\n}\n$tmpmsg = CheckBidData();\nif ($tmpmsg != 0 && !isset($errmsg)) {\n    $errmsg = ${\n'ERR_' . $tmpmsg}\n;\n}\nif (isset($_POST['action']) && !isset($errmsg)) {\n    if ($atype == 1 && !isset($errmsg)) {\n        if ($system->SETTINGS['proxy_bidding'] == 'n') {\n            if ($current_bid < $bid) {\n$query = \"INSERT INTO \" . $DBPrefix . \"bids (auction, bidder, bid, quantity;\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                          VALUES (:auc_id, :bidder_id, :bid, :qty)\";\n}\n}\n}\n}\n\n", "id": 654, "slice_label": "bad", "file_name": "D:\\bad_56_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = intval($_REQUEST['id']);\n$bid = (isset($_POST['bid'])) ? $_POST['bid'] : 0;\n$qty = (isset($_POST['qty'])) ? intval($_POST['qty']) : 1;\n$query0 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $DBPrefix . \"auctions a\n          LEFT JOIN \" . $DBPrefix . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$params = array();\n$params[] = array(':auc_id', $id, 'int');\n$db->query($query0, $params);\nif (empty($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_072;\n}\nif (!$system->CheckMoney($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_058;\n}\nelse {\n    $bid = round($system->input_money($bid), 2);\n}\n$Data = $db->result();\n$atype = $Data['auction_type'];\n$aquantity = $Data['quantity'];\n$current_bid = $Data['current_bid'];\nif ((strtotime($Data['ends']) <= time() || $Data['closed']) && !isset($errmsg)) {\n    $errmsg = $ERR_614;\n}\nif ((strtotime($Data['starts']) > time()) && !isset($errmsg)) {\n    $errmsg = $ERR_073;\n}\nif ($aquantity < $qty) {\n    $errmsg = $ERR_608;\n}\n$tmpmsg = CheckBidData();\nif ($tmpmsg != 0 && !isset($errmsg)) {\n    $errmsg = ${\n'ERR_' . $tmpmsg}\n;\n}\nif (isset($_POST['action']) && !isset($errmsg)) {\n    if ($atype == 1 && !isset($errmsg)) {\n        if ($system->SETTINGS['proxy_bidding'] == 'n') {\n            if ($current_bid < $bid) {\n$query = \"UPDATE \" . $DBPrefix . \"auctions SET current_bid = :bid, current_bid_id = :current_bid_id, num_bids = num_bids + 1 WHERE id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n\n", "id": 655, "slice_label": "bad", "file_name": "D:\\bad_56_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = intval($_REQUEST['id']);\n$bid = (isset($_POST['bid'])) ? $_POST['bid'] : 0;\n$qty = (isset($_POST['qty'])) ? intval($_POST['qty']) : 1;\n$query0 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $DBPrefix . \"auctions a\n          LEFT JOIN \" . $DBPrefix . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$params = array();\n$params[] = array(':auc_id', $id, 'int');\n$db->query($query0, $params);\nif (empty($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_072;\n}\nif (!$system->CheckMoney($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_058;\n}\n$Data = $db->result();\n$atype = $Data['auction_type'];\n$aquantity = $Data['quantity'];\nif ((strtotime($Data['ends']) <= time() || $Data['closed']) && !isset($errmsg)) {\n    $errmsg = $ERR_614;\n}\nif ((strtotime($Data['starts']) > time()) && !isset($errmsg)) {\n    $errmsg = $ERR_073;\n}\nif ($aquantity < $qty) {\n    $errmsg = $ERR_608;\n}\n$tmpmsg = CheckBidData();\nif ($tmpmsg != 0 && !isset($errmsg)) {\n    $errmsg = ${\n'ERR_' . $tmpmsg}\n;\n}\nif (isset($_POST['action']) && !isset($errmsg)) {\n    if ($atype == 1 && !isset($errmsg)) {\n}\nelse if ($atype == 2 && !isset($errmsg)) {\n$query = \"SELECT bid, quantity FROM \" . $DBPrefix . \"bids WHERE bidder = :bidder_id AND auction = :auc_id ORDER BY bid DESC LIMIT 1\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 656, "slice_label": "bad", "file_name": "D:\\bad_56_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = intval($_REQUEST['id']);\n$bid = (isset($_POST['bid'])) ? $_POST['bid'] : 0;\n$qty = (isset($_POST['qty'])) ? intval($_POST['qty']) : 1;\n$query0 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $DBPrefix . \"auctions a\n          LEFT JOIN \" . $DBPrefix . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$params = array();\n$params[] = array(':auc_id', $id, 'int');\n$db->query($query0, $params);\nif (empty($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_072;\n}\nif (!$system->CheckMoney($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_058;\n}\n$Data = $db->result();\n$atype = $Data['auction_type'];\n$aquantity = $Data['quantity'];\nif ((strtotime($Data['ends']) <= time() || $Data['closed']) && !isset($errmsg)) {\n    $errmsg = $ERR_614;\n}\nif ((strtotime($Data['starts']) > time()) && !isset($errmsg)) {\n    $errmsg = $ERR_073;\n}\nif ($aquantity < $qty) {\n    $errmsg = $ERR_608;\n}\n$tmpmsg = CheckBidData();\nif ($tmpmsg != 0 && !isset($errmsg)) {\n    $errmsg = ${\n'ERR_' . $tmpmsg}\n;\n}\nif (isset($_POST['action']) && !isset($errmsg)) {\n    if ($atype == 1 && !isset($errmsg)) {\n}\nelse if ($atype == 2 && !isset($errmsg)) {\n        if (!isset($errmsg)) {\n$query = \"INSERT INTO \" . $DBPrefix . \"bids (auction, bidder, bid, quantity;\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                      VALUES (:auc_id, :bidder_id, :bid, :qty)\";\n}\n}\n}\n\n", "id": 657, "slice_label": "bad", "file_name": "D:\\bad_56_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = intval($_REQUEST['id']);\n$bid = (isset($_POST['bid'])) ? $_POST['bid'] : 0;\n$qty = (isset($_POST['qty'])) ? intval($_POST['qty']) : 1;\n$query0 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $DBPrefix . \"auctions a\n          LEFT JOIN \" . $DBPrefix . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$params = array();\n$params[] = array(':auc_id', $id, 'int');\n$db->query($query0, $params);\nif (empty($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_072;\n}\nif (!$system->CheckMoney($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_058;\n}\n$Data = $db->result();\n$atype = $Data['auction_type'];\n$aquantity = $Data['quantity'];\nif ((strtotime($Data['ends']) <= time() || $Data['closed']) && !isset($errmsg)) {\n    $errmsg = $ERR_614;\n}\nif ((strtotime($Data['starts']) > time()) && !isset($errmsg)) {\n    $errmsg = $ERR_073;\n}\nif ($aquantity < $qty) {\n    $errmsg = $ERR_608;\n}\n$tmpmsg = CheckBidData();\nif ($tmpmsg != 0 && !isset($errmsg)) {\n    $errmsg = ${\n'ERR_' . $tmpmsg}\n;\n}\nif (isset($_POST['action']) && !isset($errmsg)) {\n    if ($atype == 1 && !isset($errmsg)) {\n}\nelse if ($atype == 2 && !isset($errmsg)) {\n        if (!isset($errmsg)) {\n$query = \"UPDATE \" . $DBPrefix . \"counters SET bids = (bids + 1;\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 658, "slice_label": "bad", "file_name": "D:\\bad_56_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = intval($_REQUEST['id']);\n$bid = (isset($_POST['bid'])) ? $_POST['bid'] : 0;\n$qty = (isset($_POST['qty'])) ? intval($_POST['qty']) : 1;\n$query0 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $DBPrefix . \"auctions a\n          LEFT JOIN \" . $DBPrefix . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$params = array();\n$params[] = array(':auc_id', $id, 'int');\n$db->query($query0, $params);\nif (empty($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_072;\n}\nif (!$system->CheckMoney($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_058;\n}\n$Data = $db->result();\n$atype = $Data['auction_type'];\n$aquantity = $Data['quantity'];\nif ((strtotime($Data['ends']) <= time() || $Data['closed']) && !isset($errmsg)) {\n    $errmsg = $ERR_614;\n}\nif ((strtotime($Data['starts']) > time()) && !isset($errmsg)) {\n    $errmsg = $ERR_073;\n}\nif ($aquantity < $qty) {\n    $errmsg = $ERR_608;\n}\n$tmpmsg = CheckBidData();\nif ($tmpmsg != 0 && !isset($errmsg)) {\n    $errmsg = ${\n'ERR_' . $tmpmsg}\n;\n}\nif (isset($_POST['action']) && !isset($errmsg)) {\n    if ($atype == 1 && !isset($errmsg)) {\n}\nelse if ($atype == 2 && !isset($errmsg)) {\n        if (!isset($errmsg)) {\n$query = \"UPDATE \" . $DBPrefix . \"auctions SET current_bid = :bid, current_bid_id = :current_bid_id, num_bids = num_bids + 1 WHERE id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 659, "slice_label": "bad", "file_name": "D:\\bad_56_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = intval($_REQUEST['id']);\n$bid = (isset($_POST['bid'])) ? $_POST['bid'] : 0;\n$qty = (isset($_POST['qty'])) ? intval($_POST['qty']) : 1;\n$query0 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $DBPrefix . \"auctions a\n          LEFT JOIN \" . $DBPrefix . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$params = array();\n$params[] = array(':auc_id', $id, 'int');\n$db->query($query0, $params);\nif (empty($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_072;\n}\nif (!$system->CheckMoney($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_058;\n}\n$Data = $db->result();\n$aquantity = $Data['quantity'];\nif ((strtotime($Data['ends']) <= time() || $Data['closed']) && !isset($errmsg)) {\n    $errmsg = $ERR_614;\n}\nif ((strtotime($Data['starts']) > time()) && !isset($errmsg)) {\n    $errmsg = $ERR_073;\n}\nif ($aquantity < $qty) {\n    $errmsg = $ERR_608;\n}\n$db->query($query0, $params);\n$last_highest_bid = array();\nif ($db->numrows() > 0) {\n    $last_highest_bid = $db->result();\n}\n$tmpmsg = CheckBidData();\nif ($tmpmsg != 0 && !isset($errmsg)) {\n    $errmsg = ${\n'ERR_' . $tmpmsg}\n;\n}\nif (isset($_POST['action']) && !isset($errmsg)) {\n    if (count($last_highest_bid) > 0) {\n$query = \"SELECT nick, name, email FROM \" . $DBPrefix . \"users WHERE id = :user_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 660, "slice_label": "bad", "file_name": "D:\\bad_56_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \n$id = intval($_REQUEST['id']);\n$bid = (isset($_POST['bid'])) ? $_POST['bid'] : 0;\n$qty = (isset($_POST['qty'])) ? intval($_POST['qty']) : 1;\n$query0 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $DBPrefix . \"auctions a\n          LEFT JOIN \" . $DBPrefix . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$params = array();\n$params[] = array(':auc_id', $id, 'int');\n$db->query($query0, $params);\nif (empty($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_072;\n}\nif (!$system->CheckMoney($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_058;\n}\n$Data = $db->result();\n$aquantity = $Data['quantity'];\nif ((strtotime($Data['ends']) <= time() || $Data['closed']) && !isset($errmsg)) {\n    $errmsg = $ERR_614;\n}\nif ((strtotime($Data['starts']) > time()) && !isset($errmsg)) {\n    $errmsg = $ERR_073;\n}\nif ($aquantity < $qty) {\n    $errmsg = $ERR_608;\n}\n$tmpmsg = CheckBidData();\nif ($tmpmsg != 0 && !isset($errmsg)) {\n    $errmsg = ${\n'ERR_' . $tmpmsg}\n;\n}\nif (isset($_POST['action']) && !isset($errmsg)) {\n$query = \"SELECT name, email, item_watch, id FROM \" . $DBPrefix . \"users WHERE item_watch LIKE :auc_id AND id != :user_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 661, "slice_label": "bad", "file_name": "D:\\bad_56_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// php code: \nif (!empty($_GET['user_id'])) {\n    $user_id = intval($_GET['user_id']);\n    $user->checkUserValid($user_id);\n}\nelse if ($user->logged_in) {\n    $user_id = $user->user_data['id'];\n}\n$query0 = \"SELECT count(id) AS auctions FROM \" . $DBPrefix . \"auctions\n\t\tWHERE user = :user_id\n\t\tAND closed = 1\";\n$params = array();\n$params[] = array(':user_id', $user_id, 'int');\n$db->query($query0, $params);\n$db->query($query0, $params);\n$auction_data = $db->fetchall();\nforeach ($auction_data as $row) {\n$query = \"SELECT bid FROM \" . $DBPrefix . \"bids WHERE auction = :user_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 662, "slice_label": "bad", "file_name": "D:\\bad_56_3.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$id_column = 'user' == $meta_type ? 'umeta_id' : 'meta_id';\n$query = \"SELECT $id_column FROM _PAD_ WHERE meta_key = %s AND _PAD_ = %d\", _PAD_, _PAD_ );\t\t//sink point: $id_column;\n$res = mysql_query($query);\n\n", "id": 663, "slice_label": "bad", "file_name": "D:\\bad_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$table = _get_meta_table( $meta_type );\n$query = \"SELECT _PAD_ FROM $table WHERE meta_key = %s AND _PAD_ = %d\", _PAD_, _PAD_ );\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 664, "slice_label": "bad", "file_name": "D:\\bad_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$column = sanitize_key($meta_type . '_id');\n$query = \"SELECT _PAD_ FROM _PAD_ WHERE meta_key = %s AND $column = %d\", _PAD_, _PAD_ );\t\t//sink point: $column;\n$res = mysql_query($query);\n\n", "id": 665, "slice_label": "bad", "file_name": "D:\\bad_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_key = $_GET['input0'];\n\n// php code: \n\t$meta_key = wp_unslash($meta_key);\n$query = \"SELECT _PAD_ FROM _PAD_ WHERE meta_key = %s AND _PAD_ = %d\", $meta_key, _PAD_ );\t\t//sink point: $meta_key;\n$res = mysql_query($query);\n\n", "id": 666, "slice_label": "bad", "file_name": "D:\\bad_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$object_id = $_GET['input0'];\n\n// php code: \n\t$object_id = absint( $object_id );\n$query = \"SELECT _PAD_ FROM _PAD_ WHERE meta_key = %s AND _PAD_ = %d\", _PAD_, $object_id );\t\t//sink point: $object_id;\n$res = mysql_query($query);\n\n", "id": 667, "slice_label": "bad", "file_name": "D:\\bad_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$id_column = 'user' == $meta_type ? 'umeta_id' : 'meta_id';\n$query = \"SELECT $id_column FROM _PAD_ WHERE meta_key = %s\", _PAD_;\t\t//sink point: $id_column;\n$res = mysql_query($query);\n\n", "id": 668, "slice_label": "bad", "file_name": "D:\\bad_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_key = $_GET['input0'];\n\n// php code: \n\t$meta_key = wp_unslash($meta_key);\n$query = \"SELECT _PAD_ FROM _PAD_ WHERE meta_key = %s\", $meta_key;\t\t//sink point: $meta_key;\n$res = mysql_query($query);\n\n", "id": 669, "slice_label": "bad", "file_name": "D:\\bad_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$table = _get_meta_table( $meta_type );\n$query = \"SELECT _PAD_ FROM $table WHERE meta_key = %s\", _PAD_;\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 670, "slice_label": "bad", "file_name": "D:\\bad_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_key = $_GET['input0'];\n$delete_all = $_GET['input1'];\n\n// php code: \n\t$meta_key = wp_unslash($meta_key);\n\tif ( $delete_all ) {\n$query = \"SELECT _PAD_ FROM _PAD_ WHERE meta_key = %s _PAD_\", $meta_key );\t\t//sink point: $meta_key;\n$res = mysql_query($query);\n\t}\n\n", "id": 671, "slice_label": "bad", "file_name": "D:\\bad_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_value = $_GET['input0'];\n$delete_all = $_GET['input1'];\n\n// php code: \n\t$meta_value = wp_unslash($meta_value);\n\t$meta_value = maybe_serialize( $meta_value );\n\tif ( $delete_all ) {\n\t\t$value_clause = '';\n\t\tif ( '' !== $meta_value && null !== $meta_value && false !== $meta_value ) {\n\t\t\t$value_clause = $wpdb->prepare( \" AND meta_value = %s\", $meta_value );\n\t\t}\n$query = \"SELECT _PAD_ FROM _PAD_ WHERE meta_key = %s $value_clause\", _PAD_ );\t\t//sink point: $value_clause;\n$res = mysql_query($query);\n\t}\n\n", "id": 672, "slice_label": "bad", "file_name": "D:\\bad_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n$delete_all = $_GET['input1'];\n\n// php code: \n\t$table = _get_meta_table( $meta_type );\n\tif ( $delete_all ) {\n$query = \"SELECT _PAD_ FROM $table WHERE meta_key = %s _PAD_\", _PAD_ );\t\t//sink point: $table;\n$res = mysql_query($query);\n\t}\n\n", "id": 673, "slice_label": "bad", "file_name": "D:\\bad_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n$delete_all = $_GET['input1'];\n\n// php code: \n\t$type_column = sanitize_key($meta_type . '_id');\n\tif ( $delete_all ) {\n$query = \"SELECT $type_column FROM _PAD_ WHERE meta_key = %s _PAD_\", _PAD_ );\t\t//sink point: $type_column;\n$res = mysql_query($query);\n\t}\n\n", "id": 674, "slice_label": "bad", "file_name": "D:\\bad_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$id_column = ( 'user' == $meta_type ) ? 'umeta_id' : 'meta_id';\n$query = \"SELECT * FROM _PAD_ WHERE $id_column = %d\", _PAD_ );\t\t//sink point: $id_column;\n$res = mysql_query($query);\n\n", "id": 675, "slice_label": "bad", "file_name": "D:\\bad_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$table = _get_meta_table( $meta_type );\n$query = \"SELECT * FROM $table WHERE _PAD_ = %d\", _PAD_ );\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 676, "slice_label": "bad", "file_name": "D:\\bad_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_id = $_GET['input0'];\n\n// php code: \n\t$meta_id = intval( $meta_id );\n$query = \"SELECT * FROM _PAD_ WHERE _PAD_ = %d\", $meta_id );\t\t//sink point: $meta_id;\n$res = mysql_query($query);\n\n", "id": 677, "slice_label": "bad", "file_name": "D:\\bad_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$column = sanitize_key($meta_type . '_id');\n$query = \"SELECT $column, meta_key, meta_value FROM _PAD_ WHERE $column IN (_PAD_) ORDER BY _PAD_ ASC\", ARRAY_A;\t\t//sink point: $column;\n$res = mysql_query($query);\n\n", "id": 678, "slice_label": "bad", "file_name": "D:\\bad_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$id_column = 'user' == $meta_type ? 'umeta_id' : 'meta_id';\n$query = \"SELECT _PAD_, meta_key, meta_value FROM _PAD_ WHERE _PAD_ IN (_PAD_) ORDER BY $id_column ASC\", ARRAY_A;\t\t//sink point: $id_column;\n$res = mysql_query($query);\n\n", "id": 679, "slice_label": "bad", "file_name": "D:\\bad_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$table = _get_meta_table( $meta_type );\n$query = \"SELECT _PAD_, meta_key, meta_value FROM $table WHERE _PAD_ IN (_PAD_) ORDER BY _PAD_ ASC\", ARRAY_A;\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 680, "slice_label": "bad", "file_name": "D:\\bad_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n$object_ids = $_GET['input1'];\n\n// php code: \n\tif ( !is_array($object_ids) ) {\n\t\t$object_ids = preg_replace('|[^0-9,]|', '', $object_ids);\n\t\t$object_ids = explode(',', $object_ids);\n\t}\n\t$object_ids = array_map('intval', $object_ids);\n\t$cache_key = $meta_type . '_meta';\n\t$ids = array();\n\tforeach ( $object_ids as $id ) {\n\t\t$cached_object = wp_cache_get( $id, $cache_key );\n\t\tif ( false === $cached_object )\n\t\t\t$ids[] = $id;\n}\n\t$id_list = join( ',', $ids );\n$query = \"SELECT _PAD_, meta_key, meta_value FROM _PAD_ WHERE _PAD_ IN ($id_list) ORDER BY _PAD_ ASC\", ARRAY_A;\t\t//sink point: $id_list;\n$res = mysql_query($query);\n\n", "id": 681, "slice_label": "bad", "file_name": "D:\\bad_2904_1.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$postid = $_GET['input0'];\n\n// php code: \n\t$post = $wpdb->get_row( $wpdb->prepare( \"SELECT * FROM $wpdb->posts WHERE ID = %d\", $postid ) );\n\t$post = get_post( $post );\n\tif ( is_post_type_hierarchical( $post->post_type ) ) {\n$query = \"SELECT * FROM $wpdb->posts WHERE post_parent = %d AND post_type = %s\", _PAD_, _PAD_->post_type;\t\t//sink point: $wpdb;\n$res = mysql_query($query);\n}\n\n", "id": 682, "slice_label": "bad", "file_name": "D:\\good_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$postid = $_GET['input0'];\n\n// php code: \n\t$post = $wpdb->get_row( $wpdb->prepare( \"SELECT * FROM $wpdb->posts WHERE ID = %d\", $postid ) );\n\t$post = get_post( $post );\n\tif ( is_post_type_hierarchical( $post->post_type ) ) {\n$query = \"SELECT * FROM _PAD_->posts WHERE post_parent = %d AND post_type = %s\", _PAD_, $post->post_type;\t\t//sink point: $post;\n$res = mysql_query($query);\n}\n\n", "id": 683, "slice_label": "bad", "file_name": "D:\\good_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$postid = $_GET['input0'];\n\n// php code: \n\t$post = $wpdb->get_row( $wpdb->prepare( \"SELECT * FROM $wpdb->posts WHERE ID = %d\", $postid ) );\n\t$post = get_post( $post );\n\t$parent_data = array( 'post_parent' => $post->post_parent );\n\t$parent_where = array( 'post_parent' => $postid );\n\tif ( is_post_type_hierarchical( $post->post_type ) ) {\n\t\t$children_query = $wpdb->prepare( \"SELECT * FROM $wpdb->posts WHERE post_parent = %d AND post_type = %s\", $postid, $post->post_type );\n\t\t$children = $wpdb->get_results( $children_query );\n\t\tif ( $children ) {\n\t\t\t$wpdb->update( $wpdb->posts, $parent_data, $parent_where + array( 'post_type' => $post->post_type ) );\n\t\t}\n}\n$query = \"SELECT ID FROM $wpdb->posts WHERE post_parent = %d AND post_type = 'revision'\", _PAD_ );\t\t//sink point: $wpdb;\n$res = mysql_query($query);\n\n", "id": 684, "slice_label": "bad", "file_name": "D:\\good_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$postid = $_GET['input0'];\n\n// php code: \n$query = \"SELECT ID FROM _PAD_->posts WHERE post_parent = %d AND post_type = 'revision'\", $postid );\t\t//sink point: $postid;\n$res = mysql_query($query);\n\n", "id": 685, "slice_label": "bad", "file_name": "D:\\good_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$postid = $_GET['input0'];\n\n// php code: \n\t$post = $wpdb->get_row( $wpdb->prepare( \"SELECT * FROM $wpdb->posts WHERE ID = %d\", $postid ) );\n\t$post = get_post( $post );\n\t$parent_data = array( 'post_parent' => $post->post_parent );\n\t$parent_where = array( 'post_parent' => $postid );\n\tif ( is_post_type_hierarchical( $post->post_type ) ) {\n\t\t$children_query = $wpdb->prepare( \"SELECT * FROM $wpdb->posts WHERE post_parent = %d AND post_type = %s\", $postid, $post->post_type );\n\t\t$children = $wpdb->get_results( $children_query );\n\t\tif ( $children ) {\n\t\t\t$wpdb->update( $wpdb->posts, $parent_data, $parent_where + array( 'post_type' => $post->post_type ) );\n\t\t}\n}\n\t$wpdb->update( $wpdb->posts, $parent_data, $parent_where + array( 'post_type' => 'attachment' ) );\n$query = \"SELECT comment_ID FROM $wpdb->comments WHERE comment_post_ID = %d\", _PAD_ );\t\t//sink point: $wpdb;\n$res = mysql_query($query);\n\n", "id": 686, "slice_label": "bad", "file_name": "D:\\good_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$postid = $_GET['input0'];\n\n// php code: \n$query = \"SELECT comment_ID FROM _PAD_->comments WHERE comment_post_ID = %d\", $postid );\t\t//sink point: $postid;\n$res = mysql_query($query);\n\n", "id": 687, "slice_label": "bad", "file_name": "D:\\good_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$postid = $_GET['input0'];\n\n// php code: \n\t$post = $wpdb->get_row( $wpdb->prepare( \"SELECT * FROM $wpdb->posts WHERE ID = %d\", $postid ) );\n\t$post = get_post( $post );\n\t$parent_data = array( 'post_parent' => $post->post_parent );\n\t$parent_where = array( 'post_parent' => $postid );\n\tif ( is_post_type_hierarchical( $post->post_type ) ) {\n\t\t$children_query = $wpdb->prepare( \"SELECT * FROM $wpdb->posts WHERE post_parent = %d AND post_type = %s\", $postid, $post->post_type );\n\t\t$children = $wpdb->get_results( $children_query );\n\t\tif ( $children ) {\n\t\t\t$wpdb->update( $wpdb->posts, $parent_data, $parent_where + array( 'post_type' => $post->post_type ) );\n\t\t}\n}\n\t$wpdb->update( $wpdb->posts, $parent_data, $parent_where + array( 'post_type' => 'attachment' ) );\n$query = \"SELECT meta_id FROM $wpdb->postmeta WHERE post_id = %d \", _PAD_ );\t\t//sink point: $wpdb;\n$res = mysql_query($query);\n\n", "id": 688, "slice_label": "bad", "file_name": "D:\\good_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$postid = $_GET['input0'];\n\n// php code: \n$query = \"SELECT meta_id FROM _PAD_->postmeta WHERE post_id = %d \", $postid );\t\t//sink point: $postid;\n$res = mysql_query($query);\n\n", "id": 689, "slice_label": "bad", "file_name": "D:\\good_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$post = $_GET['input0'];\n\n// php code: \n\t$post = get_post($post);\n\t$post_id = $post->ID;\n\t$statuses = get_post_meta($post_id, '_wp_trash_meta_comments_status', true);\n\t$group_by_status = array();\n\tforeach ( $statuses as $comment_id => $comment_status )\n\t\t$group_by_status[$comment_status][] = $comment_id;\n\tforeach ( $group_by_status as $status => $comments ) {\n$query = \"UPDATE $wpdb->comments SET comment_approved = %s WHERE comment_ID IN (_PAD_)\", _PAD_ );\t\t//sink point: $wpdb;\n$res = mysql_query($query);\n\t}\n\n", "id": 690, "slice_label": "bad", "file_name": "D:\\good_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$post = $_GET['input0'];\n\n// php code: \n\t$post = get_post($post);\n\t$post_id = $post->ID;\n\t$statuses = get_post_meta($post_id, '_wp_trash_meta_comments_status', true);\n\t$group_by_status = array();\n\tforeach ( $statuses as $comment_id => $comment_status )\n\t\t$group_by_status[$comment_status][] = $comment_id;\n\tforeach ( $group_by_status as $status => $comments ) {\n\t\tif ( 'post-trashed' == $status ) {\n\t\t\t$status = '0';\n\t\t}\n$query = \"UPDATE _PAD_->comments SET comment_approved = %s WHERE comment_ID IN (_PAD_)\", $status );\t\t//sink point: $status;\n$res = mysql_query($query);\n\t}\n\n", "id": 691, "slice_label": "bad", "file_name": "D:\\good_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$post = $_GET['input0'];\n\n// php code: \n\t$post = get_post($post);\n\t$post_id = $post->ID;\n\t$statuses = get_post_meta($post_id, '_wp_trash_meta_comments_status', true);\n\t$group_by_status = array();\n\tforeach ( $statuses as $comment_id => $comment_status )\n\t\t$group_by_status[$comment_status][] = $comment_id;\n\tforeach ( $group_by_status as $status => $comments ) {\n\t\t$comments_in = implode( ', ', array_map( 'intval', $comments ) );\n$query = \"UPDATE _PAD_->comments SET comment_approved = %s WHERE comment_ID IN ($comments_in)\", _PAD_ );\t\t//sink point: $comments_in;\n$res = mysql_query($query);\n\t}\n\n", "id": 692, "slice_label": "bad", "file_name": "D:\\good_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$post_type = $_GET['input0'];\n\n// php code: \n\tif ( 'attachment' == $post_type ) {\n}\nelse if ( is_post_type_hierarchical( $post_type ) ) {\n$query = \"SELECT post_name FROM $wpdb->posts WHERE post_name = %s AND post_type IN ( %s, 'attachment';\t\t//sink point: $wpdb;\n$res = mysql_query($query);\n}\n\n", "id": 693, "slice_label": "bad", "file_name": "D:\\good_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$ids = $_GET['input0'];\n\n// php code: \n\t$non_cached_ids = _get_non_cached_ids( $ids, 'posts' );\n\tif ( !empty( $non_cached_ids ) ) {\n$query = \"SELECT $wpdb->posts.* FROM $wpdb->posts WHERE ID IN (%s)\", join( \",\", _PAD_ ) );\t\t//sink point: $wpdb;\n$res = mysql_query($query);\n}\n\n", "id": 694, "slice_label": "bad", "file_name": "D:\\good_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$ids = $_GET['input0'];\n\n// php code: \n\t$non_cached_ids = _get_non_cached_ids( $ids, 'posts' );\n\tif ( !empty( $non_cached_ids ) ) {\n$query = \"SELECT _PAD_->posts.* FROM _PAD_->posts WHERE ID IN (%s)\", join( \",\", $non_cached_ids ) );\t\t//sink point: $non_cached_ids;\n$res = mysql_query($query);\n}\n\n", "id": 695, "slice_label": "bad", "file_name": "D:\\good_2904_2.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$product_id = $_GET['input0'];\n\n// php code: \n\t\t$rows_uploaded = $this->db->query(\"\n\t\t\tSELECT COUNT(*) count\n\t\t\tFROM `\" . DB_PREFIX . \"amazon_product`\n\t\t\tWHERE `product_id` = '\" . (int)$product_id . \"' AND status = 'uploaded'\")->row;\n\t\t$rows_uploaded = $rows_uploaded['count'];\n\t\t$rows_ok = $this->db->query(\"\n\t\t\tSELECT COUNT(*) count\n\t\t\tFROM `\" . DB_PREFIX . \"amazon_product`\n\t\t\tWHERE `product_id` = '\" . (int)$product_id . \"' AND status = 'ok'\")->row;\n\t\t$rows_ok = $rows_ok['count'];\n\t\t$rows_error = $this->db->query(\"\n\t\t\tSELECT COUNT(*) count\n\t\t\tFROM `\" . DB_PREFIX . \"amazon_product`\n\t\t\tWHERE `product_id` = '\" . (int)$product_id . \"' AND status = 'error'\")->row;\n\t\t$rows_error = $rows_error['count'];\n\t\tif ($rows_uploaded == 0 && $rows_error > 0 && $rows_ok == 0) {\n$query = \"SELECT * FROM `\" . DB_PREFIX . \"amazon_product` WHERE `product_id` = \" . (int)$product_id . \" AND `version` = 3\";\t\t//sink point: $product_id;\n$res = mysql_query($query);\n}\n\n", "id": 696, "slice_label": "bad", "file_name": "D:\\good_4869_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$product_id = $_GET['input0'];\n$version = $_GET['input1'];\n\n// php code: \n\t\tif ($version == 3) {\n$query = \"SELECT `messages` FROM `\" . DB_PREFIX . \"amazon_product` WHERE `product_id` = '\" . (int)$product_id . \"' AND `version` = 3\";\t\t//sink point: $product_id;\n$res = mysql_query($query);\n}\n\n", "id": 697, "slice_label": "bad", "file_name": "D:\\good_4869_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$product_id = $_GET['input0'];\n\n// php code: \n$query = \"SELECT `sku`, `insertion_id` FROM `\" . DB_PREFIX . \"amazon_product` WHERE `product_id` = '\" . (int)$product_id . \"' AND `version` = 2\";\t\t//sink point: $product_id;\n$res = mysql_query($query);\n\n", "id": 698, "slice_label": "bad", "file_name": "D:\\good_4869_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$product_id = $_GET['input0'];\n\n// php code: \n\t\t$insertion_rows = $this->db->query(\"SELECT `sku`, `insertion_id` FROM `\" . DB_PREFIX . \"amazon_product` WHERE `product_id` = '\" . (int)$product_id . \"' AND `version` = 2\")->rows;\n\t\tif (!empty($insertion_rows)) {\n\t\t\tforeach($insertion_rows as $insertion_row) {\n$query = \"SELECT * FROM `\" . DB_PREFIX . \"amazon_product_error` WHERE `sku` = '\" . _PAD_->db->escape($insertion_row['sku']) . \"' AND `insertion_id` = '\" . _PAD_->db->escape($insertion_row['insertion_id']) . \"'\";\t\t//sink point: $insertion_row;\n$res = mysql_query($query);\n}\n}\n\n", "id": 699, "slice_label": "bad", "file_name": "D:\\good_4869_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$product_id = $_GET['input0'];\n\n// php code: \n\t\t$insertion_rows = $this->db->query(\"SELECT `sku`, `insertion_id` FROM `\" . DB_PREFIX . \"amazon_product` WHERE `product_id` = '\" . (int)$product_id . \"' AND `version` = 2\")->rows;\n\t\tif (!empty($insertion_rows)) {\n\t\t\tforeach($insertion_rows as $insertion_row) {\n$query = \"SELECT * FROM `\" . DB_PREFIX . \"amazon_product_error` WHERE `sku` = '\" . $this->db->escape(_PAD_) . \"' AND `insertion_id` = '\" . $this->db->escape(_PAD_) . \"'\";\t\t//sink point: $this;\n$res = mysql_query($query);\n}\n}\n\n", "id": 700, "slice_label": "bad", "file_name": "D:\\good_4869_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$amazon_sku = $_GET['input0'];\n$product_id = $_GET['input1'];\n$var = $_GET['input2'];\n\n// php code: \n\t\t$count = $this->db->query(\"SELECT COUNT(*) as 'count' FROM `\" . DB_PREFIX . \"amazon_product_link` WHERE `product_id` = '\" . (int)$product_id . \"' AND `amazon_sku` = '\" . $this->db->escape($amazon_sku) . \"' AND `var` = '\" . $this->db->escape($var) . \"' LIMIT 1\")->row;\n\t\tif ($count['count'] == 0) {\n$query = \"INSERT INTO `\" . DB_PREFIX . \"amazon_product_link` SET `product_id` = '\" . (int)_PAD_ . \"', `amazon_sku` = '\" . _PAD_->db->escape(_PAD_) . \"', `var` = '\" . _PAD_->db->escape($var) . \"'\";\t\t//sink point: $var;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 701, "slice_label": "bad", "file_name": "D:\\good_4869_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$amazon_sku = $_GET['input0'];\n$product_id = $_GET['input1'];\n$var = $_GET['input2'];\n\n// php code: \n\t\t$count = $this->db->query(\"SELECT COUNT(*) as 'count' FROM `\" . DB_PREFIX . \"amazon_product_link` WHERE `product_id` = '\" . (int)$product_id . \"' AND `amazon_sku` = '\" . $this->db->escape($amazon_sku) . \"' AND `var` = '\" . $this->db->escape($var) . \"' LIMIT 1\")->row;\n\t\tif ($count['count'] == 0) {\n$query = \"INSERT INTO `\" . DB_PREFIX . \"amazon_product_link` SET `product_id` = '\" . (int)_PAD_ . \"', `amazon_sku` = '\" . _PAD_->db->escape($amazon_sku) . \"', `var` = '\" . _PAD_->db->escape(_PAD_) . \"'\";\t\t//sink point: $amazon_sku;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 702, "slice_label": "bad", "file_name": "D:\\good_4869_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$amazon_sku = $_GET['input0'];\n$product_id = $_GET['input1'];\n$var = $_GET['input2'];\n\n// php code: \n\t\t$count = $this->db->query(\"SELECT COUNT(*) as 'count' FROM `\" . DB_PREFIX . \"amazon_product_link` WHERE `product_id` = '\" . (int)$product_id . \"' AND `amazon_sku` = '\" . $this->db->escape($amazon_sku) . \"' AND `var` = '\" . $this->db->escape($var) . \"' LIMIT 1\")->row;\n\t\tif ($count['count'] == 0) {\n$query = \"INSERT INTO `\" . DB_PREFIX . \"amazon_product_link` SET `product_id` = '\" . (int)$product_id . \"', `amazon_sku` = '\" . _PAD_->db->escape(_PAD_) . \"', `var` = '\" . _PAD_->db->escape(_PAD_) . \"'\";\t\t//sink point: $product_id;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 703, "slice_label": "bad", "file_name": "D:\\good_4869_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$amazon_sku = $_GET['input0'];\n$product_id = $_GET['input1'];\n$var = $_GET['input2'];\n\n// php code: \n\t\t$count = $this->db->query(\"SELECT COUNT(*) as 'count' FROM `\" . DB_PREFIX . \"amazon_product_link` WHERE `product_id` = '\" . (int)$product_id . \"' AND `amazon_sku` = '\" . $this->db->escape($amazon_sku) . \"' AND `var` = '\" . $this->db->escape($var) . \"' LIMIT 1\")->row;\n\t\tif ($count['count'] == 0) {\n$query = \"INSERT INTO `\" . DB_PREFIX . \"amazon_product_link` SET `product_id` = '\" . (int)_PAD_ . \"', `amazon_sku` = '\" . $this->db->escape(_PAD_) . \"', `var` = '\" . $this->db->escape(_PAD_) . \"'\";\t\t//sink point: $this;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 704, "slice_label": "bad", "file_name": "D:\\good_4869_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$skus = $_GET['input0'];\n\n// php code: \n\t\t$sku_array = array();\n\t\tforeach ($skus as $sku) {\n\t\t\t$sku_array[] = \"'\" . $this->db->escape($sku) . \"'\";\n\t\t}\n\t\tif ($this->openbay->addonLoad('openstock')) {\n$query = \"SELECT apl.amazon_sku, if (pov.product_id IS NULL, p.quantity, pov.stock) AS 'quantity' FROM \" . DB_PREFIX . \"amazon_product_link apl JOIN \" . DB_PREFIX . \"product p ON apl.product_id = p.product_id LEFT JOIN \" . DB_PREFIX . \"product_option_variant pov ON apl.product_id = pov.product_id AND apl.var = pov.sku WHERE apl.amazon_sku IN (\" . implode(',', $sku_array) . \")\";\t\t//sink point: $sku_array;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 705, "slice_label": "bad", "file_name": "D:\\good_4869_0.php", "rule": "CVI_10002", "label": "", "message": ""}, {"slice": "<?php\n// controlable parameters: \n$skus = $_GET['input0'];\n\n// php code: \n\t\t$sku_array = array();\n\t\tforeach ($skus as $sku) {\n\t\t\t$sku_array[] = \"'\" . $this->db->escape($sku) . \"'\";\n\t\t}\n\t\tif ($this->openbay->addonLoad('openstock')) {\n}\nelse {\n$query = \"SELECT apl.amazon_sku, p.quantity FROM \" . DB_PREFIX . \"amazon_product_link apl JOIN \" . DB_PREFIX . \"product p ON apl.product_id = p.product_id WHERE apl.amazon_sku IN (\" . implode(',', $sku_array) . \")\";\t\t//sink point: $sku_array;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 706, "slice_label": "bad", "file_name": "D:\\good_4869_0.php", "rule": "CVI_10002", "label": "", "message": ""}]