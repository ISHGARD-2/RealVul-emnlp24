[{"slice": "<?php\n// php code: \n$query = \"SELECT user_id FROM `session` WHERE session_id = '\"._PAD_->escape(session_id()).\"' AND user_id = '\"._PAD_->escape($_GET['uid']).\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 169, "slice_label": "bad", "file_name": "good_3816_6.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var1 = _PAD_->escape(session_id())._PAD_->escape($_GET['uid']);\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 3816, "predict": 0}, {"slice": "<?php\n// php code: \n  $action = (isset($_GET['action']) ? $_GET['action'] : '');\n  if ($action == 'list') {\n$query = \"select a.association_id, a.zone_country_id, c.countries_name, a.zone_id, a.geo_zone_id, a.last_modified, a.date_added, z.zone_name from \" . TABLE_ZONES_TO_GEO_ZONES . \" a left join \" . TABLE_COUNTRIES . \" c on a.zone_country_id = c.countries_id left join \" . TABLE_ZONES . \" z on a.zone_id = z.zone_id where a.geo_zone_id = \" . (int)$_GET['zID'] . \" order by association_id\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 297, "slice_label": "bad", "file_name": "good_2048_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n  $var1 = (isset($_GET['action']) ? $_GET['action'] : '');\n  if ($var1 == 'list') {\n$var2 =  TABLE_ZONES_TO_GEO_ZONES . TABLE_COUNTRIES . TABLE_ZONES . (int)$_GET['zID'] ;\t\t//sink point: $_GET;\n$var3 = mysql_query($var2);\n}\n\n", "CVE_database_id": 2048, "predict": 0}, {"slice": "<?php\n// php code: \n$id = intval($_GET['id']);\n$bid = (isset($_GET['bid'])) ? $_GET['bid'] : 0;\n$qty = (isset($_GET['qty'])) ? intval($_GET['qty']) : 1;\n$query0 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $DBPrefix . \"auctions a\n          LEFT JOIN \" . $DBPrefix . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$params = array();\n$params[] = array(':auc_id', $id, 'int');\n$db->query($query0, $params);\nif (empty($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_072;\n}\nif (!$system->CheckMoney($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_058;\n}\n$Data = $db->result();\n$atype = $Data['auction_type'];\n$aquantity = $Data['quantity'];\nif ((strtotime($Data['ends']) <= time() || $Data['closed']) && !isset($errmsg)) {\n    $errmsg = $ERR_614;\n}\nif ((strtotime($Data['starts']) > time()) && !isset($errmsg)) {\n    $errmsg = $ERR_073;\n}\nif ($aquantity < $qty) {\n    $errmsg = $ERR_608;\n}\n$tmpmsg = CheckBidData();\nif ($tmpmsg != 0 && !isset($errmsg)) {\n    $errmsg = ${\n'ERR_' . $tmpmsg}\n;\n}\nif (isset($_GET['action']) && !isset($errmsg)) {\n    if ($atype == 1 && !isset($errmsg)) {\n}\nelse if ($atype == 2 && !isset($errmsg)) {\n        if (!isset($errmsg)) {\n$query = \"UPDATE \" . $DBPrefix . \"auctions SET current_bid = :bid, current_bid_id = :current_bid_id, num_bids = num_bids + 1 WHERE id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 134, "slice_label": "bad", "file_name": "good_56_2.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var19 = intval($_GET['id']);\n$var15 = (isset($_GET['bid'])) ? $_GET['bid'] : 0;\n$var17 = (isset($_GET['qty'])) ? intval($_GET['qty']) : 1;\n$var10 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $taint . \"auctions a\n          LEFT JOIN \" . $taint . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$var8 = array();\n$var8[] = array(':auc_id', $var19, 'int');\n$var18->query($var10, $var8);\nif (empty($var15) && !isset($var7)) {\n    $var7 = $var3;\n}\nif (!$var11->CheckMoney($var15) && !isset($var7)) {\n    $var7 = $var2;\n}\n$var14 = $var18->result();\n$var13 = $var14['auction_type'];\n$var1 = $var14['quantity'];\nif ((strtotime($var14['ends']) <= time() || $var14['closed']) && !isset($var7)) {\n    $var7 = $var6;\n}\nif ((strtotime($var14['starts']) > time()) && !isset($var7)) {\n    $var7 = $var5;\n}\nif ($var1 < $var17) {\n    $var7 = $var4;\n}\n$var9 = CheckBidData();\nif ($var9 != 0 && !isset($var7)) {\n    $var7 = ${\n'ERR_' . $var9}\n;\n}\nif (isset($_GET['action']) && !isset($var7)) {\n    if ($var13 == 1 && !isset($var7)) {\n}\nelse if ($var13 == 2 && !isset($var7)) {\n        if (!isset($var7)) {\n$var12 =  $taint ;\t\t//sink point: $taint;\n$var16 = mysql_query($var12);\n}\n}\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// php code: \n$catscontrol = new MPTTcategories();\nif (isset($_GET['action'])) {\n    if (!empty($_GET['id']) && !empty($_GET['title']) && !empty($_GET['duration']) && !empty($_GET['category']) && !empty($_GET['description']) && !empty($_GET['min_bid'])) {\n        if ($_GET['quantity'] < 1) {\n}\nelse if (isset($_GET['current_bid']) && $_GET['current_bid'] < $_GET['min_bid'] && $_GET['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_GET['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_GET['category']) {\n                $ct = intval($_GET['category']);\n                $parent_node = $db->result();\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n}\n            if ($AUCTION['secondcat'] != $_GET['secondcat']) {\n                $ct = intval($_GET['secondcat']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                for ($i = 0; $i < count($crumbs); $i++) {\n                    if ($crumbs[$i]['cat_id'] == $ct) {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET counter = counter + 1, sub_counter = sub_counter + 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                    }\n}\n}\n}\n}\n}\n\n", "id": 111, "slice_label": "bad", "file_name": "good_56_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var1 = new MPTTcategories();\nif (isset($_GET['action'])) {\n    if (!empty($_GET['id']) && !empty($_GET['title']) && !empty($_GET['duration']) && !empty($_GET['category']) && !empty($_GET['description']) && !empty($_GET['min_bid'])) {\n        if ($_GET['quantity'] < 1) {\n}\nelse if (isset($_GET['current_bid']) && $_GET['current_bid'] < $_GET['min_bid'] && $_GET['current_bid'] != 0) {\n}\nelse {\n            $var4 = \"SELECT * from \" . $taint . \"auctions WHERE id = :auc_id\";\n            $var5 = array();\n            $var5[] = array(':auc_id', $_GET['id'], 'int');\n            $var10->query($var4, $var5);\n            $var3 = $var10->result();\n            if ($var3['category'] != $_GET['category']) {\n                $var9 = intval($_GET['category']);\n                $var2 = $var10->result();\n                $var6 = $var1->get_bread_crumbs($var2['left_id'], $var2['right_id']);\n                $var6 = $var1->get_bread_crumbs($var2['left_id'], $var2['right_id']);\n}\n            if ($var3['secondcat'] != $_GET['secondcat']) {\n                $var9 = intval($_GET['secondcat']);\n                $var6 = $var1->get_bread_crumbs($var2['left_id'], $var2['right_id']);\n                for ($var11 = 0; $var11 < count($var6); $var11++) {\n                    if ($var6[$var11]['cat_id'] == $var9) {\n$var7 =  $taint ;\t\t//sink point: $taint;\n$var8 = mysql_query($var7);\n                    }\n}\n}\n}\n}\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// php code: \n$n=sanitize($_GET['n'], 3);\r\n$query = \"SELECT * FROM `\" . table_users . \"` where `user_login` = '\"._PAD_.\"' AND `last_reset_request` = FROM_UNIXTIME('\".$n.\"') AND user_level!='Spammer'\";\t\t//sink point: $n;\n$res = mysql_query($query);\n\n", "id": 302, "slice_label": "bad", "file_name": "good_2349_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$taint=sanitize($_GET['n'], 3);\r\n$var1 =  table_users .$taint;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 2349, "predict": 0}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n\tif (isset($_GET[\"index_id\"]) && $_GET[\"index_id\"] != 0) {\n$query = \"SELECT metric_id, metric_name FROM metrics as ms, index_data as ixd WHERE ms.index_id = ixd.id and ms.index_id='\".$pearDB->escape(_PAD_).\"';\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n}\n\n", "id": 65, "slice_label": "bad", "file_name": "good_2179_14.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n\t$taint = new CentreonDB();\n\tif (isset($_GET[\"index_id\"]) && $_GET[\"index_id\"] != 0) {\n$var1 = $taint->escape(_PAD_);\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2179, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$add = $_GET['input0'];\n$category = $_GET['input1'];\n$second_category = $_GET['input2'];\n\n// php code: \n    $addsub = ($add) ? '+' : '-';\n    $query0 = \"UPDATE \" . $DBPrefix . \"categories SET counter = counter \" . $addsub . \" 1 WHERE cat_id = :cat_id\";\n    $params = array();\n    $params[] = array(':cat_id', $category, 'int');\n    $db->query($query0, $params);\n    $db->query($query0, $params);\n    $parent_node = $db->result();\n    $category_crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n    if ($second_category > 0) {\n        $second_category_crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n        $crumbs = $category_crumbs + $second_category_crumbs;\n    }\nelse {\n        $crumbs = $category_crumbs;\n    }\n    for ($i = 0; $i < count($crumbs); $i++) {\n$query = \"UPDATE \" . _PAD_ . \"categories SET sub_counter = sub_counter \" . $addsub . \" 1 WHERE cat_id = :cat_id\";\t\t//sink point: $addsub;\n$res = mysql_query($query);\n}\n\n", "id": 96, "slice_label": "bad", "file_name": "bad_56_6.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var12 = $_GET['input0'];\n$var7 = $_GET['input1'];\n$var3 = $_GET['input2'];\n\n// php code: \n    $taint = ($var12) ? '+' : '-';\n    $var8 = \"UPDATE \" . $var6 . \"categories SET counter = counter \" . $taint . \" 1 WHERE cat_id = :cat_id\";\n    $var9 = array();\n    $var9[] = array(':cat_id', $var7, 'int');\n    $var14->query($var8, $var9);\n    $var14->query($var8, $var9);\n    $var4 = $var14->result();\n    $var2 = $var5->get_bread_crumbs($var4['left_id'], $var4['right_id']);\n    if ($var3 > 0) {\n        $var1 = $var5->get_bread_crumbs($var4['left_id'], $var4['right_id']);\n        $var10 = $var2 + $var1;\n    }\nelse {\n        $var10 = $var2;\n    }\n    for ($var15 = 0; $var15 < count($var10); $var15++) {\n$var11 =  $taint ;\t\t//sink point: $taint;\n$var13 = mysql_query($var11);\n}\n\n", "CVE_database_id": 56, "predict": 0}, {"slice": "<?php\n// php code: \n\t$pearDBO \t= new CentreonDB(\"centstorage\");\n\tif (isset($_GET[\"id\"]) && isset($_GET[\"color\"])){\n$query = \"SELECT  * FROM `log_archive_host` WHERE host_id = \" . $pearDBO->escape(_PAD_) . \" order by date_start desc\";\t\t//sink point: $pearDBO;\n$res = mysql_query($query);\n}\n\n", "id": 166, "slice_label": "bad", "file_name": "good_3816_2.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n\t$taint \t= new CentreonDB(\"centstorage\");\n\tif (isset($_GET[\"id\"]) && isset($_GET[\"color\"])){\n$var1 =  $taint->escape(_PAD_) ;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 3816, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$name = $_GET['input0'];\n\n// php code: \n$query = \"SELECT `category_name`, `cmd_category_id` FROM `command_categories` WHERE `category_name` = '\".htmlentities($name, ENT_QUOTES, \"UTF-8\").\"'\";\t\t//sink point: $name;\n$res = mysql_query($query);\n\n", "id": 22, "slice_label": "bad", "file_name": "bad_2179_3.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n\n// php code: \n$var1 = htmlentities($taint, ENT_QUOTES, \"UTF-8\");\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 2179, "predict": 0}, {"slice": "<?php\n// php code: \n$query = \"SELECT user_id FROM `session` WHERE session_id = '\".htmlentities($_GET[\"sid\"], ENT_QUOTES, \"UTF-8\").\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 179, "slice_label": "bad", "file_name": "bad_3816_7.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var1 = htmlentities($_GET[\"sid\"], ENT_QUOTES, \"UTF-8\");\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 3816, "predict": 0}, {"slice": "<?php\n// php code: \nif (isset($_GET['action']) && isset($_GET['username']) && isset($_GET['password'])) {\n$query = \"SELECT id, hash, suspended, password, password_type FROM \" . $DBPrefix . \"users WHERE nick = :nick OR email = :email\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 115, "slice_label": "bad", "file_name": "good_56_14.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \nif (isset($_GET['action']) && isset($_GET['username']) && isset($_GET['password'])) {\n$var1 =  $taint ;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 56, "predict": 0}, {"slice": "<?php\n// php code: \n$id = intval($_GET['id']);\n$bid = (isset($_GET['bid'])) ? $_GET['bid'] : 0;\n$qty = (isset($_GET['qty'])) ? intval($_GET['qty']) : 1;\n$query0 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $DBPrefix . \"auctions a\n          LEFT JOIN \" . $DBPrefix . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$params = array();\n$params[] = array(':auc_id', $id, 'int');\n$db->query($query0, $params);\nif (empty($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_072;\n}\nif (!$system->CheckMoney($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_058;\n}\nelse {\n    $bid = round($system->input_money($bid), 2);\n}\n$Data = $db->result();\n$atype = $Data['auction_type'];\n$aquantity = $Data['quantity'];\n$current_bid = $Data['current_bid'];\nif ((strtotime($Data['ends']) <= time() || $Data['closed']) && !isset($errmsg)) {\n    $errmsg = $ERR_614;\n}\nif ((strtotime($Data['starts']) > time()) && !isset($errmsg)) {\n    $errmsg = $ERR_073;\n}\nif ($aquantity < $qty) {\n    $errmsg = $ERR_608;\n}\n$tmpmsg = CheckBidData();\nif ($tmpmsg != 0 && !isset($errmsg)) {\n    $errmsg = ${\n'ERR_' . $tmpmsg}\n;\n}\nif (isset($_GET['action']) && !isset($errmsg)) {\n    if ($atype == 1 && !isset($errmsg)) {\n        if ($system->SETTINGS['proxy_bidding'] == 'n') {\n            if ($current_bid < $bid) {\n$query = \"UPDATE \" . $DBPrefix . \"auctions SET current_bid = :bid, current_bid_id = :current_bid_id, num_bids = num_bids + 1 WHERE id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n\n", "id": 131, "slice_label": "bad", "file_name": "good_56_2.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var20 = intval($_GET['id']);\n$var16 = (isset($_GET['bid'])) ? $_GET['bid'] : 0;\n$var18 = (isset($_GET['qty'])) ? intval($_GET['qty']) : 1;\n$var11 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $taint . \"auctions a\n          LEFT JOIN \" . $taint . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$var9 = array();\n$var9[] = array(':auc_id', $var20, 'int');\n$var19->query($var11, $var9);\nif (empty($var16) && !isset($var8)) {\n    $var8 = $var4;\n}\nif (!$var12->CheckMoney($var16) && !isset($var8)) {\n    $var8 = $var3;\n}\nelse {\n    $var16 = round($var12->input_money($var16), 2);\n}\n$var15 = $var19->result();\n$var14 = $var15['auction_type'];\n$var2 = $var15['quantity'];\n$var1 = $var15['current_bid'];\nif ((strtotime($var15['ends']) <= time() || $var15['closed']) && !isset($var8)) {\n    $var8 = $var7;\n}\nif ((strtotime($var15['starts']) > time()) && !isset($var8)) {\n    $var8 = $var6;\n}\nif ($var2 < $var18) {\n    $var8 = $var5;\n}\n$var10 = CheckBidData();\nif ($var10 != 0 && !isset($var8)) {\n    $var8 = ${\n'ERR_' . $var10}\n;\n}\nif (isset($_GET['action']) && !isset($var8)) {\n    if ($var14 == 1 && !isset($var8)) {\n        if ($var12->SETTINGS['proxy_bidding'] == 'n') {\n            if ($var1 < $var16) {\n$var13 =  $taint ;\t\t//sink point: $taint;\n$var17 = mysql_query($var13);\n}\n}\n}\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$table = _get_meta_table( $meta_type );\n$query = \"SELECT * FROM $table WHERE _PAD_ = %d\";\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 250, "slice_label": "bad", "file_name": "good_2904_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var1 = $_GET['input0'];\n\n// php code: \n\t$taint = _get_meta_table( $var1 );\n$var2 = \"$taint\";\t\t//sink point: $taint;\n$var3 = mysql_query($var2);\n\n", "CVE_database_id": 2904, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n\n// php code: \n$query = \"SELECT MAX(ID)+1 FROM `$table`\";\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 350, "slice_label": "bad", "file_name": "good_3552_2.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n\n// php code: \n$var1 = \"$taint\" ;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 3552, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$path = $_GET['input0'];\n\n// php code: \n\t\t\t$x = count($path);\n\t\t\twhile ($x) {\n$query = \"SELECT * FROM bigtree_route_history WHERE old_route = '\".sqlescape(implode(\"/\",array_slice(_PAD_,0,$x))).\"'\";\t\t//sink point: $x;\n$res = mysql_query($query);\n}\n\n", "id": 191, "slice_label": "bad", "file_name": "good_5774_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var2 = $_GET['input0'];\n\n// php code: \n\t\t\t$taint = count($var2);\n\t\t\twhile ($taint) {\n$var1 = sqlescape(implode(\"/\",array_slice(_PAD_,0,$taint))).\"\";\t\t//sink point: $taint;\n$var3 = mysql_query($var1);\n}\n\n", "CVE_database_id": 5774, "predict": 1}, {"slice": "<?php\n// php code: \n$id = intval($_GET['id']);\n$bid = (isset($_GET['bid'])) ? $_GET['bid'] : 0;\n$qty = (isset($_GET['qty'])) ? intval($_GET['qty']) : 1;\n$query0 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $DBPrefix . \"auctions a\n          LEFT JOIN \" . $DBPrefix . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$params = array();\n$params[] = array(':auc_id', $id, 'int');\n$db->query($query0, $params);\nif (empty($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_072;\n}\nif (!$system->CheckMoney($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_058;\n}\n$Data = $db->result();\n$aquantity = $Data['quantity'];\nif ((strtotime($Data['ends']) <= time() || $Data['closed']) && !isset($errmsg)) {\n    $errmsg = $ERR_614;\n}\nif ((strtotime($Data['starts']) > time()) && !isset($errmsg)) {\n    $errmsg = $ERR_073;\n}\nif ($aquantity < $qty) {\n    $errmsg = $ERR_608;\n}\n$db->query($query0, $params);\n$last_highest_bid = array();\nif ($db->numrows() > 0) {\n    $last_highest_bid = $db->result();\n}\n$tmpmsg = CheckBidData();\nif ($tmpmsg != 0 && !isset($errmsg)) {\n    $errmsg = ${\n'ERR_' . $tmpmsg}\n;\n}\nif (isset($_GET['action']) && !isset($errmsg)) {\n    if (count($last_highest_bid) > 0) {\n$query = \"SELECT nick, name, email FROM \" . $DBPrefix . \"users WHERE id = :user_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 135, "slice_label": "bad", "file_name": "good_56_2.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var19 = intval($_GET['id']);\n$var15 = (isset($_GET['bid'])) ? $_GET['bid'] : 0;\n$var17 = (isset($_GET['qty'])) ? intval($_GET['qty']) : 1;\n$var11 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $taint . \"auctions a\n          LEFT JOIN \" . $taint . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$var9 = array();\n$var9[] = array(':auc_id', $var19, 'int');\n$var18->query($var11, $var9);\nif (empty($var15) && !isset($var8)) {\n    $var8 = $var4;\n}\nif (!$var12->CheckMoney($var15) && !isset($var8)) {\n    $var8 = $var3;\n}\n$var14 = $var18->result();\n$var2 = $var14['quantity'];\nif ((strtotime($var14['ends']) <= time() || $var14['closed']) && !isset($var8)) {\n    $var8 = $var7;\n}\nif ((strtotime($var14['starts']) > time()) && !isset($var8)) {\n    $var8 = $var6;\n}\nif ($var2 < $var17) {\n    $var8 = $var5;\n}\n$var18->query($var11, $var9);\n$var1 = array();\nif ($var18->numrows() > 0) {\n    $var1 = $var18->result();\n}\n$var10 = CheckBidData();\nif ($var10 != 0 && !isset($var8)) {\n    $var8 = ${\n'ERR_' . $var10}\n;\n}\nif (isset($_GET['action']) && !isset($var8)) {\n    if (count($var1) > 0) {\n$var13 =  $taint ;\t\t//sink point: $taint;\n$var16 = mysql_query($var13);\n}\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"session_id\"])) {\n$query = \"SELECT * FROM session WHERE session_id = '\".$_GET[\"session_id\"].\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 83, "slice_label": "bad", "file_name": "bad_2179_11.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// php code: \n\tif (isset($_GET[\"session_id\"])) {\n$var1 = $_GET[\"session_id\"];\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2179, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n$delete_all = $_GET['input1'];\n\n// php code: \n\t$table = _get_meta_table( $meta_type );\n\tif ( $delete_all ) {\n$query = \"SELECT _PAD_ FROM $table WHERE meta_key = %s _PAD_\";\t\t//sink point: $table;\n$res = mysql_query($query);\n\t}\n\n", "id": 256, "slice_label": "bad", "file_name": "bad_2904_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var2 = $_GET['input0'];\n$var1 = $_GET['input1'];\n\n// php code: \n\t$taint = _get_meta_table( $var2 );\n\tif ( $var1 ) {\n$var3 = \"$taint\" ;\t\t//sink point: $taint;\n$var4 = mysql_query($var3);\n\t}\n\n", "CVE_database_id": 2904, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$meta_key = $_GET['input0'];\n\n// php code: \n\t$meta_key = wp_unslash($meta_key);\n$query = \"SELECT _PAD_ FROM _PAD_ WHERE meta_key = %s\", $meta_key;\t\t//sink point: $meta_key;\n$res = mysql_query($query);\n\n", "id": 243, "slice_label": "bad", "file_name": "good_2904_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n\n// php code: \n\t$taint = wp_unslash($taint);\n$var1 = $taint;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 2904, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$sc_id = $_GET['input0'];\n\n// php code: \n\t\tif (isset($_GET[\"sc_svcTpl\"]))\n\t\t\tforeach ($_GET[\"sc_svcTpl\"] as $key)\t{\n$query = \"INSERT INTO service_categories_relation (service_service_id, sc_id) VALUES ('\"._PAD_.\"', '\".$sc_id.\"')\";\t\t//sink point: $sc_id;\n$res = mysql_query($query);\n}\n\n", "id": 37, "slice_label": "bad", "file_name": "bad_2179_5.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n\n// php code: \n\t\tif (isset($_GET[\"sc_svcTpl\"]))\n\t\t\tforeach ($_GET[\"sc_svcTpl\"] as $var3)\t{\n$var1 = $taint;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2179, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$table = _get_meta_table( $meta_type );\n$query = \"SELECT _PAD_, meta_key, meta_value FROM $table WHERE _PAD_ IN (_PAD_) ORDER BY _PAD_ ASC\";\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 253, "slice_label": "bad", "file_name": "good_2904_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var1 = $_GET['input0'];\n\n// php code: \n\t$taint = _get_meta_table( $var1 );\n$var2 = \"$taint\" . \"\";\t\t//sink point: $taint;\n$var3 = mysql_query($var2);\n\n", "CVE_database_id": 2904, "predict": 0}, {"slice": "<?php\n// php code: \n$id = (isset($_SESSION['CURRENT_ITEM'])) ? intval($_SESSION['CURRENT_ITEM']) : 0;\n$id = (isset($_GET['id'])) ? intval($_GET['id']) : 0;\n$_SESSION['CURRENT_ITEM'] = $id;\n$_SESSION['REDIRECT_AFTER_LOGIN'] = $system->SETTINGS['siteurl'] . 'item.php?id=' . $id;\n$query0 = \"SELECT a.*, ac.counter, u.nick, u.reg_date, u.city, u.country, u.zip FROM \" . $DBPrefix . \"auctions a\n\t        LEFT JOIN \" . $DBPrefix . \"users u ON (u.id = a.user)\n\t        LEFT JOIN \" . $DBPrefix . \"auccounter ac ON (ac.auction_id = a.id)\n\t        WHERE a.id = :auction_id LIMIT 1\";\n$params = array();\n$params[] = array(':auction_id', $id, 'int');\n$db->query($query0, $params);\nif ($db->numrows() == 0) {\n    $_SESSION['msg_title'] = $ERR_622;\n    $_SESSION['msg_body'] = $ERR_623;\n}\n$auction_data = $db->result();\nif (!isset($auction_data['counter'])) {\n}\nelse {\n    if (!isset($_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n        $_SESSION['WEBID_VIEWED_AUCTIONS'] = array();\n    }\n    if (!in_array($id, $_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n$query = \"UPDATE \" . $DBPrefix . \"auccounter set counter = counter + 1 WHERE auction_id = :auction_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 99, "slice_label": "bad", "file_name": "bad_56_8.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var10 = (isset($var2['CURRENT_ITEM'])) ? intval($var2['CURRENT_ITEM']) : 0;\n$var10 = (isset($_GET['id'])) ? intval($_GET['id']) : 0;\n$var2['CURRENT_ITEM'] = $var10;\n$var2['REDIRECT_AFTER_LOGIN'] = $var6->SETTINGS['siteurl'] . $var10;\n$var5 = \"SELECT a.*, ac.counter, u.nick, u.reg_date, u.city, u.country, u.zip FROM \" . $taint . \"auctions a\n\t        LEFT JOIN \" . $taint . \"users u ON (u.id = a.user)\n\t        LEFT JOIN \" . $taint . \"auccounter ac ON (ac.auction_id = a.id)\n\t        WHERE a.id = :auction_id LIMIT 1\";\n$var7 = array();\n$var7[] = array(':auction_id', $var10, 'int');\n$var11->query($var5, $var7);\nif ($var11->numrows() == 0) {\n    $var2['msg_title'] = $var4;\n    $var2['msg_body'] = $var3;\n}\n$var1 = $var11->result();\nif (!isset($var1['counter'])) {\n}\nelse {\n    if (!isset($var2['WEBID_VIEWED_AUCTIONS'])) {\n        $var2['WEBID_VIEWED_AUCTIONS'] = array();\n    }\n    if (!in_array($var10, $var2['WEBID_VIEWED_AUCTIONS'])) {\n$var8 =  $taint ;\t\t//sink point: $taint;\n$var9 = mysql_query($var8);\n}\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$sc_id = $_GET['input0'];\n$sc_arr = $_GET['input1'];\n\n// php code: \n\t\tif ($sc_id)\n\t\t\t$sc_arr = array($sc_id=>\"1\");\n\t\tforeach($sc_arr as $key=>$value)\t{\n$query = \"UPDATE service_categories SET sc_activate = '1' WHERE sc_id = '\".$key.\"'\";\t\t//sink point: $key;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 34, "slice_label": "bad", "file_name": "bad_2179_5.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var3 = $_GET['input0'];\n$var1 = $_GET['input1'];\n\n// php code: \n\t\tif ($var3)\n\t\t\t$var1 = array($var3=>\"1\");\n\t\tforeach($var1 as $taint=>$var2)\t{\n$var4 = $taint;\t\t//sink point: $taint;\n$var5 = mysql_query($var4);\n\t\t}\n\n", "CVE_database_id": 2179, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n\n// php code: \n$query = \"SELECT \\\"Version\\\" FROM \\\"_PAD_\\\" WHERE \\\"ID\\\" = $id\";\t\t//sink point: $id;\n$res = mysql_query($query);\n\n", "id": 346, "slice_label": "bad", "file_name": "bad_3551_2.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n\n// php code: \n$var1 = \"$taint\" . \"\";\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 3551, "predict": 1}, {"slice": "<?php\n// php code: \nif (isset($_GET['action']) && $_GET['action'] == 'update') {\n    if (isset($_GET['delete']) && is_array($_GET['delete']) && count($_GET['delete']) > 0) {\n        foreach ($_GET['delete'] as $k => $v) {\n            $v = intval($v);\n}\n}\n    if (isset($_GET['sell']) && is_array($_GET['sell']) && count($_GET['sell']) > 0) {\n        foreach ($_GET['sell'] as $v) {\n$query = \"UPDATE \" . $DBPrefix . \"auctions SET sold = 's' WHERE id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 122, "slice_label": "bad", "file_name": "good_56_16.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \nif (isset($_GET['action']) && $_GET['action'] == 'update') {\n    if (isset($_GET['delete']) && is_array($_GET['delete']) && count($_GET['delete']) > 0) {\n        foreach ($_GET['delete'] as $var3 => $v) {\n            $v = intval($v);\n}\n}\n    if (isset($_GET['sell']) && is_array($_GET['sell']) && count($_GET['sell']) > 0) {\n        foreach ($_GET['sell'] as $v) {\n$var1 =  $taint ;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n}\n}\n\n", "CVE_database_id": 56, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$product_id = $_GET['input0'];\n\n// php code: \n$query = \"SELECT `sku`, `insertion_id` FROM `\" . DB_PREFIX . \"amazon_product` WHERE `product_id` = '\" . (int)$product_id . \"' AND `version` = 2\";\t\t//sink point: $product_id;\n$res = mysql_query($query);\n\n", "id": 286, "slice_label": "bad", "file_name": "bad_4869_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n\n// php code: \n$var1 =  DB_PREFIX . (int)$taint ;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 4869, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$object = $_GET['input0'];\n\n// php code: \n\t   if (isset($object->id)) {\n$query = \"UPDATE \" . $this->prefix . _PAD_ . \" SET \" . _PAD_ . \"=0 WHERE \" . _PAD_;\t\t//sink point: $this;\n$res = mysql_query($query);\n}\n\n", "id": 141, "slice_label": "bad", "file_name": "good_5278_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var1 = $_GET['input0'];\n\n// php code: \n\t   if (isset($var1->id)) {\n$var2 =  $taint->prefix ;\t\t//sink point: $taint;\n$var3 = mysql_query($var2);\n}\n\n", "CVE_database_id": 5278, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$name = $_GET['input0'];\n\n// php code: \n$query = \"SELECT `sc_name`, `sc_id` FROM `service_categories` WHERE `sc_name` = '\".htmlentities($name, ENT_QUOTES, \"UTF-8\").\"'\";\t\t//sink point: $name;\n$res = mysql_query($query);\n\n", "id": 87, "slice_label": "bad", "file_name": "good_2179_5.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n\n// php code: \n$var1 = htmlentities($taint, ENT_QUOTES, \"UTF-8\");\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 2179, "predict": 0}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"mnftr_id\"])){\n\t\tif ($_GET[\"mnftr_id\"] == -1) {\n}\nelse if ($_GET[\"mnftr_id\"] == -2) {\n}\nelse if ($_GET[\"mnftr_id\"] != 0) {\n$query = \"SELECT traps_id, traps_name FROM traps WHERE manufacturer_id = \" . $_GET[\"mnftr_id\"]. \" ORDER BY traps_name\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\t\t}\n}\n\n", "id": 39, "slice_label": "bad", "file_name": "bad_2179_7.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// php code: \n\tif (isset($_GET[\"mnftr_id\"])){\n\t\tif ($_GET[\"mnftr_id\"] == -1) {\n}\nelse if ($_GET[\"mnftr_id\"] == -2) {\n}\nelse if ($_GET[\"mnftr_id\"] != 0) {\n$var1 =  $_GET[\"mnftr_id\"];\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n\t\t}\n}\n\n", "CVE_database_id": 2179, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$width = $_GET['input0'];\n\n// php code: \n$query = 'UPDATE `' . _PAD_ . '` SET rgt = rgt + ' . $width . ' WHERE rgt >=' . _PAD_;\t\t//sink point: $width;\n$res = mysql_query($query);\n\n", "id": 147, "slice_label": "bad", "file_name": "good_5278_1.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n\n// php code: \n$var1 =  $taint ;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 5278, "predict": 1}, {"slice": "<?php\n// php code: \n$query = \"SELECT css_name FROM `css_color_menu` WHERE menu_nb = '\"._PAD_->escape($_GET[\"menu\"]).\"' LIMIT 1\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 174, "slice_label": "bad", "file_name": "good_3816_7.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var1 = _PAD_->escape($_GET[\"menu\"]);\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 3816, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n\n// php code: \n$query = \"SELECT path FROM bigtree_pages WHERE id = '\".sqlescape($id).\"'\";\t\t//sink point: $id;\n$res = mysql_query($query);\n\n", "id": 197, "slice_label": "bad", "file_name": "good_5774_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n\n// php code: \n$var1 = sqlescape($taint);\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 5774, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$column = sanitize_key($meta_type . '_id');\n$query = \"SELECT $column, meta_key, meta_value FROM _PAD_ WHERE $column IN (_PAD_) ORDER BY _PAD_ ASC\";\t\t//sink point: $column;\n$res = mysql_query($query);\n\n", "id": 251, "slice_label": "bad", "file_name": "good_2904_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var1 = $_GET['input0'];\n\n// php code: \n\t$taint = sanitize_key($var1 . '_id');\n$var2 = \"$taint\" . \"$taint\" . \"\";\t\t//sink point: $taint;\n$var3 = mysql_query($var2);\n\n", "CVE_database_id": 2904, "predict": 0}, {"slice": "<?php\n// php code: \n$id=$_GET['id'];\r\n$username=base64_decode($id);\r\n$query = \"SELECT * FROM `\" . table_users . \"` where `user_login` = '\".$username.\"' AND `last_reset_request` = FROM_UNIXTIME('\"._PAD_.\"') AND user_level!='Spammer'\";\t\t//sink point: $username;\n$res = mysql_query($query);\n\n", "id": 316, "slice_label": "bad", "file_name": "bad_2350_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var3=$_GET['id'];\r\n$taint=base64_decode($var3);\r\n$var1 =  table_users .$taint;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 2350, "predict": 0}, {"slice": "<?php\n// php code: \n$catscontrol = new MPTTcategories();\nif (isset($_GET['action'])) {\n    if (!empty($_GET['id']) && !empty($_GET['title']) && !empty($_GET['duration']) && !empty($_GET['category']) && !empty($_GET['description']) && !empty($_GET['min_bid'])) {\n        if ($_GET['quantity'] < 1) {\n}\nelse if (isset($_GET['current_bid']) && $_GET['current_bid'] < $_GET['min_bid'] && $_GET['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_GET['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_GET['category']) {\n                $ct = intval($_GET['category']);\n                $parent_node = $db->result();\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                for ($i = 0; $i < count($crumbs); $i++) {\n                    if ($crumbs[$i]['cat_id'] == $ct) {\n}\nelse {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET sub_counter = sub_counter + 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                    }\n}\n}\n}\n}\n}\n\n", "id": 107, "slice_label": "bad", "file_name": "good_56_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var1 = new MPTTcategories();\nif (isset($_GET['action'])) {\n    if (!empty($_GET['id']) && !empty($_GET['title']) && !empty($_GET['duration']) && !empty($_GET['category']) && !empty($_GET['description']) && !empty($_GET['min_bid'])) {\n        if ($_GET['quantity'] < 1) {\n}\nelse if (isset($_GET['current_bid']) && $_GET['current_bid'] < $_GET['min_bid'] && $_GET['current_bid'] != 0) {\n}\nelse {\n            $var4 = \"SELECT * from \" . $taint . \"auctions WHERE id = :auc_id\";\n            $var5 = array();\n            $var5[] = array(':auc_id', $_GET['id'], 'int');\n            $var10->query($var4, $var5);\n            $var3 = $var10->result();\n            if ($var3['category'] != $_GET['category']) {\n                $var9 = intval($_GET['category']);\n                $var2 = $var10->result();\n                $var6 = $var1->get_bread_crumbs($var2['left_id'], $var2['right_id']);\n                for ($var11 = 0; $var11 < count($var6); $var11++) {\n                    if ($var6[$var11]['cat_id'] == $var9) {\n}\nelse {\n$var7 =  $taint ;\t\t//sink point: $taint;\n$var8 = mysql_query($var7);\n                    }\n}\n}\n}\n}\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// php code: \nif (isset($_GET['action']) && $_GET['action'] == 'delopenauctions') {\n    if (isset($_GET['O_delete']) && is_array($_GET['O_delete']) && count($_GET['O_delete']) > 0) {\n        foreach ($_GET['O_delete'] as $k => $v) {\n            $query0 = \"DELETE FROM \" . $DBPrefix . \"auccounter WHERE auction_id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $v, 'int');\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n}\n        $db->query($query0, $params);\n}\n    if (isset($_GET['closenow']) && is_array($_GET['closenow']) && count($_GET['closenow']) > 0) {\n        foreach ($_GET['closenow'] as $k => $v) {\n            $db->query($query0, $params);\n        }\n}\n}\n$db->query($query0, $params);\n$db->query($query0, $params);\nwhile ($item = $db->fetch()) {\n$query = \"SELECT counter FROM \" . $DBPrefix . \"auccounter WHERE auction_id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 120, "slice_label": "bad", "file_name": "good_56_15.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \nif (isset($_GET['action']) && $_GET['action'] == 'delopenauctions') {\n    if (isset($_GET['O_delete']) && is_array($_GET['O_delete']) && count($_GET['O_delete']) > 0) {\n        foreach ($_GET['O_delete'] as $var7 => $v) {\n            $var1 = \"DELETE FROM \" . $taint . \"auccounter WHERE auction_id = :auc_id\";\n            $var2 = array();\n            $var2[] = array(':auc_id', $v, 'int');\n            $var6->query($var1, $var2);\n            $var6->query($var1, $var2);\n}\n        $var6->query($var1, $var2);\n}\n    if (isset($_GET['closenow']) && is_array($_GET['closenow']) && count($_GET['closenow']) > 0) {\n        foreach ($_GET['closenow'] as $var7 => $v) {\n            $var6->query($var1, $var2);\n        }\n}\n}\n$var6->query($var1, $var2);\n$var6->query($var1, $var2);\nwhile ($var4 = $var6->fetch()) {\n$var3 =  $taint ;\t\t//sink point: $taint;\n$var5 = mysql_query($var3);\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// php code: \nif (isset($_GET[\"service_id\"]) && $_GET[\"service_id\"]) {\n$query = \"SELECT service_description, service_id FROM service WHERE service_template_model_stm_id = '\".$pearDB->escape(_PAD_).\"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n}\n\n", "id": 6, "slice_label": "bad", "file_name": "good_2179_6.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \nif (isset($_GET[\"service_id\"]) && $_GET[\"service_id\"]) {\n$var1 = $taint->escape(_PAD_);\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2179, "predict": 0}, {"slice": "<?php\n// php code: \n$id = intval($_GET['id']);\n$bid = (isset($_GET['bid'])) ? $_GET['bid'] : 0;\n$qty = (isset($_GET['qty'])) ? intval($_GET['qty']) : 1;\n$query0 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $DBPrefix . \"auctions a\n          LEFT JOIN \" . $DBPrefix . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$params = array();\n$params[] = array(':auc_id', $id, 'int');\n$db->query($query0, $params);\nif (empty($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_072;\n}\nif (!$system->CheckMoney($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_058;\n}\n$Data = $db->result();\n$aquantity = $Data['quantity'];\nif ((strtotime($Data['ends']) <= time() || $Data['closed']) && !isset($errmsg)) {\n    $errmsg = $ERR_614;\n}\nif ((strtotime($Data['starts']) > time()) && !isset($errmsg)) {\n    $errmsg = $ERR_073;\n}\nif ($aquantity < $qty) {\n    $errmsg = $ERR_608;\n}\n$tmpmsg = CheckBidData();\nif ($tmpmsg != 0 && !isset($errmsg)) {\n    $errmsg = ${\n'ERR_' . $tmpmsg}\n;\n}\nif (isset($_GET['action']) && !isset($errmsg)) {\n$query = \"SELECT name, email, item_watch, id FROM \" . $DBPrefix . \"users WHERE item_watch LIKE :auc_id AND id != :user_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 136, "slice_label": "bad", "file_name": "good_56_2.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var18 = intval($_GET['id']);\n$var14 = (isset($_GET['bid'])) ? $_GET['bid'] : 0;\n$var16 = (isset($_GET['qty'])) ? intval($_GET['qty']) : 1;\n$var10 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $taint . \"auctions a\n          LEFT JOIN \" . $taint . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$var8 = array();\n$var8[] = array(':auc_id', $var18, 'int');\n$var17->query($var10, $var8);\nif (empty($var14) && !isset($var7)) {\n    $var7 = $var3;\n}\nif (!$var11->CheckMoney($var14) && !isset($var7)) {\n    $var7 = $var2;\n}\n$var13 = $var17->result();\n$var1 = $var13['quantity'];\nif ((strtotime($var13['ends']) <= time() || $var13['closed']) && !isset($var7)) {\n    $var7 = $var6;\n}\nif ((strtotime($var13['starts']) > time()) && !isset($var7)) {\n    $var7 = $var5;\n}\nif ($var1 < $var16) {\n    $var7 = $var4;\n}\n$var9 = CheckBidData();\nif ($var9 != 0 && !isset($var7)) {\n    $var7 = ${\n'ERR_' . $var9}\n;\n}\nif (isset($_GET['action']) && !isset($var7)) {\n$var12 =  $taint ;\t\t//sink point: $taint;\n$var15 = mysql_query($var12);\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]){\n$query = \"SELECT user_id FROM session where session_id = '\".$_GET[\"sid\"].\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 1, "slice_label": "bad", "file_name": "bad_2179_13.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// php code: \n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]){\n$var1 = $_GET[\"sid\"];\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2179, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$id_column = 'user' == $meta_type ? 'umeta_id' : 'meta_id';\n$query = \"SELECT $id_column FROM _PAD_ WHERE meta_key = %s\";\t\t//sink point: $id_column;\n$res = mysql_query($query);\n\n", "id": 242, "slice_label": "bad", "file_name": "good_2904_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var1 = $_GET['input0'];\n\n// php code: \n\t$taint = 'user' == $var1 ? 'umeta_id' : 'meta_id';\n$var2 = \"$taint\" . \"\";\t\t//sink point: $taint;\n$var3 = mysql_query($var2);\n\n", "CVE_database_id": 2904, "predict": 0}, {"slice": "<?php\n// php code: \nif (isset($_GET[\"service_id\"]) && $_GET[\"service_id\"]) {\n$query = \"SELECT service_description, service_id FROM service WHERE service_template_model_stm_id = '\"._PAD_->escape($_GET[\"service_id\"]).\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 5, "slice_label": "bad", "file_name": "good_2179_6.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \nif (isset($_GET[\"service_id\"]) && $_GET[\"service_id\"]) {\n$var1 = _PAD_->escape($_GET[\"service_id\"]);\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2179, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n\n// php code: \n$query = \"UPDATE `command_categories` SET `category_name` = '\".$_GET[\"category_name\"].\"' , `category_alias` = '\".$_GET[\"category_alias\"].\"' , `category_order` = '\".$_GET[\"category_order\"].\"' WHERE `cmd_category_id` = '\".$_GET[\"cmd_category_id\"].\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 27, "slice_label": "bad", "file_name": "bad_2179_3.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n\n// php code: \n$var1 = $_GET[\"category_name\"].$_GET[\"category_alias\"].$_GET[\"category_order\"].$_GET[\"cmd_category_id\"];\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 2179, "predict": 1}, {"slice": "<?php\n// php code: \nif (isset($_GET['action']) && $_GET['action'] == 'update') {\n    if (isset($_GET['delete']) && is_array($_GET['delete']) && count($_GET['delete']) > 0) {\n        foreach ($_GET['delete'] as $k => $v) {\n$query = \"UPDATE \" . $DBPrefix . \"counters SET closedauctions = closedauctions - 1\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 121, "slice_label": "bad", "file_name": "good_56_16.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \nif (isset($_GET['action']) && $_GET['action'] == 'update') {\n    if (isset($_GET['delete']) && is_array($_GET['delete']) && count($_GET['delete']) > 0) {\n        foreach ($_GET['delete'] as $var3 => $v) {\n$var1 =  $taint ;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n}\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"id\"]) && isset($_GET[\"color\"])){\n$query = \"SELECT  * FROM `log_archive_host` WHERE host_id = \" . _PAD_->escape($_GET[\"id\"]) . \" order by date_start desc\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 165, "slice_label": "bad", "file_name": "good_3816_2.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n\tif (isset($_GET[\"id\"]) && isset($_GET[\"color\"])){\n$var1 =  _PAD_->escape($_GET[\"id\"]) ;\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 3816, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$add = $_GET['input0'];\n$second_category = $_GET['input1'];\n\n// php code: \n    $addsub = ($add) ? '+' : '-';\n    if ($second_category > 0) {\n$query = \"UPDATE \" . _PAD_ . \"categories SET counter = counter \" . $addsub . \" 1 WHERE cat_id = :cat_id\";\t\t//sink point: $addsub;\n$res = mysql_query($query);\n}\n\n", "id": 94, "slice_label": "bad", "file_name": "bad_56_6.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var3 = $_GET['input0'];\n$var1 = $_GET['input1'];\n\n// php code: \n    $taint = ($var3) ? '+' : '-';\n    if ($var1 > 0) {\n$var2 =  $taint ;\t\t//sink point: $taint;\n$var4 = mysql_query($var2);\n}\n\n", "CVE_database_id": 56, "predict": 0}, {"slice": "<?php\n// php code: \n$id=sanitize($_GET['id'], 3);\r\n$username=base64_decode($id);\r\n$query = \"SELECT * FROM `\" . table_users . \"` where `user_login` = '\".$username.\"' AND `last_reset_request` = FROM_UNIXTIME('\"._PAD_.\"') AND user_level!='Spammer'\";\t\t//sink point: $username;\n$res = mysql_query($query);\n\n", "id": 305, "slice_label": "bad", "file_name": "bad_2349_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var3=sanitize($_GET['id'], 3);\r\n$taint=base64_decode($var3);\r\n$var1 =  table_users .$taint;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 2349, "predict": 0}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"index_id\"]) && $_GET[\"index_id\"] != 0) {\n$query = \"SELECT metric_id, metric_name FROM metrics as ms, index_data as ixd WHERE ms.index_id = ixd.id and ms.index_id='\".$_GET[\"index_id\"].\"';\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 3, "slice_label": "bad", "file_name": "bad_2179_14.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// php code: \n\tif (isset($_GET[\"index_id\"]) && $_GET[\"index_id\"] != 0) {\n$var1 = $_GET[\"index_id\"];\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2179, "predict": 1}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n\tif (isset($_GET[\"id\"]) && $_GET[\"id\"] && is_numeric($_GET[\"id\"])) {\n$query = \"SELECT dir_name, img_path FROM view_img_dir, view_img, view_img_dir_relation vidr WHERE view_img_dir.dir_id = vidr.dir_dir_parent_id AND vidr.img_img_id = img_id AND img_id = '\".$pearDB->escape(_PAD_).\"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n}\n\n", "id": 78, "slice_label": "bad", "file_name": "good_2179_2.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n\t$taint = new CentreonDB();\n\tif (isset($_GET[\"id\"]) && $_GET[\"id\"] && is_numeric($_GET[\"id\"])) {\n$var1 = $taint->escape(_PAD_);\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2179, "predict": 0}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n\tif (isset($_GET[\"session_id\"])) {\n$query = \"SELECT * FROM session WHERE session_id = '\".$pearDB->escape(_PAD_).\"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n}\n\n", "id": 55, "slice_label": "bad", "file_name": "good_2179_11.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n\t$taint = new CentreonDB();\n\tif (isset($_GET[\"session_id\"])) {\n$var1 = $taint->escape(_PAD_);\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2179, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$item = $_GET['input0'];\n\n// php code: \n\t\t\tif (!is_array($item)) {\n\t\t\t\t$item = sqlescape($item);\n$query = \"SELECT * FROM bigtree_feeds WHERE id = '$item'\";\t\t//sink point: $item;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 195, "slice_label": "bad", "file_name": "good_5774_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n\n// php code: \n\t\t\tif (!is_array($taint)) {\n\t\t\t\t$taint = sqlescape($taint);\n$var1 = \"$taint\";\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\t\t\t}\n\n", "CVE_database_id": 5774, "predict": 1}, {"slice": "<?php\n// php code: \nif (isset($_GET['action']) && $_GET['action'] == 'update') {\n    if (isset($_GET['relist']) && is_array($_GET['relist']) && count($_GET['relist']) > 0) {\n        foreach ($_GET['relist'] as $k) {\n$query = \"SELECT duration, category, quantity FROM \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 123, "slice_label": "bad", "file_name": "good_56_16.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \nif (isset($_GET['action']) && $_GET['action'] == 'update') {\n    if (isset($_GET['relist']) && is_array($_GET['relist']) && count($_GET['relist']) > 0) {\n        foreach ($_GET['relist'] as $var3) {\n$var1 =  $taint ;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n}\n}\n\n", "CVE_database_id": 56, "predict": 0}, {"slice": "<?php\n// php code: \nif (isset($_GET[\"service_id\"]) && $_GET[\"service_id\"]) {\n$query = \"SELECT service_description, service_id FROM service WHERE service_template_model_stm_id = '\".$_GET[\"service_id\"].\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 38, "slice_label": "bad", "file_name": "bad_2179_6.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// php code: \nif (isset($_GET[\"service_id\"]) && $_GET[\"service_id\"]) {\n$var1 = $_GET[\"service_id\"];\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2179, "predict": 1}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n$query = \"SELECT user_id FROM `session` WHERE session_id = '\".$pearDB->escape(session_id()).\"' AND user_id = '\".$pearDB->escape(_PAD_).\"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n\n", "id": 170, "slice_label": "bad", "file_name": "good_3816_6.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n\t$taint = new CentreonDB();\n$var1 = $taint->escape(session_id()).$taint->escape(_PAD_);\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 3816, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$key = $_GET['input0'];\n\n// php code: \n\t\t\t$key = sqlescape($key);\n$query = \"SELECT * FROM bigtree_caches WHERE `identifier` = '_PAD_' AND `key` = '$key'\";\t\t//sink point: $key;\n$res = mysql_query($query);\n\n", "id": 184, "slice_label": "bad", "file_name": "good_5774_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n\n// php code: \n\t\t\t$taint = sqlescape($taint);\n$var1 = \"$taint\" ;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 5774, "predict": 1}, {"slice": "<?php\n// php code: \n\tif (isset($_SESSION['centreon'])) {\n$query = \"SELECT user_id FROM session WHERE session_id = '\" . htmlentities($_GET['sid'], ENT_QUOTES, \"UTF-8\") . \"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 171, "slice_label": "bad", "file_name": "bad_3816_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n\tif (isset($var1['centreon'])) {\n$var2 =  htmlentities($_GET['sid'], ENT_QUOTES, \"UTF-8\") ;\t\t//sink point: $_GET;\n$var3 = mysql_query($var2);\n}\n\n", "CVE_database_id": 3816, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$id_column = 'user' == $meta_type ? 'umeta_id' : 'meta_id';\n$query = \"SELECT _PAD_, meta_key, meta_value FROM _PAD_ WHERE _PAD_ IN (_PAD_) ORDER BY $id_column ASC\";\t\t//sink point: $id_column;\n$res = mysql_query($query);\n\n", "id": 252, "slice_label": "bad", "file_name": "good_2904_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var1 = $_GET['input0'];\n\n// php code: \n\t$taint = 'user' == $var1 ? 'umeta_id' : 'meta_id';\n$var2 = \"$taint\" . \"\";\t\t//sink point: $taint;\n$var3 = mysql_query($var2);\n\n", "CVE_database_id": 2904, "predict": 0}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"host_id\"]) && $_GET[\"host_id\"]){\n$query = \"SELECT host_id, host_name FROM host WHERE host_template_model_htm_id = '\".$_GET[\"host_id\"].\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 28, "slice_label": "bad", "file_name": "bad_2179_4.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// php code: \n\tif (isset($_GET[\"host_id\"]) && $_GET[\"host_id\"]){\n$var1 = $_GET[\"host_id\"];\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2179, "predict": 1}, {"slice": "<?php\n// php code: \nif (isset($_GET['action']) && $_GET['action'] == 'delopenauctions') {\n    if (isset($_GET['O_delete']) && is_array($_GET['O_delete']) && count($_GET['O_delete']) > 0) {\n        foreach ($_GET['O_delete'] as $k => $v) {\n            $v = intval($v);\n}\n}\n    if (isset($_GET['closenow']) && is_array($_GET['closenow']) && count($_GET['closenow']) > 0) {\n        foreach ($_GET['closenow'] as $k => $v) {\n$query = \"UPDATE \" . $DBPrefix . \"auctions SET ends = CURRENT_TIMESTAMP, relist = relisted WHERE id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 118, "slice_label": "bad", "file_name": "good_56_15.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \nif (isset($_GET['action']) && $_GET['action'] == 'delopenauctions') {\n    if (isset($_GET['O_delete']) && is_array($_GET['O_delete']) && count($_GET['O_delete']) > 0) {\n        foreach ($_GET['O_delete'] as $var3 => $v) {\n            $v = intval($v);\n}\n}\n    if (isset($_GET['closenow']) && is_array($_GET['closenow']) && count($_GET['closenow']) > 0) {\n        foreach ($_GET['closenow'] as $var3 => $v) {\n$var1 =  $taint ;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n}\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// php code: \nif (isset($_GET['action']) && $_GET['action'] == 'delopenauctions') {\n    if (isset($_GET['O_delete']) && is_array($_GET['O_delete']) && count($_GET['O_delete']) > 0) {\n        foreach ($_GET['O_delete'] as $k => $v) {\n            $v = intval($v);\n}\n}\n    if (isset($_GET['startnow']) && is_array($_GET['startnow']) && count($_GET['startnow']) > 0) {\n        foreach ($_GET['startnow'] as $k => $v) {\n$query = \"SELECT duration FROM \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 126, "slice_label": "bad", "file_name": "good_56_17.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \nif (isset($_GET['action']) && $_GET['action'] == 'delopenauctions') {\n    if (isset($_GET['O_delete']) && is_array($_GET['O_delete']) && count($_GET['O_delete']) > 0) {\n        foreach ($_GET['O_delete'] as $var3 => $v) {\n            $v = intval($v);\n}\n}\n    if (isset($_GET['startnow']) && is_array($_GET['startnow']) && count($_GET['startnow']) > 0) {\n        foreach ($_GET['startnow'] as $var3 => $v) {\n$var1 =  $taint ;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n}\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$page = $_GET['input0'];\n\n// php code: \n\t\t\tif (!is_numeric($page)) {\n\t\t\t\t$page = $page[\"id\"];\n\t\t\t}\n$query = \"SELECT bigtree_tags.* FROM bigtree_tags JOIN bigtree_tags_rel ON bigtree_tags.id = bigtree_tags_rel.tag WHERE bigtree_tags_rel.`table` = 'bigtree_pages' AND bigtree_tags_rel.entry = '\".sqlescape($page).\"' ORDER BY bigtree_tags.tag\";\t\t//sink point: $page;\n$res = mysql_query($query);\n\n", "id": 219, "slice_label": "bad", "file_name": "good_5774_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n\n// php code: \n\t\t\tif (!is_numeric($taint)) {\n\t\t\t\t$taint = $taint[\"id\"];\n\t\t\t}\n$var1 = sqlescape($taint);\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 5774, "predict": 1}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"session_id\"])) {\n$query = \"SELECT * FROM session WHERE session_id = '\"._PAD_->escape($_GET[\"session_id\"]).\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 54, "slice_label": "bad", "file_name": "good_2179_11.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n\tif (isset($_GET[\"session_id\"])) {\n$var1 = _PAD_->escape($_GET[\"session_id\"]);\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2179, "predict": 0}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"index_id\"]) && $_GET[\"index_id\"] != 0) {\n$query = \"SELECT metric_id, metric_name FROM metrics as ms, index_data as ixd WHERE ms.index_id = ixd.id and ms.index_id='\"._PAD_->escape($_GET[\"index_id\"]).\"';\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 64, "slice_label": "bad", "file_name": "good_2179_14.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n\tif (isset($_GET[\"index_id\"]) && $_GET[\"index_id\"] != 0) {\n$var1 = _PAD_->escape($_GET[\"index_id\"]);\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2179, "predict": 0}, {"slice": "<?php\n// php code: \n$n=sanitize($_GET['n'], 3);\r\n$query = \"SELECT * FROM `\" . table_users . \"` where `user_login` = '\"._PAD_.\"' AND `last_reset_request` = FROM_UNIXTIME('\".$n.\"') AND user_level!='Spammer'\";\t\t//sink point: $n;\n$res = mysql_query($query);\n\n", "id": 313, "slice_label": "bad", "file_name": "good_2350_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$taint=sanitize($_GET['n'], 3);\r\n$var1 =  table_users .$taint;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 2350, "predict": 0}, {"slice": "<?php\n// php code: \n$id = (isset($_SESSION['CURRENT_ITEM'])) ? intval($_SESSION['CURRENT_ITEM']) : 0;\n$id = (isset($_GET['id'])) ? intval($_GET['id']) : 0;\n$_SESSION['CURRENT_ITEM'] = $id;\n$_SESSION['REDIRECT_AFTER_LOGIN'] = $system->SETTINGS['siteurl'] . 'item.php?id=' . $id;\n$query0 = \"SELECT a.*, ac.counter, u.nick, u.reg_date, u.city, u.country, u.zip FROM \" . $DBPrefix . \"auctions a\n\t        LEFT JOIN \" . $DBPrefix . \"users u ON (u.id = a.user)\n\t        LEFT JOIN \" . $DBPrefix . \"auccounter ac ON (ac.auction_id = a.id)\n\t        WHERE a.id = :auction_id LIMIT 1\";\n$params = array();\n$params[] = array(':auction_id', $id, 'int');\n$db->query($query0, $params);\nif ($db->numrows() == 0) {\n    $_SESSION['msg_title'] = $ERR_622;\n    $_SESSION['msg_body'] = $ERR_623;\n}\n$auction_data = $db->result();\nif (!isset($auction_data['counter'])) {\n    $params[] = array(':counter', $id, 'int');\n    $db->query($query0, $params);\n}\nelse {\n    if (!isset($_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n        $_SESSION['WEBID_VIEWED_AUCTIONS'] = array();\n    }\n    if (!in_array($id, $_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n        $db->query($query0, $params);\n}\n}\nif ($user->logged_in) {\n    $db->query($query0, $params);\n}\n$db->query($query0, $params);\nif ($system->SETTINGS['extra_cat'] == 'y' && intval($auction_data['secondcat']) > 0) {\n    $db->query($query0, $params);\n}\n$db->query($query0, $params);\n$num_bids = $db->numrows();\n$left = $auction_data['quantity'];\n$hbidder_data = array();\nforeach ($db->fetchall() as $bidrec) {\n    if ($left > 0 && !in_array($bidrec['bidder'], $hbidder_data)) {\n        $db->query($query0, $params);\n        $db->query($query0, $params);\n}\n}\nif ($user->logged_in && $num_bids > 0) {\n    $db->query($query0, $params);\n}\n$db->query($query0, $params);\nforeach ($db->fetchall() as $row) {\n$query = \"SELECT sentfrom, message FROM \" . $DBPrefix . \"messages WHERE question = :id AND reply_of = :reply_of OR id = :message_id ORDER BY sentat ASC\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 103, "slice_label": "bad", "file_name": "bad_56_8.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var17 = (isset($var4['CURRENT_ITEM'])) ? intval($var4['CURRENT_ITEM']) : 0;\n$var17 = (isset($_GET['id'])) ? intval($_GET['id']) : 0;\n$var4['CURRENT_ITEM'] = $var17;\n$var4['REDIRECT_AFTER_LOGIN'] = $var10->SETTINGS['siteurl'] . $var17;\n$var9 = \"SELECT a.*, ac.counter, u.nick, u.reg_date, u.city, u.country, u.zip FROM \" . $taint . \"auctions a\n\t        LEFT JOIN \" . $taint . \"users u ON (u.id = a.user)\n\t        LEFT JOIN \" . $taint . \"auccounter ac ON (ac.auction_id = a.id)\n\t        WHERE a.id = :auction_id LIMIT 1\";\n$var8 = array();\n$var8[] = array(':auction_id', $var17, 'int');\n$var16->query($var9, $var8);\nif ($var16->numrows() == 0) {\n    $var4['msg_title'] = $var5;\n    $var4['msg_body'] = $var6;\n}\n$var1 = $var16->result();\nif (!isset($var1['counter'])) {\n    $var8[] = array(':counter', $var17, 'int');\n    $var16->query($var9, $var8);\n}\nelse {\n    if (!isset($var4['WEBID_VIEWED_AUCTIONS'])) {\n        $var4['WEBID_VIEWED_AUCTIONS'] = array();\n    }\n    if (!in_array($var17, $var4['WEBID_VIEWED_AUCTIONS'])) {\n        $var16->query($var9, $var8);\n}\n}\nif ($var12->logged_in) {\n    $var16->query($var9, $var8);\n}\n$var16->query($var9, $var8);\nif ($var10->SETTINGS['extra_cat'] == 'y' && intval($var1['secondcat']) > 0) {\n    $var16->query($var9, $var8);\n}\n$var16->query($var9, $var8);\n$var3 = $var16->numrows();\n$var13 = $var1['quantity'];\n$var2 = array();\nforeach ($var16->fetchall() as $var7) {\n    if ($var13 > 0 && !in_array($var7['bidder'], $var2)) {\n        $var16->query($var9, $var8);\n        $var16->query($var9, $var8);\n}\n}\nif ($var12->logged_in && $var3 > 0) {\n    $var16->query($var9, $var8);\n}\n$var16->query($var9, $var8);\nforeach ($var16->fetchall() as $var14) {\n$var11 =  $taint ;\t\t//sink point: $taint;\n$var15 = mysql_query($var11);\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// php code: \n\t$pearDBO \t= new CentreonDB(\"centstorage\");\n\tif (isset($_GET[\"host_id\"]) && isset($_GET[\"id\"]) && isset($_GET[\"color\"])){\n$query = \"SELECT  * FROM `log_archive_service` WHERE host_id = '\".$pearDBO->escape(_PAD_).\"' AND service_id = \".$pearDBO->escape(_PAD_).\" ORDER BY `date_start` DESC\";\t\t//sink point: $pearDBO;\n$res = mysql_query($query);\n}\n\n", "id": 168, "slice_label": "bad", "file_name": "good_3816_4.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n\t$taint \t= new CentreonDB(\"centstorage\");\n\tif (isset($_GET[\"host_id\"]) && isset($_GET[\"id\"]) && isset($_GET[\"color\"])){\n$var1 = $taint->escape(_PAD_).$taint->escape(_PAD_);\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 3816, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n\n// php code: \n\t\tif (testServiceCategorieExistence($_GET[\"sc_name\"])){\n$query = \"SELECT MAX(sc_id) FROM `service_categories` WHERE sc_name LIKE '\".$_GET[\"sc_name\"].\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 35, "slice_label": "bad", "file_name": "bad_2179_5.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n\n// php code: \n\t\tif (testServiceCategorieExistence($_GET[\"sc_name\"])){\n$var1 = $_GET[\"sc_name\"];\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2179, "predict": 1}, {"slice": "<?php\n// php code: \n$query = \"SELECT css_name FROM `css_color_menu` WHERE menu_nb = '\".htmlentities($_GET[\"menu\"], ENT_QUOTES, \"UTF-8\").\"' LIMIT 1\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 180, "slice_label": "bad", "file_name": "bad_3816_7.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var1 = htmlentities($_GET[\"menu\"], ENT_QUOTES, \"UTF-8\");\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 3816, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$path = $_GET['input0'];\n\n// php code: \n\t\t\t$x = count($path);\n\t\t\twhile ($x) {\n$query = \"SELECT * FROM bigtree_route_history WHERE old_route = '\".implode(\"/\",array_slice($path,0,_PAD_));\t\t//sink point: $path;\n$res = mysql_query($query);\n}\n\n", "id": 228, "slice_label": "bad", "file_name": "bad_5774_0.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n\n// php code: \n\t\t\t$var3 = count($taint);\n\t\t\twhile ($var3) {\n$var1 = implode(\"/\",array_slice($taint,0,_PAD_));\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 5774, "predict": 1}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"id\"]) && $_GET[\"id\"] && is_numeric($_GET[\"id\"])) {\n$query = \"SELECT dir_name, img_path FROM view_img_dir, view_img, view_img_dir_relation vidr WHERE view_img_dir.dir_id = vidr.dir_dir_parent_id AND vidr.img_img_id = img_id AND img_id = '\"._PAD_->escape($_GET[\"id\"]).\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 77, "slice_label": "bad", "file_name": "good_2179_2.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n\tif (isset($_GET[\"id\"]) && $_GET[\"id\"] && is_numeric($_GET[\"id\"])) {\n$var1 = _PAD_->escape($_GET[\"id\"]);\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2179, "predict": 0}, {"slice": "<?php\n// php code: \n$catscontrol = new MPTTcategories();\nif (isset($_GET['action'])) {\n    if (!empty($_GET['id']) && !empty($_GET['title']) && !empty($_GET['duration']) && !empty($_GET['category']) && !empty($_GET['description']) && !empty($_GET['min_bid'])) {\n        if ($_GET['quantity'] < 1) {\n}\nelse if (isset($_GET['current_bid']) && $_GET['current_bid'] < $_GET['min_bid'] && $_GET['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_GET['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_GET['category']) {\n                $ct = intval($_GET['category']);\n                $parent_node = $db->result();\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                for ($i = 0; $i < count($crumbs); $i++) {\n                    if ($crumbs[$i]['cat_id'] == $ct) {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET counter = counter + 1, sub_counter = sub_counter + 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                    }\n}\n}\n}\n}\n}\n\n", "id": 106, "slice_label": "bad", "file_name": "good_56_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var1 = new MPTTcategories();\nif (isset($_GET['action'])) {\n    if (!empty($_GET['id']) && !empty($_GET['title']) && !empty($_GET['duration']) && !empty($_GET['category']) && !empty($_GET['description']) && !empty($_GET['min_bid'])) {\n        if ($_GET['quantity'] < 1) {\n}\nelse if (isset($_GET['current_bid']) && $_GET['current_bid'] < $_GET['min_bid'] && $_GET['current_bid'] != 0) {\n}\nelse {\n            $var4 = \"SELECT * from \" . $taint . \"auctions WHERE id = :auc_id\";\n            $var5 = array();\n            $var5[] = array(':auc_id', $_GET['id'], 'int');\n            $var10->query($var4, $var5);\n            $var3 = $var10->result();\n            if ($var3['category'] != $_GET['category']) {\n                $var9 = intval($_GET['category']);\n                $var2 = $var10->result();\n                $var6 = $var1->get_bread_crumbs($var2['left_id'], $var2['right_id']);\n                for ($var11 = 0; $var11 < count($var6); $var11++) {\n                    if ($var6[$var11]['cat_id'] == $var9) {\n$var7 =  $taint ;\t\t//sink point: $taint;\n$var8 = mysql_query($var7);\n                    }\n}\n}\n}\n}\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n\n// php code: \n$query = \"SELECT \\\"Version\\\" FROM \\\"_PAD_\\\" WHERE \\\"ID\\\" = $id\";\t\t//sink point: $id;\n$res = mysql_query($query);\n\n", "id": 342, "slice_label": "bad", "file_name": "good_3551_2.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n\n// php code: \n$var1 = \"$taint\" ;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 3551, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$tags = $_GET['input0'];\n\n// php code: \n\t\t\tforeach ($tags as $tag) {\n$query = \"SELECT * FROM bigtree_tags WHERE tag = '\".sqlescape($tag);\t\t//sink point: $tag;\n$res = mysql_query($query);\n}\n\n", "id": 212, "slice_label": "bad", "file_name": "good_5774_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var2 = $_GET['input0'];\n\n// php code: \n\t\t\tforeach ($var2 as $taint) {\n$var1 = sqlescape($taint);\t\t//sink point: $taint;\n$var3 = mysql_query($var1);\n}\n\n", "CVE_database_id": 5774, "predict": 1}, {"slice": "<?php\n// php code: \nif(isset($_GET[\"domain\"]))\n{\n\t$domain = mysql_real_escape_string($_GET[\"domain\"]);\n}\n$query = \"SELECT * FROM url_referer WHERE referer_domains='\".$domain.\"'GROUP BY url_domains, referer_domains\";\t\t//sink point: $domain;\n$res = mysql_query($query);\n\n", "id": 295, "slice_label": "bad", "file_name": "good_2318_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \nif(isset($_GET[\"domain\"]))\n{\n\t$taint = mysql_real_escape_string($_GET[\"domain\"]);\n}\n$var1 = $taint;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 2318, "predict": 0}, {"slice": "<?php\n// php code: \nif (isset($_GET['action'])) {\n    if (!empty($_GET['id']) && !empty($_GET['title']) && !empty($_GET['duration']) && !empty($_GET['category']) && !empty($_GET['description']) && !empty($_GET['min_bid'])) {\n        if ($_GET['quantity'] < 1) {\n}\nelse if (isset($_GET['current_bid']) && $_GET['current_bid'] < $_GET['min_bid'] && $_GET['current_bid'] != 0) {\n}\nelse {\n$query = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 104, "slice_label": "bad", "file_name": "good_56_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \nif (isset($_GET['action'])) {\n    if (!empty($_GET['id']) && !empty($_GET['title']) && !empty($_GET['duration']) && !empty($_GET['category']) && !empty($_GET['description']) && !empty($_GET['min_bid'])) {\n        if ($_GET['quantity'] < 1) {\n}\nelse if (isset($_GET['current_bid']) && $_GET['current_bid'] < $_GET['min_bid'] && $_GET['current_bid'] != 0) {\n}\nelse {\n$var1 =  $taint ;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n}\n}\n\n", "CVE_database_id": 56, "predict": 0}, {"slice": "<?php\n// php code: \n\t$pearDB \t= new CentreonDB();\n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]) {\n$query = \"SELECT user_id FROM session where session_id = '\".$pearDB->escape(_PAD_).\"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n}\n\n", "id": 15, "slice_label": "bad", "file_name": "good_2179_9.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n\t$taint \t= new CentreonDB();\n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]) {\n$var1 = $taint->escape(_PAD_);\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2179, "predict": 0}, {"slice": "<?php\n// php code: \n$id = (isset($_SESSION['CURRENT_ITEM'])) ? intval($_SESSION['CURRENT_ITEM']) : 0;\n$id = (isset($_GET['id'])) ? intval($_GET['id']) : 0;\n$query0 = \"SELECT a.*, ac.counter, u.nick, u.reg_date, u.city, u.country, u.zip FROM \" . $DBPrefix . \"auctions a\n\t        LEFT JOIN \" . $DBPrefix . \"users u ON (u.id = a.user)\n\t        LEFT JOIN \" . $DBPrefix . \"auccounter ac ON (ac.auction_id = a.id)\n\t        WHERE a.id = :auction_id LIMIT 1\";\n$params = array();\n$params[] = array(':auction_id', $id, 'int');\n$db->query($query0, $params);\n$auction_data = $db->result();\nif (!isset($auction_data['counter'])) {\n$query = \"INSERT INTO `\" . $DBPrefix ;\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 98, "slice_label": "bad", "file_name": "bad_56_8.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var7 = (isset($var2['CURRENT_ITEM'])) ? intval($var2['CURRENT_ITEM']) : 0;\n$var7 = (isset($_GET['id'])) ? intval($_GET['id']) : 0;\n$var3 = \"SELECT a.*, ac.counter, u.nick, u.reg_date, u.city, u.country, u.zip FROM \" . $taint . \"auctions a\n\t        LEFT JOIN \" . $taint . \"users u ON (u.id = a.user)\n\t        LEFT JOIN \" . $taint . \"auccounter ac ON (ac.auction_id = a.id)\n\t        WHERE a.id = :auction_id LIMIT 1\";\n$var4 = array();\n$var4[] = array(':auction_id', $var7, 'int');\n$var8->query($var3, $var4);\n$var1 = $var8->result();\nif (!isset($var1['counter'])) {\n$var5 =  $taint ;\t\t//sink point: $taint;\n$var6 = mysql_query($var5);\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// php code: \n$query = \"SELECT * FROM `session` WHERE session_id = '\".$_GET[\"session_id\"].\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 8, "slice_label": "bad", "file_name": "bad_2179_15.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// php code: \n$var1 = $_GET[\"session_id\"];\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 2179, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$dir = $_GET['input0'];\n\n// php code: \n$query = \"SELECT dir_id FROM view_img_dir WHERE dir_alias = '\".$dir.\"'\";\t\t//sink point: $dir;\n$res = mysql_query($query);\n\n", "id": 56, "slice_label": "bad", "file_name": "good_2179_11.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n\n// php code: \n$var1 = $taint;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 2179, "predict": 1}, {"slice": "<?php\n// php code: \n$n=$_GET['n'];\r\n$query = \"SELECT * FROM `\" . table_users . \"` where `user_login` = '\"._PAD_.\"' AND `last_reset_request` = FROM_UNIXTIME('\".$n.\"') AND user_level!='Spammer'\";\t\t//sink point: $n;\n$res = mysql_query($query);\n\n", "id": 317, "slice_label": "bad", "file_name": "bad_2350_0.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// php code: \n$taint=$_GET['n'];\r\n$var1 =  table_users .$taint;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 2350, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n\n// php code: \n\t\t\tif (is_numeric($id)) {\n}\nelse {\n$query = \"SELECT * FROM bigtree_pending_changes WHERE `id` = '\".sqlescape(substr($id,1)).\"'\");\t\t//sink point: $id;\n$res = mysql_query($query);\n}\n\n", "id": 209, "slice_label": "bad", "file_name": "good_5774_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n\n// php code: \n\t\t\tif (is_numeric($taint)) {\n}\nelse {\n$var1 = sqlescape(substr($taint,1));\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 5774, "predict": 1}, {"slice": "<?php\n// php code: \n$query = \"SELECT * FROM session WHERE session_id = '\" . htmlentities($_GET['session'], ENT_QUOTES, \"UTF-8\") . \"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 175, "slice_label": "bad", "file_name": "bad_3816_2.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var1 =  htmlentities($_GET['session'], ENT_QUOTES, \"UTF-8\") ;\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 3816, "predict": 0}, {"slice": "<?php\n// php code: \n\t$pearDB \t= new CentreonDB();\n$query = \"SELECT * FROM session WHERE session_id = '\" . $pearDB->escape(_PAD_) . \"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n\n", "id": 164, "slice_label": "bad", "file_name": "good_3816_2.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n\t$taint \t= new CentreonDB();\n$var1 =  $taint->escape(_PAD_) ;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 3816, "predict": 0}, {"slice": "<?php\n// php code: \nif (($_GET['event_id'] || !isset($_GET['event_id'])) && !isset($_GET[assignment_id])) {\n}\nelse {\n$query = 'SELECT TITLE,STAFF_ID,DATE_FORMAT(DUE_DATE,\\'%d-%b-%y\\') AS SCHOOL_DATE,ASSIGNED_DATE,DUE_DATE,DESCRIPTION FROM gradebook_assignments WHERE ASSIGNMENT_ID=\\'' . $_GET[assignment_id] ;\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 333, "slice_label": "bad", "file_name": "good_4024_0.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// php code: \nif (($_GET['event_id'] || !isset($_GET['event_id'])) && !isset($_GET[assignment_id])) {\n}\nelse {\n$var1 =  $_GET[assignment_id] ;\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 4024, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$max_age = $_GET['input0'];\n\n// php code: \n\t\t\tif ($max_age) {\n$query = \"SELECT * FROM bigtree_caches WHERE `identifier` = '_PAD_' AND `key` = '_PAD_' AND timestamp >= '\".date(\"Y-m-d H:i:s\",time() - $max_age).\"'\";\t\t//sink point: $max_age;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 181, "slice_label": "bad", "file_name": "good_5774_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n\n// php code: \n\t\t\tif ($taint) {\n$var1 = date(\"Y-m-d H:i:s\",time() - $taint).\"\";\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\t\t\t}\n\n", "CVE_database_id": 5774, "predict": 1}, {"slice": "<?php\n// php code: \n$id = intval($_GET['id']);\n$bid = (isset($_GET['bid'])) ? $_GET['bid'] : 0;\n$qty = (isset($_GET['qty'])) ? intval($_GET['qty']) : 1;\n$query0 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $DBPrefix . \"auctions a\n          LEFT JOIN \" . $DBPrefix . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$params = array();\n$params[] = array(':auc_id', $id, 'int');\n$db->query($query0, $params);\nif (empty($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_072;\n}\nif (!$system->CheckMoney($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_058;\n}\n$Data = $db->result();\n$atype = $Data['auction_type'];\n$aquantity = $Data['quantity'];\nif ((strtotime($Data['ends']) <= time() || $Data['closed']) && !isset($errmsg)) {\n    $errmsg = $ERR_614;\n}\nif ((strtotime($Data['starts']) > time()) && !isset($errmsg)) {\n    $errmsg = $ERR_073;\n}\nif ($aquantity < $qty) {\n    $errmsg = $ERR_608;\n}\n$tmpmsg = CheckBidData();\nif ($tmpmsg != 0 && !isset($errmsg)) {\n    $errmsg = ${\n'ERR_' . $tmpmsg}\n;\n}\nif (isset($_GET['action']) && !isset($errmsg)) {\n    if ($atype == 1 && !isset($errmsg)) {\n}\nelse if ($atype == 2 && !isset($errmsg)) {\n$query = \"SELECT bid, quantity FROM \" . $DBPrefix . \"bids WHERE bidder = :bidder_id AND auction = :auc_id ORDER BY bid DESC LIMIT 1\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 132, "slice_label": "bad", "file_name": "good_56_2.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var19 = intval($_GET['id']);\n$var15 = (isset($_GET['bid'])) ? $_GET['bid'] : 0;\n$var17 = (isset($_GET['qty'])) ? intval($_GET['qty']) : 1;\n$var10 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $taint . \"auctions a\n          LEFT JOIN \" . $taint . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$var8 = array();\n$var8[] = array(':auc_id', $var19, 'int');\n$var18->query($var10, $var8);\nif (empty($var15) && !isset($var7)) {\n    $var7 = $var3;\n}\nif (!$var11->CheckMoney($var15) && !isset($var7)) {\n    $var7 = $var2;\n}\n$var14 = $var18->result();\n$var13 = $var14['auction_type'];\n$var1 = $var14['quantity'];\nif ((strtotime($var14['ends']) <= time() || $var14['closed']) && !isset($var7)) {\n    $var7 = $var6;\n}\nif ((strtotime($var14['starts']) > time()) && !isset($var7)) {\n    $var7 = $var5;\n}\nif ($var1 < $var17) {\n    $var7 = $var4;\n}\n$var9 = CheckBidData();\nif ($var9 != 0 && !isset($var7)) {\n    $var7 = ${\n'ERR_' . $var9}\n;\n}\nif (isset($_GET['action']) && !isset($var7)) {\n    if ($var13 == 1 && !isset($var7)) {\n}\nelse if ($var13 == 2 && !isset($var7)) {\n$var12 =  $taint ;\t\t//sink point: $taint;\n$var16 = mysql_query($var12);\n}\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$column = sanitize_key($meta_type . '_id');\n$query = \"SELECT _PAD_ FROM _PAD_ WHERE meta_key = %s AND $column = %d\";\t\t//sink point: $column;\n$res = mysql_query($query);\n\n", "id": 241, "slice_label": "bad", "file_name": "good_2904_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var1 = $_GET['input0'];\n\n// php code: \n\t$taint = sanitize_key($var1 . '_id');\n$var2 = \"$taint\" . \"\";\t\t//sink point: $taint;\n$var3 = mysql_query($var2);\n\n", "CVE_database_id": 2904, "predict": 0}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"id\"]) && $_GET[\"id\"] && is_numeric($_GET[\"id\"])) {\n$query = \"SELECT dir_name, img_path FROM view_img_dir, view_img, view_img_dir_relation vidr WHERE view_img_dir.dir_id = vidr.dir_dir_parent_id AND vidr.img_img_id = img_id AND img_id = '\".$_GET[\"id\"].\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 13, "slice_label": "bad", "file_name": "bad_2179_2.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// php code: \n\tif (isset($_GET[\"id\"]) && $_GET[\"id\"] && is_numeric($_GET[\"id\"])) {\n$var1 = $_GET[\"id\"];\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2179, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$object = $_GET['input0'];\n$where = $_GET['input1'];\n\n// php code: \n\t   if (isset($object->id)) {\n$query = \"UPDATE \" . _PAD_->prefix . _PAD_ . \" SET \" . _PAD_ . \"=0 WHERE \" . $where;\t\t//sink point: $where;\n$res = mysql_query($query);\n}\n\n", "id": 140, "slice_label": "bad", "file_name": "good_5278_1.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var1 = $_GET['input0'];\n$taint = $_GET['input1'];\n\n// php code: \n\t   if (isset($var1->id)) {\n$var2 =  _PAD_->prefix . $taint;\t\t//sink point: $taint;\n$var3 = mysql_query($var2);\n}\n\n", "CVE_database_id": 5278, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$table = _get_meta_table( $meta_type );\n$query = \"SELECT _PAD_ FROM $table WHERE meta_key = %s\";\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 244, "slice_label": "bad", "file_name": "good_2904_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var1 = $_GET['input0'];\n\n// php code: \n\t$taint = _get_meta_table( $var1 );\n$var2 = \"$taint\" ;\t\t//sink point: $taint;\n$var3 = mysql_query($var2);\n\n", "CVE_database_id": 2904, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$edates = $_GET['input0'];\n\n// php code: \n        foreach ($edates as $edate) {\n$query = 'SELECT DISTINCT p.*, er.event_starttime, er.signup_cutoff FROM ' . $db->prefix . 'product p ';\t\t//sink point: $db;\n$res = mysql_query($query);\n}\n\n", "id": 299, "slice_label": "bad", "file_name": "good_5326_3.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var1 = $_GET['input0'];\n\n// php code: \n        foreach ($var1 as $var3) {\n$var2 =  $taint->prefix ;\t\t//sink point: $taint;\n$var4 = mysql_query($var2);\n}\n\n", "CVE_database_id": 5326, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$only_hidden = $_GET['input0'];\n\n// php code: \n\t\t\t$sort = $only_hidden ? \"nav_title ASC\" : \"position DESC, id ASC\";\n$query = \"SELECT id,nav_title,parent,external,new_window,template,route,path FROM bigtree_pages WHERE _PAD_ AND in_nav = '_PAD_' AND archived != 'on' AND (publish_at <= NOW() OR publish_at IS NULL) AND (expire_at >= NOW() OR expire_at IS NULL) ORDER BY $sort\";\t\t//sink point: $sort;\n$res = mysql_query($query);\n\n", "id": 200, "slice_label": "bad", "file_name": "good_5774_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var1 = $_GET['input0'];\n\n// php code: \n\t\t\t$taint = $var1 ? \"nav_title ASC\" : \"position DESC, id ASC\";\n$var2 = \"$taint\" ;\t\t//sink point: $taint;\n$var3 = mysql_query($var2);\n\n", "CVE_database_id": 5774, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$only_hidden = $_GET['input0'];\n\n// php code: \n\t\t\t$in_nav = $only_hidden ? \"\" : \"on\";\n$query = \"SELECT id,nav_title,parent,external,new_window,template,route,path FROM bigtree_pages WHERE _PAD_ AND in_nav = '$in_nav' AND archived != 'on' AND (publish_at <= NOW() OR publish_at IS NULL) AND (expire_at >= NOW() OR expire_at IS NULL) ORDER BY _PAD_\";\t\t//sink point: $in_nav;\n$res = mysql_query($query);\n\n", "id": 199, "slice_label": "bad", "file_name": "good_5774_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var1 = $_GET['input0'];\n\n// php code: \n\t\t\t$taint = $var1 ? \"\" : \"on\";\n$var2 = \"$taint\" ;\t\t//sink point: $taint;\n$var3 = mysql_query($var2);\n\n", "CVE_database_id": 5774, "predict": 1}, {"slice": "<?php\n// php code: \n$id = (isset($_SESSION['CURRENT_ITEM'])) ? intval($_SESSION['CURRENT_ITEM']) : 0;\n$id = (isset($_GET['id'])) ? intval($_GET['id']) : 0;\n$_SESSION['CURRENT_ITEM'] = $id;\n$_SESSION['REDIRECT_AFTER_LOGIN'] = $system->SETTINGS['siteurl'] . 'item.php?id=' . $id;\n$query0 = \"SELECT a.*, ac.counter, u.nick, u.reg_date, u.city, u.country, u.zip FROM \" . $DBPrefix . \"auctions a\n\t        LEFT JOIN \" . $DBPrefix . \"users u ON (u.id = a.user)\n\t        LEFT JOIN \" . $DBPrefix . \"auccounter ac ON (ac.auction_id = a.id)\n\t        WHERE a.id = :auction_id LIMIT 1\";\n$params = array();\n$params[] = array(':auction_id', $id, 'int');\n$db->query($query0, $params);\nif ($db->numrows() == 0) {\n    $_SESSION['msg_title'] = $ERR_622;\n    $_SESSION['msg_body'] = $ERR_623;\n}\n$auction_data = $db->result();\nif (!isset($auction_data['counter'])) {\n    $params[] = array(':counter', $id, 'int');\n    $db->query($query0, $params);\n}\nelse {\n    if (!isset($_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n        $_SESSION['WEBID_VIEWED_AUCTIONS'] = array();\n    }\n    if (!in_array($id, $_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n        $db->query($query0, $params);\n}\n}\nif ($user->logged_in) {\n    $db->query($query0, $params);\n}\n$db->query($query0, $params);\nif ($system->SETTINGS['extra_cat'] == 'y' && intval($auction_data['secondcat']) > 0) {\n    $db->query($query0, $params);\n}\n$db->query($query0, $params);\n$left = $auction_data['quantity'];\n$hbidder_data = array();\nforeach ($db->fetchall() as $bidrec) {\n    if ($left > 0 && !in_array($bidrec['bidder'], $hbidder_data)) {\n$query = \"SELECT rate FROM \" . $DBPrefix . \"feedbacks WHERE rated_user_id = :rate_users_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 101, "slice_label": "bad", "file_name": "bad_56_8.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var14 = (isset($var3['CURRENT_ITEM'])) ? intval($var3['CURRENT_ITEM']) : 0;\n$var14 = (isset($_GET['id'])) ? intval($_GET['id']) : 0;\n$var3['CURRENT_ITEM'] = $var14;\n$var3['REDIRECT_AFTER_LOGIN'] = $var7->SETTINGS['siteurl'] . $var14;\n$var6 = \"SELECT a.*, ac.counter, u.nick, u.reg_date, u.city, u.country, u.zip FROM \" . $taint . \"auctions a\n\t        LEFT JOIN \" . $taint . \"users u ON (u.id = a.user)\n\t        LEFT JOIN \" . $taint . \"auccounter ac ON (ac.auction_id = a.id)\n\t        WHERE a.id = :auction_id LIMIT 1\";\n$var9 = array();\n$var9[] = array(':auction_id', $var14, 'int');\n$var15->query($var6, $var9);\nif ($var15->numrows() == 0) {\n    $var3['msg_title'] = $var5;\n    $var3['msg_body'] = $var4;\n}\n$var2 = $var15->result();\nif (!isset($var2['counter'])) {\n    $var9[] = array(':counter', $var14, 'int');\n    $var15->query($var6, $var9);\n}\nelse {\n    if (!isset($var3['WEBID_VIEWED_AUCTIONS'])) {\n        $var3['WEBID_VIEWED_AUCTIONS'] = array();\n    }\n    if (!in_array($var14, $var3['WEBID_VIEWED_AUCTIONS'])) {\n        $var15->query($var6, $var9);\n}\n}\nif ($var11->logged_in) {\n    $var15->query($var6, $var9);\n}\n$var15->query($var6, $var9);\nif ($var7->SETTINGS['extra_cat'] == 'y' && intval($var2['secondcat']) > 0) {\n    $var15->query($var6, $var9);\n}\n$var15->query($var6, $var9);\n$var12 = $var2['quantity'];\n$var1 = array();\nforeach ($var15->fetchall() as $var8) {\n    if ($var12 > 0 && !in_array($var8['bidder'], $var1)) {\n$var10 =  $taint ;\t\t//sink point: $taint;\n$var13 = mysql_query($var10);\n}\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"o\"]) && $_GET[\"o\"] == \"r\"){\n$query = \"UPDATE session SET update_acl = '1' WHERE session_id = '\".$_GET[\"session_id\"].\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 74, "slice_label": "bad", "file_name": "bad_2179_10.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// php code: \n\tif (isset($_GET[\"o\"]) && $_GET[\"o\"] == \"r\"){\n$var1 = $_GET[\"session_id\"];\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2179, "predict": 1}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"index\"])){\n$query = \"SELECT `command_example` FROM `command` WHERE `command_id` = '\". _PAD_->escape($_GET[\"index\"]) .\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 161, "slice_label": "bad", "file_name": "good_3816_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n\tif (isset($_GET[\"index\"])){\n$var1 =  _PAD_->escape($_GET[\"index\"]) ;\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 3816, "predict": 0}, {"slice": "<?php\n// php code: \n$id = intval($_GET['id']);\n$bid = (isset($_GET['bid'])) ? $_GET['bid'] : 0;\n$qty = (isset($_GET['qty'])) ? intval($_GET['qty']) : 1;\n$query0 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $DBPrefix . \"auctions a\n          LEFT JOIN \" . $DBPrefix . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$params = array();\n$params[] = array(':auc_id', $id, 'int');\n$db->query($query0, $params);\nif (empty($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_072;\n}\nif (!$system->CheckMoney($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_058;\n}\nelse {\n    $bid = round($system->input_money($bid), 2);\n}\n$Data = $db->result();\n$atype = $Data['auction_type'];\n$aquantity = $Data['quantity'];\n$current_bid = $Data['current_bid'];\nif ((strtotime($Data['ends']) <= time() || $Data['closed']) && !isset($errmsg)) {\n    $errmsg = $ERR_614;\n}\nif ((strtotime($Data['starts']) > time()) && !isset($errmsg)) {\n    $errmsg = $ERR_073;\n}\nif ($aquantity < $qty) {\n    $errmsg = $ERR_608;\n}\n$tmpmsg = CheckBidData();\nif ($tmpmsg != 0 && !isset($errmsg)) {\n    $errmsg = ${\n'ERR_' . $tmpmsg}\n;\n}\nif (isset($_GET['action']) && !isset($errmsg)) {\n    if ($atype == 1 && !isset($errmsg)) {\n        if ($system->SETTINGS['proxy_bidding'] == 'n') {\n            if ($current_bid < $bid) {\n$query = \"SELECT u.id FROM \" . $DBPrefix . \"bids b, \" . $DBPrefix . \"users u WHERE b.auction = :auc_id AND b.bidder = u.id and u.suspended = 0 ORDER BY bid DESC\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n\n", "id": 130, "slice_label": "bad", "file_name": "good_56_2.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var20 = intval($_GET['id']);\n$var16 = (isset($_GET['bid'])) ? $_GET['bid'] : 0;\n$var18 = (isset($_GET['qty'])) ? intval($_GET['qty']) : 1;\n$var11 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $taint . \"auctions a\n          LEFT JOIN \" . $taint . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$var9 = array();\n$var9[] = array(':auc_id', $var20, 'int');\n$var19->query($var11, $var9);\nif (empty($var16) && !isset($var8)) {\n    $var8 = $var4;\n}\nif (!$var12->CheckMoney($var16) && !isset($var8)) {\n    $var8 = $var3;\n}\nelse {\n    $var16 = round($var12->input_money($var16), 2);\n}\n$var15 = $var19->result();\n$var14 = $var15['auction_type'];\n$var2 = $var15['quantity'];\n$var1 = $var15['current_bid'];\nif ((strtotime($var15['ends']) <= time() || $var15['closed']) && !isset($var8)) {\n    $var8 = $var7;\n}\nif ((strtotime($var15['starts']) > time()) && !isset($var8)) {\n    $var8 = $var6;\n}\nif ($var2 < $var18) {\n    $var8 = $var5;\n}\n$var10 = CheckBidData();\nif ($var10 != 0 && !isset($var8)) {\n    $var8 = ${\n'ERR_' . $var10}\n;\n}\nif (isset($_GET['action']) && !isset($var8)) {\n    if ($var14 == 1 && !isset($var8)) {\n        if ($var12->SETTINGS['proxy_bidding'] == 'n') {\n            if ($var1 < $var16) {\n$var13 =  $taint . $taint ;\t\t//sink point: $taint;\n$var17 = mysql_query($var13);\n}\n}\n}\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$product_id = $_GET['input0'];\n$version = $_GET['input1'];\n\n// php code: \n\t\tif ($version == 3) {\n$query = \"SELECT `messages` FROM `\" . DB_PREFIX . \"amazon_product` WHERE `product_id` = '\" . (int)$product_id . \"' AND `version` = 3\";\t\t//sink point: $product_id;\n$res = mysql_query($query);\n}\n\n", "id": 285, "slice_label": "bad", "file_name": "bad_4869_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n$var1 = $_GET['input1'];\n\n// php code: \n\t\tif ($var1 == 3) {\n$var2 =  DB_PREFIX . (int)$taint ;\t\t//sink point: $taint;\n$var3 = mysql_query($var2);\n}\n\n", "CVE_database_id": 4869, "predict": 0}, {"slice": "<?php\n// php code: \n$catscontrol = new MPTTcategories();\nif (isset($_GET['action'])) {\n    if (!empty($_GET['id']) && !empty($_GET['title']) && !empty($_GET['duration']) && !empty($_GET['category']) && !empty($_GET['description']) && !empty($_GET['min_bid'])) {\n        if ($_GET['quantity'] < 1) {\n}\nelse if (isset($_GET['current_bid']) && $_GET['current_bid'] < $_GET['min_bid'] && $_GET['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_GET['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_GET['category']) {\n                $ct = intval($_GET['category']);\n                $parent_node = $db->result();\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n}\n            if ($AUCTION['secondcat'] != $_GET['secondcat']) {\n                $ct = intval($_GET['secondcat']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                for ($i = 0; $i < count($crumbs); $i++) {\n                    if ($crumbs[$i]['cat_id'] == $ct) {\n}\nelse {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET sub_counter = sub_counter + 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                    }\n}\n}\n}\n}\n}\n\n", "id": 112, "slice_label": "bad", "file_name": "good_56_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var1 = new MPTTcategories();\nif (isset($_GET['action'])) {\n    if (!empty($_GET['id']) && !empty($_GET['title']) && !empty($_GET['duration']) && !empty($_GET['category']) && !empty($_GET['description']) && !empty($_GET['min_bid'])) {\n        if ($_GET['quantity'] < 1) {\n}\nelse if (isset($_GET['current_bid']) && $_GET['current_bid'] < $_GET['min_bid'] && $_GET['current_bid'] != 0) {\n}\nelse {\n            $var4 = \"SELECT * from \" . $taint . \"auctions WHERE id = :auc_id\";\n            $var5 = array();\n            $var5[] = array(':auc_id', $_GET['id'], 'int');\n            $var10->query($var4, $var5);\n            $var3 = $var10->result();\n            if ($var3['category'] != $_GET['category']) {\n                $var9 = intval($_GET['category']);\n                $var2 = $var10->result();\n                $var6 = $var1->get_bread_crumbs($var2['left_id'], $var2['right_id']);\n                $var6 = $var1->get_bread_crumbs($var2['left_id'], $var2['right_id']);\n}\n            if ($var3['secondcat'] != $_GET['secondcat']) {\n                $var9 = intval($_GET['secondcat']);\n                $var6 = $var1->get_bread_crumbs($var2['left_id'], $var2['right_id']);\n                for ($var11 = 0; $var11 < count($var6); $var11++) {\n                    if ($var6[$var11]['cat_id'] == $var9) {\n}\nelse {\n$var7 =  $taint ;\t\t//sink point: $taint;\n$var8 = mysql_query($var7);\n                    }\n}\n}\n}\n}\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$page = $_GET['input0'];\n\n// php code: \n$query = \"SELECT bigtree_modules.class FROM bigtree_modules JOIN bigtree_templates ON bigtree_modules.id = bigtree_templates.module WHERE bigtree_templates.id = '\".$page[\"template\"].\"'\";\t\t//sink point: $page;\n$res = mysql_query($query);\n\n", "id": 194, "slice_label": "bad", "file_name": "good_5774_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n\n// php code: \n$var1 = $taint[\"template\"];\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 5774, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$lft = $_GET['input0'];\n$rgt = $_GET['input1'];\n\n// php code: \n\t   $width = ($rgt - $lft) + 1;\n$query = 'UPDATE `' . _PAD_ . '` SET rgt = rgt - ' . $width . ' WHERE rgt > ' . _PAD_;\t\t//sink point: $width;\n$res = mysql_query($query);\n\n", "id": 154, "slice_label": "bad", "file_name": "good_5278_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var2 = $_GET['input0'];\n$var4 = $_GET['input1'];\n\n// php code: \n\t   $taint = ($var4 - $var2) + 1;\n$var1 =  $taint ;\t\t//sink point: $taint;\n$var3 = mysql_query($var1);\n\n", "CVE_database_id": 5278, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$path = $_GET['input0'];\n\n// php code: \n\t\t\t$spath = sqlescape(implode(\"/\",$path));\n$query = \"SELECT bigtree_pages.id,bigtree_templates.routed FROM bigtree_pages LEFT JOIN bigtree_templates ON bigtree_pages.template = bigtree_templates.id WHERE path = '$spath' AND archived = '' _PAD_\";\t\t//sink point: $spath;\n$res = mysql_query($query);\n\n", "id": 203, "slice_label": "bad", "file_name": "good_5774_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var2 = $_GET['input0'];\n\n// php code: \n\t\t\t$taint = sqlescape(implode(\"/\",$var2));\n$var1 = \"$taint\" ;\t\t//sink point: $taint;\n$var3 = mysql_query($var1);\n\n", "CVE_database_id": 5774, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n\n// php code: \n\t\tif (testCommandCategorieExistence($_GET[\"category_name\"])){\n$query = \"INSERT INTO `command_categories` (`category_name` , `category_alias`, `category_order`) VALUES ('\".$_GET[\"category_name\"].\"', '\".$_GET[\"category_alias\"].\"', '1')\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 26, "slice_label": "bad", "file_name": "bad_2179_3.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n\n// php code: \n\t\tif (testCommandCategorieExistence($_GET[\"category_name\"])){\n$var1 = $_GET[\"category_name\"].$_GET[\"category_alias\"];\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n\t\t}\n\n", "CVE_database_id": 2179, "predict": 1}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"host_id\"]) && $_GET[\"host_id\"]){\n$query = \"SELECT host_id, host_name FROM host WHERE host_template_model_htm_id = '\"._PAD_->escape($_GET[\"host_id\"]).\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 85, "slice_label": "bad", "file_name": "good_2179_4.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n\tif (isset($_GET[\"host_id\"]) && $_GET[\"host_id\"]){\n$var1 = _PAD_->escape($_GET[\"host_id\"]);\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2179, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$url = $_GET['input0'];\n\n// php code: \n\t\t\t$url = sqlescape(htmlspecialchars(strip_tags(rtrim($url,\"/\"))));\n$query = \"SELECT * FROM bigtree_404s WHERE broken_url = '$url'\";\t\t//sink point: $url;\n$res = mysql_query($query);\n\n", "id": 223, "slice_label": "bad", "file_name": "good_5774_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n\n// php code: \n\t\t\t$taint = sqlescape(htmlspecialchars(strip_tags(rtrim($taint,\"/\"))));\n$var1 = \"$taint\" ;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 5774, "predict": 1}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"index\"])){\n$query = \"SELECT `command_example` FROM `command` WHERE `command_id` = '\". $_GET[\"index\"] .\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 172, "slice_label": "bad", "file_name": "bad_3816_1.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// php code: \n\tif (isset($_GET[\"index\"])){\n$var1 =  $_GET[\"index\"] ;\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 3816, "predict": 1}, {"slice": "<?php\n// php code: \n$id = intval($_GET['id']);\n$bid = (isset($_GET['bid'])) ? $_GET['bid'] : 0;\n$qty = (isset($_GET['qty'])) ? intval($_GET['qty']) : 1;\n$query0 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $DBPrefix . \"auctions a\n          LEFT JOIN \" . $DBPrefix . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$params = array();\n$params[] = array(':auc_id', $id, 'int');\n$db->query($query0, $params);\nif (empty($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_072;\n}\nif (!$system->CheckMoney($bid) && !isset($errmsg)) {\n    $errmsg = $ERR_058;\n}\n$Data = $db->result();\n$atype = $Data['auction_type'];\n$aquantity = $Data['quantity'];\nif ((strtotime($Data['ends']) <= time() || $Data['closed']) && !isset($errmsg)) {\n    $errmsg = $ERR_614;\n}\nif ((strtotime($Data['starts']) > time()) && !isset($errmsg)) {\n    $errmsg = $ERR_073;\n}\nif ($aquantity < $qty) {\n    $errmsg = $ERR_608;\n}\n$tmpmsg = CheckBidData();\nif ($tmpmsg != 0 && !isset($errmsg)) {\n    $errmsg = ${\n'ERR_' . $tmpmsg}\n;\n}\nif (isset($_GET['action']) && !isset($errmsg)) {\n    if ($atype == 1 && !isset($errmsg)) {\n}\nelse if ($atype == 2 && !isset($errmsg)) {\n        if (!isset($errmsg)) {\n$query = \"UPDATE \" . $DBPrefix ;\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n\n", "id": 133, "slice_label": "bad", "file_name": "good_56_2.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var19 = intval($_GET['id']);\n$var15 = (isset($_GET['bid'])) ? $_GET['bid'] : 0;\n$var17 = (isset($_GET['qty'])) ? intval($_GET['qty']) : 1;\n$var10 = \"SELECT a.*, u.nick, u.email, u.id AS uId FROM \" . $taint . \"auctions a\n          LEFT JOIN \" . $taint . \"users u ON (a.user = u.id)\n          WHERE a.id = :auc_id\";\n$var8 = array();\n$var8[] = array(':auc_id', $var19, 'int');\n$var18->query($var10, $var8);\nif (empty($var15) && !isset($var7)) {\n    $var7 = $var3;\n}\nif (!$var11->CheckMoney($var15) && !isset($var7)) {\n    $var7 = $var2;\n}\n$var14 = $var18->result();\n$var13 = $var14['auction_type'];\n$var1 = $var14['quantity'];\nif ((strtotime($var14['ends']) <= time() || $var14['closed']) && !isset($var7)) {\n    $var7 = $var6;\n}\nif ((strtotime($var14['starts']) > time()) && !isset($var7)) {\n    $var7 = $var5;\n}\nif ($var1 < $var17) {\n    $var7 = $var4;\n}\n$var9 = CheckBidData();\nif ($var9 != 0 && !isset($var7)) {\n    $var7 = ${\n'ERR_' . $var9}\n;\n}\nif (isset($_GET['action']) && !isset($var7)) {\n    if ($var13 == 1 && !isset($var7)) {\n}\nelse if ($var13 == 2 && !isset($var7)) {\n        if (!isset($var7)) {\n$var12 =  $taint;\t\t//sink point: $taint;\n$var16 = mysql_query($var12);\n}\n}\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"host_id\"]) && isset($_GET[\"id\"]) && isset($_GET[\"color\"])){\n$query = \"SELECT  * FROM `log_archive_service` WHERE host_id = '\"._PAD_->escape($_GET[\"host_id\"]).\"' AND service_id = \"._PAD_->escape($_GET[\"id\"]).\" ORDER BY `date_start` DESC\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 167, "slice_label": "bad", "file_name": "good_3816_4.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n\tif (isset($_GET[\"host_id\"]) && isset($_GET[\"id\"]) && isset($_GET[\"color\"])){\n$var1 = _PAD_->escape($_GET[\"host_id\"])._PAD_->escape($_GET[\"id\"]);\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 3816, "predict": 0}, {"slice": "<?php\n// php code: \nif (isset($_GET['action'])) {\n    if (!empty($_GET['id']) && !empty($_GET['title']) && !empty($_GET['duration']) && !empty($_GET['category']) && !empty($_GET['description']) && !empty($_GET['min_bid'])) {\n        if ($_GET['quantity'] < 1) {\n}\nelse if (isset($_GET['current_bid']) && $_GET['current_bid'] < $_GET['min_bid'] && $_GET['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_GET['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['secondcat'] != $_GET['secondcat']) {\n$query = \"SELECT left_id, right_id, level FROM \" . $DBPrefix . \"categories WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n\n", "id": 110, "slice_label": "bad", "file_name": "good_56_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \nif (isset($_GET['action'])) {\n    if (!empty($_GET['id']) && !empty($_GET['title']) && !empty($_GET['duration']) && !empty($_GET['category']) && !empty($_GET['description']) && !empty($_GET['min_bid'])) {\n        if ($_GET['quantity'] < 1) {\n}\nelse if (isset($_GET['current_bid']) && $_GET['current_bid'] < $_GET['min_bid'] && $_GET['current_bid'] != 0) {\n}\nelse {\n            $var2 = \"SELECT * from \" . $taint . \"auctions WHERE id = :auc_id\";\n            $var3 = array();\n            $var3[] = array(':auc_id', $_GET['id'], 'int');\n            $var6->query($var2, $var3);\n            $var1 = $var6->result();\n            if ($var1['secondcat'] != $_GET['secondcat']) {\n$var4 =  $taint ;\t\t//sink point: $taint;\n$var5 = mysql_query($var4);\n}\n}\n}\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n\n// php code: \n$query = \"UPDATE `command_categories` SET `category_name` = '\".$pearDB->escape(_PAD_).\"' , `category_alias` = '\".$pearDB->escape(_PAD_).\"' , `category_order` = '\".$pearDB->escape(_PAD_).\"' WHERE `cmd_category_id` = '\".$pearDB->escape(_PAD_).\"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n\n", "id": 82, "slice_label": "bad", "file_name": "good_2179_3.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n\n// php code: \n$var1 = $taint->escape(_PAD_).$taint->escape(_PAD_).$taint->escape(_PAD_).$taint->escape(_PAD_);\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 2179, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$ends = $_GET['input0'];\n\n// php code: \n    if ($system->SETTINGS['ae_status'] == 'y' && (strtotime($ends) - $system->SETTINGS['ae_timebefore']) < time()) {\n$query = \"UPDATE \" . _PAD_ . \"auctions SET ends = DATE_ADD(ends, INTERVAL \" . $system->SETTINGS['ae_extend'] ;\t\t//sink point: $system;\n$res = mysql_query($query);\n}\n\n", "id": 129, "slice_label": "bad", "file_name": "good_56_2.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var2 = $_GET['input0'];\n\n// php code: \n    if ($taint->SETTINGS['ae_status'] == 'y' && (strtotime($var2) - $taint->SETTINGS['ae_timebefore']) < time()) {\n$var1 =  $taint->SETTINGS['ae_extend'] ;\t\t//sink point: $taint;\n$var3 = mysql_query($var1);\n}\n\n", "CVE_database_id": 56, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$ids = $_GET['input0'];\n\n// php code: \n\t$non_cached_ids = _get_non_cached_ids( $ids, 'posts' );\n\tif ( !empty( $non_cached_ids ) ) {\n$query = \"SELECT $wpdb->posts.* FROM $wpdb->posts WHERE ID IN (%s)\";\t\t//sink point: $wpdb;\n$res = mysql_query($query);\n}\n\n", "id": 237, "slice_label": "bad", "file_name": "bad_2904_2.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var3 = $_GET['input0'];\n\n// php code: \n\t$var1 = _get_non_cached_ids( $var3, 'posts' );\n\tif ( !empty( $var1 ) ) {\n$var2 = \"$taint\" . \"$taint\" ;\t\t//sink point: $taint;\n$var4 = mysql_query($var2);\n}\n\n", "CVE_database_id": 2904, "predict": 1}, {"slice": "<?php\n// php code: \n$user->checkSuspended();\n$catscontrol = new MPTTcategories();\n$query0 = \"SELECT value FROM \" . $DBPrefix . \"fees WHERE type = 'relist_fee'\";\n$db->direct_query($query0);\n$relist_fee = $db->result('value');\nif (isset($_GET['action']) && $_GET['action'] == 'update') {\n    if (isset($_GET['delete']) && is_array($_GET['delete']) && count($_GET['delete']) > 0) {\n        foreach ($_GET['delete'] as $k => $v) {\n            $db->direct_query($query0);\n            $params = array();\n            $params[] = array(':auc_id', $v, 'int');\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n        }\n}\n    if (isset($_GET['sell']) && is_array($_GET['sell']) && count($_GET['sell']) > 0) {\n        foreach ($_GET['sell'] as $v) {\n            $db->query($query0, $params);\n        }\n}\n    if (isset($_GET['relist']) && is_array($_GET['relist']) && count($_GET['relist']) > 0) {\n        foreach ($_GET['relist'] as $k) {\n            $db->query($query0, $params);\n            if ($system->SETTINGS['fees'] == 'y' && !$user->permissions['no_fees'] && $relist_fee > 0) {\n                if ($system->SETTINGS['fee_type'] == 1) {\n                    $db->query($query0, $params);\n                }\n}\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n            $db->direct_query($query0);\n            $db->query($query0, $params);\n            $parent_node = $db->result();\n            $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n            for ($i = 0; $i < count($crumbs); $i++) {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET sub_counter = sub_counter + 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n\n", "id": 125, "slice_label": "bad", "file_name": "good_56_16.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var9->checkSuspended();\n$var1 = new MPTTcategories();\n$var4 = \"SELECT value FROM \" . $taint . \"fees WHERE type = 'relist_fee'\";\n$var11->direct_query($var4);\n$var3 = $var11->result('value');\nif (isset($_GET['action']) && $_GET['action'] == 'update') {\n    if (isset($_GET['delete']) && is_array($_GET['delete']) && count($_GET['delete']) > 0) {\n        foreach ($_GET['delete'] as $var12 => $v) {\n            $var11->direct_query($var4);\n            $var6 = array();\n            $var6[] = array(':auc_id', $v, 'int');\n            $var11->query($var4, $var6);\n            $var11->query($var4, $var6);\n            $var11->query($var4, $var6);\n            $var11->query($var4, $var6);\n        }\n}\n    if (isset($_GET['sell']) && is_array($_GET['sell']) && count($_GET['sell']) > 0) {\n        foreach ($_GET['sell'] as $v) {\n            $var11->query($var4, $var6);\n        }\n}\n    if (isset($_GET['relist']) && is_array($_GET['relist']) && count($_GET['relist']) > 0) {\n        foreach ($_GET['relist'] as $var12) {\n            $var11->query($var4, $var6);\n            if ($var5->SETTINGS['fees'] == 'y' && !$var9->permissions['no_fees'] && $var3 > 0) {\n                if ($var5->SETTINGS['fee_type'] == 1) {\n                    $var11->query($var4, $var6);\n                }\n}\n            $var11->query($var4, $var6);\n            $var11->query($var4, $var6);\n            $var11->query($var4, $var6);\n            $var11->query($var4, $var6);\n            $var11->direct_query($var4);\n            $var11->query($var4, $var6);\n            $var2 = $var11->result();\n            $var7 = $var1->get_bread_crumbs($var2['left_id'], $var2['right_id']);\n            for ($var13 = 0; $var13 < count($var7); $var13++) {\n$var8 =  $taint ;\t\t//sink point: $taint;\n$var10 = mysql_query($var8);\n}\n}\n}\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// php code: \n$catscontrol = new MPTTcategories();\nif (isset($_GET['action'])) {\n    if (!empty($_GET['id']) && !empty($_GET['title']) && !empty($_GET['duration']) && !empty($_GET['category']) && !empty($_GET['description']) && !empty($_GET['min_bid'])) {\n        if ($_GET['quantity'] < 1) {\n}\nelse if (isset($_GET['current_bid']) && $_GET['current_bid'] < $_GET['min_bid'] && $_GET['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_GET['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_GET['category']) {\n                $parent_node = $db->result();\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                $cta = intval($AUCTION['category']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                for ($i = 0; $i < count($crumbs); $i++) {\n                    if ($crumbs[$i]['cat_id'] == $cta) {\n}\nelse {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET sub_counter = sub_counter - 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                    }\n}\n}\n}\n}\n}\n\n", "id": 109, "slice_label": "bad", "file_name": "good_56_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var1 = new MPTTcategories();\nif (isset($_GET['action'])) {\n    if (!empty($_GET['id']) && !empty($_GET['title']) && !empty($_GET['duration']) && !empty($_GET['category']) && !empty($_GET['description']) && !empty($_GET['min_bid'])) {\n        if ($_GET['quantity'] < 1) {\n}\nelse if (isset($_GET['current_bid']) && $_GET['current_bid'] < $_GET['min_bid'] && $_GET['current_bid'] != 0) {\n}\nelse {\n            $var4 = \"SELECT * from \" . $taint . \"auctions WHERE id = :auc_id\";\n            $var5 = array();\n            $var5[] = array(':auc_id', $_GET['id'], 'int');\n            $var10->query($var4, $var5);\n            $var3 = $var10->result();\n            if ($var3['category'] != $_GET['category']) {\n                $var2 = $var10->result();\n                $var6 = $var1->get_bread_crumbs($var2['left_id'], $var2['right_id']);\n                $var8 = intval($var3['category']);\n                $var6 = $var1->get_bread_crumbs($var2['left_id'], $var2['right_id']);\n                for ($var11 = 0; $var11 < count($var6); $var11++) {\n                    if ($var6[$var11]['cat_id'] == $var8) {\n}\nelse {\n$var7 =  $taint ;\t\t//sink point: $taint;\n$var9 = mysql_query($var7);\n                    }\n}\n}\n}\n}\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$table = $_GET['input0'];\n\n// php code: \n\t   $table = $this->prefix . $table;\n$query = 'UPDATE `' . $table . '` SET rgt = rgt + ' . _PAD_ . ' WHERE rgt >=' . _PAD_;\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 146, "slice_label": "bad", "file_name": "good_5278_1.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n\n// php code: \n\t   $taint = $var2->prefix . $taint;\n$var1 =  $taint ;\t\t//sink point: $taint;\n$var3 = mysql_query($var1);\n\n", "CVE_database_id": 5278, "predict": 1}, {"slice": "<?php\n// php code: \nif (isset($_GET['action'])) {\n    if (!empty($_GET['id']) && !empty($_GET['title']) && !empty($_GET['duration']) && !empty($_GET['category']) && !empty($_GET['description']) && !empty($_GET['min_bid'])) {\n        if ($_GET['quantity'] < 1) {\n}\nelse if (isset($_GET['current_bid']) && $_GET['current_bid'] < $_GET['min_bid'] && $_GET['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_GET['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_GET['category']) {\n$query = \"SELECT left_id, right_id, level FROM \" . $DBPrefix . \"categories WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n\n", "id": 105, "slice_label": "bad", "file_name": "good_56_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \nif (isset($_GET['action'])) {\n    if (!empty($_GET['id']) && !empty($_GET['title']) && !empty($_GET['duration']) && !empty($_GET['category']) && !empty($_GET['description']) && !empty($_GET['min_bid'])) {\n        if ($_GET['quantity'] < 1) {\n}\nelse if (isset($_GET['current_bid']) && $_GET['current_bid'] < $_GET['min_bid'] && $_GET['current_bid'] != 0) {\n}\nelse {\n            $var2 = \"SELECT * from \" . $taint . \"auctions WHERE id = :auc_id\";\n            $var3 = array();\n            $var3[] = array(':auc_id', $_GET['id'], 'int');\n            $var6->query($var2, $var3);\n            $var1 = $var6->result();\n            if ($var1['category'] != $_GET['category']) {\n$var4 =  $taint ;\t\t//sink point: $taint;\n$var5 = mysql_query($var4);\n}\n}\n}\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// php code: \n$catscontrol = new MPTTcategories();\nif (isset($_GET['action'])) {\n    if (!empty($_GET['id']) && !empty($_GET['title']) && !empty($_GET['duration']) && !empty($_GET['category']) && !empty($_GET['description']) && !empty($_GET['min_bid'])) {\n        if ($_GET['quantity'] < 1) {\n}\nelse if (isset($_GET['current_bid']) && $_GET['current_bid'] < $_GET['min_bid'] && $_GET['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_GET['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_GET['category']) {\n                $parent_node = $db->result();\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                $cta = intval($AUCTION['category']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                for ($i = 0; $i < count($crumbs); $i++) {\n                    if ($crumbs[$i]['cat_id'] == $cta) {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET counter = counter - 1, sub_counter = sub_counter - 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                    }\n}\n}\n}\n}\n}\n\n", "id": 108, "slice_label": "bad", "file_name": "good_56_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var1 = new MPTTcategories();\nif (isset($_GET['action'])) {\n    if (!empty($_GET['id']) && !empty($_GET['title']) && !empty($_GET['duration']) && !empty($_GET['category']) && !empty($_GET['description']) && !empty($_GET['min_bid'])) {\n        if ($_GET['quantity'] < 1) {\n}\nelse if (isset($_GET['current_bid']) && $_GET['current_bid'] < $_GET['min_bid'] && $_GET['current_bid'] != 0) {\n}\nelse {\n            $var4 = \"SELECT * from \" . $taint . \"auctions WHERE id = :auc_id\";\n            $var5 = array();\n            $var5[] = array(':auc_id', $_GET['id'], 'int');\n            $var10->query($var4, $var5);\n            $var3 = $var10->result();\n            if ($var3['category'] != $_GET['category']) {\n                $var2 = $var10->result();\n                $var6 = $var1->get_bread_crumbs($var2['left_id'], $var2['right_id']);\n                $var8 = intval($var3['category']);\n                $var6 = $var1->get_bread_crumbs($var2['left_id'], $var2['right_id']);\n                for ($var11 = 0; $var11 < count($var6); $var11++) {\n                    if ($var6[$var11]['cat_id'] == $var8) {\n$var7 =  $taint ;\t\t//sink point: $taint;\n$var9 = mysql_query($var7);\n                    }\n}\n}\n}\n}\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$ends = $_GET['input0'];\n\n// php code: \n    if ($system->SETTINGS['ae_status'] == 'y' && (strtotime($ends) - $system->SETTINGS['ae_timebefore']) < time()) {\n$query = \"UPDATE \" . $DBPrefix . \"auctions SET ends = DATE_ADD(ends, INTERVAL \";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 128, "slice_label": "bad", "file_name": "good_56_2.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var3 = $_GET['input0'];\n\n// php code: \n    if ($var1->SETTINGS['ae_status'] == 'y' && (strtotime($var3) - $var1->SETTINGS['ae_timebefore']) < time()) {\n$var2 =  $taint;\t\t//sink point: $taint;\n$var4 = mysql_query($var2);\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// php code: \n$id=sanitize($_GET['id'], 3);\r\n$username=base64_decode($id);\r\n$query = \"SELECT * FROM `\" . table_users . \"` where `user_login` = '\".$username.\"' AND `last_reset_request` = FROM_UNIXTIME('\"._PAD_.\"') AND user_level!='Spammer'\";\t\t//sink point: $username;\n$res = mysql_query($query);\n\n", "id": 312, "slice_label": "bad", "file_name": "good_2350_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var3=sanitize($_GET['id'], 3);\r\n$taint=base64_decode($var3);\r\n$var1 =  table_users .$taint;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 2350, "predict": 0}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"id\"]) && isset($_GET[\"color\"])){\n$query = \"SELECT  * FROM `log_archive_host` WHERE host_id = \" . $_GET[\"id\"] . \" order by date_start desc\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 176, "slice_label": "bad", "file_name": "bad_3816_2.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// php code: \n\tif (isset($_GET[\"id\"]) && isset($_GET[\"color\"])){\n$var1 =  $_GET[\"id\"] ;\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 3816, "predict": 1}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n$query = \"SELECT * FROM `session` WHERE session_id = '\".$pearDB->escape(_PAD_).\"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n\n", "id": 47, "slice_label": "bad", "file_name": "good_2179_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n\t$taint = new CentreonDB();\n$var1 = $taint->escape(_PAD_);\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 2179, "predict": 0}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n\tif (isset($_GET[\"index\"])){\n$query = \"SELECT `command_example` FROM `command` WHERE `command_id` = '\". $pearDB->escape(_PAD_) .\"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n}\n\n", "id": 162, "slice_label": "bad", "file_name": "good_3816_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n\t$taint = new CentreonDB();\n\tif (isset($_GET[\"index\"])){\n$var1 =  $taint->escape(_PAD_) ;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 3816, "predict": 0}, {"slice": "<?php\n// php code: \nif(isset($_GET[\"domain\"]))\n{\n\t$domain = $_GET[\"domain\"];\n}\n$query = \"SELECT * FROM url_referer WHERE referer_domains='\".$domain.\"'GROUP BY url_domains, referer_domains\";\t\t//sink point: $domain;\n$res = mysql_query($query);\n\n", "id": 296, "slice_label": "bad", "file_name": "bad_2318_0.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// php code: \nif(isset($_GET[\"domain\"]))\n{\n\t$taint = $_GET[\"domain\"];\n}\n$var1 = $taint;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 2318, "predict": 1}, {"slice": "<?php\n// php code: \n$query = \"SELECT * FROM `session` WHERE session_id = '\"._PAD_->escape($_GET[\"session_id\"]).\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 46, "slice_label": "bad", "file_name": "good_2179_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var1 = _PAD_->escape($_GET[\"session_id\"]);\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 2179, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$second_category = $_GET['input0'];\n\n// php code: \n    if ($second_category > 0) {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET counter = counter \" . _PAD_ . \" 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 95, "slice_label": "bad", "file_name": "bad_56_6.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var1 = $_GET['input0'];\n\n// php code: \n    if ($var1 > 0) {\n$var2 =  $taint ;\t\t//sink point: $taint;\n$var3 = mysql_query($var2);\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$child = $_GET['input0'];\n\n// php code: \n$query = \"SELECT * FROM bigtree_pages WHERE id = '$child'\");\t\t//sink point: $child;\n$res = mysql_query($query);\n\n", "id": 207, "slice_label": "bad", "file_name": "good_5774_0.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n\n// php code: \n$var1 = \"$taint\" ;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 5774, "predict": 1}, {"slice": "<?php\n// php code: \n$query = \"SELECT user_id FROM `session` WHERE session_id = '\"._PAD_->escape($_GET[\"sid\"]).\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 173, "slice_label": "bad", "file_name": "good_3816_7.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var1 = _PAD_->escape($_GET[\"sid\"]);\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 3816, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n\n// php code: \n\t\tif (isset($_GET[\"sc_svcTpl\"]))\n\t\t\tforeach ($_GET[\"sc_svcTpl\"] as $key)\t{\n$query = \"INSERT INTO service_categories_relation (service_service_id, sc_id) VALUES ('\".$key.\"', '\"._PAD_.\"')\";\t\t//sink point: $key;\n$res = mysql_query($query);\n}\n\n", "id": 36, "slice_label": "bad", "file_name": "bad_2179_5.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n\n// php code: \n\t\tif (isset($_GET[\"sc_svcTpl\"]))\n\t\t\tforeach ($_GET[\"sc_svcTpl\"] as $taint)\t{\n$var1 = $taint;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2179, "predict": 1}, {"slice": "<?php\n// php code: \n$user->checkSuspended();\n$query0 = \"SELECT value FROM \" . $DBPrefix . \"fees WHERE type = 'relist_fee'\";\n$db->direct_query($query0);\n$relist_fee = $db->result('value');\nif (isset($_GET['action']) && $_GET['action'] == 'update') {\n    if (isset($_GET['relist']) && is_array($_GET['relist']) && count($_GET['relist']) > 0) {\n        foreach ($_GET['relist'] as $k) {\n            $params = array();\n            $params[] = array(':auc_id', $k, 'int');\n            $db->query($query0, $params);\n            if ($system->SETTINGS['fees'] == 'y' && !$user->permissions['no_fees'] && $relist_fee > 0) {\n                if ($system->SETTINGS['fee_type'] == 1) {\n                    $db->query($query0, $params);\n                }\n}\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n            $db->direct_query($query0);\n            $db->query($query0, $params);\n            $parent_node = $db->result();\n            $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n            for ($i = 0; $i < count($crumbs); $i++) {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET sub_counter = sub_counter + 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n\n", "id": 127, "slice_label": "bad", "file_name": "good_56_19.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var9->checkSuspended();\n$var4 = \"SELECT value FROM \" . $taint . \"fees WHERE type = 'relist_fee'\";\n$var11->direct_query($var4);\n$var3 = $var11->result('value');\nif (isset($_GET['action']) && $_GET['action'] == 'update') {\n    if (isset($_GET['relist']) && is_array($_GET['relist']) && count($_GET['relist']) > 0) {\n        foreach ($_GET['relist'] as $var12) {\n            $var6 = array();\n            $var6[] = array(':auc_id', $var12, 'int');\n            $var11->query($var4, $var6);\n            if ($var5->SETTINGS['fees'] == 'y' && !$var9->permissions['no_fees'] && $var3 > 0) {\n                if ($var5->SETTINGS['fee_type'] == 1) {\n                    $var11->query($var4, $var6);\n                }\n}\n            $var11->query($var4, $var6);\n            $var11->query($var4, $var6);\n            $var11->query($var4, $var6);\n            $var11->query($var4, $var6);\n            $var11->direct_query($var4);\n            $var11->query($var4, $var6);\n            $var1 = $var11->result();\n            $var7 = $var2->get_bread_crumbs($var1['left_id'], $var1['right_id']);\n            for ($var13 = 0; $var13 < count($var7); $var13++) {\n$var8 =  $taint ;\t\t//sink point: $taint;\n$var10 = mysql_query($var8);\n}\n}\n}\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// php code: \n$id = (isset($_SESSION['CURRENT_ITEM'])) ? intval($_SESSION['CURRENT_ITEM']) : 0;\n$id = (isset($_GET['id'])) ? intval($_GET['id']) : 0;\n$_SESSION['CURRENT_ITEM'] = $id;\n$_SESSION['REDIRECT_AFTER_LOGIN'] = $system->SETTINGS['siteurl'] . 'item.php?id=' . $id;\n$query0 = \"SELECT a.*, ac.counter, u.nick, u.reg_date, u.city, u.country, u.zip FROM \" . $DBPrefix . \"auctions a\n\t        LEFT JOIN \" . $DBPrefix . \"users u ON (u.id = a.user)\n\t        LEFT JOIN \" . $DBPrefix . \"auccounter ac ON (ac.auction_id = a.id)\n\t        WHERE a.id = :auction_id LIMIT 1\";\n$params = array();\n$params[] = array(':auction_id', $id, 'int');\n$db->query($query0, $params);\nif ($db->numrows() == 0) {\n    $_SESSION['msg_title'] = $ERR_622;\n    $_SESSION['msg_body'] = $ERR_623;\n}\n$auction_data = $db->result();\nif (!isset($auction_data['counter'])) {\n    $params[] = array(':counter', $id, 'int');\n    $db->query($query0, $params);\n}\nelse {\n    if (!isset($_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n        $_SESSION['WEBID_VIEWED_AUCTIONS'] = array();\n    }\n    if (!in_array($id, $_SESSION['WEBID_VIEWED_AUCTIONS'])) {\n        $db->query($query0, $params);\n}\n}\nif ($user->logged_in) {\n    $db->query($query0, $params);\n}\n$db->query($query0, $params);\nif ($system->SETTINGS['extra_cat'] == 'y' && intval($auction_data['secondcat']) > 0) {\n    $db->query($query0, $params);\n}\n$db->query($query0, $params);\n$num_bids = $db->numrows();\nif ($user->logged_in && $num_bids > 0) {\n$query = \"SELECT bid FROM \" . $DBPrefix . \"bids WHERE auction = :auction AND bidder = :bidder LIMIT 1\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 102, "slice_label": "bad", "file_name": "bad_56_8.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var12 = (isset($var3['CURRENT_ITEM'])) ? intval($var3['CURRENT_ITEM']) : 0;\n$var12 = (isset($_GET['id'])) ? intval($_GET['id']) : 0;\n$var3['CURRENT_ITEM'] = $var12;\n$var3['REDIRECT_AFTER_LOGIN'] = $var7->SETTINGS['siteurl'] . $var12;\n$var6 = \"SELECT a.*, ac.counter, u.nick, u.reg_date, u.city, u.country, u.zip FROM \" . $taint . \"auctions a\n\t        LEFT JOIN \" . $taint . \"users u ON (u.id = a.user)\n\t        LEFT JOIN \" . $taint . \"auccounter ac ON (ac.auction_id = a.id)\n\t        WHERE a.id = :auction_id LIMIT 1\";\n$var8 = array();\n$var8[] = array(':auction_id', $var12, 'int');\n$var13->query($var6, $var8);\nif ($var13->numrows() == 0) {\n    $var3['msg_title'] = $var5;\n    $var3['msg_body'] = $var4;\n}\n$var1 = $var13->result();\nif (!isset($var1['counter'])) {\n    $var8[] = array(':counter', $var12, 'int');\n    $var13->query($var6, $var8);\n}\nelse {\n    if (!isset($var3['WEBID_VIEWED_AUCTIONS'])) {\n        $var3['WEBID_VIEWED_AUCTIONS'] = array();\n    }\n    if (!in_array($var12, $var3['WEBID_VIEWED_AUCTIONS'])) {\n        $var13->query($var6, $var8);\n}\n}\nif ($var10->logged_in) {\n    $var13->query($var6, $var8);\n}\n$var13->query($var6, $var8);\nif ($var7->SETTINGS['extra_cat'] == 'y' && intval($var1['secondcat']) > 0) {\n    $var13->query($var6, $var8);\n}\n$var13->query($var6, $var8);\n$var2 = $var13->numrows();\nif ($var10->logged_in && $var2 > 0) {\n$var9 =  $taint ;\t\t//sink point: $taint;\n$var11 = mysql_query($var9);\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// php code: \n\tif (isset($_SESSION['centreon'])) {\n$query = \"SELECT user_id FROM session WHERE session_id = '\" . _PAD_->escape($_GET['sid']) . \"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 159, "slice_label": "bad", "file_name": "good_3816_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n\tif (isset($var1['centreon'])) {\n$var2 =  _PAD_->escape($_GET['sid']) ;\t\t//sink point: $_GET;\n$var3 = mysql_query($var2);\n}\n\n", "CVE_database_id": 3816, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$second_category = $_GET['input0'];\n\n// php code: \n    if ($second_category > 0) {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET counter = counter \" . _PAD_ . \" 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 95, "slice_label": "bad", "file_name": "bad_56_6.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var1 = $_GET['input0'];\n\n// php code: \n    if ($var1 > 0) {\n$var2 =  $taint ;\t\t//sink point: $taint;\n$var3 = mysql_query($var2);\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$add = $_GET['input0'];\n$category = $_GET['input1'];\n$second_category = $_GET['input2'];\n\n// php code: \n    $addsub = ($add) ? '+' : '-';\n    $query0 = \"UPDATE \" . $DBPrefix . \"categories SET counter = counter \" . $addsub . \" 1 WHERE cat_id = :cat_id\";\n    $params = array();\n    $params[] = array(':cat_id', $category, 'int');\n    $db->query($query0, $params);\n    $db->query($query0, $params);\n    $parent_node = $db->result();\n    $category_crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n    if ($second_category > 0) {\n        $second_category_crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n        $crumbs = $category_crumbs + $second_category_crumbs;\n    }\nelse {\n        $crumbs = $category_crumbs;\n    }\n    for ($i = 0; $i < count($crumbs); $i++) {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET sub_counter = sub_counter \" . _PAD_ . \" 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 97, "slice_label": "bad", "file_name": "bad_56_6.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var12 = $_GET['input0'];\n$var6 = $_GET['input1'];\n$var3 = $_GET['input2'];\n\n// php code: \n    $var10 = ($var12) ? '+' : '-';\n    $var7 = \"UPDATE \" . $taint . \"categories SET counter = counter \" . $var10 . \" 1 WHERE cat_id = :cat_id\";\n    $var8 = array();\n    $var8[] = array(':cat_id', $var6, 'int');\n    $var14->query($var7, $var8);\n    $var14->query($var7, $var8);\n    $var4 = $var14->result();\n    $var2 = $var5->get_bread_crumbs($var4['left_id'], $var4['right_id']);\n    if ($var3 > 0) {\n        $var1 = $var5->get_bread_crumbs($var4['left_id'], $var4['right_id']);\n        $var9 = $var2 + $var1;\n    }\nelse {\n        $var9 = $var2;\n    }\n    for ($var15 = 0; $var15 < count($var9); $var15++) {\n$var11 =  $taint ;\t\t//sink point: $taint;\n$var13 = mysql_query($var11);\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"o\"]) && $_GET[\"o\"] == \"r\"){\n$query = \"UPDATE session SET update_acl = '1' WHERE session_id = '\"._PAD_->escape($_GET[\"session_id\"]).\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 50, "slice_label": "bad", "file_name": "good_2179_10.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n\tif (isset($_GET[\"o\"]) && $_GET[\"o\"] == \"r\"){\n$var1 = _PAD_->escape($_GET[\"session_id\"]);\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2179, "predict": 0}, {"slice": "<?php\n// php code: \n$query = \"SELECT user_id FROM `session` WHERE session_id = '\".htmlentities(session_id(), ENT_QUOTES, \"UTF-8\").\"' AND user_id = '\".htmlentities($_GET['uid'], ENT_QUOTES, \"UTF-8\").\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 178, "slice_label": "bad", "file_name": "bad_3816_6.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var1 = htmlentities(session_id(), ENT_QUOTES, \"UTF-8\").htmlentities($_GET['uid'], ENT_QUOTES, \"UTF-8\");\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 3816, "predict": 0}, {"slice": "<?php\n// php code: \n$id = (isset($_SESSION['CURRENT_ITEM'])) ? intval($_SESSION['CURRENT_ITEM']) : 0;\n$id = (isset($_GET['id'])) ? intval($_GET['id']) : 0;\n$query0 = \"SELECT a.*, ac.counter, u.nick, u.reg_date, u.city, u.country, u.zip FROM \" . $DBPrefix . \"auctions a\n\t        LEFT JOIN \" . $DBPrefix . \"users u ON (u.id = a.user)\n\t        LEFT JOIN \" . $DBPrefix . \"auccounter ac ON (ac.auction_id = a.id)\n\t        WHERE a.id = :auction_id LIMIT 1\";\n$params = array();\n$params[] = array(':auction_id', $id, 'int');\n$db->query($query0, $params);\n$auction_data = $db->result();\nif (!isset($auction_data['counter'])) {\n    $auction_data['counter'] = 1;\n}\nif ($system->SETTINGS['extra_cat'] == 'y' && intval($auction_data['secondcat']) > 0) {\n$query = \"SELECT left_id, right_id, level FROM \" . $DBPrefix . \"categories WHERE cat_id = :sec_cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 100, "slice_label": "bad", "file_name": "bad_56_8.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var8 = (isset($var2['CURRENT_ITEM'])) ? intval($var2['CURRENT_ITEM']) : 0;\n$var8 = (isset($_GET['id'])) ? intval($_GET['id']) : 0;\n$var3 = \"SELECT a.*, ac.counter, u.nick, u.reg_date, u.city, u.country, u.zip FROM \" . $taint . \"auctions a\n\t        LEFT JOIN \" . $taint . \"users u ON (u.id = a.user)\n\t        LEFT JOIN \" . $taint . \"auccounter ac ON (ac.auction_id = a.id)\n\t        WHERE a.id = :auction_id LIMIT 1\";\n$var5 = array();\n$var5[] = array(':auction_id', $var8, 'int');\n$var9->query($var3, $var5);\n$var1 = $var9->result();\nif (!isset($var1['counter'])) {\n    $var1['counter'] = 1;\n}\nif ($var4->SETTINGS['extra_cat'] == 'y' && intval($var1['secondcat']) > 0) {\n$var6 =  $taint ;\t\t//sink point: $taint;\n$var7 = mysql_query($var6);\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$ids = $_GET['input0'];\n\n// php code: \n\t$non_cached_ids = _get_non_cached_ids( $ids, 'posts' );\n\tif ( !empty( $non_cached_ids ) ) {\n$query = \"SELECT _PAD_->posts.* FROM _PAD_->posts WHERE ID IN (%s)\". join( \",\", $non_cached_ids ) ;\t\t//sink point: $non_cached_ids;\n$res = mysql_query($query);\n}\n\n", "id": 238, "slice_label": "bad", "file_name": "bad_2904_2.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var2 = $_GET['input0'];\n\n// php code: \n\t$taint = _get_non_cached_ids( $var2, 'posts' );\n\tif ( !empty( $taint ) ) {\n$var1 =  join( \",\", $taint ) ;\t\t//sink point: $taint;\n$var3 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2904, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$path = $_GET['input0'];\n\n// php code: \n\t\t\t$x = count($path);\n\t\t\twhile ($x) {\n$query = \"SELECT * FROM bigtree_route_history WHERE old_route = '\".sqlescape(implode(\"/\",array_slice($path,0,_PAD_))).\"'\";\t\t//sink point: $path;\n$res = mysql_query($query);\n}\n\n", "id": 192, "slice_label": "bad", "file_name": "good_5774_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n\n// php code: \n\t\t\t$var3 = count($taint);\n\t\t\twhile ($var3) {\n$var1 = sqlescape(implode(\"/\",array_slice($taint,0,_PAD_)));\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 5774, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$sc = $_GET['input0'];\n\n// php code: \n\t\tforeach ($sc as $key => $value)\t{\n$query = \"SELECT * FROM `command_categories` WHERE `cmd_category_id` = '\".$key.\"' LIMIT 1\";\t\t//sink point: $key;\n$res = mysql_query($query);\n}\n\n", "id": 23, "slice_label": "bad", "file_name": "bad_2179_3.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var4 = $_GET['input0'];\n\n// php code: \n\t\tforeach ($var4 as $taint => $var1)\t{\n$var2 = $taint;\t\t//sink point: $taint;\n$var3 = mysql_query($var2);\n}\n\n", "CVE_database_id": 2179, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$mobileid = $_GET['input0'];\n\n// php code: \n\t\tif ( ! User_Devices_Model::device_registered($mobileid))\n\t\t{\n$query = 'SELECT id FROM '.$this->table_prefix.'users WHERE `email` = \\''._PAD_.'\\' LIMIT 1;';\t\t//sink point: $this;\n$res = mysql_query($query);\n}\n\n", "id": 91, "slice_label": "bad", "file_name": "bad_3703_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var1 = $_GET['input0'];\n\n// php code: \n\t\tif ( ! User_Devices_Model::device_registered($var1))\n\t\t{\n$var2 = $taint->table_prefix;\t\t//sink point: $taint;\n$var3 = mysql_query($var2);\n}\n\n", "CVE_database_id": 3703, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$idList = $_GET['input0'];\n\n// php code: \n\t\t$filter = \"\";\n\t\tif($idList) {\n\t\t\t$filter = \"WHERE \\\"ID\\\" IN(\" .implode(\", \", $idList) . \")\";\n\t\t}\n$query = \"SELECT \\\"ID\\\", \\\"Version\\\" FROM \\\"_PAD_\\\" $filter\";\t\t//sink point: $filter;\n$res = mysql_query($query);\n\n", "id": 344, "slice_label": "bad", "file_name": "good_3551_2.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var1 = $_GET['input0'];\n\n// php code: \n\t\t$taint = \"\";\n\t\tif($var1) {\n\t\t\t$taint = \"WHERE \\\"ID\\\" IN(\" .implode(\", \", $var1) . \")\";\n\t\t}\n$var2 = \"$taint\" ;\t\t//sink point: $taint;\n$var3 = mysql_query($var2);\n\n", "CVE_database_id": 3551, "predict": 1}, {"slice": "<?php\n// php code: \n$id=sanitize($_GET['id'], 3);\r\n$idTemp=base64_decode($id);\r\n$username=sanitize($idTemp ,3);\r\n$query = \"SELECT * FROM `\" . table_users . \"` where `user_login` = '\".$username.\"' AND `last_reset_request` = FROM_UNIXTIME('\"._PAD_.\"') AND user_level!='Spammer'\";\t\t//sink point: $username;\n$res = mysql_query($query);\n\n", "id": 301, "slice_label": "bad", "file_name": "good_2349_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var4=sanitize($_GET['id'], 3);\r\n$var1=base64_decode($var4);\r\n$taint=sanitize($var1 ,3);\r\n$var2 =  table_users .$taint;\t\t//sink point: $taint;\n$var3 = mysql_query($var2);\n\n", "CVE_database_id": 2349, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n\n// php code: \n\t\tif (testServiceCategorieExistence($_GET[\"sc_name\"])){\n$query = \"SELECT MAX(sc_id) FROM `service_categories` WHERE sc_name LIKE '\"._PAD_->escape($_GET[\"sc_name\"]).\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 88, "slice_label": "bad", "file_name": "good_2179_5.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n\n// php code: \n\t\tif (testServiceCategorieExistence($_GET[\"sc_name\"])){\n$var1 = _PAD_->escape($_GET[\"sc_name\"]);\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2179, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$add = $_GET['input0'];\n$second_category = $_GET['input1'];\n\n// php code: \n    $addsub = ($add) ? '+' : '-';\n    if ($second_category > 0) {\n$query = \"UPDATE \" . _PAD_ . \"categories SET counter = counter \" . $addsub . \" 1 WHERE cat_id = :cat_id\";\t\t//sink point: $addsub;\n$res = mysql_query($query);\n}\n\n", "id": 94, "slice_label": "bad", "file_name": "bad_56_6.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var3 = $_GET['input0'];\n$var1 = $_GET['input1'];\n\n// php code: \n    $taint = ($var3) ? '+' : '-';\n    if ($var1 > 0) {\n$var2 =  $taint ;\t\t//sink point: $taint;\n$var4 = mysql_query($var2);\n}\n\n", "CVE_database_id": 56, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$key = $_GET['input0'];\n$max_age = $_GET['input1'];\n\n// php code: \n\t\t\t$key = sqlescape($key);\n\t\t\tif ($max_age) {\n}\nelse {\n$query = \"SELECT * FROM bigtree_caches WHERE `identifier` = '_PAD_' AND `key` = '$key'\";\t\t//sink point: $key;\n$res = mysql_query($query);\n\t\t\t}\n\n", "id": 183, "slice_label": "bad", "file_name": "good_5774_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n$var1 = $_GET['input1'];\n\n// php code: \n\t\t\t$taint = sqlescape($taint);\n\t\t\tif ($var1) {\n}\nelse {\n$var2 = \"$taint\" . \"\";\t\t//sink point: $taint;\n$var3 = mysql_query($var2);\n\t\t\t}\n\n", "CVE_database_id": 5774, "predict": 1}, {"slice": "<?php\n// php code: \nif (isset($_GET['action']) && $_GET['action'] == 'delopenauctions') {\n    if (isset($_GET['O_delete']) && is_array($_GET['O_delete']) && count($_GET['O_delete']) > 0) {\n$query = \"UPDATE \" . $DBPrefix ;\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 117, "slice_label": "bad", "file_name": "good_56_15.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \nif (isset($_GET['action']) && $_GET['action'] == 'delopenauctions') {\n    if (isset($_GET['O_delete']) && is_array($_GET['O_delete']) && count($_GET['O_delete']) > 0) {\n$var1 =  $taint ;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n}\n\n", "CVE_database_id": 56, "predict": 0}, {"slice": "<?php\n// php code: \n$catscontrol = new MPTTcategories();\nif (isset($_GET['action'])) {\n    if (!empty($_GET['id']) && !empty($_GET['title']) && !empty($_GET['duration']) && !empty($_GET['category']) && !empty($_GET['description']) && !empty($_GET['min_bid'])) {\n        if ($_GET['quantity'] < 1) {\n}\nelse if (isset($_GET['current_bid']) && $_GET['current_bid'] < $_GET['min_bid'] && $_GET['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_GET['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_GET['category']) {\n                $parent_node = $db->result();\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                $cta = intval($AUCTION['category']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n}\n            if ($AUCTION['secondcat'] != $_GET['secondcat']) {\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                $cta = intval($AUCTION['secondcat']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                for ($i = 0; $i < count($crumbs); $i++) {\n                    if ($crumbs[$i]['cat_id'] == $cta) {\n}\nelse {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET sub_counter = sub_counter - 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                    }\n}\n}\n}\n}\n}\n\n", "id": 114, "slice_label": "bad", "file_name": "good_56_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var1 = new MPTTcategories();\nif (isset($_GET['action'])) {\n    if (!empty($_GET['id']) && !empty($_GET['title']) && !empty($_GET['duration']) && !empty($_GET['category']) && !empty($_GET['description']) && !empty($_GET['min_bid'])) {\n        if ($_GET['quantity'] < 1) {\n}\nelse if (isset($_GET['current_bid']) && $_GET['current_bid'] < $_GET['min_bid'] && $_GET['current_bid'] != 0) {\n}\nelse {\n            $var4 = \"SELECT * from \" . $taint . \"auctions WHERE id = :auc_id\";\n            $var5 = array();\n            $var5[] = array(':auc_id', $_GET['id'], 'int');\n            $var10->query($var4, $var5);\n            $var3 = $var10->result();\n            if ($var3['category'] != $_GET['category']) {\n                $var2 = $var10->result();\n                $var6 = $var1->get_bread_crumbs($var2['left_id'], $var2['right_id']);\n                $var8 = intval($var3['category']);\n                $var6 = $var1->get_bread_crumbs($var2['left_id'], $var2['right_id']);\n}\n            if ($var3['secondcat'] != $_GET['secondcat']) {\n                $var6 = $var1->get_bread_crumbs($var2['left_id'], $var2['right_id']);\n                $var8 = intval($var3['secondcat']);\n                $var6 = $var1->get_bread_crumbs($var2['left_id'], $var2['right_id']);\n                for ($var11 = 0; $var11 < count($var6); $var11++) {\n                    if ($var6[$var11]['cat_id'] == $var8) {\n}\nelse {\n$var7 =  $taint ;\t\t//sink point: $taint;\n$var9 = mysql_query($var7);\n                    }\n}\n}\n}\n}\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n\n// php code: \n\t\tif (testCommandCategorieExistence($_GET[\"category_name\"])){\n$query = \"INSERT INTO `command_categories` (`category_name` , `category_alias`, `category_order`) VALUES ('\".$pearDB->escape(_PAD_).\"', '\".$pearDB->escape(_PAD_).\"', '1')\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n\t\t}\n\n", "id": 80, "slice_label": "bad", "file_name": "good_2179_3.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n\n// php code: \n\t\tif (testCommandCategorieExistence($_GET[\"category_name\"])){\n$var1 = $taint->escape(_PAD_).$taint->escape(_PAD_);\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\t\t}\n\n", "CVE_database_id": 2179, "predict": 0}, {"slice": "<?php\n// php code: \n$query = \"SELECT * FROM session WHERE session_id = '\" . _PAD_->escape($_GET['session']) . \"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n\n", "id": 163, "slice_label": "bad", "file_name": "good_3816_2.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var1 =  _PAD_->escape($_GET['session']) ;\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 3816, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$path = $_GET['input0'];\n\n// php code: \n\t\t\t$x = count($path);\n\t\t\twhile ($x) {\n$query = \"SELECT * FROM bigtree_route_history WHERE old_route = '\".implode(\"/\",array_slice(_PAD_,0,$x)).\"'\";\t\t//sink point: $x;\n$res = mysql_query($query);\n}\n\n", "id": 227, "slice_label": "bad", "file_name": "bad_5774_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var2 = $_GET['input0'];\n\n// php code: \n\t\t\t$taint = count($var2);\n\t\t\twhile ($taint) {\n$var1 = implode(\"/\",array_slice(_PAD_,0,$taint));\t\t//sink point: $taint;\n$var3 = mysql_query($var1);\n}\n\n", "CVE_database_id": 5774, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n\n// php code: \n\t\tif (testServiceCategorieExistence($_GET[\"sc_name\"])){\n$query = \"SELECT MAX(sc_id) FROM `service_categories` WHERE sc_name LIKE '\".$pearDB->escape(_PAD_).\"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n}\n\n", "id": 89, "slice_label": "bad", "file_name": "good_2179_5.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n\n// php code: \n\t\tif (testServiceCategorieExistence($_GET[\"sc_name\"])){\n$var1 = $taint->escape(_PAD_);\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2179, "predict": 0}, {"slice": "<?php\n// php code: \nif (isset($_GET['action']) && isset($_GET['username']) && isset($_GET['password'])) {\n    $query0 = \"SELECT id, hash, suspended, password, password_type FROM \" . $DBPrefix . \"users WHERE nick = :nick OR email = :email\";\n    $params = array();\n    $params[] = array(':nick', $system->cleanvars($_GET['username']), 'str');\n    $params[] = array(':email', $system->cleanvars($_GET['username']), 'str');\n    $db->query($query0, $params);\n    $user_data = $db->result();\n    if ($user_data['password_type'] == 0 && $user_data['password'] == md5($MD5_PREFIX . $_GET['password'])) {\n$query = \"UPDATE \" . $DBPrefix . \"users SET password = :password, password_type = 1 WHERE id = :user_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 116, "slice_label": "bad", "file_name": "good_56_14.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \nif (isset($_GET['action']) && isset($_GET['username']) && isset($_GET['password'])) {\n    $var3 = \"SELECT id, hash, suspended, password, password_type FROM \" . $taint . \"users WHERE nick = :nick OR email = :email\";\n    $var5 = array();\n    $var5[] = array(':nick', $var4->cleanvars($_GET['username']), 'str');\n    $var5[] = array(':email', $var4->cleanvars($_GET['username']), 'str');\n    $var8->query($var3, $var5);\n    $var2 = $var8->result();\n    if ($var2['password_type'] == 0 && $var2['password'] == md5($var1 . $_GET['password'])) {\n$var6 =  $taint ;\t\t//sink point: $taint;\n$var7 = mysql_query($var6);\n}\n}\n\n", "CVE_database_id": 56, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n$delete_all = $_GET['input1'];\n\n// php code: \n\t$type_column = sanitize_key($meta_type . '_id');\n\tif ( $delete_all ) {\n$query = \"SELECT $type_column FROM _PAD_ WHERE meta_key = %s _PAD_\";\t\t//sink point: $type_column;\n$res = mysql_query($query);\n\t}\n\n", "id": 257, "slice_label": "bad", "file_name": "bad_2904_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var2 = $_GET['input0'];\n$var1 = $_GET['input1'];\n\n// php code: \n\t$taint = sanitize_key($var2 . '_id');\n\tif ( $var1 ) {\n$var3 = \"$taint\" ;\t\t//sink point: $taint;\n$var4 = mysql_query($var3);\n\t}\n\n", "CVE_database_id": 2904, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$id = $_GET['input0'];\n\n// php code: \n\t\t\tif (substr($id,0,1) == \"p\") {\n}\nelse if ($id == 0) {\n}\nelse {\n$query = \"SELECT path FROM bigtree_pages WHERE id = '\".sqlescape($id).\"'\");\t\t//sink point: $id;\n$res = mysql_query($query);\n}\n\n", "id": 211, "slice_label": "bad", "file_name": "good_5774_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n\n// php code: \n\t\t\tif (substr($taint,0,1) == \"p\") {\n}\nelse if ($taint == 0) {\n}\nelse {\n$var1 = sqlescape($taint);\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 5774, "predict": 1}, {"slice": "<?php\n// php code: \n$user->checkSuspended();\n$query0 = \"SELECT value FROM \" . $DBPrefix . \"fees WHERE type = 'relist_fee'\";\n$db->direct_query($query0);\n$relist_fee = $db->result('value');\nif (isset($_GET['action']) && $_GET['action'] == 'update') {\n    if (isset($_GET['relist']) && is_array($_GET['relist']) && count($_GET['relist']) > 0) {\n        foreach ($_GET['relist'] as $k) {\n            if ($system->SETTINGS['fees'] == 'y' && !$user->permissions['no_fees'] && $relist_fee > 0) {\n                if ($system->SETTINGS['fee_type'] == 1) {\n$query = \"UPDATE \" . $DBPrefix . \"users SET balance = balance - :relist_fee WHERE id = :user_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n}\n}\n}\n\n", "id": 124, "slice_label": "bad", "file_name": "good_56_16.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var5->checkSuspended();\n$var2 = \"SELECT value FROM \" . $taint . \"fees WHERE type = 'relist_fee'\";\n$var7->direct_query($var2);\n$var1 = $var7->result('value');\nif (isset($_GET['action']) && $_GET['action'] == 'update') {\n    if (isset($_GET['relist']) && is_array($_GET['relist']) && count($_GET['relist']) > 0) {\n        foreach ($_GET['relist'] as $var8) {\n            if ($var3->SETTINGS['fees'] == 'y' && !$var5->permissions['no_fees'] && $var1 > 0) {\n                if ($var3->SETTINGS['fee_type'] == 1) {\n$var4 =  $taint ;\t\t//sink point: $taint;\n$var6 = mysql_query($var4);\n}\n}\n}\n}\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"host_id\"]) && isset($_GET[\"id\"]) && isset($_GET[\"color\"])){\n$query = \"SELECT  * FROM `log_archive_service` WHERE host_id = '\".$_GET[\"host_id\"].\"' AND service_id = \".$_GET[\"id\"].\" ORDER BY `date_start` DESC\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 177, "slice_label": "bad", "file_name": "bad_3816_4.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// php code: \n\tif (isset($_GET[\"host_id\"]) && isset($_GET[\"id\"]) && isset($_GET[\"color\"])){\n$var1 = $_GET[\"host_id\"].$_GET[\"id\"];\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 3816, "predict": 1}, {"slice": "<?php\n// php code: \nif (isset($_GET['action']) && isset($_GET['username']) && isset($_GET['password'])) {\n$query = \"SELECT id, hash, suspended, password, password_type FROM \" . $DBPrefix . \"users WHERE nick = :nick OR email = :email\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 115, "slice_label": "bad", "file_name": "good_56_14.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \nif (isset($_GET['action']) && isset($_GET['username']) && isset($_GET['password'])) {\n$var1 =  $taint ;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 56, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$table = _get_meta_table( $meta_type );\n$query = \"SELECT _PAD_ FROM $table WHERE meta_key = %s AND _PAD_ = %d\";\t\t//sink point: $table;\n$res = mysql_query($query);\n\n", "id": 240, "slice_label": "bad", "file_name": "good_2904_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var1 = $_GET['input0'];\n\n// php code: \n\t$taint = _get_meta_table( $var1 );\n$var2 = \"$taint\" . \"\";\t\t//sink point: $taint;\n$var3 = mysql_query($var2);\n\n", "CVE_database_id": 2904, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$id_column = 'user' == $meta_type ? 'umeta_id' : 'meta_id';\n$query = \"SELECT $id_column FROM _PAD_ WHERE meta_key = %s AND _PAD_ = %d\";\t\t//sink point: $id_column;\n$res = mysql_query($query);\n\n", "id": 239, "slice_label": "bad", "file_name": "good_2904_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var1 = $_GET['input0'];\n\n// php code: \n\t$taint = 'user' == $var1 ? 'umeta_id' : 'meta_id';\n$var2 = \"$taint\" . \"\";\t\t//sink point: $taint;\n$var3 = mysql_query($var2);\n\n", "CVE_database_id": 2904, "predict": 0}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"host_id\"]) && $_GET[\"host_id\"]){\n$query = \"SELECT host_id, host_name FROM host WHERE host_template_model_htm_id = '\".$pearDB->escape(_PAD_).\"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n}\n\n", "id": 86, "slice_label": "bad", "file_name": "good_2179_4.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n\tif (isset($_GET[\"host_id\"]) && $_GET[\"host_id\"]){\n$var1 = $taint->escape(_PAD_);\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2179, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$object = $_GET['input0'];\n\n// php code: \n\t   if (isset($object->id)) {\n$query = \"UPDATE \" . _PAD_->prefix . _PAD_ . \" SET \" . _PAD_ . \"=1 WHERE id=\" . $object->id;\t\t//sink point: $object;\n$res = mysql_query($query);\n}\n\n", "id": 142, "slice_label": "bad", "file_name": "good_5278_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n\n// php code: \n\t   if (isset($taint->id)) {\n$var1 =  _PAD_->prefix . $taint->id;\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 5278, "predict": 0}, {"slice": "<?php\n// php code: \nif (!empty($_GET['user_id'])) {\n    $user_id = intval($_GET['user_id']);\n    $user->checkUserValid($user_id);\n}\nelse if ($user->logged_in) {\n    $user_id = $user->user_data['id'];\n}\n$query0 = \"SELECT count(id) AS auctions FROM \" . $DBPrefix . \"auctions\n\t\tWHERE user = :user_id\n\t\tAND closed = 1\";\n$params = array();\n$params[] = array(':user_id', $user_id, 'int');\n$db->query($query0, $params);\n$db->query($query0, $params);\n$auction_data = $db->fetchall();\nforeach ($auction_data as $row) {\n$query = \"SELECT bid FROM \" . $DBPrefix . \"bids WHERE auction = :user_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n\n", "id": 137, "slice_label": "bad", "file_name": "good_56_3.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \nif (!empty($_GET['user_id'])) {\n    $var2 = intval($_GET['user_id']);\n    $var6->checkUserValid($var2);\n}\nelse if ($var6->logged_in) {\n    $var2 = $var6->user_data['id'];\n}\n$var3 = \"SELECT count(id) AS auctions FROM \" . $taint . \"auctions\n\t\tWHERE user = :user_id\n\t\tAND closed = 1\";\n$var4 = array();\n$var4[] = array(':user_id', $var2, 'int');\n$var9->query($var3, $var4);\n$var9->query($var3, $var4);\n$var1 = $var9->fetchall();\nforeach ($var1 as $var8) {\n$var5 =  $taint ;\t\t//sink point: $taint;\n$var7 = mysql_query($var5);\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// php code: \n$catscontrol = new MPTTcategories();\nif (isset($_GET['action'])) {\n    if (!empty($_GET['id']) && !empty($_GET['title']) && !empty($_GET['duration']) && !empty($_GET['category']) && !empty($_GET['description']) && !empty($_GET['min_bid'])) {\n        if ($_GET['quantity'] < 1) {\n}\nelse if (isset($_GET['current_bid']) && $_GET['current_bid'] < $_GET['min_bid'] && $_GET['current_bid'] != 0) {\n}\nelse {\n            $query0 = \"SELECT * from \" . $DBPrefix . \"auctions WHERE id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $_GET['id'], 'int');\n            $db->query($query0, $params);\n            $AUCTION = $db->result();\n            if ($AUCTION['category'] != $_GET['category']) {\n                $parent_node = $db->result();\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                $cta = intval($AUCTION['category']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n}\n            if ($AUCTION['secondcat'] != $_GET['secondcat']) {\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                $cta = intval($AUCTION['secondcat']);\n                $crumbs = $catscontrol->get_bread_crumbs($parent_node['left_id'], $parent_node['right_id']);\n                for ($i = 0; $i < count($crumbs); $i++) {\n                    if ($crumbs[$i]['cat_id'] == $cta) {\n$query = \"UPDATE \" . $DBPrefix . \"categories SET counter = counter - 1, sub_counter = sub_counter - 1 WHERE cat_id = :cat_id\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n                    }\n}\n}\n}\n}\n}\n\n", "id": 113, "slice_label": "bad", "file_name": "good_56_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n$var1 = new MPTTcategories();\nif (isset($_GET['action'])) {\n    if (!empty($_GET['id']) && !empty($_GET['title']) && !empty($_GET['duration']) && !empty($_GET['category']) && !empty($_GET['description']) && !empty($_GET['min_bid'])) {\n        if ($_GET['quantity'] < 1) {\n}\nelse if (isset($_GET['current_bid']) && $_GET['current_bid'] < $_GET['min_bid'] && $_GET['current_bid'] != 0) {\n}\nelse {\n            $var4 = \"SELECT * from \" . $taint . \"auctions WHERE id = :auc_id\";\n            $var5 = array();\n            $var5[] = array(':auc_id', $_GET['id'], 'int');\n            $var10->query($var4, $var5);\n            $var3 = $var10->result();\n            if ($var3['category'] != $_GET['category']) {\n                $var2 = $var10->result();\n                $var6 = $var1->get_bread_crumbs($var2['left_id'], $var2['right_id']);\n                $var8 = intval($var3['category']);\n                $var6 = $var1->get_bread_crumbs($var2['left_id'], $var2['right_id']);\n}\n            if ($var3['secondcat'] != $_GET['secondcat']) {\n                $var6 = $var1->get_bread_crumbs($var2['left_id'], $var2['right_id']);\n                $var8 = intval($var3['secondcat']);\n                $var6 = $var1->get_bread_crumbs($var2['left_id'], $var2['right_id']);\n                for ($var11 = 0; $var11 < count($var6); $var11++) {\n                    if ($var6[$var11]['cat_id'] == $var8) {\n$var7 =  $taint ;\t\t//sink point: $taint;\n$var9 = mysql_query($var7);\n                    }\n}\n}\n}\n}\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// php code: \n\t$pearDB = new CentreonDB();\n\tif (isset($_SESSION['centreon'])) {\n$query = \"SELECT user_id FROM session WHERE session_id = '\" . $pearDB->escape(_PAD_) . \"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n}\n\n", "id": 160, "slice_label": "bad", "file_name": "good_3816_0.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n\t$taint = new CentreonDB();\n\tif (isset($var1['centreon'])) {\n$var2 =  $taint->escape(_PAD_) ;\t\t//sink point: $taint;\n$var3 = mysql_query($var2);\n}\n\n", "CVE_database_id": 3816, "predict": 0}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"o\"]) && $_GET[\"o\"] == \"r\"){\n$query = \"UPDATE session SET update_acl = '1' WHERE session_id = '\".$pearDB->escape(_PAD_).\"'\";\t\t//sink point: $pearDB;\n$res = mysql_query($query);\n}\n\n", "id": 51, "slice_label": "bad", "file_name": "good_2179_10.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n\tif (isset($_GET[\"o\"]) && $_GET[\"o\"] == \"r\"){\n$var1 = $taint->escape(_PAD_);\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2179, "predict": 0}, {"slice": "<?php\n// controlable parameters: \n$page = $_GET['input0'];\n\n// php code: \n$query = \"SELECT bigtree_modules.class FROM bigtree_modules JOIN bigtree_templates ON bigtree_modules.id = bigtree_templates.module WHERE bigtree_templates.id = '\".$page[\"template\"].\"'\";\t\t//sink point: $page;\n$res = mysql_query($query);\n\n", "id": 229, "slice_label": "bad", "file_name": "bad_5774_0.php", "rule": "CVI_10002", "label": "bad", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$taint = $_GET['input0'];\n\n// php code: \n$var1 = $taint[\"template\"];\t\t//sink point: $taint;\n$var2 = mysql_query($var1);\n\n", "CVE_database_id": 5774, "predict": 1}, {"slice": "<?php\n// php code: \nif (isset($_GET['action']) && $_GET['action'] == 'delopenauctions') {\n    if (isset($_GET['O_delete']) && is_array($_GET['O_delete']) && count($_GET['O_delete']) > 0) {\n        foreach ($_GET['O_delete'] as $k => $v) {\n            $query0 = \"DELETE FROM \" . $DBPrefix . \"auccounter WHERE auction_id = :auc_id\";\n            $params = array();\n            $params[] = array(':auc_id', $v, 'int');\n            $db->query($query0, $params);\n            $db->query($query0, $params);\n}\n        $db->query($query0, $params);\n}\n    if (isset($_GET['closenow']) && is_array($_GET['closenow']) && count($_GET['closenow']) > 0) {\n        foreach ($_GET['closenow'] as $k => $v) {\n            $db->query($query0, $params);\n        }\n}\n}\n$db->query($query0, $params);\n$db->query($query0, $params);\nwhile ($item = $db->fetch()) {\n    if ($item['num_bids'] > 0) {\n$query = \"SELECT bid FROM \" . $DBPrefix . \"bids WHERE auction = :auc_id ORDER BY bid DESC, id DESC LIMIT 1\";\t\t//sink point: $DBPrefix;\n$res = mysql_query($query);\n}\n}\n\n", "id": 119, "slice_label": "bad", "file_name": "good_56_15.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \nif (isset($_GET['action']) && $_GET['action'] == 'delopenauctions') {\n    if (isset($_GET['O_delete']) && is_array($_GET['O_delete']) && count($_GET['O_delete']) > 0) {\n        foreach ($_GET['O_delete'] as $var7 => $v) {\n            $var1 = \"DELETE FROM \" . $taint . \"auccounter WHERE auction_id = :auc_id\";\n            $var2 = array();\n            $var2[] = array(':auc_id', $v, 'int');\n            $var6->query($var1, $var2);\n            $var6->query($var1, $var2);\n}\n        $var6->query($var1, $var2);\n}\n    if (isset($_GET['closenow']) && is_array($_GET['closenow']) && count($_GET['closenow']) > 0) {\n        foreach ($_GET['closenow'] as $var7 => $v) {\n            $var6->query($var1, $var2);\n        }\n}\n}\n$var6->query($var1, $var2);\n$var6->query($var1, $var2);\nwhile ($var4 = $var6->fetch()) {\n    if ($var4['num_bids'] > 0) {\n$var3 =  $taint ;\t\t//sink point: $taint;\n$var5 = mysql_query($var3);\n}\n}\n\n", "CVE_database_id": 56, "predict": 1}, {"slice": "<?php\n// controlable parameters: \n$meta_type = $_GET['input0'];\n\n// php code: \n\t$id_column = ( 'user' == $meta_type ) ? 'umeta_id' : 'meta_id';\n$query = \"SELECT * FROM _PAD_ WHERE $id_column = %d\";\t\t//sink point: $id_column;\n$res = mysql_query($query);\n\n", "id": 249, "slice_label": "bad", "file_name": "good_2904_1.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// controlable parameters: \n$var1 = $_GET['input0'];\n\n// php code: \n\t$taint = ( 'user' == $var1 ) ? 'umeta_id' : 'meta_id';\n$var2 = \"$taint\" ;\t\t//sink point: $taint;\n$var3 = mysql_query($var2);\n\n", "CVE_database_id": 2904, "predict": 0}, {"slice": "<?php\n// php code: \n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]) {\n$query = \"SELECT user_id FROM session where session_id = '\"._PAD_->escape($_GET[\"sid\"]).\"'\";\t\t//sink point: $_GET;\n$res = mysql_query($query);\n}\n\n", "id": 14, "slice_label": "bad", "file_name": "good_2179_9.php", "rule": "CVI_10002", "label": "good", "message": "", "renamed_slice": "<?php\n// php code: \n\tif (isset($_GET[\"sid\"]) && $_GET[\"sid\"]) {\n$var1 = _PAD_->escape($_GET[\"sid\"]);\t\t//sink point: $_GET;\n$var2 = mysql_query($var1);\n}\n\n", "CVE_database_id": 2179, "predict": 0}]